{
    "items": [
        {
            "tags": [
                "windows-vista",
                "python-2.7"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 66736,
                        "reputation": 7916,
                        "user_id": 195644,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "xaav"
                    },
                    "reply_to_user": {
                        "account_id": 212122,
                        "reputation": 294472,
                        "user_id": 464744,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "Blender"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1307458704,
                    "post_id": 6260149,
                    "comment_id": 7312390,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows#comment7312390_6260149",
                    "body": "Add that as an answer and I&#39;ll mark it as correct."
                },
                {
                    "owner": {
                        "account_id": 286372,
                        "reputation": 2528,
                        "user_id": 585592,
                        "user_type": "registered",
                        "display_name": "Fernando Macedo"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1418911478,
                    "post_id": 6260149,
                    "comment_id": 43522877,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows#comment43522877_6260149",
                    "body": "@xaav, since the Blender answer was removed (I don&#39;t know why), can you endorse my answer marking it as correct, since it shows a fix to the problem? Thanks!"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 397124,
                                "reputation": 18825,
                                "user_id": 761090,
                                "user_type": "registered",
                                "accept_rate": 70,
                                "display_name": "eudoxos"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1352232968,
                            "post_id": 8464306,
                            "comment_id": 18068804,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/8464306#comment18068804_8464306",
                            "body": "I keep getting permission error, despite priviledges being set to my best knowledge correctly (the user is an administrator, the script runs in non-elevated mode). What could be the cause?"
                        },
                        {
                            "owner": {
                                "account_id": 286372,
                                "reputation": 2528,
                                "user_id": 585592,
                                "user_type": "registered",
                                "display_name": "Fernando Macedo"
                            },
                            "reply_to_user": {
                                "account_id": 397124,
                                "reputation": 18825,
                                "user_id": 761090,
                                "user_type": "registered",
                                "accept_rate": 70,
                                "display_name": "eudoxos"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1353503495,
                            "post_id": 8464306,
                            "comment_id": 18465637,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/8464306#comment18465637_8464306",
                            "body": "@eudoxos your python process need to be started with admin privileges. This can be done running it from an elevated cmd.exe."
                        },
                        {
                            "owner": {
                                "account_id": 397124,
                                "reputation": 18825,
                                "user_id": 761090,
                                "user_type": "registered",
                                "accept_rate": 70,
                                "display_name": "eudoxos"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1353577666,
                            "post_id": 8464306,
                            "comment_id": 18491849,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/8464306#comment18491849_8464306",
                            "body": "I&#39;ve already found this out somewhere on the web. It is totally stupid, that the an administrator must launch its own process elevated to get it working. Since it is a user program, I cannot request users to run it in elevated mode. Security design made in microsoft."
                        },
                        {
                            "owner": {
                                "account_id": 25805,
                                "reputation": 22730,
                                "user_id": 66629,
                                "user_type": "registered",
                                "display_name": "Gian Marco"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1361642276,
                            "post_id": 8464306,
                            "comment_id": 21145732,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/8464306#comment21145732_8464306",
                            "body": "For some obscure (at least to me) security reason, Microsoft enginneer  decided to allow creation of symlinks just to members of &#39;Administrators&#39; group. It is possible to change this with using &quot;Local Security Policy&quot; tool (&#39;Create symbolic links&#39; option).  Unfortunately this does not work for users in Administrators group due to UAC: <a href=\"http://social.technet.microsoft.com/Forums/en-US/itprovistasecurity/thread/cb593ad0-9edc-4cd1-bb67-46c360b45f91\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/itprovistasecurity&zwnj;&#8203;/&hellip;</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 286372,
                        "reputation": 2528,
                        "user_id": 585592,
                        "user_type": "registered",
                        "display_name": "Fernando Macedo"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 29,
                    "last_activity_date": 1418155246,
                    "last_edit_date": 1495541410,
                    "creation_date": 1323610059,
                    "answer_id": 8464306,
                    "question_id": 6260149,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/8464306#8464306",
                    "body": "<p>There's a way to fix this, patching the <strong>os</strong> module on your's python environment start.</p>\n\n<p>The function to create symlinks is already avaliable from Windows API, you only need do call it.</p>\n\n<p>During python's startup, an attempt is made to import a module named <strong>sitecustomize.py</strong>, on the <a href=\"http://docs.python.org/library/site.html\" rel=\"noreferrer\">site-packages directory</a>. We will use this hook to attach our function to the os module.</p>\n\n<p>Put this code on the file sitecustomize.py:</p>\n\n<pre><code>import os\n\n__CSL = None\ndef symlink(source, link_name):\n    '''symlink(source, link_name)\n       Creates a symbolic link pointing to source named link_name'''\n    global __CSL\n    if __CSL is None:\n        import ctypes\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        __CSL = csl\n    flags = 0\n    if source is not None and os.path.isdir(source):\n        flags = 1\n    if __CSL(link_name, source, flags) == 0:\n        raise ctypes.WinError()\n\nos.symlink = symlink\n</code></pre>\n\n<hr>\n\n<p>Your Python process needs to be started with enabled \"Create symbolic links\" privilege, this is not a Python issue, every program that claims to use this Windows API will need it. This can be done running your Python interpreter from an elevated <code>cmd.exe</code>. A better alternative is to grant the privilege to the user, provided your Windows edition ships with the required Group Policy editor (<code>gpedit.msc</code>). See the screenshot below. You can adjust the value to include whatever user or security group requires this kind of privilege without compromising on the security of the administrative accounts.</p>\n\n<p><img src=\"https://i.stack.imgur.com/O8rns.png\" alt=\"The group policy editor\"></p>\n\n<p><strong>Note:</strong> Code snippet from <a href=\"https://stackoverflow.com/questions/1447575/symlinks-on-windows/4388195#4388195\">here</a></p>\n"
                },
                {
                    "owner": {
                        "account_id": 25805,
                        "reputation": 22730,
                        "user_id": 66629,
                        "user_type": "registered",
                        "display_name": "Gian Marco"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 21,
                    "last_activity_date": 1361642865,
                    "creation_date": 1361642865,
                    "answer_id": 15043806,
                    "question_id": 6260149,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/15043806#15043806",
                    "body": "<p>Like the Fernando Macedo answer, but IMO less invasive:</p>\n\n<pre><code>def symlink(source, link_name):\n    import os\n    os_symlink = getattr(os, \"symlink\", None)\n    if callable(os_symlink):\n        os_symlink(source, link_name)\n    else:\n        import ctypes\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        flags = 1 if os.path.isdir(source) else 0\n        if csl(link_name, source, flags) == 0:\n            raise ctypes.WinError()\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 249576,
                                "reputation": 3185,
                                "user_id": 525741,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "William Payne"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1471361221,
                            "post_id": 28382515,
                            "comment_id": 65310403,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/28382515#comment65310403_28382515",
                            "body": "I understand that the function is designed to be a noop if a permissions problem is encountered, but I do not understand why the ctypes.WinError exception is raised at all if it is always going to be swallowed by the exception handler? Is this a placeholder to enable a developer to choose to do something different with the exception, or am I missing a subtlety here?"
                        },
                        {
                            "owner": {
                                "account_id": 414465,
                                "reputation": 13269,
                                "user_id": 788700,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "Adobe"
                            },
                            "reply_to_user": {
                                "account_id": 249576,
                                "reputation": 3185,
                                "user_id": 525741,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "William Payne"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1471362227,
                            "post_id": 28382515,
                            "comment_id": 65311079,
                            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/28382515#comment65311079_28382515",
                            "body": "@WilliamPayne: as far as I remember, it was making links given it has sufficient permissions, but would raise <code>WinError</code> in case <code>csl(link_name, source.replace(&#39;&#47;&#39;, &#39;\\\\&#39;), flags) == 0</code> -- in which case it would also make a link. So everything worked, and I didn&#39;t understand why the <code>WinError</code>. So I just suppressed the error."
                        }
                    ],
                    "owner": {
                        "account_id": 414465,
                        "reputation": 13269,
                        "user_id": 788700,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "Adobe"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 11,
                    "last_activity_date": 1423477930,
                    "last_edit_date": 1495540042,
                    "creation_date": 1423314765,
                    "answer_id": 28382515,
                    "question_id": 6260149,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/28382515#28382515",
                    "body": "<p>Like Gian Marco Gherardi <a href=\"https://stackoverflow.com/a/15043806/788700\">answer</a> but defines <code>os.symlink</code> on windows, so that your code can safely work on windows and linux:</p>\n\n<pre><code>import os\nos_symlink = getattr(os, \"symlink\", None)\nif callable(os_symlink):\n    pass\nelse:\n    def symlink_ms(source, link_name):\n        import ctypes\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        flags = 1 if os.path.isdir(source) else 0\n        if csl(link_name, source, flags) == 0:\n            raise ctypes.WinError()\n    os.symlink = symlink_ms\n</code></pre>\n\n<p>If you run your script as administrator everything is fine, if you want to run it as user -- you have to <a href=\"https://stackoverflow.com/a/8464306/788700\">grant python a permission to make symlinks</a> -- which only possible under windows vista+ ultimate or professional.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Gian Marco Gherardi <a href=\"https://stackoverflow.com/a/15043806/788700\">answer</a> creates a link to a unix path: <code>like/this</code> and it doesn't work. The fix is to do <code>source.replace('/', '\\\\')</code>:</p>\n\n<pre><code># symlink support under windows:\nimport os\nos_symlink = getattr(os, \"symlink\", None)\nif callable(os_symlink):\n    pass\nelse:\n    def symlink_ms(source, link_name):\n        import ctypes\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        flags = 1 if os.path.isdir(source) else 0\n        if csl(link_name, source.replace('/', '\\\\'), flags) == 0:\n            raise ctypes.WinError()\n    os.symlink = symlink_ms\n</code></pre>\n\n<p>Another way is to use window's vista+ <code>mklink</code> utility. But using this utility requires same permissions. Still:</p>\n\n<pre><code># symlink support under windows:\nimport os\nos_symlink = getattr(os, \"symlink\", None)\nif callable(os_symlink):\n    pass\nelse:\n    def symlink_ms(source, link_name):\n        os.system(\"mklink {link} {target}\".format(\n            link = link_name,\n            target = source.replace('/', '\\\\')))\n    os.symlink = symlink_ms\n</code></pre>\n\n<p><strong>Edit 2</strong>:</p>\n\n<p>Here's what I'm finally using: this script makes a link under windows if the user has a privilage to do so, otherwise it just doesn't make a link:</p>\n\n<pre><code>import os\nif os.name == \"nt\":\n    def symlink_ms(source, link_name):\n        import ctypes\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        flags = 1 if os.path.isdir(source) else 0\n        try:\n            if csl(link_name, source.replace('/', '\\\\'), flags) == 0:\n                raise ctypes.WinError()\n        except:\n            pass\n    os.symlink = symlink_ms\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 12092831,
                        "reputation": 91,
                        "user_id": 8838145,
                        "user_type": "registered",
                        "display_name": "bovesan"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1660381641,
                    "last_edit_date": 1660381641,
                    "creation_date": 1660377011,
                    "answer_id": 73342489,
                    "question_id": 6260149,
                    "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows/73342489#73342489",
                    "body": "<p>Windows 10 in developer mode can create symlinks without elevated privileges by setting the <em>SYMBOLIC_LINK_FLAG_ALLOW_UNPRIVILEGED_CREATE</em> flag as per the <a href=\"https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createsymboliclinkw\" rel=\"nofollow noreferrer\">Windows</a> documentation. My only issue is that deleting any existing link still needs elevated privileges.</p>\n<pre><code>os_symlink = getattr(os, &quot;symlink&quot;, None)\nif callable(os_symlink):\n    pass\nelse:\n    print &quot;Patching windows symlink support&quot;\n    def symlink_ms(source, link_name):\n        import ctypes\n        import ctypes.wintypes as wintypes\n        if os.path.exists(link_name):\n            df = ctypes.windll.kernel32.DeleteFileW\n            if df(link_name) == 0:\n                print &quot;Could not remove existing file:&quot;, link_name\n                print &quot;You should remove the file manually through Explorer or an elevated cmd process.&quot;\n                raise ctypes.WinError()\n        csl = ctypes.windll.kernel32.CreateSymbolicLinkW\n        csl.argtypes = (ctypes.c_wchar_p, ctypes.c_wchar_p, ctypes.c_uint32)\n        csl.restype = ctypes.c_ubyte\n        flags = 1 if os.path.isdir(source) else 0\n        flags += 2 # For unprivileged mode. Requires Developer Mode to be activated.\n        if csl(link_name, source, flags) == 0:\n            raise ctypes.WinError()\n    os.symlink = symlink_ms\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 66736,
                "reputation": 7916,
                "user_id": 195644,
                "user_type": "registered",
                "accept_rate": 67,
                "display_name": "xaav"
            },
            "comment_count": 2,
            "is_answered": true,
            "answer_count": 4,
            "score": 23,
            "last_activity_date": 1660381641,
            "creation_date": 1307414563,
            "question_id": 6260149,
            "link": "https://stackoverflow.com/questions/6260149/os-symlink-support-in-windows",
            "title": "OS.symlink support in windows",
            "body": "<p>I downloaded python 2.7.1 from the python website and installed it to windows. When attempting to symlink a file, I find that it is not supported.</p>\n\n<p>However, I found <a href=\"http://bugs.python.org/issue1578269\">this issue</a>, and saw that it was fixed. Will this be implemented, and if so when? I'm running windows Vista.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 6879
}