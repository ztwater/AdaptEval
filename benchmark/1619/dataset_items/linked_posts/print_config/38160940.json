{
    "items": [
        {
            "tags": [
                "neural-network",
                "tensorflow"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1479771554,
                    "post_id": 38160940,
                    "comment_id": 68689846,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model#comment68689846_38160940",
                    "body": "your question description and title do not match (unless I&#39;m confusing the terminology of graph and model). In the question you ask about a graph and the title you ask about a model. What if you had two different models? I&#39;d suggest to clarify that on the question."
                },
                {
                    "owner": {
                        "account_id": 472347,
                        "reputation": 5274,
                        "user_id": 880783,
                        "user_type": "registered",
                        "accept_rate": 57,
                        "display_name": "bers"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1591647000,
                    "post_id": 38160940,
                    "comment_id": 110130342,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model#comment110130342_38160940",
                    "body": "Related if you are using Keras: <a href=\"https://stackoverflow.com/questions/45046525/how-can-i-get-the-number-of-trainable-parameters-of-a-model-in-keras\" title=\"how can i get the number of trainable parameters of a model in keras\">stackoverflow.com/questions/45046525/&hellip;</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1479771229,
                            "post_id": 38161314,
                            "comment_id": 68689741,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment68689741_38161314",
                            "body": "if you have more than one model, how does <code>tf.trainable_variables()</code> know which one to use?"
                        },
                        {
                            "owner": {
                                "account_id": 3451796,
                                "reputation": 26844,
                                "user_id": 2891324,
                                "user_type": "registered",
                                "display_name": "nessuno"
                            },
                            "reply_to_user": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1479797664,
                            "post_id": 38161314,
                            "comment_id": 68697035,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment68697035_38161314",
                            "body": "tf.trainable_variables() returns all the variables marked as trainable that are present in the current graph. If in the current graph you have more than one model, you have to manually filter the variables using theyr names. Somethink like if variable.name.strartswith(&quot;model2&quot;): ..."
                        },
                        {
                            "owner": {
                                "account_id": 9935500,
                                "reputation": 10769,
                                "user_id": 7353970,
                                "user_type": "registered",
                                "display_name": "whiletrue"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1507387899,
                            "post_id": 38161314,
                            "comment_id": 80193773,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment80193773_38161314",
                            "body": "this solution gives me the error &quot;Exception occurred: Can&#39;t convert &#39;int&#39; object to str implicitly&quot;.   You need to cast &#39;dim&#39; explicitly to &#39;int&#39; as the suggested in the answer below (which I suggest to be the correct answer)"
                        },
                        {
                            "owner": {
                                "account_id": 1904816,
                                "reputation": 1188,
                                "user_id": 1719901,
                                "user_type": "registered",
                                "accept_rate": 92,
                                "display_name": "Sudip Das"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522664250,
                            "post_id": 38161314,
                            "comment_id": 86225198,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment86225198_38161314",
                            "body": "really helpful,"
                        },
                        {
                            "owner": {
                                "account_id": 2632131,
                                "reputation": 781,
                                "user_id": 2277812,
                                "user_type": "registered",
                                "accept_rate": 20,
                                "display_name": "chikitin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1573481813,
                            "post_id": 38161314,
                            "comment_id": 103886038,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment103886038_38161314",
                            "body": "It seems in TF2, this has changed to  tf.compat.v1.trainable_variables()! But then this return 0 parameters!"
                        },
                        {
                            "owner": {
                                "account_id": 3451796,
                                "reputation": 26844,
                                "user_id": 2891324,
                                "user_type": "registered",
                                "display_name": "nessuno"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1573500157,
                            "post_id": 38161314,
                            "comment_id": 103894382,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#comment103894382_38161314",
                            "body": "In TensorFlow 2 this answer is deprecated. You have to use the <code>.trainable_variables</code> of your Keras model - there is no more a global graph!"
                        }
                    ],
                    "owner": {
                        "account_id": 3451796,
                        "reputation": 26844,
                        "user_id": 2891324,
                        "user_type": "registered",
                        "display_name": "nessuno"
                    },
                    "comment_count": 6,
                    "is_accepted": true,
                    "score": 94,
                    "last_activity_date": 1544082879,
                    "last_edit_date": 1544082879,
                    "creation_date": 1467470549,
                    "answer_id": 38161314,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/38161314#38161314",
                    "body": "<p>Loop over the shape of every variable in <code>tf.trainable_variables()</code>.</p>\n\n<pre><code>total_parameters = 0\nfor variable in tf.trainable_variables():\n    # shape is an array of tf.Dimension\n    shape = variable.get_shape()\n    print(shape)\n    print(len(shape))\n    variable_parameters = 1\n    for dim in shape:\n        print(dim)\n        variable_parameters *= dim.value\n    print(variable_parameters)\n    total_parameters += variable_parameters\nprint(total_parameters)\n</code></pre>\n\n<p>Update: I wrote an article to clarify the dynamic/static shapes in Tensorflow because of this answer: <a href=\"https://pgaleone.eu/tensorflow/2018/07/28/understanding-tensorflow-tensors-shape-static-dynamic/\" rel=\"noreferrer\">https://pgaleone.eu/tensorflow/2018/07/28/understanding-tensorflow-tensors-shape-static-dynamic/</a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 92013,
                                "reputation": 3822,
                                "user_id": 252370,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "f4."
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1479771242,
                            "post_id": 39936930,
                            "comment_id": 68689746,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#comment68689746_39936930",
                            "body": "the answer does work (r0.11.0). yours is more plug n play :)"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "reply_to_user": {
                                "account_id": 92013,
                                "reputation": 3822,
                                "user_id": 252370,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "f4."
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1479771288,
                            "post_id": 39936930,
                            "comment_id": 68689762,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#comment68689762_39936930",
                            "body": "@f4. there seems to be a bug with this because <code>y</code> doesn&#39;t seem to be used."
                        },
                        {
                            "owner": {
                                "account_id": 92013,
                                "reputation": 3822,
                                "user_id": 252370,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "f4."
                            },
                            "reply_to_user": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1479771337,
                            "post_id": 39936930,
                            "comment_id": 68689777,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#comment68689777_39936930",
                            "body": "@CharlieParker I fixed it a few seconds ago ;)"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "reply_to_user": {
                                "account_id": 92013,
                                "reputation": 3822,
                                "user_id": 252370,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "f4."
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1479771416,
                            "post_id": 39936930,
                            "comment_id": 68689804,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#comment68689804_39936930",
                            "body": "@f4. it still doesn&#39;t truly solve the issue I was trying to do (or the original author intended since he gave y as an input) because I was looking for a function that depended on the model one gave as input (i.e. <code>y</code>). Right now as given, I have no idea what on earth it counts. My suspicion is that it counts just all models (I have two separate models)."
                        },
                        {
                            "owner": {
                                "account_id": 92013,
                                "reputation": 3822,
                                "user_id": 252370,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "f4."
                            },
                            "reply_to_user": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1479771839,
                            "post_id": 39936930,
                            "comment_id": 68689935,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#comment68689935_39936930",
                            "body": "@CharlieParker it counts all trainable variables, which by default is all variables I believe. You can work something out using the variables attributes like graph or name."
                        }
                    ],
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "comment_count": 5,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1479771269,
                    "last_edit_date": 1479771269,
                    "creation_date": 1475957770,
                    "answer_id": 39936930,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/39936930#39936930",
                    "body": "<p>Not sure if the answer given actually runs (I found you need to convert the dim object to an int for it to work). Here is is one that works and you can just copy paste the functions and call them (added a few comments too):</p>\n\n<pre><code>def count_number_trainable_params():\n    '''\n    Counts the number of trainable variables.\n    '''\n    tot_nb_params = 0\n    for trainable_variable in tf.trainable_variables():\n        shape = trainable_variable.get_shape() # e.g [D,F] or [W,H,C]\n        current_nb_params = get_nb_params_shape(shape)\n        tot_nb_params = tot_nb_params + current_nb_params\n    return tot_nb_params\n\ndef get_nb_params_shape(shape):\n    '''\n    Computes the total number of params for a given shap.\n    Works for any number of shapes etc [D,F] or [W,H,C] computes D*F and W*H*C.\n    '''\n    nb_params = 1\n    for dim in shape:\n        nb_params = nb_params*int(dim)\n    return nb_params \n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 6393443,
                                "reputation": 3017,
                                "user_id": 4958717,
                                "user_type": "registered",
                                "accept_rate": 93,
                                "display_name": "dsalaj"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1587806916,
                            "post_id": 41256689,
                            "comment_id": 108657592,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/41256689#comment108657592_41256689",
                            "body": "The <code>tfprof</code> link is broken. As the edit queue is full here is the <a href=\"https://github.com/tensorflow/profiler-ui\" rel=\"nofollow noreferrer\">working link</a>. Also for the <code>tfprof</code> has been deprecated."
                        }
                    ],
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user6621932"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 7,
                    "last_activity_date": 1588093002,
                    "last_edit_date": 1588093002,
                    "creation_date": 1482302703,
                    "answer_id": 41256689,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/41256689#41256689",
                    "body": "<p>Update April 2020: tfprof and the Profiler UI have been deprecated in favor of <a href=\"https://www.tensorflow.org/tensorboard/tensorboard_profiling_keras\" rel=\"nofollow noreferrer\">profiler support in TensorBoard</a>. </p>\n\n<p>The two existing answers are good if you're looking into computing the number of parameters yourself. If your question was more along the lines of \"is there an easy way to profile my TensorFlow models?\", I would highly recommend looking into <a href=\"https://github.com/tensorflow/profiler-ui\" rel=\"nofollow noreferrer\">tfprof</a>. It profiles your model, including calculating the number of parameters.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 9936273,
                        "reputation": 171,
                        "user_id": 7354533,
                        "user_type": "registered",
                        "display_name": "Gregor Mitscha-Baude"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1483023615,
                    "creation_date": 1483023615,
                    "answer_id": 41382167,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/41382167#41382167",
                    "body": "<p>I'll throw in my equivalent but shorter implementation:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def count_params():\n    \"print number of trainable variables\"\n    size = lambda v: reduce(lambda x, y: x*y, v.get_shape().as_list())\n    n = sum(size(v) for v in tf.trainable_variables())\n    print \"Model size: %dK\" % (n/1000,)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 229842,
                                "reputation": 3795,
                                "user_id": 493080,
                                "user_type": "registered",
                                "accept_rate": 36,
                                "display_name": "mustafa"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1494030344,
                            "post_id": 43801016,
                            "comment_id": 74670199,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/43801016#comment74670199_43801016",
                            "body": "in my version, v doesn&#39;t have a shape_as_list() function but only get_shape() function"
                        },
                        {
                            "owner": {
                                "account_id": 7483216,
                                "reputation": 920,
                                "user_id": 5687374,
                                "user_type": "registered",
                                "display_name": "Michael Gygli"
                            },
                            "reply_to_user": {
                                "account_id": 229842,
                                "reputation": 3795,
                                "user_id": 493080,
                                "user_type": "registered",
                                "accept_rate": 36,
                                "display_name": "mustafa"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1494070408,
                            "post_id": 43801016,
                            "comment_id": 74678261,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/43801016#comment74678261_43801016",
                            "body": "I think earlier versions don&#39;t have .shape but get_shape(). Updated my answer. Anyway, I wrote v.shape.as_list() and not v.shape_as_list()."
                        },
                        {
                            "owner": {
                                "account_id": 1869956,
                                "reputation": 1135,
                                "user_id": 1692437,
                                "user_type": "registered",
                                "display_name": "Julius Kunze"
                            },
                            "edited": false,
                            "score": 14,
                            "creation_date": 1499010678,
                            "post_id": 43801016,
                            "comment_id": 76723689,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/43801016#comment76723689_43801016",
                            "body": "<code>np.sum([np.prod(v.shape) for v in tf.trainable_variables()])</code> works as well in TensorFlow 1.2"
                        },
                        {
                            "owner": {
                                "account_id": 17755031,
                                "reputation": 103,
                                "user_id": 12892305,
                                "user_type": "registered",
                                "display_name": "Manute"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1663145558,
                            "post_id": 43801016,
                            "comment_id": 130167919,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/43801016#comment130167919_43801016",
                            "body": "<code>np.sum([np.prod(v.shape) for v in model.trainable_variables])</code> works for me --&gt; without function call &quot;()&quot; at the end"
                        }
                    ],
                    "owner": {
                        "account_id": 7483216,
                        "reputation": 920,
                        "user_id": 5687374,
                        "user_type": "registered",
                        "display_name": "Michael Gygli"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 50,
                    "last_activity_date": 1494070456,
                    "last_edit_date": 1494070456,
                    "creation_date": 1493975742,
                    "answer_id": 43801016,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/43801016#43801016",
                    "body": "<p>I have an even shorter version, one line solution using using numpy:</p>\n\n<pre><code>np.sum([np.prod(v.get_shape().as_list()) for v in tf.trainable_variables()])\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 13861216,
                        "reputation": 1141,
                        "user_id": 10006823,
                        "user_type": "registered",
                        "display_name": "Ran Feldesh"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1533609885,
                    "creation_date": 1533609885,
                    "answer_id": 51718091,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/51718091#51718091",
                    "body": "<p>If one prefers to avoid numpy (it can be left out for many projects), then:</p>\n\n<pre><code>all_trainable_vars = tf.reduce_sum([tf.reduce_prod(v.shape) for v in tf.trainable_variables()])\n</code></pre>\n\n<p>This is a TF translation of the previous answer by Julius Kunze.</p>\n\n<p>As any TF operation, it requires a session run to evaluate:</p>\n\n<pre><code>print(sess.run(all_trainable_vars))\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2158506,
                                "reputation": 59336,
                                "user_id": 4685471,
                                "user_type": "registered",
                                "display_name": "desertnaut"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1592530375,
                            "post_id": 62308994,
                            "comment_id": 110465809,
                            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/62308994#comment110465809_62308994",
                            "body": "This is Keras, not Tensorflow; question is clearly about Tensorflow models, not Keras ones."
                        }
                    ],
                    "owner": {
                        "account_id": 12690614,
                        "reputation": 177,
                        "user_id": 9220849,
                        "user_type": "registered",
                        "display_name": "Cillin O Foghlu"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1690698967,
                    "last_edit_date": 1690698967,
                    "creation_date": 1591808153,
                    "answer_id": 62308994,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/62308994#62308994",
                    "body": "<pre><code>model.summary()\n</code></pre>\n<pre><code>Model: &quot;sequential_32&quot;\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d_88 (Conv2D)           (None, 240, 240, 16)      448       \n_________________________________________________________________\nmax_pooling2d_87 (MaxPooling (None, 120, 120, 16)      0         \n_________________________________________________________________\nconv2d_89 (Conv2D)           (None, 120, 120, 32)      4640      \n_________________________________________________________________\nmax_pooling2d_88 (MaxPooling (None, 60, 60, 32)        0         \n_________________________________________________________________\nconv2d_90 (Conv2D)           (None, 60, 60, 64)        18496     \n_________________________________________________________________\nmax_pooling2d_89 (MaxPooling (None, 30, 30, 64)        0         \n_________________________________________________________________\nflatten_29 (Flatten)         (None, 57600)             0         \n_________________________________________________________________\ndropout_48 (Dropout)         (None, 57600)             0         \n_________________________________________________________________\ndense_150 (Dense)            (None, 24)                1382424   \n_________________________________________________________________\ndense_151 (Dense)            (None, 9)                 225       \n_________________________________________________________________\ndense_152 (Dense)            (None, 3)                 30        \n_________________________________________________________________\ndense_153 (Dense)            (None, 1)                 4         \n=================================================================\nTotal params: 1,406,267\nTrainable params: 1,406,267\nNon-trainable params: 0\n_________________________________________________________________\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 5259350,
                        "reputation": 114,
                        "user_id": 4201275,
                        "user_type": "registered",
                        "display_name": "jeugregg"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1639465868,
                    "creation_date": 1639465868,
                    "answer_id": 70344976,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/70344976#70344976",
                    "body": "<p>Now, you can use this :</p>\n<pre><code>from keras.utils.layer_utils import count_params  \n\ncount_params(model.trainable_weights)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 13141106,
                        "reputation": 1310,
                        "user_id": 9492673,
                        "user_type": "registered",
                        "display_name": "Tommaso Di Noto"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1660902559,
                    "creation_date": 1660902559,
                    "answer_id": 73414909,
                    "question_id": 38160940,
                    "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model/73414909#73414909",
                    "body": "<p>Works for me on <strong>TF v2.9</strong>. Credit to <a href=\"https://lindevs.com/count-number-of-parameters-of-model-in-tensorflow-2/#:%7E:text=trainableParams%20%3D%20np.sum(%5Bnp.prod(v.get_shape())%20for%20v%20in%20model.trainable_weights%5D)%0AnonTrainableParams%20%3D%20np.sum(%5Bnp.prod(v.get_shape())%20for%20v%20in%20model.non_trainable_weights%5D)%0AtotalParams%20%3D%20trainableParams%20%2B%20nonTrainableParams%0A%0Aprint(trainableParams)%0Aprint(nonTrainableParams)%0Aprint(totalParams)\" rel=\"noreferrer\">this answer</a></p>\n<pre><code>import numpy as np\n\ntrainable_params = np.sum([np.prod(v.get_shape()) for v in model.trainable_weights])\nnon_trainable_params = np.sum([np.prod(v.get_shape()) for v in model.non_trainable_weights])\ntotal_params = trainable_params + non_trainable_params\n    \nprint(trainable_params)\nprint(non_trainable_params)\nprint(total_params)\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 7600666,
                "reputation": 2797,
                "user_id": 5765409,
                "user_type": "registered",
                "display_name": "j314erre"
            },
            "comment_count": 2,
            "is_answered": true,
            "accepted_answer_id": 38161314,
            "answer_count": 9,
            "score": 76,
            "last_activity_date": 1690698967,
            "creation_date": 1467467711,
            "last_edit_date": 1541527000,
            "question_id": 38160940,
            "link": "https://stackoverflow.com/questions/38160940/how-to-count-total-number-of-trainable-parameters-in-a-tensorflow-model",
            "title": "How to count total number of trainable parameters in a tensorflow model?",
            "body": "<p>Is there a function call or another way to count the total number of parameters in a tensorflow model?</p>\n\n<p>By parameters I mean: an N dim vector of trainable variables has N parameters, a <code>NxM</code> matrix has <code>N*M</code> parameters, etc. So essentially I'd like to sum the product of the shape dimensions of all the trainable variables in a tensorflow session.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 6882
}