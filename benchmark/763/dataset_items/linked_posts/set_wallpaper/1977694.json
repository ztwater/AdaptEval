{
    "items": [
        {
            "tags": [
                "python",
                "background",
                "desktop"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 64585,
                        "reputation": 864612,
                        "user_id": 190597,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "unutbu"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1262132251,
                    "post_id": 1977694,
                    "comment_id": 1892866,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python#comment1892866_1977694",
                    "body": "For the linux-half of your question, (and assuming a GNOME desktop environment), you might want to take a look at <a href=\"http://oracle.bridgewayconsulting.com.au/~danni/misc/change-background-py.html\" rel=\"nofollow noreferrer\">oracle.bridgewayconsulting.com.au/~danni/misc/&hellip;</a>"
                },
                {
                    "owner": {
                        "account_id": 6828413,
                        "reputation": 576,
                        "user_id": 5253369,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "TheInitializer"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1464624691,
                    "post_id": 1977694,
                    "comment_id": 62550542,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python#comment62550542_1977694",
                    "body": "Anyone know how to do this in KDE?"
                }
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 83097,
                        "reputation": 25134,
                        "user_id": 233201,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "display_name": "James"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1262132914,
                    "creation_date": 1262132914,
                    "answer_id": 1977790,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977790#1977790",
                    "body": "<p>On windows, you will need some trickery with <a href=\"http://sourceforge.net/projects/pywin32/\" rel=\"noreferrer\">pywin32</a>, and <a href=\"http://blogs.msdn.com/coding4fun/archive/2006/10/31/912569.aspx\" rel=\"noreferrer\">the windows API</a>, on 'linux' the answer will depend on which desktop is running - KDE, Gnome, or something more exotic. Under KDE (and maybe Gnome) you can probably send a message using D-Bus, which you could do without including any new libraries by using the command line tool dbus-send.</p>\n\n<p>The other option would be to set the desktop wallpaper to a file which you then edit / replace from python - but this will probably only result in a change when the user logs in.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1832182,
                                "reputation": 7876,
                                "user_id": 1663352,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Noelkd"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1368530365,
                            "post_id": 1977831,
                            "comment_id": 23758368,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment23758368_1977831",
                            "body": "Didn&#39;t seem to work with a .jpg, works with a .bmp tho (on xp)"
                        },
                        {
                            "owner": {
                                "account_id": 219066,
                                "reputation": 649,
                                "user_id": 475735,
                                "user_type": "registered",
                                "accept_rate": 56,
                                "display_name": "CrazyPenguin"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1389022755,
                            "post_id": 1977831,
                            "comment_id": 31471634,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment31471634_1977831",
                            "body": "I successfully used a jpg on win 7"
                        },
                        {
                            "owner": {
                                "account_id": 3465546,
                                "reputation": 10132,
                                "user_id": 2901207,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "CularBytes"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1413998792,
                            "post_id": 1977831,
                            "comment_id": 41656718,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment41656718_1977831",
                            "body": "doesn&#39;t seem to work on 3.4 ctypes.windll doesnt contain a user32 method/function"
                        },
                        {
                            "owner": {
                                "account_id": 83767,
                                "reputation": 5049,
                                "user_id": 234652,
                                "user_type": "registered",
                                "display_name": "J.J."
                            },
                            "reply_to_user": {
                                "account_id": 3465546,
                                "reputation": 10132,
                                "user_id": 2901207,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "CularBytes"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1414175242,
                            "post_id": 1977831,
                            "comment_id": 41729828,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment41729828_1977831",
                            "body": "@RageCompex the API is in user32.dll; you can always load it directly."
                        },
                        {
                            "owner": {
                                "account_id": 43258,
                                "reputation": 825,
                                "user_id": 126362,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "ejm"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1549536346,
                            "post_id": 1977831,
                            "comment_id": 95940750,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment95940750_1977831",
                            "body": "I would recommend using SystemParametersInfoW on both Python2 and Python3 (and making sure the path you are trying to set is properly decoded to unicode on python2). (The *W variant takes a unicode parameter - W for <b>W</b>ide char while the *A variant takes ANSI parameter)."
                        },
                        {
                            "owner": {
                                "account_id": 43258,
                                "reputation": 825,
                                "user_id": 126362,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "ejm"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1549536516,
                            "post_id": 1977831,
                            "comment_id": 95940838,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment95940838_1977831",
                            "body": "Also, for the final parameter, you can use the value <code>3</code>, which comes from <code>SPIF_UPDATEINIFILE | SPIF_SENDCHANGE</code> (search those constants on <a href=\"https://learn.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-systemparametersinfow\" rel=\"nofollow noreferrer\">learn.microsoft.com/en-us/windows/desktop/api/winuser/&hellip;</a> for more info on what they do; the values can be found in <code>win32con</code> module - although there is no need for a dependency on that module just to get these constant values)"
                        },
                        {
                            "owner": {
                                "account_id": 10977790,
                                "reputation": 422,
                                "user_id": 8065970,
                                "user_type": "registered",
                                "display_name": "theashwanisingla"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1576339603,
                            "post_id": 1977831,
                            "comment_id": 104871392,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment104871392_1977831",
                            "body": "Didn&#39;t work for me. I&#39;m using win10 and python 3.6.x. I used <code>SystemParametersInfoW </code> with parameter as <code>u&quot;image.jpg&quot;</code> and <code>&quot;image.jpg&quot;</code> but both didn&#39;t work. Any other solution?"
                        },
                        {
                            "owner": {
                                "account_id": 10344756,
                                "reputation": 541,
                                "user_id": 10916136,
                                "user_type": "registered",
                                "display_name": "Veki"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1649305243,
                            "post_id": 1977831,
                            "comment_id": 126843265,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#comment126843265_1977831",
                            "body": "Can you help with this? <a href=\"https://stackoverflow.com/questions/65914485/set-windows-wallpaper-fit-span-position-using-python-script\" title=\"set windows wallpaper fit span position using python script\">stackoverflow.com/questions/65914485/&hellip;</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 83767,
                        "reputation": 5049,
                        "user_id": 234652,
                        "user_type": "registered",
                        "display_name": "J.J."
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 43,
                    "last_activity_date": 1442819410,
                    "last_edit_date": 1442819410,
                    "creation_date": 1262133655,
                    "answer_id": 1977831,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1977831#1977831",
                    "body": "<p>On Windows with python2.5 or higher, use ctypes to load user32.dll and call <a href=\"http://msdn.microsoft.com/en-us/library/ms724947%28VS.85%29.aspx\" rel=\"noreferrer\"><code>SystemParametersInfo()</code></a> with SPI_SETDESKWALLPAPER action. </p>\n\n<p>For example:</p>\n\n<pre><code>import ctypes\nSPI_SETDESKWALLPAPER = 20 \nctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, \"image.jpg\" , 0)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 310642,
                                "reputation": 18929,
                                "user_id": 623735,
                                "user_type": "registered",
                                "accept_rate": 85,
                                "display_name": "hobs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1319511626,
                            "post_id": 1978847,
                            "comment_id": 9621931,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1978847#comment9621931_1978847",
                            "body": "For Ubuntu 11.04 this no longer seems to work. The gconf setting changes, but the background doesn&#39;t refresh to the new image."
                        },
                        {
                            "owner": {
                                "account_id": 378480,
                                "reputation": 1461,
                                "user_id": 731221,
                                "user_type": "registered",
                                "accept_rate": 92,
                                "display_name": "MikeVaughan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1331927999,
                            "post_id": 1978847,
                            "comment_id": 12393097,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1978847#comment12393097_1978847",
                            "body": "I&#39;m using 11.04, and I just wrote a script that cycles through images in a folder, and I used this snippet. Worked fine for me.   However, I&#39;m executing the command with os.system(command)"
                        }
                    ],
                    "owner": {
                        "account_id": 39725,
                        "reputation": 7208,
                        "user_id": 1422778,
                        "user_type": "registered",
                        "display_name": "Raja Selvaraj"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 14,
                    "last_activity_date": 1262157102,
                    "creation_date": 1262157102,
                    "answer_id": 1978847,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/1978847#1978847",
                    "body": "<p>On a gnome desktop, you usually do this with gconf, either directly calling gconftool or using the gconf python module. The latter is in the link given by unutbu. The first method could be done like this.</p>\n\n<pre><code>import commands\ncommand = \"gconftool-2 --set /desktop/gnome/background/picture_filename --type string '/path/to/file.jpg'\"\nstatus, output = commands.getstatusoutput(command)  # status=0 if success\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 625607,
                        "reputation": 91,
                        "user_id": 367617,
                        "user_type": "unregistered",
                        "display_name": "Alex"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1276629421,
                    "creation_date": 1276629421,
                    "answer_id": 3048284,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/3048284#3048284",
                    "body": "<p>In gnome, it is probably preferable to use the python binding of gconf directly:</p>\n\n<pre><code>import gconf\nconf = gconf.client_get_default()\nconf.set_string('/desktop/gnome/background/picture_filename','/path/to/filename.jpg')\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 12831980,
                                "reputation": 4542,
                                "user_id": 9282844,
                                "user_type": "registered",
                                "display_name": "Guimoute"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1609892097,
                            "post_id": 20024286,
                            "comment_id": 115962747,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/20024286#comment115962747_20024286",
                            "body": "For those interested, you see yourself as a wallpaper in real time if you use this answer in conjunction with opencv, it&#39;s hilarious. <code>source = cv2.VideoCapture(0); path = r&quot;C:\\Users\\YOUR_NAME_HERE\\Desktop\\my_face.png&quot;;</code> then loop <code>for _ in range(50): cv2.imwrite(path, source.read()[1]); ctypes.windll.user32.SystemParametersInfoA(20, 0, path, 0); time.sleep(1&#47;10)</code> then <code>source.release()</code>."
                        },
                        {
                            "owner": {
                                "account_id": 20502368,
                                "reputation": 320,
                                "user_id": 15046005,
                                "user_type": "registered",
                                "display_name": "Hacker"
                            },
                            "reply_to_user": {
                                "account_id": 12831980,
                                "reputation": 4542,
                                "user_id": 9282844,
                                "user_type": "registered",
                                "display_name": "Guimoute"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1641464415,
                            "post_id": 20024286,
                            "comment_id": 124812853,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/20024286#comment124812853_20024286",
                            "body": "@Guimoute this is a crazy idea, but in a cool way"
                        }
                    ],
                    "owner": {
                        "account_id": 3014863,
                        "reputation": 73,
                        "user_id": 2557340,
                        "user_type": "registered",
                        "display_name": "sidthekid"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1654830964,
                    "last_edit_date": 1654830964,
                    "creation_date": 1384638302,
                    "answer_id": 20024286,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/20024286#20024286",
                    "body": "<p>Firstly, import <code>ctypes</code>: it gives you access to windows components such as the screensaver, wallpapers, etc.</p>\n<p>Then call</p>\n<pre><code>ctypes.windll.user32.SystemParametersInfoA(20, 0, the_complete_path_of_your_image, 0)\n</code></pre>\n<p>Make sure the path is the complete path of your image, <a href=\"http://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/3389dd46-6227-4b5a-ba57-9ba343620d7f/problems-with-paintdesktop-under-windows-8?forum=windowsgeneraldevelopmentissues\" rel=\"nofollow noreferrer\">not just the path from the active directory</a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user5413945"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1460118111,
                            "post_id": 21213504,
                            "comment_id": 60606342,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/21213504#comment60606342_21213504",
                            "body": "Instead of the <code>get_home_dir()</code> function, you can just use <code>os.path.expanduser(&#39;~&#39;)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 3100683,
                                "reputation": 3992,
                                "user_id": 2624876,
                                "user_type": "registered",
                                "display_name": "1j01"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1694028578,
                            "post_id": 21213504,
                            "comment_id": 135839059,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/21213504#comment135839059_21213504",
                            "body": "I have updated this code for Python 3, got it working across Ubuntu 22, Windows 10, and macOS 10.14, and tightened security by avoiding interpolating shell commands: <a href=\"https://github.com/1j01/textual-paint/blob/main/src/textual_paint/wallpaper.py\" rel=\"nofollow noreferrer\">github.com/1j01/textual-paint/blob/main/src/textual_paint/&hellip;</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 2426492,
                        "reputation": 617,
                        "user_id": 2118300,
                        "user_type": "registered",
                        "display_name": "Martin Hansen"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 21,
                    "last_activity_date": 1390108776,
                    "last_edit_date": 1495540009,
                    "creation_date": 1390108776,
                    "answer_id": 21213504,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/21213504#21213504",
                    "body": "<p>I use the following method in one of my initial projects:</p>\n\n<pre><code>    def set_wallpaper(self,file_loc, first_run):\n        # Note: There are two common Linux desktop environments where \n        # I have not been able to set the desktop background from \n        # command line: KDE, Enlightenment\n        desktop_env = self.get_desktop_environment()\n        try:\n            if desktop_env in [\"gnome\", \"unity\", \"cinnamon\"]:\n                uri = \"'file://%s'\" % file_loc\n                try:\n                    SCHEMA = \"org.gnome.desktop.background\"\n                    KEY = \"picture-uri\"\n                    gsettings = Gio.Settings.new(SCHEMA)\n                    gsettings.set_string(KEY, uri)\n                except:\n                    args = [\"gsettings\", \"set\", \"org.gnome.desktop.background\", \"picture-uri\", uri]\n                    subprocess.Popen(args)\n            elif desktop_env==\"mate\":\n                try: # MATE &gt;= 1.6\n                    # info from http://wiki.mate-desktop.org/docs:gsettings\n                    args = [\"gsettings\", \"set\", \"org.mate.background\", \"picture-filename\", \"'%s'\" % file_loc]\n                    subprocess.Popen(args)\n                except: # MATE &lt; 1.6\n                    # From https://bugs.launchpad.net/variety/+bug/1033918\n                    args = [\"mateconftool-2\",\"-t\",\"string\",\"--set\",\"/desktop/mate/background/picture_filename\",'\"%s\"' %file_loc]\n                    subprocess.Popen(args)\n            elif desktop_env==\"gnome2\": # Not tested\n                # From https://bugs.launchpad.net/variety/+bug/1033918\n                args = [\"gconftool-2\",\"-t\",\"string\",\"--set\",\"/desktop/gnome/background/picture_filename\", '\"%s\"' %file_loc]\n                subprocess.Popen(args)\n            ## KDE4 is difficult\n            ## see http://blog.zx2c4.com/699 for a solution that might work\n            elif desktop_env in [\"kde3\", \"trinity\"]:\n                # From http://ubuntuforums.org/archive/index.php/t-803417.html\n                args = 'dcop kdesktop KBackgroundIface setWallpaper 0 \"%s\" 6' % file_loc\n                subprocess.Popen(args,shell=True)\n            elif desktop_env==\"xfce4\":\n                #From http://www.commandlinefu.com/commands/view/2055/change-wallpaper-for-xfce4-4.6.0\n                if first_run:\n                    args0 = [\"xfconf-query\", \"-c\", \"xfce4-desktop\", \"-p\", \"/backdrop/screen0/monitor0/image-path\", \"-s\", file_loc]\n                    args1 = [\"xfconf-query\", \"-c\", \"xfce4-desktop\", \"-p\", \"/backdrop/screen0/monitor0/image-style\", \"-s\", \"3\"]\n                    args2 = [\"xfconf-query\", \"-c\", \"xfce4-desktop\", \"-p\", \"/backdrop/screen0/monitor0/image-show\", \"-s\", \"true\"]\n                    subprocess.Popen(args0)\n                    subprocess.Popen(args1)\n                    subprocess.Popen(args2)\n                args = [\"xfdesktop\",\"--reload\"]\n                subprocess.Popen(args)\n            elif desktop_env==\"razor-qt\": #TODO: implement reload of desktop when possible\n                if first_run:\n                    desktop_conf = configparser.ConfigParser()\n                    # Development version\n                    desktop_conf_file = os.path.join(self.get_config_dir(\"razor\"),\"desktop.conf\") \n                    if os.path.isfile(desktop_conf_file):\n                        config_option = r\"screens\\1\\desktops\\1\\wallpaper\"\n                    else:\n                        desktop_conf_file = os.path.join(self.get_home_dir(),\".razor/desktop.conf\")\n                        config_option = r\"desktops\\1\\wallpaper\"\n                    desktop_conf.read(os.path.join(desktop_conf_file))\n                    try:\n                        if desktop_conf.has_option(\"razor\",config_option): #only replacing a value\n                            desktop_conf.set(\"razor\",config_option,file_loc)\n                            with codecs.open(desktop_conf_file, \"w\", encoding=\"utf-8\", errors=\"replace\") as f:\n                                desktop_conf.write(f)\n                    except:\n                        pass\n                else:\n                    #TODO: reload desktop when possible\n                    pass \n            elif desktop_env in [\"fluxbox\",\"jwm\",\"openbox\",\"afterstep\"]:\n                #http://fluxbox-wiki.org/index.php/Howto_set_the_background\n                # used fbsetbg on jwm too since I am too lazy to edit the XML configuration \n                # now where fbsetbg does the job excellent anyway. \n                # and I have not figured out how else it can be set on Openbox and AfterSTep\n                # but fbsetbg works excellent here too.\n                try:\n                    args = [\"fbsetbg\", file_loc]\n                    subprocess.Popen(args)\n                except:\n                    sys.stderr.write(\"ERROR: Failed to set wallpaper with fbsetbg!\\n\")\n                    sys.stderr.write(\"Please make sre that You have fbsetbg installed.\\n\")\n            elif desktop_env==\"icewm\":\n                # command found at http://urukrama.wordpress.com/2007/12/05/desktop-backgrounds-in-window-managers/\n                args = [\"icewmbg\", file_loc]\n                subprocess.Popen(args)\n            elif desktop_env==\"blackbox\":\n                # command found at http://blackboxwm.sourceforge.net/BlackboxDocumentation/BlackboxBackground\n                args = [\"bsetbg\", \"-full\", file_loc]\n                subprocess.Popen(args)\n            elif desktop_env==\"lxde\":\n                args = \"pcmanfm --set-wallpaper %s --wallpaper-mode=scaled\" % file_loc\n                subprocess.Popen(args,shell=True)\n            elif desktop_env==\"windowmaker\":\n                # From http://www.commandlinefu.com/commands/view/3857/set-wallpaper-on-windowmaker-in-one-line\n                args = \"wmsetbg -s -u %s\" % file_loc\n                subprocess.Popen(args,shell=True)\n            ## NOT TESTED BELOW - don't want to mess things up ##\n            #elif desktop_env==\"enlightenment\": # I have not been able to make it work on e17. On e16 it would have been something in this direction\n            #    args = \"enlightenment_remote -desktop-bg-add 0 0 0 0 %s\" % file_loc\n            #    subprocess.Popen(args,shell=True)\n            #elif desktop_env==\"windows\": #Not tested since I do not run this on Windows\n            #    #From https://stackoverflow.com/questions/1977694/change-desktop-background\n            #    import ctypes\n            #    SPI_SETDESKWALLPAPER = 20\n            #    ctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, file_loc , 0)\n            #elif desktop_env==\"mac\": #Not tested since I do not have a mac\n            #    #From https://stackoverflow.com/questions/431205/how-can-i-programatically-change-the-background-in-mac-os-x\n            #    try:\n            #        from appscript import app, mactypes\n            #        app('Finder').desktop_picture.set(mactypes.File(file_loc))\n            #    except ImportError:\n            #        #import subprocess\n            #        SCRIPT = \"\"\"/usr/bin/osascript&lt;&lt;END\n            #        tell application \"Finder\" to\n            #        set desktop picture to POSIX file \"%s\"\n            #        end tell\n            #        END\"\"\"\n            #        subprocess.Popen(SCRIPT%file_loc, shell=True)\n            else:\n                if first_run: #don't spam the user with the same message over and over again\n                    sys.stderr.write(\"Warning: Failed to set wallpaper. Your desktop environment is not supported.\")\n                    sys.stderr.write(\"You can try manually to set Your wallpaper to %s\" % file_loc)\n                return False\n            return True\n        except:\n            sys.stderr.write(\"ERROR: Failed to set wallpaper. There might be a bug.\\n\")\n            return False\n\n    def get_config_dir(self, app_name=APP_NAME):\n        if \"XDG_CONFIG_HOME\" in os.environ:\n            confighome = os.environ['XDG_CONFIG_HOME'] \n        elif \"APPDATA\" in os.environ: # On Windows\n            confighome = os.environ['APPDATA'] \n        else:\n            try:\n                from xdg import BaseDirectory   \n                confighome =  BaseDirectory.xdg_config_home\n            except ImportError: # Most likely a Linux/Unix system anyway\n                confighome =  os.path.join(self.get_home_dir(),\".config\")\n        configdir = os.path.join(confighome,app_name)\n        return configdir\n\n    def get_home_dir(self):\n        if sys.platform == \"cygwin\":\n            home_dir = os.getenv('HOME')\n        else:\n            home_dir = os.getenv('USERPROFILE') or os.getenv('HOME')\n        if home_dir is not None:\n            return os.path.normpath(home_dir)\n        else:\n            raise KeyError(\"Neither USERPROFILE or HOME environment variables set.\")\n</code></pre>\n\n<p>The get_desktop_environment method has been posted <a href=\"https://stackoverflow.com/questions/2035657/what-is-my-current-desktop-environment/21213358#21213358\">in another thread</a>.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 3392340,
                        "reputation": 5384,
                        "user_id": 2846920,
                        "user_type": "registered",
                        "accept_rate": 36,
                        "display_name": "ShivaGuntuku"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1464429057,
                    "last_edit_date": 1592644375,
                    "creation_date": 1464429057,
                    "answer_id": 37497543,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37497543#37497543",
                    "body": "<h1>changing the background image of desktop</h1>\n<pre><code>    import ctypes\n    import os\n    SPI_SETDESKWALLPAPER = 20 \n    ctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, 'your image path', 3) \n    #'C:\\\\Users\\\\Public\\\\Pictures\\\\abc.jpg'\n</code></pre>\n<p>it worked fine for me. windows10, python27</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 476140,
                                "reputation": 36009,
                                "user_id": 886887,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Harry Johnston"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1498976854,
                            "post_id": 37669111,
                            "comment_id": 76715226,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#comment76715226_37669111",
                            "body": "This is nonsense.  The choice of ASCII or Unicode is completely unrelated to whether you are running 32-bit or 64-bit Windows.  (You had to use ASCII on 16-bit Windows, and Windows 95/98/ME, but Windows NT has always supported Unicode, both 32-bit and 64-bit versions.)"
                        },
                        {
                            "owner": {
                                "account_id": 2034412,
                                "reputation": 685,
                                "user_id": 1817121,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Johnny"
                            },
                            "reply_to_user": {
                                "account_id": 476140,
                                "reputation": 36009,
                                "user_id": 886887,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Harry Johnston"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1510948587,
                            "post_id": 37669111,
                            "comment_id": 81669356,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#comment81669356_37669111",
                            "body": "@HarryJohnston then how do you explain <code>SystemParametersInfoA</code> not working on Windows 10 64-bit?"
                        },
                        {
                            "owner": {
                                "account_id": 476140,
                                "reputation": 36009,
                                "user_id": 886887,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Harry Johnston"
                            },
                            "reply_to_user": {
                                "account_id": 2034412,
                                "reputation": 685,
                                "user_id": 1817121,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Johnny"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1510973727,
                            "post_id": 37669111,
                            "comment_id": 81676955,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#comment81676955_37669111",
                            "body": "@Johnny, I&#39;ve just tried it, and it works perfectly well for me.  That&#39;s from C, mind you, so it is still <i>possible</i> that there&#39;s some Python-related weirdness happening that somehow depends on the bitness of the operating system, though that seems very unlikely.  Looking at the ctypes documentation, it <i>should</i> depend only on whether you&#39;re using Python 2 or Python 3."
                        },
                        {
                            "owner": {
                                "account_id": 2034412,
                                "reputation": 685,
                                "user_id": 1817121,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Johnny"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1511598921,
                            "post_id": 37669111,
                            "comment_id": 81922917,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#comment81922917_37669111",
                            "body": "I find it interesting that Vlad doesn&#39;t defend his findings."
                        },
                        {
                            "owner": {
                                "account_id": 235174,
                                "reputation": 941,
                                "user_id": 501814,
                                "user_type": "registered",
                                "display_name": "Andris"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1567013948,
                            "post_id": 37669111,
                            "comment_id": 101839236,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#comment101839236_37669111",
                            "body": "<code>is_64_windows()</code> actually determines whether the python install is 32 or 64 bit, doesn&#39;t it? You are free to install 32 bit python on 64 bit Windows."
                        }
                    ],
                    "owner": {
                        "account_id": 14552,
                        "reputation": 87023,
                        "user_id": 30038,
                        "user_type": "registered",
                        "accept_rate": 96,
                        "display_name": "Vlad Bezden"
                    },
                    "comment_count": 5,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1465303439,
                    "last_edit_date": 1465303439,
                    "creation_date": 1465262553,
                    "answer_id": 37669111,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/37669111#37669111",
                    "body": "<p>There is a difference what <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724947(v=vs.85).aspx\" rel=\"nofollow\">SystemParametersInfo</a> method to be called based on what if you are running on 64 bit or 32 bit OS. For 64 bit you have to use SystemParametersInfoW (Unicode) and for 32 bit SystemParametersInfoA (ANSI)</p>\n\n<pre><code>import struct\nimport ctypes\n\n\nSPI_SETDESKWALLPAPER = 20\nWALLPAPER_PATH = 'C:\\\\your_file_name.jpg'\n\n\ndef is_64_windows():\n    \"\"\"Find out how many bits is OS. \"\"\"\n    return struct.calcsize('P') * 8 == 64\n\n\ndef get_sys_parameters_info():\n    \"\"\"Based on if this is 32bit or 64bit returns correct version of SystemParametersInfo function. \"\"\"\n    return ctypes.windll.user32.SystemParametersInfoW if is_64_windows() \\\n        else ctypes.windll.user32.SystemParametersInfoA\n\n\ndef change_wallpaper():\n    sys_parameters_info = get_sys_parameters_info()\n    r = sys_parameters_info(SPI_SETDESKWALLPAPER, 0, WALLPAPER_PATH, 3)\n\n    # When the SPI_SETDESKWALLPAPER flag is used,\n    # SystemParametersInfo returns TRUE\n    # unless there is an error (like when the specified file doesn't exist).\n    if not r:\n        print(ctypes.WinError())\n\n\nchange_wallpaper()\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2034412,
                                "reputation": 685,
                                "user_id": 1817121,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Johnny"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1510948884,
                            "post_id": 46504228,
                            "comment_id": 81669499,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/46504228#comment81669499_46504228",
                            "body": "Is it Python or the types of Windows used?"
                        },
                        {
                            "owner": {
                                "account_id": 5399370,
                                "reputation": 441,
                                "user_id": 4299632,
                                "user_type": "registered",
                                "display_name": "mesksr"
                            },
                            "reply_to_user": {
                                "account_id": 2034412,
                                "reputation": 685,
                                "user_id": 1817121,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Johnny"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1511038139,
                            "post_id": 46504228,
                            "comment_id": 81694364,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/46504228#comment81694364_46504228",
                            "body": "Python2 uses <b>SystemParametersInfoA</b> and Python3 uses <b>SystemParametersInfoW</b>"
                        },
                        {
                            "owner": {
                                "account_id": 43258,
                                "reputation": 825,
                                "user_id": 126362,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "ejm"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1549535691,
                            "post_id": 46504228,
                            "comment_id": 95940333,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/46504228#comment95940333_46504228",
                            "body": "To clarify the difference between <code>SystemParametersInfoA</code> and <code>SystemParametersInfoW</code>; the latter takes a unicode parameter (aka <b>W</b>ide char), the former takes an ANSI parameter. You can still use the *W variant on Python2 but make sure you pass a unicode (e.g. u&quot;path&quot;, or str.decode(...)) instead of a str (which is the same as python3 bytes)."
                        },
                        {
                            "owner": {
                                "account_id": 17200087,
                                "reputation": 166,
                                "user_id": 12452008,
                                "user_type": "registered",
                                "display_name": "gowtham758550"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1707210127,
                            "post_id": 46504228,
                            "comment_id": 137415313,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/46504228#comment137415313_46504228",
                            "body": "this script is working even if the user don&#39;t have privilege to change wallpaper !!"
                        }
                    ],
                    "owner": {
                        "account_id": 5399370,
                        "reputation": 441,
                        "user_id": 4299632,
                        "user_type": "registered",
                        "display_name": "mesksr"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 44,
                    "last_activity_date": 1506785474,
                    "creation_date": 1506785474,
                    "answer_id": 46504228,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/46504228#46504228",
                    "body": "<p>For Python3.5, SystemParametersInfoA doesn't work. <strong>Use SystemParametersInfoW.</strong></p>\n\n<pre><code>import ctypes\nctypes.windll.user32.SystemParametersInfoW(20, 0, \"absolute path\" , 0)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 10344756,
                                "reputation": 541,
                                "user_id": 10916136,
                                "user_type": "registered",
                                "display_name": "Veki"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1649305226,
                            "post_id": 53803378,
                            "comment_id": 126843260,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/53803378#comment126843260_53803378",
                            "body": "Can you help with this? <a href=\"https://stackoverflow.com/questions/65914485/set-windows-wallpaper-fit-span-position-using-python-script\" title=\"set windows wallpaper fit span position using python script\">stackoverflow.com/questions/65914485/&hellip;</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 12876439,
                        "reputation": 3191,
                        "user_id": 9312988,
                        "user_type": "registered",
                        "display_name": "Puddle"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1544976016,
                    "last_edit_date": 1544976016,
                    "creation_date": 1544972375,
                    "answer_id": 53803378,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/53803378#53803378",
                    "body": "<pre><code>import ctypes,win32con\n\ndef getWallpaper():\n    ubuf = ctypes.create_unicode_buffer(512)\n    ctypes.windll.user32.SystemParametersInfoW(win32con.SPI_GETDESKWALLPAPER,len(ubuf),ubuf,0)\n    return ubuf.value\n\ndef setWallpaper(path):\n    changed = win32con.SPIF_UPDATEINIFILE | win32con.SPIF_SENDCHANGE\n    ctypes.windll.user32.SystemParametersInfoW(win32con.SPI_SETDESKWALLPAPER,0,path,changed)\n</code></pre>\n\n<p>Alternatively: (with <code>SystemParametersInfoA</code>)</p>\n\n<pre><code>def getWallpaper():\n    sbuf = ctypes.create_string_buffer(512) # ctypes.c_buffer(512)\n    ctypes.windll.user32.SystemParametersInfoA(win32con.SPI_GETDESKWALLPAPER,len(sbuf),sbuf,0)\n    return sbuf.value\n\ndef setWallpaper(path):\n    changed = win32con.SPIF_UPDATEINIFILE | win32con.SPIF_SENDCHANGE\n    ctypes.windll.user32.SystemParametersInfoA(win32con.SPI_SETDESKWALLPAPER,0,path.encode(),changed) # \"\".encode() = b\"\"\n</code></pre>\n\n<p>Arguments are:<br>\n<code>SystemParametersInfo(SetOrGet, GetBufferSize, SetBufferOrGetBuffer, SetChange)</code></p>\n\n<p>The path has to be absolute, so if you're using something relative to your script, do:<br>\n<code>path = os.path.abspath(path)</code></p>\n\n<p>To see more stuff you can do with <code>SystemParametersInfo</code>, see the <a href=\"https://learn.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa\" rel=\"nofollow noreferrer\">docs</a>.<br>\n(near the bottom there's an example to change the mouse speed)</p>\n\n<p>P.S. There are many answers already here, but they're leaving out the broadcasting you're supposed to do. Sure it works without it, but it's bad practice not to use it properly.</p>\n\n<p>P.P.S And they only gave hard coded values, rather than the variables they come from.</p>\n\n<p>Also note, i use 512 characters for the buffer size when getting the path, just to be more safe since paths might exceed 256. I doubt anyone will have paths as long as that though.</p>\n\n<p>One more note. I've only tested the above examples in Python 3, but i don't think SystemParametersInfoA needs the .encode() in Python 2. (they updated strings in Python 3 to unicode i believe) The string in SystemParametersInfoW may need converting for Python 2.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 17846518,
                        "reputation": 21,
                        "user_id": 12963184,
                        "user_type": "registered",
                        "display_name": "Godeta"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1589480025,
                    "creation_date": 1589480025,
                    "answer_id": 61804458,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/61804458#61804458",
                    "body": "<p>Just adding a small precision to ShivaGuntuku 's post :\nIn python 3 you should replace the 'A' by a 'W' in SytemParametersInfoA. Small exemple to change your desktop background in windows10 with python 3 :</p>\n\n<pre><code>import ctypes\nimport os\nSPI_SETDESKWALLPAPER = 20\nctypes.windll.user32.SystemParametersInfoW(\n    SPI_SETDESKWALLPAPER, 0, 'C:\\\\Users\\\\godet\\\\OneDrive\\\\Images\\\\breaker_wall.jpg', 0)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 15029562,
                        "reputation": 131,
                        "user_id": 10848139,
                        "user_type": "registered",
                        "display_name": "iamkanaramyadav"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1593591576,
                    "last_edit_date": 1593591576,
                    "creation_date": 1589667911,
                    "answer_id": 61844402,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/61844402#61844402",
                    "body": "<p>On Windows with python2.5 or higher, use ctypes to load user32.dll and call</p>\n<pre><code>import ctypes\nctypes.windll.user32.SystemParametersInfoW(20,0,&quot;Path_wallpaper&quot;, 0) \n     speak(&quot;Background changed succesfully&quot;)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 19600123,
                                "reputation": 92,
                                "user_id": 14345173,
                                "user_type": "registered",
                                "display_name": "nsde"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639775320,
                            "post_id": 68375182,
                            "comment_id": 124443615,
                            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/68375182#comment124443615_68375182",
                            "body": "It doesn&#39;t support Linux (at least the descriptions says so..)"
                        }
                    ],
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user14093271"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1626253802,
                    "creation_date": 1626253802,
                    "answer_id": 68375182,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/68375182#68375182",
                    "body": "<p>I read all the answers and after searching for a while i found a easier solution.</p>\n<p>Install the module named py-wallpaper.</p>\n<pre><code>pip install py-wallpaper\n</code></pre>\n<p>Import the module.</p>\n<pre><code>from wallpaper import set_wallpaper, get_wallpaper\n</code></pre>\n<p>set the wallpaper using set walpaper</p>\n<pre><code>set_wallpaper(&quot;location/to/image.jpg&quot;)\n</code></pre>\n<p>get the current wallpaper's path using get wallpaper</p>\n<pre><code>print(get_wallpaper())\n</code></pre>\n<p>thanks.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 20307144,
                        "reputation": 903,
                        "user_id": 14895107,
                        "user_type": "registered",
                        "display_name": "Abhimanyu Sharma"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1664623594,
                    "creation_date": 1664623594,
                    "answer_id": 73917926,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/73917926#73917926",
                    "body": "<p>this works for me</p>\n<pre><code>import ctypes\nctypes.windll.user32.SystemParametersInfoW(20,0,path:os.PathLike,3)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 23325805,
                        "reputation": 970,
                        "user_id": 17402986,
                        "user_type": "registered",
                        "display_name": "ashraf minhaj"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1665402191,
                    "creation_date": 1665402191,
                    "answer_id": 74014390,
                    "question_id": 1977694,
                    "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python/74014390#74014390",
                    "body": "<p>You can use this library <a href=\"https://github.com/geekpradd/PyWallpaper\" rel=\"nofollow noreferrer\">PyWallpaper</a>, worked for me on mac also.</p>\n<p>To install type <code>pip install PyWallpaper</code>.\nAnd then to change/set your wallpaper -</p>\n<pre><code>from PyWallpaper import change_wallpaper\nchange_wallpaper(&quot;/some_path/sample.jpg&quot;)\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 60599,
                "reputation": 5640,
                "user_id": 180960,
                "user_type": "registered",
                "accept_rate": 64,
                "display_name": "aliva"
            },
            "comment_count": 2,
            "is_answered": true,
            "answer_count": 15,
            "score": 52,
            "last_activity_date": 1665402191,
            "creation_date": 1262131346,
            "last_edit_date": 1490689555,
            "question_id": 1977694,
            "link": "https://stackoverflow.com/questions/1977694/how-can-i-change-my-desktop-background-with-python",
            "title": "How can I change my desktop background with python?",
            "body": "<p>How can I change my desktop background with python?</p>\n\n<p>I want to do it in both Windows and Linux.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 8595
}