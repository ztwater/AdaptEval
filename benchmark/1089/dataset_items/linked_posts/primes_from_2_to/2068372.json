{
    "items": [
        {
            "tags": [
                "python",
                "math",
                "optimization",
                "primes"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 30893,
                        "reputation": 7215,
                        "user_id": 84513,
                        "user_type": "registered",
                        "accept_rate": 73,
                        "display_name": "Shekhar"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1264258295,
                    "post_id": 2068372,
                    "comment_id": 2061403,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment2061403_2068372",
                    "body": "Code sniplet in question is much faster if numbers declared like numbers = set(range(n, 2, -2)). But can&#39;t beat sundaram3.  Thanks for the question."
                },
                {
                    "owner": {
                        "account_id": 50166,
                        "reputation": 40301,
                        "user_id": 149530,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Michael F"
                    },
                    "edited": false,
                    "score": 4,
                    "creation_date": 1315667983,
                    "post_id": 2068372,
                    "comment_id": 8898980,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment8898980_2068372",
                    "body": "It&#39;d be nice if there could be Python 3 versions of the functions in the answers."
                },
                {
                    "owner": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1352567366,
                    "post_id": 2068372,
                    "comment_id": 18176766,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment18176766_2068372",
                    "body": "Surely there&#39;s a library to do this so we don&#39;t have to roll our own&gt; xkcd promised Python is as simple as <code>import antigravity</code>. Isn&#39;t there anything like <code>require &#39;prime&#39;; Prime.take(10)</code> (Ruby)?"
                },
                {
                    "owner": {
                        "account_id": 3137088,
                        "reputation": 13833,
                        "user_id": 2653390,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "Shashank"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1381205432,
                    "post_id": 2068372,
                    "comment_id": 28476970,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment28476970_2068372",
                    "body": "Note that you do not need to pass in a set as your argument to <code>difference_update</code>. You can simply do <code>numbers.difference_update(xrange(p*2, N+1, p))</code> That will shave a few milliseconds off your time at the very least."
                },
                {
                    "owner": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1435960959,
                    "post_id": 2068372,
                    "comment_id": 50430508,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment50430508_2068372",
                    "body": "I suspect a Python binding around the C++ library <a href=\"http://primesieve.org/\" rel=\"nofollow noreferrer\">primesieve</a> would be <i>orders of magnitude</i> faster than all of these."
                },
                {
                    "owner": {
                        "account_id": 2463410,
                        "reputation": 26077,
                        "user_id": 2147024,
                        "user_type": "registered",
                        "display_name": "Jared"
                    },
                    "reply_to_user": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "edited": false,
                    "score": 4,
                    "creation_date": 1436320107,
                    "post_id": 2068372,
                    "comment_id": 50557459,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment50557459_2068372",
                    "body": "@ColonelPanic As it so happens I updated <a href=\"https://github.com/jaredks/pyprimesieve\" rel=\"nofollow noreferrer\">github.com/jaredks/pyprimesieve</a> for Py3 and added to PyPi. It&#39;s certainly faster than these but not orders of magnitude - more like ~5x faster than the best numpy versions."
                },
                {
                    "owner": {
                        "account_id": 5250593,
                        "reputation": 956,
                        "user_id": 4194964,
                        "user_type": "registered",
                        "display_name": "Brian Cain"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1436890289,
                    "post_id": 2068372,
                    "comment_id": 50796919,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment50796919_2068372",
                    "body": "I don&#39;t know the speed comparison to the answers already listed here, however I would recommend looking at <a href=\"http://www.sagemath.org/\" rel=\"nofollow noreferrer\">sagemath.org</a>  It is a crypto python frame work that has many built in functions  to do the things that you are looking for."
                },
                {
                    "owner": {
                        "account_id": 78868,
                        "reputation": 348877,
                        "user_id": 224132,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "Peter Cordes"
                    },
                    "reply_to_user": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "edited": false,
                    "score": 4,
                    "creation_date": 1437244137,
                    "post_id": 2068372,
                    "comment_id": 50951995,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment50951995_2068372",
                    "body": "@ColonelPanic: I think editing old answers to note that they&#39;ve aged is appropriate, since that makes it a more useful resource.  If the &quot;accepted&quot; answer is no longer the best one, maybe edit a note into the question with a 2015 update to point people at the current best method."
                },
                {
                    "owner": {
                        "account_id": 1460523,
                        "reputation": 879,
                        "user_id": 1374975,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Albert van der Horst"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1545876724,
                    "post_id": 2068372,
                    "comment_id": 94717750,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment94717750_2068372",
                    "body": "I can&#39;t believe that no moderator has deleted this question. It asks for improvement in speed of an algorithm that is admittedly not correct. Groetjes Albert"
                },
                {
                    "owner": {
                        "account_id": 7683118,
                        "reputation": 602,
                        "user_id": 5821790,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Vepir"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1600106091,
                    "post_id": 2068372,
                    "comment_id": 112977336,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment112977336_2068372",
                    "body": "<code>from sympy import sieve; sieve.extend(N);</code>"
                },
                {
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user16657590"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1632061101,
                    "post_id": 2068372,
                    "comment_id": 122386339,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n#comment122386339_2068372",
                    "body": "Hey that&#39;s really fast code.  you are right the code fails for <code>n =10000</code> as <code>number.pop()</code> doesn&#39;t pop out the least one as not sorted. <a href=\"https://stackoverflow.com/questions/69222673/number-of-primes-less-than-or-equal-to-x/69227431?r=SearchResults&amp;s=51|5.9308#69227431\">Thread</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 34048,
                                "reputation": 869830,
                                "user_id": 95810,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Alex Martelli"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1263513553,
                            "post_id": 2068412,
                            "comment_id": 1997910,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068412#comment1997910_2068412",
                            "body": "@jbochi, you&#39;re welcome -- but do look at that URL, including the credits: it took <b>ten</b> of us to collectively refine the code to this point, including Python-performance luminaries such as Tim Peters and Raymond Hettinger (I wrote the final text of the recipe since I edited the printed Cookbook, but in terms of coding my contribution was on a par with the others&#39;) -- in the end, it&#39;s really subtle and finely tuned code, and that&#39;s not surprising!-)"
                        },
                        {
                            "owner": {
                                "account_id": 81883,
                                "reputation": 29266,
                                "user_id": 230636,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "jbochi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1263514402,
                            "post_id": 2068412,
                            "comment_id": 1997992,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068412#comment1997992_2068412",
                            "body": "@Alex: Knowing that your code is &quot;only&quot; twice as fast as mine, makes me pretty proud then. :) The URL was also very interesting to read. Thanks again."
                        },
                        {
                            "owner": {
                                "account_id": 4551,
                                "reputation": 94733,
                                "user_id": 6899,
                                "user_type": "registered",
                                "accept_rate": 84,
                                "display_name": "tzot"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1285470156,
                            "post_id": 2068412,
                            "comment_id": 4023983,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068412#comment4023983_2068412",
                            "body": "And it can be made even faster with a minor change: see <a href=\"http://stackoverflow.com/questions/2211990/how-to-implement-an-efficient-infinite-generator-of-prime-numbers-in-python/3796442#3796442\" title=\"how to implement an efficient infinite generator of prime numbers in python\">stackoverflow.com/questions/2211990/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1343946485,
                            "post_id": 2068412,
                            "comment_id": 15657933,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068412#comment15657933_2068412",
                            "body": "... And it <a href=\"http://stackoverflow.com/a/10733621/849891\">can be made yet faster</a> with additional ~1.2x-1.3x speedup, drastic reduction in memory footprint from O(n) to O(sqrt(n)) and improvement in empirical time complexity, by postponing the addition of primes to the dict until their <i>square</i> is seen in the input. <a href=\"http://ideone.com/WFv4f\" rel=\"nofollow noreferrer\">Test it here</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 34048,
                        "reputation": 869830,
                        "user_id": 95810,
                        "user_type": "registered",
                        "accept_rate": 80,
                        "display_name": "Alex Martelli"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 43,
                    "last_activity_date": 1437053620,
                    "last_edit_date": 1437053620,
                    "creation_date": 1263513126,
                    "answer_id": 2068412,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068412#2068412",
                    "body": "<p>There's a pretty neat sample from the Python Cookbook <a href=\"http://oreilly.com/pub/a/python/excerpt/pythonckbk_chap1/index1.html?page=last\" rel=\"noreferrer\">here</a> -- the fastest version proposed on that URL is:</p>\n\n<pre><code>import itertools\ndef erat2( ):\n    D = {  }\n    yield 2\n    for q in itertools.islice(itertools.count(3), 0, None, 2):\n        p = D.pop(q, None)\n        if p is None:\n            D[q*q] = q\n            yield q\n        else:\n            x = p + q\n            while x in D or not (x&amp;1):\n                x += p\n            D[x] = p\n</code></pre>\n\n<p>so that would give</p>\n\n<pre><code>def get_primes_erat(n):\n  return list(itertools.takewhile(lambda p: p&lt;n, erat2()))\n</code></pre>\n\n<p>Measuring at the shell prompt (as I prefer to do) with this code in pri.py, I observe:</p>\n\n<pre><code>$ python2.5 -mtimeit -s'import pri' 'pri.get_primes(1000000)'\n10 loops, best of 3: 1.69 sec per loop\n$ python2.5 -mtimeit -s'import pri' 'pri.get_primes_erat(1000000)'\n10 loops, best of 3: 673 msec per loop\n</code></pre>\n\n<p>so it looks like the Cookbook solution is over twice as fast.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 22723,
                        "reputation": 226381,
                        "user_id": 56338,
                        "user_type": "registered",
                        "accept_rate": 44,
                        "display_name": "sth"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 22,
                    "last_activity_date": 1263514444,
                    "creation_date": 1263514444,
                    "answer_id": 2068522,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068522#2068522",
                    "body": "<p>The algorithm is fast, but it has a serious flaw:</p>\n\n<pre><code>&gt;&gt;&gt; sorted(get_primes(530))\n[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73,\n79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163,\n167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251,\n257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349,\n353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443,\n449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 527, 529]\n&gt;&gt;&gt; 17*31\n527\n&gt;&gt;&gt; 23*23\n529\n</code></pre>\n\n<p>You assume that <code>numbers.pop()</code> would return the smallest number in the set, but this is not guaranteed at all. Sets are unordered and <code>pop()</code> removes and returns an <a href=\"http://docs.python.org/library/stdtypes.html#set.pop\" rel=\"noreferrer\"><strong>arbitrary</strong></a> element, so it cannot be used to select the next prime from the remaining numbers.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 81883,
                                "reputation": 29266,
                                "user_id": 230636,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "jbochi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1263517916,
                            "post_id": 2068548,
                            "comment_id": 1998287,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment1998287_2068548",
                            "body": "That&#39;s not pure Python, but it&#39;s the fastest version so far. thanks!"
                        },
                        {
                            "owner": {
                                "account_id": 34048,
                                "reputation": 869830,
                                "user_id": 95810,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Alex Martelli"
                            },
                            "edited": false,
                            "score": 7,
                            "creation_date": 1263519669,
                            "post_id": 2068548,
                            "comment_id": 1998429,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment1998429_2068548",
                            "body": "If you&#39;re interested in non-pure-Python code, then you should check out <code>gmpy</code> -- it has pretty good support for primes, via the <code>next_prime</code> method of its <code>mpz</code> type."
                        },
                        {
                            "owner": {
                                "account_id": 60297,
                                "reputation": 39000,
                                "user_id": 180174,
                                "user_type": "registered",
                                "accept_rate": 96,
                                "display_name": "Kimvais"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1263550553,
                            "post_id": 2068548,
                            "comment_id": 2000472,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment2000472_2068548",
                            "body": "just for correctness, the code example should have <code>import numpy as np</code>"
                        },
                        {
                            "owner": {
                                "account_id": 80057,
                                "reputation": 95055,
                                "user_id": 226621,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Alok Singhal"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1263959327,
                            "post_id": 2068548,
                            "comment_id": 2032467,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment2032467_2068548",
                            "body": "<code>int(n ** 0.5)</code> should be <code>int(math.ceil(n ** 0.5))</code> or <code>int(n ** 0.5) + 1</code>.  <code>ambi_sieve(10)</code> gives wrong answer otherwise."
                        },
                        {
                            "owner": {
                                "account_id": 33021,
                                "reputation": 10215,
                                "user_id": 92092,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "stephan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1264087025,
                            "post_id": 2068548,
                            "comment_id": 2045411,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment2045411_2068548",
                            "body": "You might want to add wheel factorization to your comparison. The version on <a href=\"http://zerovolt.com/?p=88\" rel=\"nofollow noreferrer\">zerovolt.com/?p=88</a> (which happened to be the first that I found googling) is faster on my machine than the other pure Python versions you list."
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 33021,
                                "reputation": 10215,
                                "user_id": 92092,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "stephan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1264095539,
                            "post_id": 2068548,
                            "comment_id": 2046784,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment2046784_2068548",
                            "body": "@stephan: Thank you for the link. Are you sure you would not like to throw your hat into the ring?"
                        },
                        {
                            "owner": {
                                "account_id": 33021,
                                "reputation": 10215,
                                "user_id": 92092,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "stephan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1264110711,
                            "post_id": 2068548,
                            "comment_id": 2048942,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment2048942_2068548",
                            "body": "@~unutbu: go ahead if you want. To me, your comparison of various very fast algorithms seems to be the perfect place to add this specific implementation. I have used your script to compare the speed and verify correctness."
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276514307,
                            "post_id": 2068548,
                            "comment_id": 3106443,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3106443_2068548",
                            "body": "@~unutbu: <code>sieveOfEratosthenes()</code> is faster if we allow only pure Python than any other variant (without psyco, numpy). Python3: sieveOfEratosthenes: 0.055, sieve_wheel_30: 0.061 ambi_sieve_plain: 0.130, sieveOfAtkin: 0.270; Python2: sieveOfEratosthenes: 0.061, sieve_wheel_30: 0.086, ambi_sieve_plain: 0.137, sieveOfAtkin: 0.216. If we allow C extensions then gmpy2-based variant (<code>0.041</code>) is the fastest in Python3 <a href=\"http://stackoverflow.com/questions/2897297/speed-up-bitstring-bit-operations-in-python/2901856#2901856\" title=\"speed up bitstring bit operations in python\">stackoverflow.com/questions/2897297/&hellip;</a> <code>ambi_sieve: 0.015</code> is the fastest on Python2 if C extensions are allowed."
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276520648,
                            "post_id": 2068548,
                            "comment_id": 3107213,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3107213_2068548",
                            "body": "@J.F Sebastian: Thanks for the info. I&#39;ve rechecked my timeit runs and at least on my machine (Intel E2160 running Ubuntu 9.10) <code>sieveOfEratosthenes</code> is definitely not the fastest. Do you think our differing results could be due to hardware? Also, have you checked Robert William Hanks&#39; primesfrom3to1? <a href=\"http://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\" title=\"fastest way to list all primes below n in python\">stackoverflow.com/questions/2068372/&hellip;</a> Using numpy I&#39;m getting primesfrom3to1 (19.6) versus ambi_sieve (29.4)."
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276541493,
                            "post_id": 2068548,
                            "comment_id": 3110232,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3110232_2068548",
                            "body": "@~unutbu: Indeed <code>primesfrom3to1()</code> (corrected to return <code>r_[...</code>) takes 17 seconds for n=1e9 vs. 22.2 seconds for <code>ambi_sieve()</code> (for n=1e6 both are almost the same (15ms) <code>ambi_sieve()</code> being slightly faster). Among pure Python versions <code>sieveOfEratosthenes</code> is the fastest on my machine (Intel i7, Ubuntu 10.04)"
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276641007,
                            "post_id": 2068548,
                            "comment_id": 3121268,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3121268_2068548",
                            "body": "New @Robert William Hanks&#39;s <code>primes()</code> function <a href=\"http://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\" title=\"fastest way to list all primes below n in python\">stackoverflow.com/questions/2068372/&hellip;</a> is the fastest (for n=1e6) now among pure Python solutions <a href=\"http://ideone.com/weu23\" rel=\"nofollow noreferrer\">ideone.com/weu23</a>"
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276712150,
                            "post_id": 2068548,
                            "comment_id": 3128605,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3128605_2068548",
                            "body": "@J.F. Sebastian: Neat program. I love the decorators. Using your program on my machine, <code>primes1</code> is still sometimes faster than <code>primes</code> (well, on 2 out of 3 runs...). Without <code>psycho</code> the difference between those two seems to be on the order of the standard error between runs."
                        },
                        {
                            "owner": {
                                "account_id": 142554,
                                "reputation": 361,
                                "user_id": 350331,
                                "user_type": "registered",
                                "display_name": "Robert William Hanks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276728187,
                            "post_id": 2068548,
                            "comment_id": 3130766,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3130766_2068548",
                            "body": "in my machine times for primes &amp; primes1 (without psycho) are exactly the same,i just posted as an example because it uses slightly less memory. i just posted a variation of primesfrom3to with the same upside that at least for 1e7 is faster in may machine."
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "reply_to_user": {
                                "account_id": 142554,
                                "reputation": 361,
                                "user_id": 350331,
                                "user_type": "registered",
                                "display_name": "Robert William Hanks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276779133,
                            "post_id": 2068548,
                            "comment_id": 3135113,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3135113_2068548",
                            "body": "@Robert William Hanks: <code>primesfrom2to</code> is slightly faster than <code>ambi_sieve</code> for n=1e6 <a href=\"http://ideone.com/9MOfq\" rel=\"nofollow noreferrer\">ideone.com/9MOfq</a>"
                        },
                        {
                            "owner": {
                                "account_id": 142554,
                                "reputation": 361,
                                "user_id": 350331,
                                "user_type": "registered",
                                "display_name": "Robert William Hanks"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276789601,
                            "post_id": 2068548,
                            "comment_id": 3136985,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3136985_2068548",
                            "body": "@J.F. Sebastian: sorry to ask you that, would you mind to test it again? i made a change in the translation part of the code primesfrom2to and i am getting better results in my machine."
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "reply_to_user": {
                                "account_id": 142554,
                                "reputation": 361,
                                "user_id": 350331,
                                "user_type": "registered",
                                "display_name": "Robert William Hanks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1276853128,
                            "post_id": 2068548,
                            "comment_id": 3143125,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3143125_2068548",
                            "body": "@Robert William Hanks: new version of <code>primesfrom2to</code> is definitely faster than <code>ambi_sieve</code> for sufficiently large n. <a href=\"http://ideone.com/ddiU2\" rel=\"nofollow noreferrer\">ideone.com/ddiU2</a>"
                        },
                        {
                            "owner": {
                                "account_id": 142554,
                                "reputation": 361,
                                "user_id": 350331,
                                "user_type": "registered",
                                "display_name": "Robert William Hanks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1279846100,
                            "post_id": 2068548,
                            "comment_id": 3435538,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment3435538_2068548",
                            "body": "@~unutbu: just added a new version of primesfrom2to &amp; primes2, if you have time you may want to timeit those."
                        },
                        {
                            "owner": {
                                "account_id": 1392725,
                                "reputation": 39591,
                                "user_id": 1399309,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "Scott Tesler"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1385678165,
                            "post_id": 2068548,
                            "comment_id": 30247538,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment30247538_2068548",
                            "body": "Dead links are dead :("
                        },
                        {
                            "owner": {
                                "account_id": 306439,
                                "reputation": 7829,
                                "user_id": 617185,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "kmonsoor"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1387811027,
                            "post_id": 2068548,
                            "comment_id": 31086903,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment31086903_2068548",
                            "body": "but, for noobies, which one is simplest, yet reasonably fast ?"
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1387826333,
                            "post_id": 2068548,
                            "comment_id": 31094015,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment31094015_2068548",
                            "body": "Conceptually, the simplest algorithm (to understand) is the <a href=\"http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">Sieve of Eratosthenes</a>. I would start there. If it is fast enough, great. If not, use the benchmarks posted above to guide you to a faster algorithm."
                        },
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user2379410"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1397418404,
                            "post_id": 2068548,
                            "comment_id": 35214686,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment35214686_2068548",
                            "body": "Using <code>itertools.compress</code> makes <code>rwh_primes1</code> the fastest in the category &quot;plain Python without Psycho&quot; in my testing. I.e. replace the last line with <code>return [2] + list(compress(xrange(3,n,2), sieve[1:]))</code>"
                        },
                        {
                            "owner": {
                                "account_id": 203538,
                                "reputation": 1514,
                                "user_id": 451246,
                                "user_type": "registered",
                                "accept_rate": 56,
                                "display_name": "Ehsan Kia"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1398650030,
                            "post_id": 2068548,
                            "comment_id": 35725916,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment35725916_2068548",
                            "body": "If you&#39;re using pypy, these benchmarks (the psyco ones) seem fairly off. Surprisingly enough, I found sieveOfEratosthenes and ambi_sieve_plain to be the fastest with pypy. This is what I found for the non-numpy ones <a href=\"https://gist.github.com/5bf466bb1ee9e5726a52\" rel=\"nofollow noreferrer\">gist.github.com/5bf466bb1ee9e5726a52</a>"
                        },
                        {
                            "owner": {
                                "account_id": 1136346,
                                "reputation": 16542,
                                "user_id": 1121352,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "gaborous"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1436447949,
                            "post_id": 2068548,
                            "comment_id": 50624486,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment50624486_2068548",
                            "body": "If someone wonders how the functions here fare against <a href=\"https://en.wikibooks.org/wiki/Efficient_Prime_Number_Generating_Algorithms\" rel=\"nofollow noreferrer\">PG7.8 of Wikibooks</a> for pure python without psyco nor pypy: for n = 1000000: PG7.8: 4.93 s per loop ; rwh_primes1: 69 ms per loop ; rwh_primes2: 57.1 ms per loop"
                        },
                        {
                            "owner": {
                                "account_id": 4148701,
                                "reputation": 15803,
                                "user_id": 3924118,
                                "user_type": "registered",
                                "accept_rate": 35,
                                "display_name": "nbro"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1453212267,
                            "post_id": 2068548,
                            "comment_id": 57495482,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment57495482_2068548",
                            "body": "@unutbu Please, fix the links to the different algorithms."
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 4148701,
                                "reputation": 15803,
                                "user_id": 3924118,
                                "user_type": "registered",
                                "accept_rate": 35,
                                "display_name": "nbro"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1453212911,
                            "post_id": 2068548,
                            "comment_id": 57495920,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment57495920_2068548",
                            "body": "@nbro: Which links are broken?"
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 4148701,
                                "reputation": 15803,
                                "user_id": 3924118,
                                "user_type": "registered",
                                "accept_rate": 35,
                                "display_name": "nbro"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1453215729,
                            "post_id": 2068548,
                            "comment_id": 57498009,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment57498009_2068548",
                            "body": "@nbro: The sieveOfAtkin like has been updated with a <a href=\"http://web.archive.org\" rel=\"nofollow noreferrer\">web.archive.org</a> <a href=\"https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83\" rel=\"nofollow noreferrer\">cached page</a>."
                        },
                        {
                            "owner": {
                                "account_id": 1572203,
                                "reputation": 10427,
                                "user_id": 1459669,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "no\u0265\u0287\u028e\u0500\u028ez\u0250\u0279\u0186"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1482531637,
                            "post_id": 2068548,
                            "comment_id": 69819946,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment69819946_2068548",
                            "body": "Can you update this with PyPy, now that psyco is dead and PyPy has superseded it?"
                        },
                        {
                            "owner": {
                                "account_id": 6386201,
                                "reputation": 45900,
                                "user_id": 4954037,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "hiro protagonist"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1540311063,
                            "post_id": 2068548,
                            "comment_id": 92814808,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment92814808_2068548",
                            "body": "the zerovolt.com link is broken... but there is a wheel implementation in python right here: <a href=\"https://stackoverflow.com/a/30563958/4954037\">stackoverflow.com/a/30563958/4954037</a>"
                        },
                        {
                            "owner": {
                                "account_id": 6321039,
                                "reputation": 393303,
                                "user_id": 4909087,
                                "user_type": "registered",
                                "accept_rate": 97,
                                "display_name": "cs95"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1542000168,
                            "post_id": 2068548,
                            "comment_id": 93397238,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment93397238_2068548",
                            "body": "Would be great if these functions and timings could be updated for python3."
                        },
                        {
                            "owner": {
                                "account_id": 395294,
                                "reputation": 25561,
                                "user_id": 758174,
                                "user_type": "registered",
                                "accept_rate": 61,
                                "display_name": "Pierre D"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1642783739,
                            "post_id": 2068548,
                            "comment_id": 125172079,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment125172079_2068548",
                            "body": "2.47ms for 1e6 <a href=\"https://stackoverflow.com/a/70804184/758174\">using <code>numba</code></a> and a simple (older) Sieve of Atkin."
                        },
                        {
                            "owner": {
                                "account_id": 462742,
                                "reputation": 17486,
                                "user_id": 865220,
                                "user_type": "registered",
                                "accept_rate": 23,
                                "display_name": "ishandutta2007"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1653027901,
                            "post_id": 2068548,
                            "comment_id": 127754912,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment127754912_2068548",
                            "body": "In c++ I use min_25 sieve.I takes less than 1 sec to generate primes till 1 Billion. Which of the above catagories would it fall into for python ?"
                        },
                        {
                            "owner": {
                                "account_id": 5498923,
                                "reputation": 238,
                                "user_id": 4368898,
                                "user_type": "registered",
                                "display_name": "Matt Popovich"
                            },
                            "reply_to_user": {
                                "account_id": 6321039,
                                "reputation": 393303,
                                "user_id": 4909087,
                                "user_type": "registered",
                                "accept_rate": 97,
                                "display_name": "cs95"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1661144475,
                            "post_id": 2068548,
                            "comment_id": 129692992,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment129692992_2068548",
                            "body": "@cs95 the answers below contain updated code for Python3, specifically this <a href=\"https://stackoverflow.com/a/3035188/4368898\">community wiki</a> and this <a href=\"https://stackoverflow.com/a/58983866/4368898\">recent-ish answer from Nico</a>."
                        },
                        {
                            "owner": {
                                "account_id": 3813614,
                                "reputation": 10232,
                                "user_id": 3163618,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "qwr"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1676824502,
                            "post_id": 2068548,
                            "comment_id": 133210730,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#comment133210730_2068548",
                            "body": "Now test with pypy!"
                        }
                    ],
                    "owner": {
                        "account_id": 64585,
                        "reputation": 864612,
                        "user_id": 190597,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "unutbu"
                    },
                    "comment_count": 33,
                    "is_accepted": true,
                    "score": 415,
                    "last_activity_date": 1453215637,
                    "last_edit_date": 1495540505,
                    "creation_date": 1263514749,
                    "answer_id": 2068548,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2068548#2068548",
                    "body": "<p><strong>Warning:</strong> <code>timeit</code> results may vary due to differences in hardware or\nversion of Python.  </p>\n\n<p>Below is a script which compares a number of implementations: \n<UL>\n<LI>ambi_sieve_plain,\n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">rwh_primes</a>, \n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">rwh_primes1</a>, \n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">rwh_primes2</a>, \n<LI><a href=\"https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83\" rel=\"noreferrer\">sieveOfAtkin</a>, \n<LI><a href=\"http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d\" rel=\"noreferrer\">sieveOfEratosthenes</a>, \n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279\">sundaram3</a>,\n<LI><a href=\"http://zerovolt.com/?p=88\" rel=\"noreferrer\">sieve_wheel_30</a>,\n<LI><a href=\"http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html\" rel=\"noreferrer\">ambi_sieve</a> (requires numpy)\n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">primesfrom3to</a> (requires numpy)\n<LI><a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">primesfrom2to</a> (requires numpy)\n</UL></p>\n\n<p>Many thanks to <a href=\"https://stackoverflow.com/users/92092/stephan\">stephan</a> for bringing sieve_wheel_30 to my attention.\nCredit goes to <a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">Robert William Hanks</a> for primesfrom2to, primesfrom3to, rwh_primes, rwh_primes1, and rwh_primes2.</p>\n\n<p>Of the plain Python methods tested, <strong>with psyco</strong>, for n=1000000,\n<strong>rwh_primes1</strong> was the fastest tested.</p>\n\n<pre><code>+---------------------+-------+\n| Method              | ms    |\n+---------------------+-------+\n| rwh_primes1         | 43.0  |\n| sieveOfAtkin        | 46.4  |\n| rwh_primes          | 57.4  |\n| sieve_wheel_30      | 63.0  |\n| rwh_primes2         | 67.8  |    \n| sieveOfEratosthenes | 147.0 |\n| ambi_sieve_plain    | 152.0 |\n| sundaram3           | 194.0 |\n+---------------------+-------+\n</code></pre>\n\n<p>Of the plain Python methods tested, <strong>without psyco</strong>, for n=1000000,\n<strong>rwh_primes2</strong> was the fastest.</p>\n\n<pre><code>+---------------------+-------+\n| Method              | ms    |\n+---------------------+-------+\n| rwh_primes2         | 68.1  |\n| rwh_primes1         | 93.7  |\n| rwh_primes          | 94.6  |\n| sieve_wheel_30      | 97.4  |\n| sieveOfEratosthenes | 178.0 |\n| ambi_sieve_plain    | 286.0 |\n| sieveOfAtkin        | 314.0 |\n| sundaram3           | 416.0 |\n+---------------------+-------+\n</code></pre>\n\n<p>Of all the methods tested, <em>allowing numpy</em>, for n=1000000,\n<strong>primesfrom2to</strong> was the fastest tested.</p>\n\n<pre><code>+---------------------+-------+\n| Method              | ms    |\n+---------------------+-------+\n| primesfrom2to       | 15.9  |\n| primesfrom3to       | 18.4  |\n| ambi_sieve          | 29.3  |\n+---------------------+-------+\n</code></pre>\n\n<p>Timings were measured using the command:</p>\n\n<pre><code>python -mtimeit -s\"import primes\" \"primes.{method}(1000000)\"\n</code></pre>\n\n<p>with <code>{method}</code> replaced by each of the method names.</p>\n\n<p>primes.py:</p>\n\n<pre><code>#!/usr/bin/env python\nimport psyco; psyco.full()\nfrom math import sqrt, ceil\nimport numpy as np\n\ndef rwh_primes(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    \"\"\" Returns  a list of primes &lt; n \"\"\"\n    sieve = [True] * n\n    for i in xrange(3,int(n**0.5)+1,2):\n        if sieve[i]:\n            sieve[i*i::2*i]=[False]*((n-i*i-1)/(2*i)+1)\n    return [2] + [i for i in xrange(3,n,2) if sieve[i]]\n\ndef rwh_primes1(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    \"\"\" Returns  a list of primes &lt; n \"\"\"\n    sieve = [True] * (n/2)\n    for i in xrange(3,int(n**0.5)+1,2):\n        if sieve[i/2]:\n            sieve[i*i/2::i] = [False] * ((n-i*i-1)/(2*i)+1)\n    return [2] + [2*i+1 for i in xrange(1,n/2) if sieve[i]]\n\ndef rwh_primes2(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    \"\"\" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n \"\"\"\n    correction = (n%6&gt;1)\n    n = {0:n,1:n-1,2:n+4,3:n+3,4:n+2,5:n+1}[n%6]\n    sieve = [True] * (n/3)\n    sieve[0] = False\n    for i in xrange(int(n**0.5)/3+1):\n      if sieve[i]:\n        k=3*i+1|1\n        sieve[      ((k*k)/3)      ::2*k]=[False]*((n/6-(k*k)/6-1)/k+1)\n        sieve[(k*k+4*k-2*k*(i&amp;1))/3::2*k]=[False]*((n/6-(k*k+4*k-2*k*(i&amp;1))/6-1)/k+1)\n    return [2,3] + [3*i+1|1 for i in xrange(1,n/3-correction) if sieve[i]]\n\ndef sieve_wheel_30(N):\n    # http://zerovolt.com/?p=88\n    ''' Returns a list of primes &lt;= N using wheel criterion 2*3*5 = 30\n\nCopyright 2009 by zerovolt.com\nThis code is free for non-commercial purposes, in which case you can just leave this comment as a credit for my work.\nIf you need this code for commercial purposes, please contact me by sending an email to: info [at] zerovolt [dot] com.'''\n    __smallp = ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59,\n    61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139,\n    149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227,\n    229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311,\n    313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401,\n    409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491,\n    499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599,\n    601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683,\n    691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797,\n    809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887,\n    907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997)\n\n    wheel = (2, 3, 5)\n    const = 30\n    if N &lt; 2:\n        return []\n    if N &lt;= const:\n        pos = 0\n        while __smallp[pos] &lt;= N:\n            pos += 1\n        return list(__smallp[:pos])\n    # make the offsets list\n    offsets = (7, 11, 13, 17, 19, 23, 29, 1)\n    # prepare the list\n    p = [2, 3, 5]\n    dim = 2 + N // const\n    tk1  = [True] * dim\n    tk7  = [True] * dim\n    tk11 = [True] * dim\n    tk13 = [True] * dim\n    tk17 = [True] * dim\n    tk19 = [True] * dim\n    tk23 = [True] * dim\n    tk29 = [True] * dim\n    tk1[0] = False\n    # help dictionary d\n    # d[a , b] = c  ==&gt; if I want to find the smallest useful multiple of (30*pos)+a\n    # on tkc, then I need the index given by the product of [(30*pos)+a][(30*pos)+b]\n    # in general. If b &lt; a, I need [(30*pos)+a][(30*(pos+1))+b]\n    d = {}\n    for x in offsets:\n        for y in offsets:\n            res = (x*y) % const\n            if res in offsets:\n                d[(x, res)] = y\n    # another help dictionary: gives tkx calling tmptk[x]\n    tmptk = {1:tk1, 7:tk7, 11:tk11, 13:tk13, 17:tk17, 19:tk19, 23:tk23, 29:tk29}\n    pos, prime, lastadded, stop = 0, 0, 0, int(ceil(sqrt(N)))\n    # inner functions definition\n    def del_mult(tk, start, step):\n        for k in xrange(start, len(tk), step):\n            tk[k] = False\n    # end of inner functions definition\n    cpos = const * pos\n    while prime &lt; stop:\n        # 30k + 7\n        if tk7[pos]:\n            prime = cpos + 7\n            p.append(prime)\n            lastadded = 7\n            for off in offsets:\n                tmp = d[(7, off)]\n                start = (pos + prime) if off == 7 else (prime * (const * (pos + 1 if tmp &lt; 7 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 11\n        if tk11[pos]:\n            prime = cpos + 11\n            p.append(prime)\n            lastadded = 11\n            for off in offsets:\n                tmp = d[(11, off)]\n                start = (pos + prime) if off == 11 else (prime * (const * (pos + 1 if tmp &lt; 11 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 13\n        if tk13[pos]:\n            prime = cpos + 13\n            p.append(prime)\n            lastadded = 13\n            for off in offsets:\n                tmp = d[(13, off)]\n                start = (pos + prime) if off == 13 else (prime * (const * (pos + 1 if tmp &lt; 13 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 17\n        if tk17[pos]:\n            prime = cpos + 17\n            p.append(prime)\n            lastadded = 17\n            for off in offsets:\n                tmp = d[(17, off)]\n                start = (pos + prime) if off == 17 else (prime * (const * (pos + 1 if tmp &lt; 17 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 19\n        if tk19[pos]:\n            prime = cpos + 19\n            p.append(prime)\n            lastadded = 19\n            for off in offsets:\n                tmp = d[(19, off)]\n                start = (pos + prime) if off == 19 else (prime * (const * (pos + 1 if tmp &lt; 19 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 23\n        if tk23[pos]:\n            prime = cpos + 23\n            p.append(prime)\n            lastadded = 23\n            for off in offsets:\n                tmp = d[(23, off)]\n                start = (pos + prime) if off == 23 else (prime * (const * (pos + 1 if tmp &lt; 23 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # 30k + 29\n        if tk29[pos]:\n            prime = cpos + 29\n            p.append(prime)\n            lastadded = 29\n            for off in offsets:\n                tmp = d[(29, off)]\n                start = (pos + prime) if off == 29 else (prime * (const * (pos + 1 if tmp &lt; 29 else 0) + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n        # now we go back to top tk1, so we need to increase pos by 1\n        pos += 1\n        cpos = const * pos\n        # 30k + 1\n        if tk1[pos]:\n            prime = cpos + 1\n            p.append(prime)\n            lastadded = 1\n            for off in offsets:\n                tmp = d[(1, off)]\n                start = (pos + prime) if off == 1 else (prime * (const * pos + tmp) )//const\n                del_mult(tmptk[off], start, prime)\n    # time to add remaining primes\n    # if lastadded == 1, remove last element and start adding them from tk1\n    # this way we don't need an \"if\" within the last while\n    if lastadded == 1:\n        p.pop()\n    # now complete for every other possible prime\n    while pos &lt; len(tk1):\n        cpos = const * pos\n        if tk1[pos]: p.append(cpos + 1)\n        if tk7[pos]: p.append(cpos + 7)\n        if tk11[pos]: p.append(cpos + 11)\n        if tk13[pos]: p.append(cpos + 13)\n        if tk17[pos]: p.append(cpos + 17)\n        if tk19[pos]: p.append(cpos + 19)\n        if tk23[pos]: p.append(cpos + 23)\n        if tk29[pos]: p.append(cpos + 29)\n        pos += 1\n    # remove exceeding if present\n    pos = len(p) - 1\n    while p[pos] &gt; N:\n        pos -= 1\n    if pos &lt; len(p) - 1:\n        del p[pos+1:]\n    # return p list\n    return p\n\ndef sieveOfEratosthenes(n):\n    \"\"\"sieveOfEratosthenes(n): return the list of the primes &lt; n.\"\"\"\n    # Code from: &lt;dickinsm@gmail.com&gt;, Nov 30 2006\n    # http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d\n    if n &lt;= 2:\n        return []\n    sieve = range(3, n, 2)\n    top = len(sieve)\n    for si in sieve:\n        if si:\n            bottom = (si*si - 3) // 2\n            if bottom &gt;= top:\n                break\n            sieve[bottom::si] = [0] * -((bottom - top) // si)\n    return [2] + [el for el in sieve if el]\n\ndef sieveOfAtkin(end):\n    \"\"\"sieveOfAtkin(end): return a list of all the prime numbers &lt;end\n    using the Sieve of Atkin.\"\"\"\n    # Code by Steve Krenzel, &lt;Sgk284@gmail.com&gt;, improved\n    # Code: https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83\n    # Info: http://en.wikipedia.org/wiki/Sieve_of_Atkin\n    assert end &gt; 0\n    lng = ((end-1) // 2)\n    sieve = [False] * (lng + 1)\n\n    x_max, x2, xd = int(sqrt((end-1)/4.0)), 0, 4\n    for xd in xrange(4, 8*x_max + 2, 8):\n        x2 += xd\n        y_max = int(sqrt(end-x2))\n        n, n_diff = x2 + y_max*y_max, (y_max &lt;&lt; 1) - 1\n        if not (n &amp; 1):\n            n -= n_diff\n            n_diff -= 2\n        for d in xrange((n_diff - 1) &lt;&lt; 1, -1, -8):\n            m = n % 12\n            if m == 1 or m == 5:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n -= d\n\n    x_max, x2, xd = int(sqrt((end-1) / 3.0)), 0, 3\n    for xd in xrange(3, 6 * x_max + 2, 6):\n        x2 += xd\n        y_max = int(sqrt(end-x2))\n        n, n_diff = x2 + y_max*y_max, (y_max &lt;&lt; 1) - 1\n        if not(n &amp; 1):\n            n -= n_diff\n            n_diff -= 2\n        for d in xrange((n_diff - 1) &lt;&lt; 1, -1, -8):\n            if n % 12 == 7:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n -= d\n\n    x_max, y_min, x2, xd = int((2 + sqrt(4-8*(1-end)))/4), -1, 0, 3\n    for x in xrange(1, x_max + 1):\n        x2 += xd\n        xd += 6\n        if x2 &gt;= end: y_min = (((int(ceil(sqrt(x2 - end))) - 1) &lt;&lt; 1) - 2) &lt;&lt; 1\n        n, n_diff = ((x*x + x) &lt;&lt; 1) - 1, (((x-1) &lt;&lt; 1) - 2) &lt;&lt; 1\n        for d in xrange(n_diff, y_min, -8):\n            if n % 12 == 11:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n += d\n\n    primes = [2, 3]\n    if end &lt;= 3:\n        return primes[:max(0,end-2)]\n\n    for n in xrange(5 &gt;&gt; 1, (int(sqrt(end))+1) &gt;&gt; 1):\n        if sieve[n]:\n            primes.append((n &lt;&lt; 1) + 1)\n            aux = (n &lt;&lt; 1) + 1\n            aux *= aux\n            for k in xrange(aux, end, 2 * aux):\n                sieve[k &gt;&gt; 1] = False\n\n    s  = int(sqrt(end)) + 1\n    if s  % 2 == 0:\n        s += 1\n    primes.extend([i for i in xrange(s, end, 2) if sieve[i &gt;&gt; 1]])\n\n    return primes\n\ndef ambi_sieve_plain(n):\n    s = range(3, n, 2)\n    for m in xrange(3, int(n**0.5)+1, 2): \n        if s[(m-3)/2]: \n            for t in xrange((m*m-3)/2,(n&gt;&gt;1)-1,m):\n                s[t]=0\n    return [2]+[t for t in s if t&gt;0]\n\ndef sundaram3(max_n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279\n    numbers = range(3, max_n+1, 2)\n    half = (max_n)//2\n    initial = 4\n\n    for step in xrange(3, max_n+1, 2):\n        for i in xrange(initial, half, step):\n            numbers[i-1] = 0\n        initial += 2*(step+1)\n\n        if initial &gt; half:\n            return [2] + filter(None, numbers)\n\n################################################################################\n# Using Numpy:\ndef ambi_sieve(n):\n    # http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html\n    s = np.arange(3, n, 2)\n    for m in xrange(3, int(n ** 0.5)+1, 2): \n        if s[(m-3)/2]: \n            s[(m*m-3)/2::m]=0\n    return np.r_[2, s[s&gt;0]]\n\ndef primesfrom3to(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    \"\"\" Returns a array of primes, p &lt; n \"\"\"\n    assert n&gt;=2\n    sieve = np.ones(n/2, dtype=np.bool)\n    for i in xrange(3,int(n**0.5)+1,2):\n        if sieve[i/2]:\n            sieve[i*i/2::i] = False\n    return np.r_[2, 2*np.nonzero(sieve)[0][1::]+1]    \n\ndef primesfrom2to(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    \"\"\" Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n \"\"\"\n    sieve = np.ones(n/3 + (n%6==2), dtype=np.bool)\n    sieve[0] = False\n    for i in xrange(int(n**0.5)/3+1):\n        if sieve[i]:\n            k=3*i+1|1\n            sieve[      ((k*k)/3)      ::2*k] = False\n            sieve[(k*k+4*k-2*k*(i&amp;1))/3::2*k] = False\n    return np.r_[2,3,((3*np.nonzero(sieve)[0]+1)|1)]\n\nif __name__=='__main__':\n    import itertools\n    import sys\n\n    def test(f1,f2,num):\n        print('Testing {f1} and {f2} return same results'.format(\n            f1=f1.func_name,\n            f2=f2.func_name))\n        if not all([a==b for a,b in itertools.izip_longest(f1(num),f2(num))]):\n            sys.exit(\"Error: %s(%s) != %s(%s)\"%(f1.func_name,num,f2.func_name,num))\n\n    n=1000000\n    test(sieveOfAtkin,sieveOfEratosthenes,n)\n    test(sieveOfAtkin,ambi_sieve,n)\n    test(sieveOfAtkin,ambi_sieve_plain,n) \n    test(sieveOfAtkin,sundaram3,n)\n    test(sieveOfAtkin,sieve_wheel_30,n)\n    test(sieveOfAtkin,primesfrom3to,n)\n    test(sieveOfAtkin,primesfrom2to,n)\n    test(sieveOfAtkin,rwh_primes,n)\n    test(sieveOfAtkin,rwh_primes1,n)         \n    test(sieveOfAtkin,rwh_primes2,n)\n</code></pre>\n\n<p>Running the script tests that all implementations give the same result.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 71746,
                        "reputation": 68552,
                        "user_id": 207432,
                        "user_type": "registered",
                        "display_name": "Daniel G"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1263541285,
                    "creation_date": 1263541285,
                    "answer_id": 2070107,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070107#2070107",
                    "body": "<p>For the fastest code, the numpy solution is the best. For purely academic reasons, though, I'm posting my pure python version, which is a bit less than 50% faster than the cookbook version posted above. Since I make the entire list in memory, you need enough space to hold everything, but it seems to scale fairly well.</p>\n\n<pre><code>def daniel_sieve_2(maxNumber):\n    \"\"\"\n    Given a number, returns all numbers less than or equal to\n    that number which are prime.\n    \"\"\"\n    allNumbers = range(3, maxNumber+1, 2)\n    for mIndex, number in enumerate(xrange(3, maxNumber+1, 2)):\n        if allNumbers[mIndex] == 0:\n            continue\n        # now set all multiples to 0\n        for index in xrange(mIndex+number, (maxNumber-3)/2+1, number):\n            allNumbers[index] = 0\n    return [2] + filter(lambda n: n!=0, allNumbers)\n</code></pre>\n\n<p>And the results:</p>\n\n<pre><code>&gt;&gt;&gt;mine = timeit.Timer(\"daniel_sieve_2(1000000)\",\n...                    \"from sieves import daniel_sieve_2\")\n&gt;&gt;&gt;prev = timeit.Timer(\"get_primes_erat(1000000)\",\n...                    \"from sieves import get_primes_erat\")\n&gt;&gt;&gt;print \"Mine: {0:0.4f} ms\".format(min(mine.repeat(3, 1))*1000)\nMine: 428.9446 ms\n&gt;&gt;&gt;print \"Previous Best {0:0.4f} ms\".format(min(prev.repeat(3, 1))*1000)\nPrevious Best 621.3581 ms\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 71746,
                                "reputation": 68552,
                                "user_id": 207432,
                                "user_type": "registered",
                                "display_name": "Daniel G"
                            },
                            "edited": false,
                            "score": 11,
                            "creation_date": 1263545343,
                            "post_id": 2070175,
                            "comment_id": 2000019,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070175#comment2000019_2070175",
                            "body": "To be fair, though, you&#39;d have to count the time downloading, unzipping, and formatting the primes and compare that with the time to generate primes using an algorithm - any one of these algorithms could easily write the results to a file for later use. I think in that case, given enough memory to actually calculate all primes less than 982,451,653, the numpy solution would still be faster."
                        },
                        {
                            "owner": {
                                "account_id": 60297,
                                "reputation": 39000,
                                "user_id": 180174,
                                "user_type": "registered",
                                "accept_rate": 96,
                                "display_name": "Kimvais"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1263550281,
                            "post_id": 2070175,
                            "comment_id": 2000441,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070175#comment2000441_2070175",
                            "body": "@Daniel correct. However the store what you have and continue whenever needed still stands..."
                        },
                        {
                            "owner": {
                                "account_id": 257724,
                                "reputation": 1013,
                                "user_id": 539394,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Ross"
                            },
                            "reply_to_user": {
                                "account_id": 71746,
                                "reputation": 68552,
                                "user_id": 207432,
                                "user_type": "registered",
                                "display_name": "Daniel G"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1414018606,
                            "post_id": 2070175,
                            "comment_id": 41666552,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070175#comment41666552_2070175",
                            "body": "@Daniel G I think download time is irrelevant. Isn&#39;t it really about generating the numbers, so you would want to take into account the algorithm used to create that list you&#39;re downloading. And any time complexity would ignore the once of file transfer given it O(n)."
                        },
                        {
                            "owner": {
                                "account_id": 3343954,
                                "reputation": 103,
                                "user_id": 4729930,
                                "user_type": "registered",
                                "display_name": "Batman"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1495501152,
                            "post_id": 2070175,
                            "comment_id": 75267410,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070175#comment75267410_2070175",
                            "body": "The <a href=\"https://primes.utm.edu/notes/faq/LongestList.html\" rel=\"nofollow noreferrer\">FAQ</a> for the UTM prime page suggests calculating small primes is faster than reading them off a disk (the question is what small means)."
                        }
                    ],
                    "owner": {
                        "account_id": 60297,
                        "reputation": 39000,
                        "user_id": 180174,
                        "user_type": "registered",
                        "accept_rate": 96,
                        "display_name": "Kimvais"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 19,
                    "last_activity_date": 1263542298,
                    "creation_date": 1263542298,
                    "answer_id": 2070175,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2070175#2070175",
                    "body": "<p>For <strong>truly</strong> fastest solution with sufficiently large N would be to download a <a href=\"http://primes.utm.edu/lists/small/millions/\" rel=\"noreferrer\">pre-calculated list of primes</a>, store it as a tuple and do something like:</p>\n\n<pre><code>for pos,i in enumerate(primes):\n    if i &gt; N:\n        print primes[:pos]\n</code></pre>\n\n<p>If <code>N &gt; primes[-1]</code> <em>only</em> then calculate more primes and save the new list in your code, so next time it is equally as fast.</p>\n\n<p><em>Always think outside the box.</em></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 17728,
                                "reputation": 26815,
                                "user_id": 39991,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "mthurlin"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1263983660,
                            "post_id": 2073279,
                            "comment_id": 2034228,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2073279#comment2034228_2073279",
                            "body": "I managed to speed up your function about 20% by adding &quot;zero = 0&quot; at the top of the function and then replacing the lambda in your filter with &quot;zero.__sub__&quot;. Not the prettiest code in the world, but a bit faster :)"
                        },
                        {
                            "owner": {
                                "account_id": 81883,
                                "reputation": 29266,
                                "user_id": 230636,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "jbochi"
                            },
                            "reply_to_user": {
                                "account_id": 17728,
                                "reputation": 26815,
                                "user_id": 39991,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "mthurlin"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1263985681,
                            "post_id": 2073279,
                            "comment_id": 2034429,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2073279#comment2034429_2073279",
                            "body": "@truppo: Thanks for your comment! I just realized that passing <code>None</code> instead of the original function works and it&#39;s even faster than <code>zero.__sub__</code>"
                        },
                        {
                            "owner": {
                                "account_id": 1715461,
                                "reputation": 1318,
                                "user_id": 1572626,
                                "user_type": "registered",
                                "accept_rate": 87,
                                "display_name": "wrhall"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1379807869,
                            "post_id": 2073279,
                            "comment_id": 27965578,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2073279#comment27965578_2073279",
                            "body": "Did you know that if you pass <code>sundaram3(9)</code> it will return <code>[2, 3, 5, 7, 9]</code>?  It seems to do this with numerous -- perhaps all -- odd numbers (even when they aren&#39;t prime)"
                        },
                        {
                            "owner": {
                                "account_id": 1397514,
                                "reputation": 11806,
                                "user_id": 1327005,
                                "user_type": "registered",
                                "accept_rate": 54,
                                "display_name": "Assem"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1452150508,
                            "post_id": 2073279,
                            "comment_id": 57043783,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2073279#comment57043783_2073279",
                            "body": "it has an issue: sundaram3(7071) includes 7071 while it is not prime"
                        }
                    ],
                    "owner": {
                        "account_id": 81883,
                        "reputation": 29266,
                        "user_id": 230636,
                        "user_type": "registered",
                        "accept_rate": 90,
                        "display_name": "jbochi"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 29,
                    "last_activity_date": 1263985879,
                    "last_edit_date": 1263985879,
                    "creation_date": 1263574202,
                    "answer_id": 2073279,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2073279#2073279",
                    "body": "<p>Using <a href=\"http://plus.maths.org/issue50/features/havil/index.html\" rel=\"noreferrer\">Sundaram's Sieve</a>, I think I broke pure-Python's record:</p>\n\n<pre><code>def sundaram3(max_n):\n    numbers = range(3, max_n+1, 2)\n    half = (max_n)//2\n    initial = 4\n\n    for step in xrange(3, max_n+1, 2):\n        for i in xrange(initial, half, step):\n            numbers[i-1] = 0\n        initial += 2*(step+1)\n\n        if initial &gt; half:\n            return [2] + filter(None, numbers)\n</code></pre>\n\n<p>Comparasion:</p>\n\n<pre><code>C:\\USERS&gt;python -m timeit -n10 -s \"import get_primes\" \"get_primes.get_primes_erat(1000000)\"\n10 loops, best of 3: 710 msec per loop\n\nC:\\USERS&gt;python -m timeit -n10 -s \"import get_primes\" \"get_primes.daniel_sieve_2(1000000)\"\n10 loops, best of 3: 435 msec per loop\n\nC:\\USERS&gt;python -m timeit -n10 -s \"import get_primes\" \"get_primes.sundaram3(1000000)\"\n10 loops, best of 3: 327 msec per loop\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 81883,
                                "reputation": 29266,
                                "user_id": 230636,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "jbochi"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1264068440,
                            "post_id": 2106069,
                            "comment_id": 2043273,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106069#comment2043273_2106069",
                            "body": "Thank&#39;s for the Miller-Rabin primality test, but this code is actually slower and is not providing the correct results. 37 is prime and does not pass the test."
                        },
                        {
                            "owner": {
                                "account_id": 92155,
                                "reputation": 6825,
                                "user_id": 252684,
                                "user_type": "registered",
                                "accept_rate": 81,
                                "display_name": "Ruggiero Spearman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1264072062,
                            "post_id": 2106069,
                            "comment_id": 2043591,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106069#comment2043591_2106069",
                            "body": "I guess 37 is one of the special cases, my bad. I was hopeful about the deterministic version though :)"
                        },
                        {
                            "owner": {
                                "account_id": 426421,
                                "reputation": 1302,
                                "user_id": 807631,
                                "user_type": "registered",
                                "accept_rate": 97,
                                "display_name": "Misguided"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1385509036,
                            "post_id": 2106069,
                            "comment_id": 30170527,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106069#comment30170527_2106069",
                            "body": "There isn&#39;t any special case for rabin miller."
                        },
                        {
                            "owner": {
                                "account_id": 874629,
                                "reputation": 1642,
                                "user_id": 924537,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Logan"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1387924601,
                            "post_id": 2106069,
                            "comment_id": 31125642,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106069#comment31125642_2106069",
                            "body": "You misread the article. It is 31, not 37. This is why your implementation fails."
                        }
                    ],
                    "owner": {
                        "account_id": 92155,
                        "reputation": 6825,
                        "user_id": 252684,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "Ruggiero Spearman"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1683941955,
                    "last_edit_date": 1683941955,
                    "creation_date": 1264033065,
                    "answer_id": 2106069,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106069#2106069",
                    "body": "<p>A deterministic implementation of Miller-Rabin's Primality test on the assumption that N &lt; 9,080,191</p>\n<pre><code>import sys\n\ndef miller_rabin_pass(a, n):\n    d = n - 1\n    s = 0\n    while d % 2 == 0:\n        d &gt;&gt;= 1\n        s += 1\n\n    a_to_power = pow(a, d, n)\n    if a_to_power == 1:\n        return True\n    for i in range(s-1):\n        if a_to_power == n - 1:\n            return True\n        a_to_power = (a_to_power * a_to_power) % n\n    return a_to_power == n - 1\n\n\ndef miller_rabin(n):\n    if n &lt;= 2:\n        return n == 2\n\n    if n &lt; 2_047:\n        return miller_rabin_pass(2, n)\n\n    return all(miller_rabin_pass(a, n) for a in (31, 73))\n\n\nn = int(sys.argv[1])\nprimes = [2]\nfor p in range(3,n,2):\n  if miller_rabin(p):\n    primes.append(p)\nprint len(primes)\n</code></pre>\n<p>According to the article on Wikipedia (<a href=\"http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/Miller\u2013Rabin_primality_test</a>) testing N &lt; 9,080,191 for a = 31 and 73 is enough to decide whether N is composite or not.</p>\n<p>And I adapted the source code from the probabilistic implementation of original Miller-Rabin's test found here: <a href=\"https://www.literateprograms.org/miller-rabin_primality_test__python_.html\" rel=\"nofollow noreferrer\">https://www.literateprograms.org/miller-rabin_primality_test__python_.html</a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 81883,
                                "reputation": 29266,
                                "user_id": 230636,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "jbochi"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1264068855,
                            "post_id": 2106085,
                            "comment_id": 2043322,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106085#comment2043322_2106085",
                            "body": "Or download them from here <a href=\"http://primes.utm.edu/lists/small/millions/\" rel=\"nofollow noreferrer\">primes.utm.edu/lists/small/millions</a>, but the idea is to test python&#39;s limit and see if beautiful code emerge from optimization."
                        }
                    ],
                    "owner": {
                        "account_id": 24487,
                        "reputation": 24728,
                        "user_id": 62288,
                        "user_type": "registered",
                        "display_name": "Dave W. Smith"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1264033300,
                    "creation_date": 1264033300,
                    "answer_id": 2106085,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2106085#2106085",
                    "body": "<p>If you have control over N, the very fastest way to list all primes is to precompute them. Seriously. Precomputing is a way overlooked optimization.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 42964,
                        "reputation": 26450,
                        "user_id": 125382,
                        "user_type": "registered",
                        "accept_rate": 91,
                        "display_name": "MAK"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1264090176,
                    "creation_date": 1264090176,
                    "answer_id": 2110724,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2110724#2110724",
                    "body": "<p>Here's the code I normally use to generate primes in Python:</p>\n\n<pre><code>$ python -mtimeit -s'import sieve' 'sieve.sieve(1000000)' \n10 loops, best of 3: 445 msec per loop\n$ cat sieve.py\nfrom math import sqrt\n\ndef sieve(size):\n prime=[True]*size\n rng=xrange\n limit=int(sqrt(size))\n\n for i in rng(3,limit+1,+2):\n  if prime[i]:\n   prime[i*i::+i]=[False]*len(prime[i*i::+i])\n\n return [2]+[i for i in rng(3,size,+2) if prime[i]]\n\nif __name__=='__main__':\n print sieve(100)\n</code></pre>\n\n<p>It can't compete with the faster solutions posted here, but at least it is pure python.</p>\n\n<p>Thanks for posting this question. I really learnt a lot today. </p>\n"
                },
                {
                    "owner": {
                        "account_id": 12436,
                        "reputation": 27613,
                        "user_id": 24468,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "akuhn"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1264382782,
                    "last_edit_date": 1264382782,
                    "creation_date": 1264382482,
                    "answer_id": 2129681,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/2129681#2129681",
                    "body": "<p>My guess is that the <em>fastest</em> of all ways is to hard code the primes in your code.</p>\n\n<p>So why not just write a slow script that generates another source file that has all numbers hardwired in it, and then import that source file when you run your actual program.</p>\n\n<p>Of course, this works only if you know the upper bound of N at compile time, but thus is the case for (almost) all project Euler problems. </p>\n\n<p>&nbsp;</p>\n\n<p><strong>PS:</strong> <em>I might be wrong though iff parsing the source with hard-wired primes is slower than computing them in the first place, but as far I know Python runs from compiled <code>.pyc</code> files so reading a binary array with all primes up to N should be bloody fast in that case.</em></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1117304,
                                "reputation": 15645,
                                "user_id": 1106367,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Adam"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1364167036,
                            "post_id": 3035188,
                            "comment_id": 22131203,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment22131203_3035188",
                            "body": "Numpy is now compatible with Python 3. The fact that it&#39;s not in the standard library is good, that way they can have their own release cycle."
                        },
                        {
                            "owner": {
                                "account_id": 6386201,
                                "reputation": 45900,
                                "user_id": 4954037,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "hiro protagonist"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1437162629,
                            "post_id": 3035188,
                            "comment_id": 50932418,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50932418_3035188",
                            "body": "to just store binary values in an array i suggest <code>bitarray</code> - as used here (for the simplest prime sieve; not a contender in the race here!) <a href=\"https://stackoverflow.com/questions/31120986/optimize-sieve-of-eratosthenes-further/31122596#31122596\" title=\"optimize sieve of eratosthenes further\">stackoverflow.com/questions/31120986/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 4217317,
                                "reputation": 201,
                                "user_id": 4934364,
                                "user_type": "registered",
                                "display_name": "355durch113"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1445035923,
                            "post_id": 3035188,
                            "comment_id": 54168524,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment54168524_3035188",
                            "body": "When casting in the <code>primesfrom2to()</code> method, should the division be inside of the brackets?"
                        },
                        {
                            "owner": {
                                "account_id": 2894488,
                                "reputation": 6440,
                                "user_id": 2482582,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Moebius"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1460146507,
                            "post_id": 3035188,
                            "comment_id": 60624024,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment60624024_3035188",
                            "body": "For a pure python version compatible with python 3, follow this link : <a href=\"http://stackoverflow.com/a/33356284/2482582\">stackoverflow.com/a/33356284/2482582</a>"
                        },
                        {
                            "owner": {
                                "account_id": 4993527,
                                "reputation": 54950,
                                "user_id": 4014959,
                                "user_type": "registered",
                                "display_name": "PM 2Ring"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1489586629,
                            "post_id": 3035188,
                            "comment_id": 72736135,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment72736135_3035188",
                            "body": "FWIW, the version in your 1st code block is the topic of <a href=\"http://stackoverflow.com/questions/42811019/prime-numbers-generator-explanation\">this question</a>. I should also mention that I used a Python 3 version of your code <a href=\"http://stackoverflow.com/a/38743446/4014959\">here</a>."
                        },
                        {
                            "owner": {
                                "account_id": 3445698,
                                "reputation": 5401,
                                "user_id": 2886575,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "Him"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1564732355,
                            "post_id": 3035188,
                            "comment_id": 101134863,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment101134863_3035188",
                            "body": "Holy buttsnacks this sucker is fast."
                        },
                        {
                            "owner": {
                                "account_id": 395294,
                                "reputation": 25561,
                                "user_id": 758174,
                                "user_type": "registered",
                                "accept_rate": 61,
                                "display_name": "Pierre D"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1642815647,
                            "post_id": 3035188,
                            "comment_id": 125180345,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment125180345_3035188",
                            "body": "How about <code>numba</code> versions of these algos? For motivation, <a href=\"https://stackoverflow.com/a/70804184/758174\">here</a> I use <code>numba</code> to implement an older version of Atkin&#39;s sieve. It takes <b>2.5ms</b> to get the primes up to <code>10**6</code> and 10.6s up to <code>10**9</code>."
                        },
                        {
                            "owner": {
                                "account_id": 462742,
                                "reputation": 17486,
                                "user_id": 865220,
                                "user_type": "registered",
                                "accept_rate": 23,
                                "display_name": "ishandutta2007"
                            },
                            "reply_to_user": {
                                "account_id": 395294,
                                "reputation": 25561,
                                "user_id": 758174,
                                "user_type": "registered",
                                "accept_rate": 61,
                                "display_name": "Pierre D"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1653027391,
                            "post_id": 3035188,
                            "comment_id": 127754764,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment127754764_3035188",
                            "body": "@PierreD that&#39;s as fast as my c++ implementation of Atkin&#39;s segmented sieve. But in c++ I currently use <code>min_25 sieve</code> which can sieve up to 10**9 in less than 1 sec. Can it be made avaiable in python?"
                        }
                    ],
                    "owner": {
                        "account_id": 142554,
                        "reputation": 361,
                        "user_id": 350331,
                        "user_type": "registered",
                        "display_name": "Robert William Hanks"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 161,
                    "last_activity_date": 1640784658,
                    "last_edit_date": 1640784658,
                    "creation_date": 1276494580,
                    "answer_id": 3035188,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#3035188",
                    "body": "<p>Faster &amp; more memory-wise pure Python code:</p>\n<pre><code>def primes(n):\n    &quot;&quot;&quot; Returns  a list of primes &lt; n &quot;&quot;&quot;\n    sieve = [True] * n\n    for i in range(3,int(n**0.5)+1,2):\n        if sieve[i]:\n            sieve[i*i::2*i]=[False]*((n-i*i-1)//(2*i)+1)\n    return [2] + [i for i in range(3,n,2) if sieve[i]]\n</code></pre>\n<p>or starting with half sieve</p>\n<pre><code>def primes1(n):\n    &quot;&quot;&quot; Returns  a list of primes &lt; n &quot;&quot;&quot;\n    sieve = [True] * (n//2)\n    for i in range(3,int(n**0.5)+1,2):\n        if sieve[i//2]:\n            sieve[i*i//2::i] = [False] * ((n-i*i-1)//(2*i)+1)\n    return [2] + [2*i+1 for i in range(1,n//2) if sieve[i]]\n</code></pre>\n<p>Faster &amp; more memory-wise numpy code:</p>\n<pre><code>import numpy\ndef primesfrom3to(n):\n    &quot;&quot;&quot; Returns a array of primes, 3 &lt;= p &lt; n &quot;&quot;&quot;\n    sieve = numpy.ones(n//2, dtype=bool)\n    for i in range(3,int(n**0.5)+1,2):\n        if sieve[i//2]:\n            sieve[i*i//2::i] = False\n    return 2*numpy.nonzero(sieve)[0][1::]+1\n</code></pre>\n<p>a faster variation starting with a third of a sieve:</p>\n<pre><code>import numpy\ndef primesfrom2to(n):\n    &quot;&quot;&quot; Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n &quot;&quot;&quot;\n    sieve = numpy.ones(n//3 + (n%6==2), dtype=bool)\n    for i in range(1,int(n**0.5)//3+1):\n        if sieve[i]:\n            k=3*i+1|1\n            sieve[       k*k//3     ::2*k] = False\n            sieve[k*(k-2*(i&amp;1)+4)//3::2*k] = False\n    return numpy.r_[2,3,((3*numpy.nonzero(sieve)[0][1:]+1)|1)]\n</code></pre>\n<p>A (hard-to-code) pure-python version of the above code would be:</p>\n<pre><code>def primes2(n):\n    &quot;&quot;&quot; Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n &quot;&quot;&quot;\n    n, correction = n-n%6+6, 2-(n%6&gt;1)\n    sieve = [True] * (n//3)\n    for i in range(1,int(n**0.5)//3+1):\n      if sieve[i]:\n        k=3*i+1|1\n        sieve[      k*k//3      ::2*k] = [False] * ((n//6-k*k//6-1)//k+1)\n        sieve[k*(k-2*(i&amp;1)+4)//3::2*k] = [False] * ((n//6-k*(k-2*(i&amp;1)+4)//6-1)//k+1)\n    return [2,3] + [3*i+1|1 for i in range(1,n//3-correction) if sieve[i]]\n</code></pre>\n<p>Unfortunately pure-python don't adopt the simpler and faster numpy way of doing assignment, and calling <code>len()</code> inside the loop as in <code>[False]*len(sieve[((k*k)//3)::2*k])</code> is too slow. So I had to improvise to correct input (&amp; avoid more math) and do some extreme (&amp; painful) math-magic.</p>\n<p>Personally I think it is a shame that numpy (which is so widely used) is not part of Python standard library, and that the improvements in syntax and speed seem to be completely overlooked by Python developers.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1352581975,
                            "post_id": 3476592,
                            "comment_id": 18180375,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3476592#comment18180375_3476592",
                            "body": "for a postponed addition of primes into the dict (until the square of a prime is seen in the input) see <a href=\"http://stackoverflow.com/a/10733621/849891\">stackoverflow.com/a/10733621/849891</a> ."
                        }
                    ],
                    "owner": {
                        "account_id": 183854,
                        "reputation": 4141,
                        "user_id": 1016274,
                        "user_type": "registered",
                        "display_name": "user1016274"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1281701095,
                    "creation_date": 1281701095,
                    "answer_id": 3476592,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3476592#3476592",
                    "body": "<p>Sorry to bother but erat2() has a serious flaw in the algorithm.</p>\n\n<p>While searching for the next composite, we need to test odd numbers only.\nq,p both are odd; then q+p is even and doesn't need to be tested, but q+2*p is always odd. This eliminates the \"if even\" test in the while loop condition and saves about 30% of the runtime.</p>\n\n<p>While we're at it: instead of the elegant 'D.pop(q,None)' get and delete method use 'if q in D: p=D[q],del D[q]' which is twice as fast! At least on my machine (P3-1Ghz).\nSo I suggest this implementation of this clever algorithm:</p>\n\n<pre><code>def erat3( ):\n    from itertools import islice, count\n\n    # q is the running integer that's checked for primeness.\n    # yield 2 and no other even number thereafter\n    yield 2\n    D = {}\n    # no need to mark D[4] as we will test odd numbers only\n    for q in islice(count(3),0,None,2):\n        if q in D:                  #  is composite\n            p = D[q]\n            del D[q]\n            # q is composite. p=D[q] is the first prime that\n            # divides it. Since we've reached q, we no longer\n            # need it in the map, but we'll mark the next\n            # multiple of its witnesses to prepare for larger\n            # numbers.\n            x = q + p+p        # next odd(!) multiple\n            while x in D:      # skip composites\n                x += p+p\n            D[x] = p\n        else:                  # is prime\n            # q is a new prime.\n            # Yield it and mark its first multiple that isn't\n            # already marked in previous iterations.\n            D[q*q] = q\n            yield q\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1283565455,
                            "post_id": 3638617,
                            "comment_id": 3826399,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3638617#comment3826399_3638617",
                            "body": "<code>upto=10**6</code>: <code>primesfrom2to()</code> - 7 ms; <code>prime6()</code> - 12 ms <a href=\"http://ideone.com/oDg2Y\" rel=\"nofollow noreferrer\">ideone.com/oDg2Y</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 647320,
                        "reputation": 41,
                        "user_id": 439236,
                        "user_type": "unregistered",
                        "display_name": "nolfonzo"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1283539022,
                    "creation_date": 1283539022,
                    "answer_id": 3638617,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3638617#3638617",
                    "body": "<p>A slightly different implementation of a half sieve using Numpy:</p>\n\n<p><a href=\"http://rebrained.com/?p=458\" rel=\"nofollow noreferrer\">http://rebrained.com/?p=458</a></p>\n\n<pre>\nimport math\nimport numpy\ndef prime6(upto):\n    primes=numpy.arange(3,upto+1,2)\n    isprime=numpy.ones((upto-1)/2,dtype=bool)\n    for factor in primes[:int(math.sqrt(upto))]:\n        if isprime[(factor-2)/2]: isprime[(factor*3-2)/2:(upto-1)/2:factor]=0\n    return numpy.insert(primes[isprime],0,2)\n</pre>\n\n<p>Can someone compare this with the other timings?  On my machine it seems pretty comparable to the other Numpy half-sieve.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 4551,
                        "reputation": 94733,
                        "user_id": 6899,
                        "user_type": "registered",
                        "accept_rate": 84,
                        "display_name": "tzot"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1285470455,
                    "last_edit_date": 1495541430,
                    "creation_date": 1285470455,
                    "answer_id": 3796455,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3796455#3796455",
                    "body": "<p>The fastest method I've tried so far is based on the <a href=\"http://oreilly.com/pub/a/python/excerpt/pythonckbk_chap1/index1.html?page=last\" rel=\"nofollow noreferrer\">Python cookbook <code>erat2</code></a> function:</p>\n\n<pre><code>import itertools as it\ndef erat2a( ):\n    D = {  }\n    yield 2\n    for q in it.islice(it.count(3), 0, None, 2):\n        p = D.pop(q, None)\n        if p is None:\n            D[q*q] = q\n            yield q\n        else:\n            x = q + 2*p\n            while x in D:\n                x += 2*p\n            D[x] = p\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/2211990/how-to-implement-an-efficient-infinite-generator-of-prime-numbers-in-python/3796442#3796442\">this</a> answer for an explanation of the speeding-up.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 2389551,
                        "reputation": 41586,
                        "user_id": 2089675,
                        "user_type": "registered",
                        "accept_rate": 80,
                        "display_name": "smac89"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1361401975,
                    "last_edit_date": 1361401975,
                    "creation_date": 1361333182,
                    "answer_id": 14972126,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/14972126#14972126",
                    "body": "<p>First time using python, so some of the methods I use in this might seem a bit cumbersome. I just straight converted my c++ code to python and this is what I have (albeit a tad bit slowww in python)</p>\n\n<pre><code>#!/usr/bin/env python\nimport time\n\ndef GetPrimes(n):\n\n    Sieve = [1 for x in xrange(n)]\n\n    Done = False\n    w = 3\n\n    while not Done:\n\n        for q in xrange (3, n, 2):\n            Prod = w*q\n            if Prod &lt; n:\n                Sieve[Prod] = 0\n            else:\n                break\n\n        if w &gt; (n/2):\n            Done = True\n        w += 2\n\n    return Sieve\n\n\n\nstart = time.clock()\n\nd = 10000000\nPrimes = GetPrimes(d)\n\ncount = 1 #This is for 2\n\nfor x in xrange (3, d, 2):\n    if Primes[x]:\n        count+=1\n\nelapsed = (time.clock() - start)\nprint \"\\nFound\", count, \"primes in\", elapsed, \"seconds!\\n\"\n</code></pre>\n\n<blockquote>\n  <p>pythonw Primes.py</p>\n  \n  <p>Found 664579 primes in 12.799119 seconds!</p>\n</blockquote>\n\n<pre><code>#!/usr/bin/env python\nimport time\n\ndef GetPrimes2(n):\n\n    Sieve = [1 for x in xrange(n)]\n\n    for q in xrange (3, n, 2):\n        k = q\n        for y in xrange(k*3, n, k*2):\n            Sieve[y] = 0\n\n    return Sieve\n\n\n\nstart = time.clock()\n\nd = 10000000\nPrimes = GetPrimes2(d)\n\ncount = 1 #This is for 2\n\nfor x in xrange (3, d, 2):\n    if Primes[x]:\n        count+=1\n\nelapsed = (time.clock() - start)\nprint \"\\nFound\", count, \"primes in\", elapsed, \"seconds!\\n\"\n</code></pre>\n\n<blockquote>\n  <p>pythonw Primes2.py</p>\n  \n  <p>Found 664579 primes in 10.230172 seconds!</p>\n</blockquote>\n\n<pre><code>#!/usr/bin/env python\nimport time\n\ndef GetPrimes3(n):\n\n    Sieve = [1 for x in xrange(n)]\n\n    for q in xrange (3, n, 2):\n        k = q\n        for y in xrange(k*k, n, k &lt;&lt; 1):\n            Sieve[y] = 0\n\n    return Sieve\n\n\n\nstart = time.clock()\n\nd = 10000000\nPrimes = GetPrimes3(d)\n\ncount = 1 #This is for 2\n\nfor x in xrange (3, d, 2):\n    if Primes[x]:\n        count+=1\n\nelapsed = (time.clock() - start)\nprint \"\\nFound\", count, \"primes in\", elapsed, \"seconds!\\n\"\n</code></pre>\n\n<blockquote>\n  <p>python Primes2.py</p>\n  \n  <p>Found 664579 primes in 7.113776 seconds!</p>\n</blockquote>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1366183932,
                            "post_id": 16004075,
                            "comment_id": 22909293,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/16004075#comment22909293_16004075",
                            "body": "posting one timing for an unknown machine says nothing. The accepted answer here says &quot;without psyco, for n=1000000, rwh_primes2 was the fastest&quot;. So if you&#39;d provide your timings for that code as well as yours, on the same machine, and at 2, 4, 10 mln as well, <i>then</i> it&#39;d be much more informative."
                        },
                        {
                            "owner": {
                                "account_id": 263802,
                                "reputation": 3497,
                                "user_id": 549617,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "GordonBGood"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1376930796,
                            "post_id": 16004075,
                            "comment_id": 26883644,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/16004075#comment26883644_16004075",
                            "body": "-1, This code depends on special features of the bitarray implemented in C, which is why the code is fast as most of the work is being done in native code in the slice assignment. The bitarray package <b>BREAKS</b> the standard definition for proper slices (indexed over a range) for mutable sequences in that it allows assigning a single boolean 0/1 or True/False to all elements of the slice, whereas the standard behavior for pure Python seems to be to not allow this and only allow the assignment value of 0 in which case it is treated as a del of all of the slice elements from the sequence/array."
                        },
                        {
                            "owner": {
                                "account_id": 263802,
                                "reputation": 3497,
                                "user_id": 549617,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "GordonBGood"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1376934858,
                            "post_id": 16004075,
                            "comment_id": 26885610,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/16004075#comment26885610_16004075",
                            "body": "cont&#39;d:  If calling non-standard native code were to be compared, we may as well write a &quot;fastprimes&quot; sequence generator package based on C code such as that of <a href=\"https://code.google.com/p/primesieve/\" rel=\"nofollow noreferrer\">Kim Walisch&#39;s primesieve</a> and generate all the primes in the four billion plus 32-bit number range in just a few seconds with a single call to the sequence generator.  This would also use almost no memory as the linked code is based on a segmented Sieve of Eratosthenes and thus only uses a few ten&#39;s of Kilobytes of RAM, and if a sequence were generated there would be no list storage required."
                        }
                    ],
                    "owner": {
                        "account_id": 317442,
                        "reputation": 7181,
                        "user_id": 634135,
                        "user_type": "registered",
                        "accept_rate": 61,
                        "display_name": "cobie"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1369047379,
                    "last_edit_date": 1369047379,
                    "creation_date": 1365971832,
                    "answer_id": 16004075,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/16004075#16004075",
                    "body": "<p>I may be late to the party but will have to add my own code for this. It uses approximately n/2 in space because we don't need to store even numbers and I also make use of the bitarray python module, further draStically cutting down on memory consumption and enabling computing all primes up to 1,000,000,000</p>\n\n<pre><code>from bitarray import bitarray\ndef primes_to(n):\n    size = n//2\n    sieve = bitarray(size)\n    sieve.setall(1)\n    limit = int(n**0.5)\n    for i in range(1,limit):\n        if sieve[i]:\n            val = 2*i+1\n            sieve[(i+i*val)::val] = 0\n    return [2] + [2*i+1 for i, v in enumerate(sieve) if v and i &gt; 0]\n\npython -m timeit -n10 -s \"import euler\" \"euler.primes_to(1000000000)\"\n10 loops, best of 3: 46.5 sec per loop\n</code></pre>\n\n<p>This was run on a 64bit 2.4GHZ MAC OSX 10.8.3</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1457007532,
                            "post_id": 18944432,
                            "comment_id": 59215245,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/18944432#comment59215245_18944432",
                            "body": "to visualize your test results, plot them on log-log scale, to <i>see</i> and compare the <a href=\"https://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth\" rel=\"nofollow noreferrer\">empirical orders of growth</a>."
                        },
                        {
                            "owner": {
                                "account_id": 3302287,
                                "reputation": 610,
                                "user_id": 2804068,
                                "user_type": "registered",
                                "display_name": "ABri"
                            },
                            "reply_to_user": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1457813046,
                            "post_id": 18944432,
                            "comment_id": 59580227,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/18944432#comment59580227_18944432",
                            "body": "@ Will thanks for the input, i&#39;ll have this in mind the next time i need such comparison"
                        }
                    ],
                    "owner": {
                        "account_id": 3302287,
                        "reputation": 610,
                        "user_id": 2804068,
                        "user_type": "registered",
                        "display_name": "ABri"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1380094403,
                    "last_edit_date": 1380094403,
                    "creation_date": 1379856958,
                    "answer_id": 18944432,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/18944432#18944432",
                    "body": "<p>I know the competition is closed for some years. \u2026</p>\n\n<p>Nonetheless this is my suggestion for a pure python prime sieve, based on omitting the multiples of 2, 3 and 5 by using appropriate steps while processing the sieve forward. Nonetheless it is actually slower for N&lt;10^9 than @Robert William Hanks superior solutions rwh_primes2 and rwh_primes1. By using a ctypes.c_ushort sieve array above 1.5* 10^8 it is somehow adaptive to memory limits.</p>\n\n<p>10^6</p>\n\n<p>$ python -mtimeit -s\"import primeSieveSpeedComp\" \"primeSieveSpeedComp.primeSieveSeq(1000000)\"\n10 loops, best of 3: 46.7 msec per loop</p>\n\n<blockquote>\n  <p>to compare:$ python -mtimeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes1(1000000)\" 10 loops, best of 3: 43.2\n  msec per loop\n  to compare: $ python -m timeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes2(1000000)\" 10 loops, best of 3: 34.5\n  msec per loop</p>\n</blockquote>\n\n<p>10^7</p>\n\n<p>$ python -mtimeit -s\"import primeSieveSpeedComp\" \"primeSieveSpeedComp.primeSieveSeq(10000000)\"\n10 loops, best of 3: 530 msec per loop</p>\n\n<blockquote>\n  <p>to compare:$ python -mtimeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes1(10000000)\" 10 loops, best of 3: 494\n  msec per loop\n  to compare: $ python -m timeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes2(10000000)\" 10 loops, best of 3: 375\n  msec per loop</p>\n</blockquote>\n\n<p>10^8</p>\n\n<p>$ python -mtimeit -s\"import primeSieveSpeedComp\" \"primeSieveSpeedComp.primeSieveSeq(100000000)\"\n10 loops, best of 3: 5.55 sec per loop</p>\n\n<blockquote>\n  <p>to compare: $ python -mtimeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes1(100000000)\" 10 loops, best of 3: 5.33\n  sec per loop\n  to compare: $ python -m timeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes2(100000000)\" 10 loops, best of 3: 3.95\n  sec per loop</p>\n</blockquote>\n\n<p>10^9</p>\n\n<p>$ python -mtimeit -s\"import primeSieveSpeedComp\" \"primeSieveSpeedComp.primeSieveSeq(1000000000)\"\n10 loops, best of 3: <strong>61.2</strong> sec per loop</p>\n\n<blockquote>\n  <p>to compare: $ python -mtimeit -n 3 -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes1(1000000000)\" 3 loops, best of 3: <strong>97.8</strong>\n  sec per loop</p>\n  \n  <p>to compare: $ python -m timeit -s\"import primeSieveSpeedComp\"\n  \"primeSieveSpeedComp.rwh_primes2(1000000000)\" 10 loops, best of 3:\n  41.9 sec per loop</p>\n</blockquote>\n\n<p>You may copy the code below into ubuntus primeSieveSpeedComp to review this tests.</p>\n\n<pre><code>def primeSieveSeq(MAX_Int):\n    if MAX_Int &gt; 5*10**8:\n        import ctypes\n        int16Array = ctypes.c_ushort * (MAX_Int &gt;&gt; 1)\n        sieve = int16Array()\n        #print 'uses ctypes \"unsigned short int Array\"'\n    else:\n        sieve = (MAX_Int &gt;&gt; 1) * [False]\n        #print 'uses python list() of long long int'\n    if MAX_Int &lt; 10**8:\n        sieve[4::3] = [True]*((MAX_Int - 8)/6+1)\n        sieve[12::5] = [True]*((MAX_Int - 24)/10+1)\n    r = [2, 3, 5]\n    n = 0\n    for i in xrange(int(MAX_Int**0.5)/30+1):\n        n += 3\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 2\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 1\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 2\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 1\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 2\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 3\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n        n += 1\n        if not sieve[n]:\n            n2 = (n &lt;&lt; 1) + 1\n            r.append(n2)\n            n2q = (n2**2) &gt;&gt; 1\n            sieve[n2q::n2] = [True]*(((MAX_Int &gt;&gt; 1) - n2q - 1) / n2 + 1)\n    if MAX_Int &lt; 10**8:\n        return [2, 3, 5]+[(p &lt;&lt; 1) + 1 for p in [n for n in xrange(3, MAX_Int &gt;&gt; 1) if not sieve[n]]]\n    n = n &gt;&gt; 1\n    try:\n        for i in xrange((MAX_Int-2*n)/30 + 1):\n            n += 3\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 2\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 1\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 2\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 1\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 2\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 3\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n            n += 1\n            if not sieve[n]:\n                r.append((n &lt;&lt; 1) + 1)\n    except:\n        pass\n    return r\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 3951560,
                        "reputation": 11,
                        "user_id": 3261711,
                        "user_type": "registered",
                        "display_name": "user3261711"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": -1,
                    "last_activity_date": 1391301684,
                    "creation_date": 1391301684,
                    "answer_id": 21505621,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/21505621#21505621",
                    "body": "<p>This is an elegant and simpler solution to find primes using a stored list. Starts with a 4 variables, you only have to test odd primes for divisors, and you only have to test up to a half of what number you are testing as a prime (no point in testing whether 9, 11, 13 divide into 17). It tests previously stored primes as divisors.`</p>\n\n<pre><code>    # Program to calculate Primes\n primes = [1,3,5,7]\nfor n in range(9,100000,2):\n    for x in range(1,(len(primes)/2)):\n        if n % primes[x] == 0:\n            break\n    else:\n        primes.append(n)\nprint primes\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1947029,
                        "reputation": 2632,
                        "user_id": 1751920,
                        "user_type": "registered",
                        "display_name": "Stefan Gruenwald"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1414964367,
                    "creation_date": 1414964367,
                    "answer_id": 26704740,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/26704740#26704740",
                    "body": "<p>I collected several prime number sieves over time. The fastest on my computer is this:</p>\n\n<pre><code>from time import time\n# 175 ms for all the primes up to the value 10**6\ndef primes_sieve(limit):\n    a = [True] * limit\n    a[0] = a[1] = False\n    #a[2] = True\n    for n in xrange(4, limit, 2):\n        a[n] = False\n    root_limit = int(limit**.5)+1\n    for i in xrange(3,root_limit):\n        if a[i]:\n            for n in xrange(i*i, limit, 2*i):\n                a[n] = False\n    return a\n\nLIMIT = 10**6\ns=time()\nprimes = primes_sieve(LIMIT)\nprint time()-s\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 5352941,
                        "reputation": 1411,
                        "user_id": 4266559,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "lavee_singh"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": -4,
                    "last_activity_date": 1437225547,
                    "last_edit_date": 1437225547,
                    "creation_date": 1423846513,
                    "answer_id": 28504698,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28504698#28504698",
                    "body": "<p>This is the way you can compare with others.</p>\n\n<pre><code># You have to list primes upto n\nnums = xrange(2, n)\nfor i in range(2, 10):\n    nums = filter(lambda s: s==i or s%i, nums)\nprint nums\n</code></pre>\n\n<p>So simple...</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1423947972,
                            "post_id": 28517084,
                            "comment_id": 45357387,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment45357387_28517084",
                            "body": "it is incorrect e.g., <code>ajs_primes3a(10)</code> -&gt; <code>array([2, 3, 5, 7, 9])</code>. <code>9</code> is not a prime"
                        },
                        {
                            "owner": {
                                "account_id": 510095,
                                "reputation": 121,
                                "user_id": 2065097,
                                "user_type": "registered",
                                "display_name": "James Salmoni"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1424038460,
                            "post_id": 28517084,
                            "comment_id": 45378579,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment45378579_28517084",
                            "body": "You spotted an edge case I hadn&#39;t \u2013 well done! The problem was in &#39;for idx in range(3, int(upto ** 0.5), 2):&#39; which should be &#39;for idx in range(3, int(upto ** 0.5) + 1, 2):&#39;. Thanks but it works now."
                        },
                        {
                            "owner": {
                                "account_id": 510095,
                                "reputation": 121,
                                "user_id": 2065097,
                                "user_type": "registered",
                                "display_name": "James Salmoni"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1424038727,
                            "post_id": 28517084,
                            "comment_id": 45378670,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment45378670_28517084",
                            "body": "The reason was that the idx loop went up to &#39;upto ** 05&#39; which for cases up to and including 15. From 16 onwards, it works fine. This was a set of edge cases I hadn&#39;t tested for. Adding 1 means it should work for all numbers."
                        },
                        {
                            "owner": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1424044411,
                            "post_id": 28517084,
                            "comment_id": 45380201,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment45380201_28517084",
                            "body": "It seems to work now. It is the slowest among <code>numpy</code>-based solutions that return an array. Note: no true Sieve of Eratosthenes implementation uses modulo -- no need to mention it. You could use <code>mat[idx*idx::idx]</code> instead of <code>mat[idx*2::idx]</code>. And <code>np.nonzero(mat)[0]</code> instead of <code>np.where(mat == True)[0]</code>."
                        },
                        {
                            "owner": {
                                "account_id": 510095,
                                "reputation": 121,
                                "user_id": 2065097,
                                "user_type": "registered",
                                "display_name": "James Salmoni"
                            },
                            "reply_to_user": {
                                "account_id": 3021,
                                "reputation": 408304,
                                "user_id": 4279,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "jfs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1424102048,
                            "post_id": 28517084,
                            "comment_id": 45403722,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment45403722_28517084",
                            "body": "Thanks JF. I tested against prime6() and got a result faster up to (IIRC) about 250k when prime6() took over. primesfrom2to() was faster. At up to 20m, ajs_primes3a() took 0.034744977951ms, prime6() took 0.0222899913788ms  and primesfrom2to() took 0.0104751586914ms (same machine, same load, best of 10 timings). It&#39;s honestly better than I thought it would be!"
                        },
                        {
                            "owner": {
                                "account_id": 2769539,
                                "reputation": 100,
                                "user_id": 2384405,
                                "user_type": "registered",
                                "display_name": "mndrake"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1451709679,
                            "post_id": 28517084,
                            "comment_id": 56869005,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#comment56869005_28517084",
                            "body": "It would be faster if <code>mat[idx*2::idx] = False</code> was checked if needed. <code>if mat[idx]: mat[idx*2::idx] = False</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 510095,
                        "reputation": 121,
                        "user_id": 2065097,
                        "user_type": "registered",
                        "display_name": "James Salmoni"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1424038574,
                    "last_edit_date": 1424038574,
                    "creation_date": 1423927504,
                    "answer_id": 28517084,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/28517084#28517084",
                    "body": "<p>I'm slow responding to this question but it seemed like a fun exercise. I'm using numpy which might be cheating and I doubt this method is the fastest but it should be clear. It sieves a Boolean array referring to its indices only and elicits prime numbers from the indices of all True values. No modulo needed.</p>\n\n<pre><code>import numpy as np\ndef ajs_primes3a(upto):\n    mat = np.ones((upto), dtype=bool)\n    mat[0] = False\n    mat[1] = False\n    mat[4::2] = False\n    for idx in range(3, int(upto ** 0.5)+1, 2):\n        mat[idx*2::idx] = False\n    return np.where(mat == True)[0]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3903232,
                                "reputation": 1007,
                                "user_id": 3230492,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "lukejanicke"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1596568528,
                            "post_id": 31221522,
                            "comment_id": 111851617,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31221522#comment111851617_31221522",
                            "body": "I notice this prints the whole list, whereas from the <i>community wiki</i> answer <code>primesfrom2to(10000)</code> returns <code>[   2    3    5 ... 9949 9967 9973]</code>. Is that shortening a NumPy <code>nd.array</code> thing?"
                        },
                        {
                            "owner": {
                                "account_id": 222412,
                                "reputation": 57009,
                                "user_id": 480982,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Thomas Weller"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1714072632,
                            "post_id": 31221522,
                            "comment_id": 138193412,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31221522#comment138193412_31221522",
                            "body": "10^6 takes 0.3s, 10^7 takes 3.6s, 10^8 takes 37s (on my machine; Thinkpad P15). That&#39;s considerably slower than the numpy version, which runs in 0.4s for 10^8."
                        }
                    ],
                    "owner": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 15,
                    "last_activity_date": 1437383165,
                    "last_edit_date": 1437383165,
                    "creation_date": 1436018809,
                    "answer_id": 31221522,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31221522#31221522",
                    "body": "<p>If you don't want to reinvent the wheel, you can install the symbolic maths library <a href=\"http://www.sympy.org/en/index.html\" rel=\"noreferrer\">sympy</a> (yes it's Python 3 compatible)</p>\n\n<pre><code>pip install sympy\n</code></pre>\n\n<p>And use the <a href=\"http://docs.sympy.org/dev/modules/ntheory.html#sympy.ntheory.generate.Sieve.primerange\" rel=\"noreferrer\">primerange</a> function</p>\n\n<pre><code>from sympy import sieve\nprimes = list(sieve.primerange(1, 10**6))\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2811537,
                                "reputation": 3074,
                                "user_id": 2809008,
                                "user_type": "registered",
                                "display_name": "ljetibo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1436858680,
                            "post_id": 31322423,
                            "comment_id": 50775057,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31322423#comment50775057_31322423",
                            "body": "It&#39;s not exactly what OP ordered but I fail to see why the downvote. It&#39;s a 2.8sec solution unlike some other outside modules. I&#39;ve noticed in the source that it&#39;s threaded, got any tests on how well it scales?"
                        },
                        {
                            "owner": {
                                "account_id": 107038,
                                "reputation": 135374,
                                "user_id": 284795,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "Colonel Panic"
                            },
                            "reply_to_user": {
                                "account_id": 2811537,
                                "reputation": 3074,
                                "user_id": 2809008,
                                "user_type": "registered",
                                "display_name": "ljetibo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1436861957,
                            "post_id": 31322423,
                            "comment_id": 50776933,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31322423#comment50776933_31322423",
                            "body": "@ljetibo cheers. The bottleneck seems to be copying C++ vector to Python list, thus the <code>count_primes</code> function is much faster than <code>generate_primes</code>"
                        },
                        {
                            "owner": {
                                "account_id": 107038,
                                "reputation": 135374,
                                "user_id": 284795,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "Colonel Panic"
                            },
                            "reply_to_user": {
                                "account_id": 2811537,
                                "reputation": 3074,
                                "user_id": 2809008,
                                "user_type": "registered",
                                "display_name": "ljetibo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1436862607,
                            "post_id": 31322423,
                            "comment_id": 50777341,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31322423#comment50777341_31322423",
                            "body": "On my computer it can comfortably generate primes up to 1e8 (it gives MemoryError for 1e9) , and count primes up to 1e10. @HappyLeapSecond above compares algorithms for 1e6"
                        }
                    ],
                    "owner": {
                        "account_id": 107038,
                        "reputation": 135374,
                        "user_id": 284795,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "Colonel Panic"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1437383206,
                    "last_edit_date": 1437383206,
                    "creation_date": 1436457007,
                    "answer_id": 31322423,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/31322423#31322423",
                    "body": "<p>It's instructive to write your own prime finding code, but it's also useful to have a fast reliable library at hand. I wrote a wrapper around the <a href=\"http://primesieve.org/\" rel=\"noreferrer\">C++ library primesieve</a>, named it <a href=\"https://github.com/hickford/primesieve-python\" rel=\"noreferrer\">primesieve-python</a></p>\n\n<p>Try it <code>pip install primesieve</code></p>\n\n<pre><code>import primesieve\nprimes = primesieve.generate_primes(10**8)\n</code></pre>\n\n<p>I'd be curious to see the speed compared.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 4865069,
                        "reputation": 163,
                        "user_id": 5439078,
                        "user_type": "registered",
                        "display_name": "Jason"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 11,
                    "last_activity_date": 1456676054,
                    "last_edit_date": 1456676054,
                    "creation_date": 1445896271,
                    "answer_id": 33356284,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/33356284#33356284",
                    "body": "<p>If you accept itertools but not numpy, here is an adaptation of rwh_primes2 for Python 3 that runs about twice as fast on my machine.  The only substantial change is using a bytearray instead of a list for the boolean, and using compress instead of a list comprehension to build the final list.  (I'd add this as a comment like moarningsun if I were able.)</p>\n\n<pre><code>import itertools\nizip = itertools.zip_longest\nchain = itertools.chain.from_iterable\ncompress = itertools.compress\ndef rwh_primes2_python3(n):\n    \"\"\" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n \"\"\"\n    zero = bytearray([False])\n    size = n//3 + (n % 6 == 2)\n    sieve = bytearray([True]) * size\n    sieve[0] = False\n    for i in range(int(n**0.5)//3+1):\n      if sieve[i]:\n        k=3*i+1|1\n        start = (k*k+4*k-2*k*(i&amp;1))//3\n        sieve[(k*k)//3::2*k]=zero*((size - (k*k)//3 - 1) // (2 * k) + 1)\n        sieve[  start ::2*k]=zero*((size -   start  - 1) // (2 * k) + 1)\n    ans = [2,3]\n    poss = chain(izip(*[range(i, n, 6) for i in (1,5)]))\n    ans.extend(compress(poss, sieve))\n    return ans\n</code></pre>\n\n<p>Comparisons:</p>\n\n<pre><code>&gt;&gt;&gt; timeit.timeit('primes.rwh_primes2(10**6)', setup='import primes', number=1)\n0.0652179726976101\n&gt;&gt;&gt; timeit.timeit('primes.rwh_primes2_python3(10**6)', setup='import primes', number=1)\n0.03267321276325674\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&gt;&gt;&gt; timeit.timeit('primes.rwh_primes2(10**8)', setup='import primes', number=1)\n6.394284538007014\n&gt;&gt;&gt; timeit.timeit('primes.rwh_primes2_python3(10**8)', setup='import primes', number=1)\n3.833829450302801\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 9035625,
                        "reputation": 129,
                        "user_id": 6731733,
                        "user_type": "registered",
                        "display_name": "lifolofi"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1475703414,
                    "last_edit_date": 1475703414,
                    "creation_date": 1475686089,
                    "answer_id": 39879618,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/39879618#39879618",
                    "body": "<p>It's all written and tested. So there is no need to reinvent the wheel.</p>\n\n<pre><code>python -m timeit -r10 -s\"from sympy import sieve\" \"primes = list(sieve.primerange(1, 10**6))\"\n</code></pre>\n\n<p>gives us a record breaking <strong>12.2 msec</strong>!</p>\n\n<pre><code>10 loops, best of 10: 12.2 msec per loop\n</code></pre>\n\n<p>If this is not fast enough, you can try PyPy:</p>\n\n<pre><code>pypy -m timeit -r10 -s\"from sympy import sieve\" \"primes = list(sieve.primerange(1, 10**6))\"\n</code></pre>\n\n<p>which results in:</p>\n\n<pre><code>10 loops, best of 10: 2.03 msec per loop\n</code></pre>\n\n<p>The answer with 247 up-votes lists 15.9 ms for the best solution.\nCompare this!!!</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1566812156,
                            "post_id": 40101683,
                            "comment_id": 101760423,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/40101683#comment101760423_40101683",
                            "body": "to compare <a href=\"https://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth\" rel=\"nofollow noreferrer\">algorithmic performances</a>, it&#39;s better to plot at a <a href=\"https://en.wikipedia.org/wiki/Log%E2%80%93log_plot\" rel=\"nofollow noreferrer\">log-log scale</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 2293512,
                        "reputation": 1084,
                        "user_id": 2015612,
                        "user_type": "registered",
                        "display_name": "Bruno Adel&#233;"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1476774358,
                    "last_edit_date": 1495541430,
                    "creation_date": 1476774358,
                    "answer_id": 40101683,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/40101683#40101683",
                    "body": "<p>I tested  some <a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n?answertab=active#tab-top\">unutbu's functions</a>, i computed it with hungred millions number</p>\n\n<p>The winners are the functions that use numpy library, </p>\n\n<p><strong>Note</strong>: It would also interesting make a memory utilization test :)</p>\n\n<p><a href=\"https://i.stack.imgur.com/LYfjc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LYfjc.png\" alt=\"Computation time result\"></a></p>\n\n<p><strong>Sample code</strong></p>\n\n<p><a href=\"https://github.com/badele/prime-number\" rel=\"nofollow noreferrer\">Complete code on my github repository</a></p>\n\n<pre><code>#!/usr/bin/env python\n\nimport lib\nimport timeit\nimport sys\nimport math\nimport datetime\n\nimport prettyplotlib as ppl\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nfrom prettyplotlib import brewer2mpl\n\nprimenumbers_gen = [\n    'sieveOfEratosthenes',\n    'ambi_sieve',\n    'ambi_sieve_plain',\n    'sundaram3',\n    'sieve_wheel_30',\n    'primesfrom3to',\n    'primesfrom2to',\n    'rwh_primes',\n    'rwh_primes1',\n    'rwh_primes2',\n]\n\ndef human_format(num):\n    # https://stackoverflow.com/questions/579310/formatting-long-numbers-as-strings-in-python?answertab=active#tab-top\n    magnitude = 0\n    while abs(num) &gt;= 1000:\n        magnitude += 1\n        num /= 1000.0\n    # add more suffixes if you need them\n    return '%.2f%s' % (num, ['', 'K', 'M', 'G', 'T', 'P'][magnitude])\n\n\nif __name__=='__main__':\n\n    # Vars\n    n = 10000000 # number itereration generator\n    nbcol = 5 # For decompose prime number generator\n    nb_benchloop = 3 # Eliminate false positive value during the test (bench average time)\n    datetimeformat = '%Y-%m-%d %H:%M:%S.%f'\n    config = 'from __main__ import n; import lib'\n    primenumbers_gen = {\n        'sieveOfEratosthenes': {'color': 'b'},\n        'ambi_sieve': {'color': 'b'},\n        'ambi_sieve_plain': {'color': 'b'},\n         'sundaram3': {'color': 'b'},\n        'sieve_wheel_30': {'color': 'b'},\n# # #        'primesfrom2to': {'color': 'b'},\n        'primesfrom3to': {'color': 'b'},\n        # 'rwh_primes': {'color': 'b'},\n        # 'rwh_primes1': {'color': 'b'},\n        'rwh_primes2': {'color': 'b'},\n    }\n\n\n    # Get n in command line\n    if len(sys.argv)&gt;1:\n        n = int(sys.argv[1])\n\n    step = int(math.ceil(n / float(nbcol)))\n    nbs = np.array([i * step for i in range(1, int(nbcol) + 1)])\n    set2 = brewer2mpl.get_map('Paired', 'qualitative', 12).mpl_colors\n\n    print datetime.datetime.now().strftime(datetimeformat)\n    print(\"Compute prime number to %(n)s\" % locals())\n    print(\"\")\n\n    results = dict()\n    for pgen in primenumbers_gen:\n        results[pgen] = dict()\n        benchtimes = list()\n        for n in nbs:\n            t = timeit.Timer(\"lib.%(pgen)s(n)\" % locals(), setup=config)\n            execute_times = t.repeat(repeat=nb_benchloop,number=1)\n            benchtime = np.mean(execute_times)\n            benchtimes.append(benchtime)\n        results[pgen] = {'benchtimes':np.array(benchtimes)}\n\nfig, ax = plt.subplots(1)\nplt.ylabel('Computation time (in second)')\nplt.xlabel('Numbers computed')\ni = 0\nfor pgen in primenumbers_gen:\n\n    bench = results[pgen]['benchtimes']\n    avgs = np.divide(bench,nbs)\n    avg = np.average(bench, weights=nbs)\n\n    # Compute linear regression\n    A = np.vstack([nbs, np.ones(len(nbs))]).T\n    a, b = np.linalg.lstsq(A, nbs*avgs)[0]\n\n    # Plot\n    i += 1\n    #label=\"%(pgen)s\" % locals()\n    #ppl.plot(nbs, nbs*avgs, label=label, lw=1, linestyle='--', color=set2[i % 12])\n    label=\"%(pgen)s avg\" % locals()\n    ppl.plot(nbs, a * nbs + b, label=label, lw=2, color=set2[i % 12])\nprint datetime.datetime.now().strftime(datetimeformat)\n\nppl.legend(ax, loc='upper left', ncol=4)\n\n# Change x axis label\nax.get_xaxis().get_major_formatter().set_scientific(False)\nfig.canvas.draw()\nlabels = [human_format(int(item.get_text())) for item in ax.get_xticklabels()]\n\nax.set_xticklabels(labels)\nax = plt.gca()\n\nplt.show()\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 6503350,
                        "reputation": 5419,
                        "user_id": 5033247,
                        "user_type": "registered",
                        "display_name": "Smart Manoj"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1500465817,
                    "creation_date": 1500465817,
                    "answer_id": 45189992,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/45189992#45189992",
                    "body": "<p>For Python 3</p>\n\n<pre><code>def rwh_primes2(n):\n    correction = (n%6&gt;1)\n    n = {0:n,1:n-1,2:n+4,3:n+3,4:n+2,5:n+1}[n%6]\n    sieve = [True] * (n//3)\n    sieve[0] = False\n    for i in range(int(n**0.5)//3+1):\n      if sieve[i]:\n        k=3*i+1|1\n        sieve[      ((k*k)//3)      ::2*k]=[False]*((n//6-(k*k)//6-1)//k+1)\n        sieve[(k*k+4*k-2*k*(i&amp;1))//3::2*k]=[False]*((n//6-(k*k+4*k-2*k*(i&amp;1))//6-1)//k+1)\n    return [2,3] + [3*i+1|1 for i in range(1,n//3-correction) if sieve[i]]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 8324652,
                                "reputation": 121,
                                "user_id": 7799269,
                                "user_type": "registered",
                                "display_name": "it&#39;s a hire car baby"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1536700815,
                            "post_id": 46635266,
                            "comment_id": 91516936,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/46635266#comment91516936_46635266",
                            "body": "In Python 3 I used this function <a href=\"https://stackoverflow.com/a/3035188/7799269\">stackoverflow.com/a/3035188/7799269</a> but replaced / with // and xrange with range and they seemed much faster than this."
                        }
                    ],
                    "owner": {
                        "account_id": 11880916,
                        "reputation": 411,
                        "user_id": 8694657,
                        "user_type": "registered",
                        "display_name": "Bruno Astrolino"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1507500263,
                    "last_edit_date": 1507500263,
                    "creation_date": 1507491339,
                    "answer_id": 46635266,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/46635266#46635266",
                    "body": "<p>Here is two updated (pure Python 3.6) versions of one of the fastest functions,</p>\n\n<pre><code>from itertools import compress\n\ndef rwh_primes1v1(n):\n    \"\"\" Returns  a list of primes &lt; n for n &gt; 2 \"\"\"\n    sieve = bytearray([True]) * (n//2)\n    for i in range(3,int(n**0.5)+1,2):\n        if sieve[i//2]:\n            sieve[i*i//2::i] = bytearray((n-i*i-1)//(2*i)+1)\n    return [2,*compress(range(3,n,2), sieve[1:])]\n\ndef rwh_primes1v2(n):\n    \"\"\" Returns a list of primes &lt; n for n &gt; 2 \"\"\"\n    sieve = bytearray([True]) * (n//2+1)\n    for i in range(1,int(n**0.5)//2+1):\n        if sieve[i]:\n            sieve[2*i*(i+1)::2*i+1] = bytearray((n//2-2*i*(i+1))//(2*i+1)+1)\n    return [2,*compress(range(3,n,2), sieve[1:])]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 6183436,
                                "reputation": 2093,
                                "user_id": 4818212,
                                "user_type": "registered",
                                "display_name": "AcK"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1623356798,
                            "post_id": 48645005,
                            "comment_id": 120064139,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/48645005#comment120064139_48645005",
                            "body": "Link to example is dead."
                        },
                        {
                            "owner": {
                                "account_id": 2054371,
                                "reputation": 7694,
                                "user_id": 1832566,
                                "user_type": "registered",
                                "accept_rate": 24,
                                "display_name": "Alexander"
                            },
                            "reply_to_user": {
                                "account_id": 6183436,
                                "reputation": 2093,
                                "user_id": 4818212,
                                "user_type": "registered",
                                "display_name": "AcK"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1623427197,
                            "post_id": 48645005,
                            "comment_id": 120084911,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/48645005#comment120084911_48645005",
                            "body": "Thanks, I&#39;ve removed the link."
                        }
                    ],
                    "owner": {
                        "account_id": 2054371,
                        "reputation": 7694,
                        "user_id": 1832566,
                        "user_type": "registered",
                        "accept_rate": 24,
                        "display_name": "Alexander"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1623424706,
                    "last_edit_date": 1623424706,
                    "creation_date": 1517926227,
                    "answer_id": 48645005,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/48645005#48645005",
                    "body": "<p>Here is an interesting technique to generate prime numbers (yet not the most efficient) using python's list comprehensions:</p>\n<pre><code>noprimes = [j for i in range(2, 8) for j in range(i*2, 50, i)]\nprimes = [x for x in range(2, 50) if x not in noprimes]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7007078,
                        "reputation": 1746,
                        "user_id": 5371102,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "display_name": "Peter M&#248;lgaard Pallesen"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1566806188,
                    "last_edit_date": 1566806188,
                    "creation_date": 1557489873,
                    "answer_id": 56077387,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/56077387#56077387",
                    "body": "<p>Here is a numpy version of Sieve of Eratosthenes having both good complexity (lower than sorting an array of length n) and vectorization.  Compared to @unutbu times this just as fast as the packages with 46 microsecons to find all primes below a million. </p>\n\n<pre><code>import numpy as np \ndef generate_primes(n):\n    is_prime = np.ones(n+1,dtype=bool)\n    is_prime[0:2] = False\n    for i in range(int(n**0.5)+1):\n        if is_prime[i]:\n            is_prime[i**2::i]=False\n    return np.where(is_prime)[0]\n</code></pre>\n\n<p>Timings: </p>\n\n<pre><code>import time    \nfor i in range(2,10):\n    timer =time.time()\n    generate_primes(10**i)\n    print('n = 10^',i,' time =', round(time.time()-timer,6))\n\n&gt;&gt; n = 10^ 2  time = 5.6e-05\n&gt;&gt; n = 10^ 3  time = 6.4e-05\n&gt;&gt; n = 10^ 4  time = 0.000114\n&gt;&gt; n = 10^ 5  time = 0.000593\n&gt;&gt; n = 10^ 6  time = 0.00467\n&gt;&gt; n = 10^ 7  time = 0.177758\n&gt;&gt; n = 10^ 8  time = 1.701312\n&gt;&gt; n = 10^ 9  time = 19.322478\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 9681837,
                        "reputation": 130,
                        "user_id": 7183250,
                        "user_type": "registered",
                        "display_name": "MrSeeker"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1563423939,
                    "last_edit_date": 1563423939,
                    "creation_date": 1558662664,
                    "answer_id": 56284894,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/56284894#56284894",
                    "body": "<p><strong>Fastest prime sieve in <em>Pure Python</em></strong>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from itertools import compress\n\ndef half_sieve(n):\n    \"\"\"\n    Returns a list of prime numbers less than `n`.\n    \"\"\"\n    if n &lt;= 2:\n        return []\n    sieve = bytearray([True]) * (n // 2)\n    for i in range(3, int(n ** 0.5) + 1, 2):\n        if sieve[i // 2]:\n            sieve[i * i // 2::i] = bytearray((n - i * i - 1) // (2 * i) + 1)\n    primes = list(compress(range(1, n, 2), sieve))\n    primes[0] = 2\n    return primes\n</code></pre>\n\n<p>I optimised <em>Sieve of Eratosthenes</em> for speed and memory. <br></p>\n\n<h1>Benchmark</h1>\n\n<pre><code>from time import clock\nimport platform\n\ndef benchmark(iterations, limit):\n    start = clock()\n    for x in range(iterations):\n        half_sieve(limit)\n    end = clock() - start\n    print(f'{end/iterations:.4f} seconds for primes &lt; {limit}')\n\nif __name__ == '__main__':\n    print(platform.python_version())\n    print(platform.platform())\n    print(platform.processor())\n    it = 10\n    for pw in range(4, 9):\n        benchmark(it, 10**pw)\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>&gt;&gt;&gt; 3.6.7\n&gt;&gt;&gt; Windows-10-10.0.17763-SP0\n&gt;&gt;&gt; Intel64 Family 6 Model 78 Stepping 3, GenuineIntel\n&gt;&gt;&gt; 0.0003 seconds for primes &lt; 10000\n&gt;&gt;&gt; 0.0021 seconds for primes &lt; 100000\n&gt;&gt;&gt; 0.0204 seconds for primes &lt; 1000000\n&gt;&gt;&gt; 0.2389 seconds for primes &lt; 10000000\n&gt;&gt;&gt; 2.6702 seconds for primes &lt; 100000000\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 16529493,
                        "reputation": 146,
                        "user_id": 11943198,
                        "user_type": "registered",
                        "display_name": "Greg Ames"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1569765915,
                    "last_edit_date": 1569765915,
                    "creation_date": 1568155367,
                    "answer_id": 57879041,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/57879041#57879041",
                    "body": "<p>I found a pure Python 2 prime generator <a href=\"https://programmingpraxis.com/2012/01/06/pritchards-wheel-sieve/\" rel=\"nofollow noreferrer\">here </a>, in a comment by Willy Good, that is faster than rwh2_primes.  </p>\n\n<pre><code>def primes235(limit):\nyield 2; yield 3; yield 5\nif limit &lt; 7: return\nmodPrms = [7,11,13,17,19,23,29,31]\ngaps = [4,2,4,2,4,6,2,6,4,2,4,2,4,6,2,6] # 2 loops for overflow\nndxs = [0,0,0,0,1,1,2,2,2,2,3,3,4,4,4,4,5,5,5,5,5,5,6,6,7,7,7,7,7,7]\nlmtbf = (limit + 23) // 30 * 8 - 1 # integral number of wheels rounded up\nlmtsqrt = (int(limit ** 0.5) - 7)\nlmtsqrt = lmtsqrt // 30 * 8 + ndxs[lmtsqrt % 30] # round down on the wheel\nbuf = [True] * (lmtbf + 1)\nfor i in xrange(lmtsqrt + 1):\n    if buf[i]:\n        ci = i &amp; 7; p = 30 * (i &gt;&gt; 3) + modPrms[ci]\n        s = p * p - 7; p8 = p &lt;&lt; 3\n        for j in range(8):\n            c = s // 30 * 8 + ndxs[s % 30]\n            buf[c::p8] = [False] * ((lmtbf - c) // p8 + 1)\n            s += p * gaps[ci]; ci += 1\nfor i in xrange(lmtbf - 6 + (ndxs[(limit - 7) % 30])): # adjust for extras\n    if buf[i]: yield (30 * (i &gt;&gt; 3) + modPrms[i &amp; 7])\n</code></pre>\n\n<p>My results:</p>\n\n<pre><code>$ time ./prime_rwh2.py 1e8\n5761455 primes found &lt; 1e8\n\nreal    0m3.201s\nuser    0m2.609s\nsys     0m0.578s\n$ time ./prime_wheel.py 1e8\n5761455 primes found &lt; 1e8\n\nreal    0m2.710s\nuser    0m2.469s\nsys     0m0.219s\n</code></pre>\n\n<p>...on my recent midrange laptop (i5 8265U 1.6GHz) running Ubuntu on Win 10.</p>\n\n<p>This is a mod 30 wheel sieve which skips multiples of 2, 3, and 5.  It works great for me up to about 2.5e9, when my laptop starts running out of 8G RAM and swapping a lot.  </p>\n\n<p>I like mod 30 since it has only 8 remainders that aren't multiples of 2, 3, or 5. That enables using shifts and \"&amp;\" for multiplication, division and mod, and should allow packing results for one mod 30 wheel into a byte.  I have morphed Willy's code into a segmented mod 30 wheel sieve to eliminate the thrashing for big N and posted it <a href=\"https://codereview.stackexchange.com/q/229813/210384\">here</a>.</p>\n\n<p>There is an even faster <a href=\"https://stackoverflow.com/a/57108107/11943198\">Javascript version</a> which is segmented and uses a mod 210 wheel (no multiples of 2, 3, 5, or 7) by @GordonBGood with an in depth explanation that is useful to me.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 175491,
                        "reputation": 47712,
                        "user_id": 405550,
                        "user_type": "registered",
                        "accept_rate": 77,
                        "display_name": "Zaz"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1569643790,
                    "creation_date": 1569643790,
                    "answer_id": 58143286,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/58143286#58143286",
                    "body": "<p>The simplest way I've found of doing this is:</p>\n\n<pre><code>primes = []\nfor n in range(low, high + 1):\n    if all(n % i for i in primes):\n        primes.append(n)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 453089,
                                "reputation": 70598,
                                "user_id": 849891,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Will Ness"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1641302900,
                            "post_id": 58983866,
                            "comment_id": 124765609,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/58983866#comment124765609_58983866",
                            "body": "mmm, log-log plots... :)"
                        },
                        {
                            "owner": {
                                "account_id": 3813614,
                                "reputation": 10232,
                                "user_id": 3163618,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "qwr"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1676782086,
                            "post_id": 58983866,
                            "comment_id": 133205162,
                            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/58983866#comment133205162_58983866",
                            "body": "now try it with pypy!"
                        }
                    ],
                    "owner": {
                        "account_id": 144356,
                        "reputation": 56762,
                        "user_id": 353337,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "Nico Schl&#246;mer"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1641232211,
                    "last_edit_date": 1641232211,
                    "creation_date": 1574370906,
                    "answer_id": 58983866,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/58983866#58983866",
                    "body": "<p>I've updated much of the code for Python 3 and threw it at <a href=\"https://github.com/nschloe/perfplot\" rel=\"noreferrer\">perfplot</a> (a project of mine) to see which is actually fastest. Turns out that, for large <code>n</code>, <code>primesfrom{2,3}to</code> takes the cake:</p>\n<p><a href=\"https://i.stack.imgur.com/kaA9s.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/kaA9s.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p>Code to reproduce the plot:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import perfplot\nfrom math import sqrt, ceil\nimport numpy as np\nimport sympy\n\n\ndef rwh_primes(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Returns  a list of primes &lt; n &quot;&quot;&quot;\n    sieve = [True] * n\n    for i in range(3, int(n ** 0.5) + 1, 2):\n        if sieve[i]:\n            sieve[i * i::2 * i] = [False] * ((n - i * i - 1) // (2 * i) + 1)\n    return [2] + [i for i in range(3, n, 2) if sieve[i]]\n\n\ndef rwh_primes1(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Returns  a list of primes &lt; n &quot;&quot;&quot;\n    sieve = [True] * (n // 2)\n    for i in range(3, int(n ** 0.5) + 1, 2):\n        if sieve[i // 2]:\n            sieve[i * i // 2::i] = [False] * ((n - i * i - 1) // (2 * i) + 1)\n    return [2] + [2 * i + 1 for i in range(1, n // 2) if sieve[i]]\n\n\ndef rwh_primes2(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot;Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n&quot;&quot;&quot;\n    assert n &gt;= 6\n    correction = n % 6 &gt; 1\n    n = {0: n, 1: n - 1, 2: n + 4, 3: n + 3, 4: n + 2, 5: n + 1}[n % 6]\n    sieve = [True] * (n // 3)\n    sieve[0] = False\n    for i in range(int(n ** 0.5) // 3 + 1):\n        if sieve[i]:\n            k = 3 * i + 1 | 1\n            sieve[((k * k) // 3)::2 * k] = [False] * (\n                (n // 6 - (k * k) // 6 - 1) // k + 1\n            )\n            sieve[(k * k + 4 * k - 2 * k * (i &amp; 1)) // 3::2 * k] = [False] * (\n                (n // 6 - (k * k + 4 * k - 2 * k * (i &amp; 1)) // 6 - 1) // k + 1\n            )\n    return [2, 3] + [3 * i + 1 | 1 for i in range(1, n // 3 - correction) if sieve[i]]\n\n\ndef sieve_wheel_30(N):\n    # http://zerovolt.com/?p=88\n    &quot;&quot;&quot; Returns a list of primes &lt;= N using wheel criterion 2*3*5 = 30\n\nCopyright 2009 by zerovolt.com\nThis code is free for non-commercial purposes, in which case you can just leave this comment as a credit for my work.\nIf you need this code for commercial purposes, please contact me by sending an email to: info [at] zerovolt [dot] com.&quot;&quot;&quot;\n    __smallp = (\n        2,\n        3,\n        5,\n        7,\n        11,\n        13,\n        17,\n        19,\n        23,\n        29,\n        31,\n        37,\n        41,\n        43,\n        47,\n        53,\n        59,\n        61,\n        67,\n        71,\n        73,\n        79,\n        83,\n        89,\n        97,\n        101,\n        103,\n        107,\n        109,\n        113,\n        127,\n        131,\n        137,\n        139,\n        149,\n        151,\n        157,\n        163,\n        167,\n        173,\n        179,\n        181,\n        191,\n        193,\n        197,\n        199,\n        211,\n        223,\n        227,\n        229,\n        233,\n        239,\n        241,\n        251,\n        257,\n        263,\n        269,\n        271,\n        277,\n        281,\n        283,\n        293,\n        307,\n        311,\n        313,\n        317,\n        331,\n        337,\n        347,\n        349,\n        353,\n        359,\n        367,\n        373,\n        379,\n        383,\n        389,\n        397,\n        401,\n        409,\n        419,\n        421,\n        431,\n        433,\n        439,\n        443,\n        449,\n        457,\n        461,\n        463,\n        467,\n        479,\n        487,\n        491,\n        499,\n        503,\n        509,\n        521,\n        523,\n        541,\n        547,\n        557,\n        563,\n        569,\n        571,\n        577,\n        587,\n        593,\n        599,\n        601,\n        607,\n        613,\n        617,\n        619,\n        631,\n        641,\n        643,\n        647,\n        653,\n        659,\n        661,\n        673,\n        677,\n        683,\n        691,\n        701,\n        709,\n        719,\n        727,\n        733,\n        739,\n        743,\n        751,\n        757,\n        761,\n        769,\n        773,\n        787,\n        797,\n        809,\n        811,\n        821,\n        823,\n        827,\n        829,\n        839,\n        853,\n        857,\n        859,\n        863,\n        877,\n        881,\n        883,\n        887,\n        907,\n        911,\n        919,\n        929,\n        937,\n        941,\n        947,\n        953,\n        967,\n        971,\n        977,\n        983,\n        991,\n        997,\n    )\n    # wheel = (2, 3, 5)\n    const = 30\n    if N &lt; 2:\n        return []\n    if N &lt;= const:\n        pos = 0\n        while __smallp[pos] &lt;= N:\n            pos += 1\n        return list(__smallp[:pos])\n    # make the offsets list\n    offsets = (7, 11, 13, 17, 19, 23, 29, 1)\n    # prepare the list\n    p = [2, 3, 5]\n    dim = 2 + N // const\n    tk1 = [True] * dim\n    tk7 = [True] * dim\n    tk11 = [True] * dim\n    tk13 = [True] * dim\n    tk17 = [True] * dim\n    tk19 = [True] * dim\n    tk23 = [True] * dim\n    tk29 = [True] * dim\n    tk1[0] = False\n    # help dictionary d\n    # d[a , b] = c  ==&gt; if I want to find the smallest useful multiple of (30*pos)+a\n    # on tkc, then I need the index given by the product of [(30*pos)+a][(30*pos)+b]\n    # in general. If b &lt; a, I need [(30*pos)+a][(30*(pos+1))+b]\n    d = {}\n    for x in offsets:\n        for y in offsets:\n            res = (x * y) % const\n            if res in offsets:\n                d[(x, res)] = y\n    # another help dictionary: gives tkx calling tmptk[x]\n    tmptk = {1: tk1, 7: tk7, 11: tk11, 13: tk13, 17: tk17, 19: tk19, 23: tk23, 29: tk29}\n    pos, prime, lastadded, stop = 0, 0, 0, int(ceil(sqrt(N)))\n\n    # inner functions definition\n    def del_mult(tk, start, step):\n        for k in range(start, len(tk), step):\n            tk[k] = False\n\n    # end of inner functions definition\n    cpos = const * pos\n    while prime &lt; stop:\n        # 30k + 7\n        if tk7[pos]:\n            prime = cpos + 7\n            p.append(prime)\n            lastadded = 7\n            for off in offsets:\n                tmp = d[(7, off)]\n                start = (\n                    (pos + prime)\n                    if off == 7\n                    else (prime * (const * (pos + 1 if tmp &lt; 7 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 11\n        if tk11[pos]:\n            prime = cpos + 11\n            p.append(prime)\n            lastadded = 11\n            for off in offsets:\n                tmp = d[(11, off)]\n                start = (\n                    (pos + prime)\n                    if off == 11\n                    else (prime * (const * (pos + 1 if tmp &lt; 11 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 13\n        if tk13[pos]:\n            prime = cpos + 13\n            p.append(prime)\n            lastadded = 13\n            for off in offsets:\n                tmp = d[(13, off)]\n                start = (\n                    (pos + prime)\n                    if off == 13\n                    else (prime * (const * (pos + 1 if tmp &lt; 13 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 17\n        if tk17[pos]:\n            prime = cpos + 17\n            p.append(prime)\n            lastadded = 17\n            for off in offsets:\n                tmp = d[(17, off)]\n                start = (\n                    (pos + prime)\n                    if off == 17\n                    else (prime * (const * (pos + 1 if tmp &lt; 17 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 19\n        if tk19[pos]:\n            prime = cpos + 19\n            p.append(prime)\n            lastadded = 19\n            for off in offsets:\n                tmp = d[(19, off)]\n                start = (\n                    (pos + prime)\n                    if off == 19\n                    else (prime * (const * (pos + 1 if tmp &lt; 19 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 23\n        if tk23[pos]:\n            prime = cpos + 23\n            p.append(prime)\n            lastadded = 23\n            for off in offsets:\n                tmp = d[(23, off)]\n                start = (\n                    (pos + prime)\n                    if off == 23\n                    else (prime * (const * (pos + 1 if tmp &lt; 23 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # 30k + 29\n        if tk29[pos]:\n            prime = cpos + 29\n            p.append(prime)\n            lastadded = 29\n            for off in offsets:\n                tmp = d[(29, off)]\n                start = (\n                    (pos + prime)\n                    if off == 29\n                    else (prime * (const * (pos + 1 if tmp &lt; 29 else 0) + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n        # now we go back to top tk1, so we need to increase pos by 1\n        pos += 1\n        cpos = const * pos\n        # 30k + 1\n        if tk1[pos]:\n            prime = cpos + 1\n            p.append(prime)\n            lastadded = 1\n            for off in offsets:\n                tmp = d[(1, off)]\n                start = (\n                    (pos + prime)\n                    if off == 1\n                    else (prime * (const * pos + tmp)) // const\n                )\n                del_mult(tmptk[off], start, prime)\n    # time to add remaining primes\n    # if lastadded == 1, remove last element and start adding them from tk1\n    # this way we don't need an &quot;if&quot; within the last while\n    if lastadded == 1:\n        p.pop()\n    # now complete for every other possible prime\n    while pos &lt; len(tk1):\n        cpos = const * pos\n        if tk1[pos]:\n            p.append(cpos + 1)\n        if tk7[pos]:\n            p.append(cpos + 7)\n        if tk11[pos]:\n            p.append(cpos + 11)\n        if tk13[pos]:\n            p.append(cpos + 13)\n        if tk17[pos]:\n            p.append(cpos + 17)\n        if tk19[pos]:\n            p.append(cpos + 19)\n        if tk23[pos]:\n            p.append(cpos + 23)\n        if tk29[pos]:\n            p.append(cpos + 29)\n        pos += 1\n    # remove exceeding if present\n    pos = len(p) - 1\n    while p[pos] &gt; N:\n        pos -= 1\n    if pos &lt; len(p) - 1:\n        del p[pos + 1 :]\n    # return p list\n    return p\n\n\ndef sieve_of_eratosthenes(n):\n    &quot;&quot;&quot;sieveOfEratosthenes(n): return the list of the primes &lt; n.&quot;&quot;&quot;\n    # Code from: &lt;dickinsm@gmail.com&gt;, Nov 30 2006\n    # http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d\n    if n &lt;= 2:\n        return []\n    sieve = list(range(3, n, 2))\n    top = len(sieve)\n    for si in sieve:\n        if si:\n            bottom = (si * si - 3) // 2\n            if bottom &gt;= top:\n                break\n            sieve[bottom::si] = [0] * -((bottom - top) // si)\n    return [2] + [el for el in sieve if el]\n\n\ndef sieve_of_atkin(end):\n    &quot;&quot;&quot;return a list of all the prime numbers &lt;end using the Sieve of Atkin.&quot;&quot;&quot;\n    # Code by Steve Krenzel, &lt;Sgk284@gmail.com&gt;, improved\n    # Code: https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83\n    # Info: http://en.wikipedia.org/wiki/Sieve_of_Atkin\n    assert end &gt; 0\n    lng = (end - 1) // 2\n    sieve = [False] * (lng + 1)\n\n    x_max, x2, xd = int(sqrt((end - 1) / 4.0)), 0, 4\n    for xd in range(4, 8 * x_max + 2, 8):\n        x2 += xd\n        y_max = int(sqrt(end - x2))\n        n, n_diff = x2 + y_max * y_max, (y_max &lt;&lt; 1) - 1\n        if not (n &amp; 1):\n            n -= n_diff\n            n_diff -= 2\n        for d in range((n_diff - 1) &lt;&lt; 1, -1, -8):\n            m = n % 12\n            if m == 1 or m == 5:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n -= d\n\n    x_max, x2, xd = int(sqrt((end - 1) / 3.0)), 0, 3\n    for xd in range(3, 6 * x_max + 2, 6):\n        x2 += xd\n        y_max = int(sqrt(end - x2))\n        n, n_diff = x2 + y_max * y_max, (y_max &lt;&lt; 1) - 1\n        if not (n &amp; 1):\n            n -= n_diff\n            n_diff -= 2\n        for d in range((n_diff - 1) &lt;&lt; 1, -1, -8):\n            if n % 12 == 7:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n -= d\n\n    x_max, y_min, x2, xd = int((2 + sqrt(4 - 8 * (1 - end))) / 4), -1, 0, 3\n    for x in range(1, x_max + 1):\n        x2 += xd\n        xd += 6\n        if x2 &gt;= end:\n            y_min = (((int(ceil(sqrt(x2 - end))) - 1) &lt;&lt; 1) - 2) &lt;&lt; 1\n        n, n_diff = ((x * x + x) &lt;&lt; 1) - 1, (((x - 1) &lt;&lt; 1) - 2) &lt;&lt; 1\n        for d in range(n_diff, y_min, -8):\n            if n % 12 == 11:\n                m = n &gt;&gt; 1\n                sieve[m] = not sieve[m]\n            n += d\n\n    primes = [2, 3]\n    if end &lt;= 3:\n        return primes[: max(0, end - 2)]\n\n    for n in range(5 &gt;&gt; 1, (int(sqrt(end)) + 1) &gt;&gt; 1):\n        if sieve[n]:\n            primes.append((n &lt;&lt; 1) + 1)\n            aux = (n &lt;&lt; 1) + 1\n            aux *= aux\n            for k in range(aux, end, 2 * aux):\n                sieve[k &gt;&gt; 1] = False\n\n    s = int(sqrt(end)) + 1\n    if s % 2 == 0:\n        s += 1\n    primes.extend([i for i in range(s, end, 2) if sieve[i &gt;&gt; 1]])\n\n    return primes\n\n\ndef ambi_sieve_plain(n):\n    s = list(range(3, n, 2))\n    for m in range(3, int(n ** 0.5) + 1, 2):\n        if s[(m - 3) // 2]:\n            for t in range((m * m - 3) // 2, (n &gt;&gt; 1) - 1, m):\n                s[t] = 0\n    return [2] + [t for t in s if t &gt; 0]\n\n\ndef sundaram3(max_n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279\n    numbers = range(3, max_n + 1, 2)\n    half = (max_n) // 2\n    initial = 4\n\n    for step in range(3, max_n + 1, 2):\n        for i in range(initial, half, step):\n            numbers[i - 1] = 0\n        initial += 2 * (step + 1)\n\n        if initial &gt; half:\n            return [2] + filter(None, numbers)\n\n\n# Using Numpy:\ndef ambi_sieve(n):\n    # http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html\n    s = np.arange(3, n, 2)\n    for m in range(3, int(n ** 0.5) + 1, 2):\n        if s[(m - 3) // 2]:\n            s[(m * m - 3) // 2::m] = 0\n    return np.r_[2, s[s &gt; 0]]\n\n\ndef primesfrom3to(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Returns an array of primes, p &lt; n &quot;&quot;&quot;\n    assert n &gt;= 2\n    sieve = np.ones(n // 2, dtype=bool)\n    for i in range(3, int(n ** 0.5) + 1, 2):\n        if sieve[i // 2]:\n            sieve[i * i // 2::i] = False\n    return np.r_[2, 2 * np.nonzero(sieve)[0][1::] + 1]\n\n\ndef primesfrom2to(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Input n&gt;=6, Returns an array of primes, 2 &lt;= p &lt; n &quot;&quot;&quot;\n    assert n &gt;= 6\n    sieve = np.ones(n // 3 + (n % 6 == 2), dtype=bool)\n    sieve[0] = False\n    for i in range(int(n ** 0.5) // 3 + 1):\n        if sieve[i]:\n            k = 3 * i + 1 | 1\n            sieve[((k * k) // 3)::2 * k] = False\n            sieve[(k * k + 4 * k - 2 * k * (i &amp; 1)) // 3::2 * k] = False\n    return np.r_[2, 3, ((3 * np.nonzero(sieve)[0] + 1) | 1)]\n\n\ndef sympy_sieve(n):\n    return list(sympy.sieve.primerange(1, n))\n\n\nb = perfplot.bench(\n    setup=lambda n: n,\n    kernels=[\n        rwh_primes,\n        rwh_primes1,\n        rwh_primes2,\n        sieve_wheel_30,\n        sieve_of_eratosthenes,\n        sieve_of_atkin,\n        # ambi_sieve_plain,\n        # sundaram3,\n        ambi_sieve,\n        primesfrom3to,\n        primesfrom2to,\n        sympy_sieve,\n    ],\n    n_range=[2 ** k for k in range(3, 25)],\n    xlabel=&quot;n&quot;,\n)\nb.save(&quot;out.png&quot;)\nb.show()\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 441885,
                        "reputation": 60711,
                        "user_id": 832230,
                        "user_type": "registered",
                        "display_name": "Asclepius"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1600977687,
                    "last_edit_date": 1600977687,
                    "creation_date": 1597509356,
                    "answer_id": 63428414,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/63428414#63428414",
                    "body": "<p>This is a variation of the solution in the question that should be faster than what's in the question. It uses a static sieve of Eratosthenes with no other optimizations.</p>\n<pre class=\"lang-py prettyprint-override\"><code>from typing import List\n\ndef list_primes(limit: int) -&gt; List[int]:\n    primes = set(range(2, limit + 1))\n    for i in range(2, limit + 1):\n        if i in primes:\n            primes.difference_update(set(list(range(i, limit + 1, i))[1:]))\n    return sorted(primes)\n\n&gt;&gt;&gt; list_primes(100)\n[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 8448473,
                        "reputation": 2333,
                        "user_id": 6338179,
                        "user_type": "registered",
                        "display_name": "Daniel Giger"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1680233245,
                    "last_edit_date": 1680233245,
                    "creation_date": 1625713485,
                    "answer_id": 68295105,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/68295105#68295105",
                    "body": "<p>I may have been slow to join the party, but I make up for it with the fastest code (at least it is on my machine, as of writing).  This approach uses both numpy and bitarray, and is inspired by <code>primesfrom2to</code> from <a href=\"https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\">this answer</a>.</p>\n<pre><code>import numpy as np\nfrom bitarray import bitarray\n\n\ndef bit_primes(n):\n    bit_sieve = bitarray(n // 3 + (n % 6 == 2))\n    bit_sieve.setall(1)\n    bit_sieve[0] = False\n\n    for i in range(int(n ** 0.5) // 3 + 1):\n        if bit_sieve[i]:\n            k = 3 * i + 1 | 1\n            bit_sieve[k * k // 3::2 * k] = False\n            bit_sieve[(k * k + 4 * k - 2 * k * (i &amp; 1)) // 3::2 * k] = False\n\n    np_sieve = np.unpackbits(np.frombuffer(bit_sieve.tobytes(), dtype=np.uint8)).view(bool)\n    return np.concatenate(((2, 3), ((3 * np.flatnonzero(np_sieve) + 1) | 1)))\n</code></pre>\n<p>Here's a comparison with <code>primesfrom2to</code>, which was previously found to be the fastest solution in <a href=\"https://stackoverflow.com/a/2068548/6338179\">unutbu's comparison</a>:</p>\n<pre><code>python3 -m timeit -s &quot;import fast_primes&quot; &quot;fast_primes.bit_primes(1000000)&quot;\n200 loops, best of 5: 1.19 msec per loop\n\npython3 -m timeit -s &quot;import fast_primes&quot; &quot;fast_primes.primesfrom2to(1000000)&quot;\n200 loops, best of 5: 1.23 msec per loop\n</code></pre>\n<p>For finding primes under 1 million, <code>bit_primes</code> was slightly faster.\nFor larger values of <code>n</code>, the difference can be more significant.  In some cases, <code>bit_primes</code> was over twice as fast:</p>\n<pre><code>python3 -m timeit -s &quot;import fast_primes&quot; &quot;fast_primes.bit_primes(500_000_000)&quot;\n1 loop, best of 5: 540 msec per loop\n\npython3 -m timeit -s &quot;import fast_primes&quot; &quot;fast_primes.primesfrom2to(500_000_000)&quot;\n1 loop, best of 5: 1.15 sec per loop\n</code></pre>\n<p>For reference, here's the minimally modified (to work in Python 3) version of <code>primesfrom2to</code> I compared with:</p>\n<pre><code>def primesfrom2to(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n&quot;&quot;&quot;\n    sieve = np.ones(n // 3 + (n % 6 == 2), dtype=np.bool)\n    sieve[0] = False\n    for i in range(int(n ** 0.5) // 3 + 1):\n        if sieve[i]:\n            k = 3 * i + 1 | 1\n            sieve[((k * k) // 3)::2 * k] = False\n            sieve[(k * k + 4 * k - 2 * k * (i &amp; 1)) // 3::2 * k] = False\n    return np.r_[2, 3, ((3 * np.nonzero(sieve)[0] + 1) | 1)]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user16657590"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1632118071,
                    "last_edit_date": 1632118071,
                    "creation_date": 1632061741,
                    "answer_id": 69244164,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/69244164#69244164",
                    "body": "<p>You have a faster code and also the simplest code generating primes.\nbut for the higher number, it's not working for <code>n=10000, 10000000</code> it failed maybe it's <code>.pop()</code> method</p>\n<p>Consider: is N prime?</p>\n<ul>\n<li><p>case 1:</p>\n<p>You got some factors of N,</p>\n<pre><code>for i in range(2, N):\n</code></pre>\n<p>If N is prime loop is performed  for ~(N-2) times. else less number of times</p>\n</li>\n<li><p>case 2:</p>\n<pre><code>for i in range(2, int(math.sqrt(N)): \n</code></pre>\n<p>Loop is performed for almost ~(sqrt(N)-2) times if N is prime else will break somewhere</p>\n</li>\n<li><p>case 3:</p>\n<p>Better We Divide N With Only number of <strong>primes&lt;=sqrt(N)</strong></p>\n<p>Where loop is performed for only \u03c0(sqrt(N)) times</p>\n<p><strong>\u03c0(sqrt(N)) &lt;&lt; sqrt(N) as N increases</strong></p>\n<pre class=\"lang-py prettyprint-override\"><code>from math import sqrt\nfrom time import *\nprime_list = [2]\nn = int(input())\ns = time()\nfor n0 in range(2,n+1):\n    for i0 in prime_list:\n        if n0%i0==0:\n            break\n        elif i0&gt;=int(sqrt(n0)):\n            prime_list.append(n0)\n            break\ne = time()\nprint(e-s)\n#print(prime_list); print(f'pi({n})={len(prime_list)}')\nprint(f'{n}: {len(prime_list)}, time: {e-s}')\n</code></pre>\n</li>\n<li><p>Output</p>\n<pre><code>100: 25, time: 0.00010275840759277344\n1000: 168, time: 0.0008606910705566406\n10000: 1229, time: 0.015588521957397461\n100000: 9592, time: 0.023436546325683594\n1000000: 78498, time: 4.1965954303741455\n10000000: 664579, time: 109.24591708183289\n100000000: 5761455, time: 2289.130858898163\n</code></pre>\n</li>\n</ul>\n<p>For less than 1000 seems slow but then for &lt;10^6 I think it's faster.</p>\n<p>Though, I couldn't understand the time complexity.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 395294,
                        "reputation": 25561,
                        "user_id": 758174,
                        "user_type": "registered",
                        "accept_rate": 61,
                        "display_name": "Pierre D"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1657584283,
                    "last_edit_date": 1657584283,
                    "creation_date": 1642781070,
                    "answer_id": 70804184,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/70804184#70804184",
                    "body": "<p>I'm surprised nobody mentioned <a href=\"https://numba.pydata.org/numba-doc/dev/reference/jit-compilation.html\" rel=\"nofollow noreferrer\"><code>numba</code></a> yet.</p>\n<p>This version gets to the 1M mark in 2.47 ms \u00b1 36.5 \u00b5s.</p>\n<p>Years ago, pseudo-code for <em>a version</em> of Atkin's sieve was given on the Wikipedia page <a href=\"http://en.wikipedia.org/wiki/Prime_number\" rel=\"nofollow noreferrer\">Prime number</a>. This isn't there anymore, and a reference to the <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Atkin\" rel=\"nofollow noreferrer\">Sieve of Atkin</a> seems to be a different algorithm. A 2007/03/01 version of the Wikipedia page, <a href=\"https://en.wikipedia.org/w/index.php?title=Prime_number&amp;oldid=111775466\" rel=\"nofollow noreferrer\">Primer number as of 2007-03-01</a>, shows the pseudo-code I used as reference.</p>\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\nfrom numba import njit\n\n@njit\ndef nb_primes(n):\n    # Generates prime numbers 2 &lt;= p &lt;= n\n    # Atkin's sieve -- see https://en.wikipedia.org/w/index.php?title=Prime_number&amp;oldid=111775466\n    sqrt_n = int(np.sqrt(n)) + 1\n\n    # initialize the sieve\n    s = np.full(n + 1, -1, dtype=np.int8)\n    s[2] = 1\n    s[3] = 1\n\n    # put in candidate primes:\n    # integers which have an odd number of\n    # representations by certain quadratic forms\n    for x in range(1, sqrt_n):\n        x2 = x * x\n        for y in range(1, sqrt_n):\n            y2 = y * y\n            k = 4 * x2 + y2\n            if k &lt;= n and (k % 12 == 1 or k % 12 == 5): s[k] *= -1\n            k = 3 * x2 + y2\n            if k &lt;= n and (k % 12 == 7): s[k] *= -1\n            k = 3 * x2 - y2\n            if k &lt;= n and x &gt; y and k % 12 == 11: s[k] *= -1\n\n    # eliminate composites by sieving\n    for k in range(5, sqrt_n):\n        if s[k]:\n            k2 = k*k\n            # k is prime, omit multiples of its square; this is sufficient because\n            # composites which managed to get on the list cannot be square-free\n            for i in range(1, n // k2 + 1):\n                j = i * k2 # j \u2208 {k\u00b2, 2k\u00b2, 3k\u00b2, ..., n}\n                s[j] = -1\n    return np.nonzero(s&gt;0)[0]\n\n# initial run for &quot;compilation&quot; \nnb_primes(10)\n</code></pre>\n<h2>Timing</h2>\n<pre class=\"lang-py prettyprint-override\"><code>In[10]:\n%timeit nb_primes(1_000_000)\n\nOut[10]:\n2.47 ms \u00b1 36.5 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n\nIn[11]:\n%timeit nb_primes(10_000_000)\n\nOut[11]:\n33.4 ms \u00b1 373 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\n\nIn[12]:\n%timeit nb_primes(100_000_000)\n\nOut[12]:\n828 ms \u00b1 5.64 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1224616,
                        "reputation": 3513,
                        "user_id": 1190453,
                        "user_type": "registered",
                        "accept_rate": 82,
                        "display_name": "danbst"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1652990770,
                    "creation_date": 1652990770,
                    "answer_id": 72310515,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/72310515#72310515",
                    "body": "<p>Starting from <a href=\"https://stackoverflow.com/a/68295105/1190453\">this 2021 answer</a>, I haven't found <code>bitarray</code> approach to be beneficial for primes below 1 billion.</p>\n<p>But I was able to speedup <code>primesfrom2to</code> almost x2 with several tricks:</p>\n<ul>\n<li>use <code>numexpr</code> library to convert numpy expressions to tight loops with less allocations</li>\n<li>replace <code>np.ones</code> with a faster alternative</li>\n<li>manipulate first 9 elements of a sieve in a way, so there is no need to change array shape later</li>\n</ul>\n<p>All in all, time for primes &lt;1 billion went from 25s to 14.5s on my machine</p>\n<pre><code>import numexpr as ne\nimport numpy as np\n\ndef primesfrom2to_numexpr(n):\n    # https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188\n    &quot;&quot;&quot; Input n&gt;=24, Returns a array of primes, 2 &lt;= p &lt; n + a few over&quot;&quot;&quot;\n    sieve = np.zeros((n // 3 + (n % 6 == 2))//4+1, dtype=np.int32)\n    ne.evaluate('sieve + 0x01010101', out=sieve)\n    sieve = sieve.view('int8')\n    #sieve = np.ones(n // 3 + (n % 6 == 2), dtype=np.bool_)\n    sieve[0] = 0\n    for i in np.arange(int(n ** 0.5) // 3 + 1):\n        if sieve[i]:\n            k = 3 * i + 1 | 1\n            sieve[((k * k) // 3)::2 * k] = 0\n            sieve[(k * k + 4 * k - 2 * k * (i &amp; 1)) // 3::2 * k] = 0\n    sieve[[0,8]] = 1\n    result = np.flatnonzero(sieve)\n    ne.evaluate('result * 3 + 1 + result%2', out=result)\n    result[:9] = [2,3,5,7,11,13,17,19,23]\n    return result\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7791304,
                        "reputation": 29,
                        "user_id": 6239719,
                        "user_type": "registered",
                        "display_name": "Rohit Sohlot"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1681318470,
                    "creation_date": 1681318470,
                    "answer_id": 75998039,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/75998039#75998039",
                    "body": "<pre class=\"lang-py prettyprint-override\"><code>def find_primes(n):\n    # Create a boolean list to track prime numbers\n    primes = [True] * (n+1)\n    primes[0] = primes[1] = False\n\n    # Mark all multiples of 2 as composite (except 2 itself)\n    for i in range(4, n+1, 2):\n        primes[i] = False\n\n    # Iterate over all odd numbers and mark their multiples as composite\n    for i in range(3, int(n**0.5)+1, 2):\n        if primes[i]:\n            for j in range(i*i, n+1, 2*i):\n                primes[j] = False\n\n    # Return a list of prime numbers\n    return [i for i in range(n+1) if primes[I]]\nprimes = find_primes(1000000)\nprint(primes)\n</code></pre>\n<p>The find_primes function takes an integer n as input and returns a list of all prime numbers from 1 to n. The code first creates a boolean list primes of length n+1 to track prime numbers. It then marks all multiples of 2 as composite (except 2 itself), since all other even numbers are not prime. Next, it iterates over all odd numbers from 3 to the square root of n and marks their multiples as composite. Finally, it returns a list of all prime numbers by filtering out the composite numbers from the boolean list.</p>\n<p>Note that the Sieve of Eratosthenes algorithm has a time complexity of O(n log log n), which makes it much more efficient than testing each number for primality individually.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 20016172,
                        "reputation": 2598,
                        "user_id": 14672114,
                        "user_type": "registered",
                        "display_name": "RARE Kpop Manifesto"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1710346004,
                    "creation_date": 1710346004,
                    "answer_id": 78155249,
                    "question_id": 2068372,
                    "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/78155249#78155249",
                    "body": "<p>You can save a lot of space by first pre-filtering down all 8 scenarios of the <code>mod 30 wheel</code> collapsed down to this simple formula :</p>\n<pre><code>((x % 30) - 15)^4 % 30 == 16\n</code></pre>\n<p>or simply</p>\n<pre><code>( x % 30 - 15 )^4 % 30 == 16\n</code></pre>\n<p>Then each byte can represent exactly 1 spin of the wheel, which is already <strong>73.3%</strong> space savings right off the bat compared to 1 bit for every natural number.</p>\n<p>(I usually prefer starting the wheel at <code>11,13,...,31,37</code> instead of <code>1,7,...,23,29</code>)</p>\n"
                }
            ],
            "owner": {
                "account_id": 81883,
                "reputation": 29266,
                "user_id": 230636,
                "user_type": "registered",
                "accept_rate": 90,
                "display_name": "jbochi"
            },
            "comment_count": 11,
            "is_answered": true,
            "accepted_answer_id": 2068548,
            "answer_count": 41,
            "score": 398,
            "last_activity_date": 1710346004,
            "creation_date": 1263512427,
            "last_edit_date": 1414967610,
            "question_id": 2068372,
            "link": "https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n",
            "title": "Fastest way to list all primes below N",
            "body": "<p>This is the best algorithm I could come up.</p>\n\n<pre><code>def get_primes(n):\n    numbers = set(range(n, 1, -1))\n    primes = []\n    while numbers:\n        p = numbers.pop()\n        primes.append(p)\n        numbers.difference_update(set(range(p*2, n+1, p)))\n    return primes\n\n&gt;&gt;&gt; timeit.Timer(stmt='get_primes.get_primes(1000000)', setup='import   get_primes').timeit(1)\n1.1499958793645562\n</code></pre>\n\n<p>Can it be made even faster?</p>\n\n<p>This code has a flaw: Since <code>numbers</code> is an unordered set, there is no guarantee that <code>numbers.pop()</code> will remove the lowest number from the set. Nevertheless, it works (at least for me) for some input numbers:</p>\n\n<pre><code>&gt;&gt;&gt; sum(get_primes(2000000))\n142913828922L\n#That's the correct sum of all numbers below 2 million\n&gt;&gt;&gt; 529 in get_primes(1000)\nFalse\n&gt;&gt;&gt; 529 in get_primes(530)\nTrue\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7993
}