{
    "items": [
        {
            "tags": [
                "python",
                "search",
                "numpy"
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 60,
                            "creation_date": 1270234318,
                            "post_id": 2566508,
                            "comment_id": 2573376,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment2573376_2566508",
                            "body": "@EOL: <code>return np.abs(array-value).min()</code> gives the wrong answer. This gives you the min of the absolute value distance, and somehow we need to return the actual array value. We could add <code>value</code> and come close, but the absolute value throws a wrench into things..."
                        },
                        {
                            "owner": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1270336033,
                            "post_id": 2566508,
                            "comment_id": 2578574,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment2578574_2566508",
                            "body": "@~unutbu You&#39;re right, my bad.  I can&#39;t think of anything better than your solution!"
                        },
                        {
                            "owner": {
                                "account_id": 1365525,
                                "reputation": 10563,
                                "user_id": 2623899,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "abcd"
                            },
                            "edited": false,
                            "score": 43,
                            "creation_date": 1428521569,
                            "post_id": 2566508,
                            "comment_id": 47201902,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment47201902_2566508",
                            "body": "seems crazy there isn&#39;t a numpy built-in that does this."
                        },
                        {
                            "owner": {
                                "account_id": 5055245,
                                "reputation": 1095,
                                "user_id": 4058679,
                                "user_type": "registered",
                                "accept_rate": 44,
                                "display_name": "jsmedmar"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1470072419,
                            "post_id": 2566508,
                            "comment_id": 64787114,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment64787114_2566508",
                            "body": "Can someone explain what is the time complexity of this algorithm?"
                        },
                        {
                            "owner": {
                                "account_id": 3288083,
                                "reputation": 348,
                                "user_id": 3303915,
                                "user_type": "registered",
                                "display_name": "\u039furous"
                            },
                            "reply_to_user": {
                                "account_id": 5055245,
                                "reputation": 1095,
                                "user_id": 4058679,
                                "user_type": "registered",
                                "accept_rate": 44,
                                "display_name": "jsmedmar"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1475898729,
                            "post_id": 2566508,
                            "comment_id": 67140189,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment67140189_2566508",
                            "body": "@jsmedmar <code>O(n)</code> unless is doing something strange: <code>n</code> operations to apply the vectorized subtraction, <code>n</code> operations to find the minimum, up to <code>n</code> operations to get the element based on the index. <code>O(3n) = O(n)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 442600,
                                "reputation": 1084,
                                "user_id": 833285,
                                "user_type": "registered",
                                "accept_rate": 42,
                                "display_name": "Josh Albert"
                            },
                            "reply_to_user": {
                                "account_id": 5055245,
                                "reputation": 1095,
                                "user_id": 4058679,
                                "user_type": "registered",
                                "accept_rate": 44,
                                "display_name": "jsmedmar"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1485361694,
                            "post_id": 2566508,
                            "comment_id": 70897090,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment70897090_2566508",
                            "body": "@jsmedmar The bisection method (see my below answer) is O(log(n))."
                        },
                        {
                            "owner": {
                                "account_id": 2061909,
                                "reputation": 5592,
                                "user_id": 1838257,
                                "user_type": "registered",
                                "display_name": "gosuto"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1526366203,
                            "post_id": 2566508,
                            "comment_id": 87703251,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment87703251_2566508",
                            "body": "<code>FutureWarning: &#39;argmin&#39; is deprecated. Use &#39;idxmin&#39; instead. The behavior of &#39;argmin&#39; will be corrected to return the positional minimum in the future. Use &#39;series.values.argmin&#39; to get the position of the minimum now.</code> Using <code>idxmin</code> instead of <code>argmin</code> works for me with the solution above. (v3.6.4)"
                        },
                        {
                            "owner": {
                                "account_id": 64585,
                                "reputation": 864612,
                                "user_id": 190597,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "unutbu"
                            },
                            "reply_to_user": {
                                "account_id": 2061909,
                                "reputation": 5592,
                                "user_id": 1838257,
                                "user_type": "registered",
                                "display_name": "gosuto"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1526382095,
                            "post_id": 2566508,
                            "comment_id": 87712678,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment87712678_2566508",
                            "body": "@jorijnsmit: To make the code compatible with Pandas Series, I&#39;ve added <code>array = np.asarray(array)</code>. This will convert the Series into a NumPy array. Then calling NumPy&#39;s <a href=\"https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.argmin.html\" rel=\"nofollow noreferrer\"><code>argmin</code></a> will work as expected. I can not change it to <code>idxmin</code> because that would break the code if <code>find_nearest</code> were passed a NumPy array."
                        },
                        {
                            "owner": {
                                "account_id": 2996898,
                                "reputation": 1116,
                                "user_id": 2543267,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "tsherwen"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1528911747,
                            "post_id": 2566508,
                            "comment_id": 88690023,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment88690023_2566508",
                            "body": "It is worth pointing out that although this works on unsorted data, if there there are multiple array elements with equal absolute distance to the value, the 1st value found will be returned. This is because of use of <a href=\"https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.argmin.html\" rel=\"nofollow noreferrer\"><code>numpy.argmin</code></a> which follows the rule: <code>In case of multiple occurrences of the minimum values, the indices corresponding to the first occurrence are returned.</code>"
                        },
                        {
                            "owner": {
                                "account_id": 12968437,
                                "reputation": 22848,
                                "user_id": 9375102,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Umar.H"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1555447736,
                            "post_id": 2566508,
                            "comment_id": 98113227,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment98113227_2566508",
                            "body": "amazing answer, I tried this with a <code>groupby().transform(lambda)</code> but I kept getting a shape mismatch error, the vectorised version below seemed to work. if you don&#39;t mind could you explain why?"
                        },
                        {
                            "owner": {
                                "account_id": 13084673,
                                "reputation": 141,
                                "user_id": 9454050,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "user9454050"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1571360215,
                            "post_id": 2566508,
                            "comment_id": 103224412,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment103224412_2566508",
                            "body": "This is really helpful, but is there a way to reduce the tolerance of the function. For example, if I want to search for 10, but this value isnt represented, the function will return say... 18?"
                        },
                        {
                            "owner": {
                                "account_id": 12849012,
                                "reputation": 53,
                                "user_id": 9840645,
                                "user_type": "registered",
                                "display_name": "Berkcem"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1575035458,
                            "post_id": 2566508,
                            "comment_id": 104443803,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment104443803_2566508",
                            "body": "Hello @unutbu. Am I allowed to use this code for commercial use?"
                        },
                        {
                            "owner": {
                                "account_id": 261274,
                                "reputation": 411,
                                "user_id": 545346,
                                "user_type": "registered",
                                "display_name": "johanvdw"
                            },
                            "edited": false,
                            "score": 23,
                            "creation_date": 1605000660,
                            "post_id": 2566508,
                            "comment_id": 114512331,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment114512331_2566508",
                            "body": "big fat warning: if your data contains np.nan, those points will always come out as nearest."
                        },
                        {
                            "owner": {
                                "account_id": 2123624,
                                "reputation": 7683,
                                "user_id": 1886357,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "eric"
                            },
                            "reply_to_user": {
                                "account_id": 261274,
                                "reputation": 411,
                                "user_id": 545346,
                                "user_type": "registered",
                                "display_name": "johanvdw"
                            },
                            "edited": false,
                            "score": 16,
                            "creation_date": 1616080211,
                            "post_id": 2566508,
                            "comment_id": 117896234,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment117896234_2566508",
                            "body": "@johanvdw wow that should almost count as a bug.  To fix it, replace <code>np.argmin()</code> with <code>np.nanargmin()</code> and it works."
                        },
                        {
                            "owner": {
                                "account_id": 31530,
                                "reputation": 21799,
                                "user_id": 86643,
                                "user_type": "registered",
                                "accept_rate": 45,
                                "display_name": "denis"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1634486876,
                            "post_id": 2566508,
                            "comment_id": 123032286,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment123032286_2566508",
                            "body": "<a href=\"https://numpy.org/doc/stable/reference/generated/numpy.searchsorted.html\" rel=\"nofollow noreferrer\">Numpy searchsorted</a> works for any number of query points, 1 or 1000. One <i>can</i> do queries one by one, <code>for q in querypoints: n = find_nearest( q )</code>, but sorting all 1000, then essentially mergesort, is way faster. (I think <code>searchsorted</code> does that, don&#39;t know.) See <code>class Mid_rgrid</code> <a href=\"https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/69479668#69479668\">below</a> which finds nearest-neighbor of any number of queries with searchsorted. It works on regular grids in 2d, 3d ... too."
                        },
                        {
                            "owner": {
                                "account_id": 1008778,
                                "reputation": 8128,
                                "user_id": 1021819,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "jtlz2"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1649319270,
                            "post_id": 2566508,
                            "comment_id": 126846864,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#comment126846864_2566508",
                            "body": "I&#39;ve always kept this function in my pocket. Except that I usually return <code>idx, array[idx]</code> so I can use the indices elsewhere."
                        }
                    ],
                    "owner": {
                        "account_id": 64585,
                        "reputation": 864612,
                        "user_id": 190597,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "unutbu"
                    },
                    "comment_count": 16,
                    "is_accepted": true,
                    "score": 735,
                    "last_activity_date": 1655694895,
                    "last_edit_date": 1655694895,
                    "creation_date": 1270209661,
                    "answer_id": 2566508,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/2566508#2566508",
                    "body": "<pre><code>import numpy as np\ndef find_nearest(array, value):\n    array = np.asarray(array)\n    idx = (np.abs(array - value)).argmin()\n    return array[idx]\n</code></pre>\n<p>Example usage:</p>\n<pre><code>array = np.random.random(10)\nprint(array)\n# [ 0.21069679  0.61290182  0.63425412  0.84635244  0.91599191  0.00213826\n#   0.17104965  0.56874386  0.57319379  0.28719469]\n\nprint(find_nearest(array, value=0.5))\n# 0.568743859261\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2271495,
                                "reputation": 946,
                                "user_id": 1998767,
                                "user_type": "registered",
                                "display_name": "Max Shron"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1386771613,
                            "post_id": 10465997,
                            "comment_id": 30680213,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/10465997#comment30680213_10465997",
                            "body": "The &quot;flat&quot; bit isn&#39;t necessary. <code>a[np.abs(a-a0).argmin)]</code> works fine."
                        },
                        {
                            "owner": {
                                "account_id": 1219770,
                                "reputation": 4210,
                                "user_id": 1186624,
                                "user_type": "registered",
                                "display_name": "relent95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1673859152,
                            "post_id": 10465997,
                            "comment_id": 132583104,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/10465997#comment132583104_10465997",
                            "body": "On the above old comment of Max shron, it does not work for a two or more dimensional case."
                        }
                    ],
                    "owner": {
                        "account_id": 1462140,
                        "reputation": 2098,
                        "user_id": 1376150,
                        "user_type": "registered",
                        "display_name": "kwgoodman"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 80,
                    "last_activity_date": 1336252079,
                    "creation_date": 1336252079,
                    "answer_id": 10465997,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/10465997#10465997",
                    "body": "<p>With slight modification, the answer above works with arrays of arbitrary dimension (1d, 2d, 3d, ...):</p>\n\n<pre><code>def find_nearest(a, a0):\n    \"Element in nd array `a` closest to the scalar value `a0`\"\n    idx = np.abs(a - a0).argmin()\n    return a.flat[idx]\n</code></pre>\n\n<p>Or, written as a single line:</p>\n\n<pre><code>a.flat[np.abs(a - a0).argmin()]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 212739,
                                "reputation": 280,
                                "user_id": 465750,
                                "user_type": "registered",
                                "display_name": "Widjet"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1448005109,
                            "post_id": 14806751,
                            "comment_id": 55408096,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/14806751#comment55408096_14806751",
                            "body": "Good answer, I&#39;ve never used the <code>outer</code> method of a ufunc before, I think I&#39;ll be using it more in the future. The first function should return <code>array[indices]</code>, by the way."
                        },
                        {
                            "owner": {
                                "account_id": 1669838,
                                "reputation": 5898,
                                "user_id": 1536499,
                                "user_type": "registered",
                                "accept_rate": 63,
                                "display_name": "anthonybell"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1505244133,
                            "post_id": 14806751,
                            "comment_id": 79330612,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/14806751#comment79330612_14806751",
                            "body": "This solution does not scale.  <code>np.subtract.outer</code> will generate the entire outer-product matrix which is really slow and memory intensive if <code>array</code> and/or <code>values</code> is very large."
                        }
                    ],
                    "owner": {
                        "account_id": 774980,
                        "reputation": 3401,
                        "user_id": 877493,
                        "user_type": "registered",
                        "display_name": "ryggyr"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 10,
                    "last_activity_date": 1452201547,
                    "last_edit_date": 1452201547,
                    "creation_date": 1360562699,
                    "answer_id": 14806751,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/14806751#14806751",
                    "body": "<p>Here's a version that will handle a non-scalar \"values\" array:</p>\n\n<pre><code>import numpy as np\n\ndef find_nearest(array, values):\n    indices = np.abs(np.subtract.outer(array, values)).argmin(0)\n    return array[indices]\n</code></pre>\n\n<p>Or a version that returns a numeric type (e.g. int, float) if the input is scalar:</p>\n\n<pre><code>def find_nearest(array, values):\n    values = np.atleast_1d(values)\n    indices = np.abs(np.subtract.outer(array, values)).argmin(0)\n    out = array[indices]\n    return out if len(out) &gt; 1 else out[0]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3503093,
                                "reputation": 4626,
                                "user_id": 2929337,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "cfh"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1500552020,
                            "post_id": 17678303,
                            "comment_id": 77394033,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/17678303#comment77394033_17678303",
                            "body": "I think <code>norm(..., axis=-1)</code> should be faster than extracting the <code>x,y</code> values through Python iteration. Also, <code>x,y</code> are scalars here? Then <code>norm(x+y)</code> is a bug since, e.g., the distance <code>(+1, -1)</code> will be treated as 0."
                        },
                        {
                            "owner": {
                                "account_id": 3377622,
                                "reputation": 4052,
                                "user_id": 2835460,
                                "user_type": "registered",
                                "display_name": "ezChx"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1587699876,
                            "post_id": 17678303,
                            "comment_id": 108619154,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/17678303#comment108619154_17678303",
                            "body": "This worked for me <code>idx = np.array([np.linalg.norm(x+y) for (x,y) in abs(array-value)]).argmin()</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 1694704,
                        "reputation": 458,
                        "user_id": 1556335,
                        "user_type": "registered",
                        "display_name": "Onasafari"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 19,
                    "last_activity_date": 1373982452,
                    "creation_date": 1373982452,
                    "answer_id": 17678303,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/17678303#17678303",
                    "body": "<p>Here's an extension to find the nearest vector in an array of vectors.  </p>\n\n<pre><code>import numpy as np\n\ndef find_nearest_vector(array, value):\n  idx = np.array([np.linalg.norm(x+y) for (x,y) in array-value]).argmin()\n  return array[idx]\n\nA = np.random.random((10,2))*100\n\"\"\" A = array([[ 34.19762933,  43.14534123],\n   [ 48.79558706,  47.79243283],\n   [ 38.42774411,  84.87155478],\n   [ 63.64371943,  50.7722317 ],\n   [ 73.56362857,  27.87895698],\n   [ 96.67790593,  77.76150486],\n   [ 68.86202147,  21.38735169],\n   [  5.21796467,  59.17051276],\n   [ 82.92389467,  99.90387851],\n   [  6.76626539,  30.50661753]])\"\"\"\npt = [6, 30]  \nprint find_nearest_vector(A,pt)\n# array([  6.76626539,  30.50661753])\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 219148,
                        "reputation": 5116,
                        "user_id": 475872,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Nick Crawford"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 11,
                    "last_activity_date": 1377733503,
                    "creation_date": 1377733503,
                    "answer_id": 18500089,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/18500089#18500089",
                    "body": "<p>If you don't want to use numpy this will do it:</p>\n\n<pre><code>def find_nearest(array, value):\n    n = [abs(i-value) for i in array]\n    idx = n.index(min(n))\n    return array[idx]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 368313,
                                "reputation": 7606,
                                "user_id": 715042,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Michael"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1424196458,
                            "post_id": 26026189,
                            "comment_id": 45446311,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment45446311_26026189",
                            "body": "That sounds like the most reasonable solution. I wonder why it is so slow anyways. Plain <code>np.searchsorted</code> takes about 2 &#181;s for my test set, the whole function about 10 &#181;s. Using <code>np.abs</code> it&#39;s getting even worse. No clue what python is doing there."
                        },
                        {
                            "owner": {
                                "account_id": 241711,
                                "reputation": 13699,
                                "user_id": 2712652,
                                "user_type": "registered",
                                "display_name": "Demitri"
                            },
                            "reply_to_user": {
                                "account_id": 368313,
                                "reputation": 7606,
                                "user_id": 715042,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Michael"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1424271186,
                            "post_id": 26026189,
                            "comment_id": 45480215,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment45480215_26026189",
                            "body": "@Michael For single values, the Numpy math routines will be slower than the <code>math</code> routines, see <a href=\"http://stackoverflow.com/questions/3650194/are-numpys-math-functions-faster-than-pythons\">this answer</a>."
                        },
                        {
                            "owner": {
                                "account_id": 284283,
                                "reputation": 1477,
                                "user_id": 582298,
                                "user_type": "registered",
                                "accept_rate": 85,
                                "display_name": "coderforlife"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1452239926,
                            "post_id": 26026189,
                            "comment_id": 57089287,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment57089287_26026189",
                            "body": "This is the best solution if you have multiple values you want to look up at once (with a few adjustments). The whole <code>if&#47;else</code> needs to be replaced with <code>idx = idx - (np.abs(value - array[idx-1]) &lt; np.abs(value - array[idx])); return array[idx]</code>"
                        },
                        {
                            "owner": {
                                "account_id": 3725692,
                                "reputation": 1471,
                                "user_id": 5902284,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "nicoco"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1462280761,
                            "post_id": 26026189,
                            "comment_id": 61562394,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment61562394_26026189",
                            "body": "This is great but doesn&#39;t work if <code>value</code> is bigger than <code>array</code>&#39;s biggest element. I changed the <code>if</code> statement to <code>if idx == len(array) or math.fabs(value - array[idx - 1]) &lt; math.fabs(value - array[idx])</code> to make it work for me!"
                        },
                        {
                            "owner": {
                                "account_id": 5937,
                                "reputation": 991,
                                "user_id": 9802,
                                "user_type": "registered",
                                "display_name": "JPaget"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1462942283,
                            "post_id": 26026189,
                            "comment_id": 61843766,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment61843766_26026189",
                            "body": "This doesn&#39;t work when idx is 0.  The if should read: <code>if idx &gt; 0 and (idx == len(array) or math.fabs(value - array[idx-1]) &lt; math.fabs(value - array[idx])):</code>"
                        },
                        {
                            "owner": {
                                "account_id": 4398470,
                                "reputation": 4571,
                                "user_id": 3584851,
                                "user_type": "registered",
                                "display_name": "jolvi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1701807951,
                            "post_id": 26026189,
                            "comment_id": 136820587,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#comment136820587_26026189",
                            "body": "I don&#39;t understand why <code>math.fabs</code> is needed here. <code>value - array[idx-1] &lt; array[idx] - value</code> looks correct too?"
                        }
                    ],
                    "owner": {
                        "account_id": 241711,
                        "reputation": 13699,
                        "user_id": 2712652,
                        "user_type": "registered",
                        "display_name": "Demitri"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 124,
                    "last_activity_date": 1466009764,
                    "last_edit_date": 1466009764,
                    "creation_date": 1411591689,
                    "answer_id": 26026189,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/26026189#26026189",
                    "body": "<p><em>IF</em> your array is sorted and is very large, this is a much faster solution:</p>\n\n<pre><code>def find_nearest(array,value):\n    idx = np.searchsorted(array, value, side=\"left\")\n    if idx &gt; 0 and (idx == len(array) or math.fabs(value - array[idx-1]) &lt; math.fabs(value - array[idx])):\n        return array[idx-1]\n    else:\n        return array[idx]\n</code></pre>\n\n<p>This scales to very large arrays. You can easily modify the above to sort in the method if you can't assume that the array is already sorted. It\u2019s overkill for small arrays, but once they get large this is much faster.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4706793,
                                "reputation": 1775,
                                "user_id": 3808639,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "aph"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1428505266,
                            "post_id": 29518176,
                            "comment_id": 47191711,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#comment47191711_29518176",
                            "body": "It&#39;s worth pointing out that this is a great example of how optimizing code tends to make it uglier and harder to read. The answer given by @unutbu should be (much) preferred in cases where speed is not a major concern, since it is far more transparent."
                        },
                        {
                            "owner": {
                                "account_id": 252935,
                                "reputation": 7315,
                                "user_id": 307633,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Fookatchu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1428573309,
                            "post_id": 29518176,
                            "comment_id": 47223207,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#comment47223207_29518176",
                            "body": "I don&#39;t see the answer given by @Michael. Is this an error or am I blind?"
                        },
                        {
                            "owner": {
                                "account_id": 4706793,
                                "reputation": 1775,
                                "user_id": 3808639,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "aph"
                            },
                            "reply_to_user": {
                                "account_id": 252935,
                                "reputation": 7315,
                                "user_id": 307633,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Fookatchu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1428587837,
                            "post_id": 29518176,
                            "comment_id": 47233033,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#comment47233033_29518176",
                            "body": "Nope, you&#39;re not blind, I&#39;m just illiterate ;-) It was @Demitri whose answer I was riffing on. My bad. I just fixed my post. Thanks!"
                        },
                        {
                            "owner": {
                                "account_id": 1040243,
                                "reputation": 10251,
                                "user_id": 1457380,
                                "user_type": "registered",
                                "accept_rate": 98,
                                "display_name": "PatrickT"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1517660183,
                            "post_id": 29518176,
                            "comment_id": 84191146,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#comment84191146_29518176",
                            "body": "I get different answers with Demitri&#39;s and yours. Any ideas? <code>x = np.array([2038, 1758, 1721, 1637, 2097, 2047, 2205, 1787, 2287, 1940, 2311, 2054, 2406, 1471, 1460])</code>. With <code>find_nearest(x, 1739.5)</code> (closest value to the first quantile), I get  <code>1637</code> (reasonable) and <code>1</code> (bug?)."
                        },
                        {
                            "owner": {
                                "account_id": 1762861,
                                "reputation": 1442,
                                "user_id": 1609464,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "nwly"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1677975496,
                            "post_id": 29518176,
                            "comment_id": 133443897,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#comment133443897_29518176",
                            "body": "Agree with PatrickT, this version&#39;s buggy.  Recommend @anthonybell&#39;s solution, which is faster than Demitri&#39;s."
                        }
                    ],
                    "owner": {
                        "account_id": 4706793,
                        "reputation": 1775,
                        "user_id": 3808639,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "aph"
                    },
                    "comment_count": 5,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1462946857,
                    "last_edit_date": 1462946857,
                    "creation_date": 1428504860,
                    "answer_id": 29518176,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/29518176#29518176",
                    "body": "<p>For large arrays, the (excellent) answer given by @Demitri is far faster than the answer currently marked as best. I've adapted his exact algorithm in the following two ways:</p>\n\n<ol>\n<li><p>The function below works whether or not the input array is sorted.</p></li>\n<li><p>The function below returns the <em>index</em> of the input array corresponding to the closest value, which is somewhat more general.</p></li>\n</ol>\n\n<p>Note that the function below also handles a specific edge case that would lead to a bug in the original function written by @Demitri. Otherwise, my algorithm is identical to his. </p>\n\n<pre><code>def find_idx_nearest_val(array, value):\n    idx_sorted = np.argsort(array)\n    sorted_array = np.array(array[idx_sorted])\n    idx = np.searchsorted(sorted_array, value, side=\"left\")\n    if idx &gt;= len(array):\n        idx_nearest = idx_sorted[len(array)-1]\n    elif idx == 0:\n        idx_nearest = idx_sorted[0]\n    else:\n        if abs(value - sorted_array[idx-1]) &lt; abs(value - sorted_array[idx]):\n            idx_nearest = idx_sorted[idx-1]\n        else:\n            idx_nearest = idx_sorted[idx]\n    return idx_nearest\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 544895,
                                "reputation": 461,
                                "user_id": 914363,
                                "user_type": "registered",
                                "display_name": "Ben"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1492003147,
                            "post_id": 32740709,
                            "comment_id": 73803193,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/32740709#comment73803193_32740709",
                            "body": "Building a KDTree is quite an overhead for such a problem. I would not recommend such a solution unless you have to make multiple queries on a big array ... And then, it would be better to build it once and reuse it, rather than creating it on the fly for each query."
                        }
                    ],
                    "owner": {
                        "account_id": 3065406,
                        "reputation": 4765,
                        "user_id": 2597213,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "efirvida"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1443182136,
                    "last_edit_date": 1443182136,
                    "creation_date": 1443014354,
                    "answer_id": 32740709,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/32740709#32740709",
                    "body": "<p>Here is a version with scipy for @Ari Onasafari, answer \"<strong><em>to find the nearest vector in an array of vectors</em></strong>\"</p>\n\n<pre><code>In [1]: from scipy import spatial\n\nIn [2]: import numpy as np\n\nIn [3]: A = np.random.random((10,2))*100\n\nIn [4]: A\nOut[4]:\narray([[ 68.83402637,  38.07632221],\n       [ 76.84704074,  24.9395109 ],\n       [ 16.26715795,  98.52763827],\n       [ 70.99411985,  67.31740151],\n       [ 71.72452181,  24.13516764],\n       [ 17.22707611,  20.65425362],\n       [ 43.85122458,  21.50624882],\n       [ 76.71987125,  44.95031274],\n       [ 63.77341073,  78.87417774],\n       [  8.45828909,  30.18426696]])\n\nIn [5]: pt = [6, 30]  # &lt;-- the point to find\n\nIn [6]: A[spatial.KDTree(A).query(pt)[1]] # &lt;-- the nearest point \nOut[6]: array([  8.45828909,  30.18426696])\n\n#how it works!\nIn [7]: distance,index = spatial.KDTree(A).query(pt)\n\nIn [8]: distance # &lt;-- The distances to the nearest neighbors\nOut[8]: 2.4651855048258393\n\nIn [9]: index # &lt;-- The locations of the neighbors\nOut[9]: 9\n\n#then \nIn [10]: A[index]\nOut[10]: array([  8.45828909,  30.18426696])\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2163896,
                                "reputation": 702,
                                "user_id": 1917407,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "adamcircle"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1496942970,
                            "post_id": 41856629,
                            "comment_id": 75881835,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#comment75881835_41856629",
                            "body": "You&#39;re assuming that the array is sorted. There are many reasons why someone would not want to sort the array: for example, if the array represented the data points on a line graph."
                        },
                        {
                            "owner": {
                                "account_id": 4411839,
                                "reputation": 6309,
                                "user_id": 3594526,
                                "user_type": "registered",
                                "accept_rate": 30,
                                "display_name": "Felix"
                            },
                            "edited": false,
                            "score": 12,
                            "creation_date": 1500909118,
                            "post_id": 41856629,
                            "comment_id": 77530635,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#comment77530635_41856629",
                            "body": "The python standard library already contains in implementation of the bisection algorithm: <a href=\"https://docs.python.org/3.6/library/bisect.html\" rel=\"nofollow noreferrer\">docs.python.org/3.6/library/bisect.html</a>"
                        },
                        {
                            "owner": {
                                "account_id": 10972243,
                                "reputation": 444,
                                "user_id": 8062091,
                                "user_type": "registered",
                                "display_name": "Mr.Zeus"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1534359703,
                            "post_id": 41856629,
                            "comment_id": 90681867,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#comment90681867_41856629",
                            "body": "When you said, &quot;if <code>array</code> is small then method 2 seems the fastest.&quot; how small did you mean @JoshAlbert?"
                        },
                        {
                            "owner": {
                                "account_id": 43003,
                                "reputation": 26116,
                                "user_id": 125507,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "endolith"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1537300847,
                            "post_id": 41856629,
                            "comment_id": 91732743,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#comment91732743_41856629",
                            "body": "This doesn&#39;t find the <i>nearest</i> value, it finds the next-lowest value."
                        },
                        {
                            "owner": {
                                "account_id": 1329581,
                                "reputation": 2132,
                                "user_id": 1273751,
                                "user_type": "registered",
                                "display_name": "Homero Esmeraldo"
                            },
                            "reply_to_user": {
                                "account_id": 43003,
                                "reputation": 26116,
                                "user_id": 125507,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "endolith"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1551211907,
                            "post_id": 41856629,
                            "comment_id": 96555754,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#comment96555754_41856629",
                            "body": "@endolith that&#39;s the case for bisect only."
                        }
                    ],
                    "owner": {
                        "account_id": 442600,
                        "reputation": 1084,
                        "user_id": 833285,
                        "user_type": "registered",
                        "accept_rate": 42,
                        "display_name": "Josh Albert"
                    },
                    "comment_count": 5,
                    "is_accepted": false,
                    "score": 27,
                    "last_activity_date": 1497042902,
                    "last_edit_date": 1497042902,
                    "creation_date": 1485361482,
                    "answer_id": 41856629,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41856629#41856629",
                    "body": "<p><strong>Summary of answer</strong>: If one has a sorted <code>array</code> then the bisection code (given below) performs the fastest. ~100-1000 times faster for large arrays, and ~2-100 times faster for small arrays. It does not require numpy either. \nIf you have an unsorted <code>array</code> then if <code>array</code> is large, one should consider first using an O(n logn) sort and then bisection, and if <code>array</code> is small then method 2 seems the fastest.</p>\n\n<p><strong>First you should clarify what you mean by nearest value</strong>. Often one wants the interval in an abscissa, e.g. array=[0,0.7,2.1], value=1.95, answer would be idx=1. This is the case that I suspect you need (otherwise the following can be modified very easily with a followup conditional statement once you find the interval). I will note that the optimal way to perform this is with bisection (which I will provide first - note it does not require numpy at all and is faster than using numpy functions because they perform redundant operations). Then I will provide a timing comparison against the others presented here by other users.</p>\n\n<p>Bisection:</p>\n\n<pre><code>def bisection(array,value):\n    '''Given an ``array`` , and given a ``value`` , returns an index j such that ``value`` is between array[j]\n    and array[j+1]. ``array`` must be monotonic increasing. j=-1 or j=len(array) is returned\n    to indicate that ``value`` is out of range below and above respectively.'''\n    n = len(array)\n    if (value &lt; array[0]):\n        return -1\n    elif (value &gt; array[n-1]):\n        return n\n    jl = 0# Initialize lower\n    ju = n-1# and upper limits.\n    while (ju-jl &gt; 1):# If we are not yet done,\n        jm=(ju+jl) &gt;&gt; 1# compute a midpoint with a bitshift\n        if (value &gt;= array[jm]):\n            jl=jm# and replace either the lower limit\n        else:\n            ju=jm# or the upper limit, as appropriate.\n        # Repeat until the test condition is satisfied.\n    if (value == array[0]):# edge cases at bottom\n        return 0\n    elif (value == array[n-1]):# and top\n        return n-1\n    else:\n        return jl\n</code></pre>\n\n<p>Now I'll define the code from the other answers, they each return an index:</p>\n\n<pre><code>import math\nimport numpy as np\n\ndef find_nearest1(array,value):\n    idx,val = min(enumerate(array), key=lambda x: abs(x[1]-value))\n    return idx\n\ndef find_nearest2(array, values):\n    indices = np.abs(np.subtract.outer(array, values)).argmin(0)\n    return indices\n\ndef find_nearest3(array, values):\n    values = np.atleast_1d(values)\n    indices = np.abs(np.int64(np.subtract.outer(array, values))).argmin(0)\n    out = array[indices]\n    return indices\n\ndef find_nearest4(array,value):\n    idx = (np.abs(array-value)).argmin()\n    return idx\n\n\ndef find_nearest5(array, value):\n    idx_sorted = np.argsort(array)\n    sorted_array = np.array(array[idx_sorted])\n    idx = np.searchsorted(sorted_array, value, side=\"left\")\n    if idx &gt;= len(array):\n        idx_nearest = idx_sorted[len(array)-1]\n    elif idx == 0:\n        idx_nearest = idx_sorted[0]\n    else:\n        if abs(value - sorted_array[idx-1]) &lt; abs(value - sorted_array[idx]):\n            idx_nearest = idx_sorted[idx-1]\n        else:\n            idx_nearest = idx_sorted[idx]\n    return idx_nearest\n\ndef find_nearest6(array,value):\n    xi = np.argmin(np.abs(np.ceil(array[None].T - value)),axis=0)\n    return xi\n</code></pre>\n\n<p>Now I'll time the codes:\n<strong>Note</strong> methods 1,2,4,5 don't correctly give the interval. Methods 1,2,4 round to nearest point in array (e.g. >=1.5 -> 2), and method 5 always rounds up (e.g. 1.45 -> 2). Only methods 3, and 6, and of course bisection give the interval properly.</p>\n\n<pre><code>array = np.arange(100000)\nval = array[50000]+0.55\nprint( bisection(array,val))\n%timeit bisection(array,val)\nprint( find_nearest1(array,val))\n%timeit find_nearest1(array,val)\nprint( find_nearest2(array,val))\n%timeit find_nearest2(array,val)\nprint( find_nearest3(array,val))\n%timeit find_nearest3(array,val)\nprint( find_nearest4(array,val))\n%timeit find_nearest4(array,val)\nprint( find_nearest5(array,val))\n%timeit find_nearest5(array,val)\nprint( find_nearest6(array,val))\n%timeit find_nearest6(array,val)\n\n(50000, 50000)\n100000 loops, best of 3: 4.4 \u00b5s per loop\n50001\n1 loop, best of 3: 180 ms per loop\n50001\n1000 loops, best of 3: 267 \u00b5s per loop\n[50000]\n1000 loops, best of 3: 390 \u00b5s per loop\n50001\n1000 loops, best of 3: 259 \u00b5s per loop\n50001\n1000 loops, best of 3: 1.21 ms per loop\n[50000]\n1000 loops, best of 3: 746 \u00b5s per loop\n</code></pre>\n\n<p>For a large array bisection gives 4us compared to next best 180us and longest 1.21ms (~100 - 1000 times faster). For smaller arrays it's ~2-100 times faster.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 1456763,
                        "reputation": 1544,
                        "user_id": 1372149,
                        "user_type": "registered",
                        "accept_rate": 0,
                        "display_name": "Ishan Tomar"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 7,
                    "last_activity_date": 1631244527,
                    "last_edit_date": 1631244527,
                    "creation_date": 1485841409,
                    "answer_id": 41950439,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/41950439#41950439",
                    "body": "<p>I think the most pythonic way would be:</p>\n<pre><code> num = 65 # Input number\n array = np.random.random((10))*100 # Given array \n nearest_idx = np.where(abs(array-num)==abs(array-num).min())[0] # If you want the index of the element of array (array) nearest to the the given number (num)\n nearest_val = array[abs(array-num)==abs(array-num).min()] # If you directly want the element of array (array) nearest to the given number (num)\n</code></pre>\n<p>This is the basic code. You can use it as a function if you want</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1868749,
                                "reputation": 4140,
                                "user_id": 3033945,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Sergey Antopolskiy"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1519646012,
                            "post_id": 46184652,
                            "comment_id": 84980253,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment84980253_46184652",
                            "body": "in case you have constant sampling in the array, it becomes even simpler: <code>idx = np.searchsorted(array, values)</code> then: <code>idx[array[idx] - values&gt;np.diff(array).mean()*0.5]-=1</code> and finally <code>return array[idx]</code>"
                        },
                        {
                            "owner": {
                                "account_id": 189428,
                                "reputation": 31377,
                                "user_id": 4790871,
                                "user_type": "registered",
                                "accept_rate": 99,
                                "display_name": "David Parks"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1632340742,
                            "post_id": 46184652,
                            "comment_id": 122469150,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment122469150_46184652",
                            "body": "First answer that &quot;just works&quot;: <code>get_closest([1,5,10,20], [1,4,16]) -&gt; [1, 5, 20]</code>, this one should have more upvotes."
                        },
                        {
                            "owner": {
                                "account_id": 987385,
                                "reputation": 377,
                                "user_id": 1125290,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "egor.ananyev"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1637107264,
                            "post_id": 46184652,
                            "comment_id": 123736501,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment123736501_46184652",
                            "body": "Exactly what I needed and incredibly fast! Thank you so much Anthony!"
                        },
                        {
                            "owner": {
                                "account_id": 2870479,
                                "reputation": 11869,
                                "user_id": 2463948,
                                "user_type": "registered",
                                "accept_rate": 36,
                                "display_name": "Flash Thunder"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1662622781,
                            "post_id": 46184652,
                            "comment_id": 130049445,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment130049445_46184652",
                            "body": "any simple way to distinguish if it should be nearest from the left (like lower than) or from the right (like higher than) given value?"
                        },
                        {
                            "owner": {
                                "account_id": 1762861,
                                "reputation": 1442,
                                "user_id": 1609464,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "nwly"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1677981955,
                            "post_id": 46184652,
                            "comment_id": 133444503,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment133444503_46184652",
                            "body": "Note that the input variable <code>array</code> needs to be sorted in ascending order per <code>np.searchsorted</code> requirement."
                        },
                        {
                            "owner": {
                                "account_id": 2989509,
                                "reputation": 562,
                                "user_id": 2537394,
                                "user_type": "registered",
                                "display_name": "YPOC"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1684158315,
                            "post_id": 46184652,
                            "comment_id": 134471747,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#comment134471747_46184652",
                            "body": "Even works when the array has shifted indices caused by passing in <code>array[3:]</code>. Perfect!"
                        }
                    ],
                    "owner": {
                        "account_id": 1669838,
                        "reputation": 5898,
                        "user_id": 1536499,
                        "user_type": "registered",
                        "accept_rate": 63,
                        "display_name": "anthonybell"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 24,
                    "last_activity_date": 1632340936,
                    "last_edit_date": 1632340936,
                    "creation_date": 1505247197,
                    "answer_id": 46184652,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/46184652#46184652",
                    "body": "<p>Here is a fast vectorized version of @Dimitri's solution if you have many <code>values</code> to search for (<code>values</code> can be multi-dimensional array):</p>\n<pre><code># `values` should be sorted\ndef get_closest(array, values):\n    # make sure array is a numpy array\n    array = np.array(array)\n\n    # get insert positions\n    idxs = np.searchsorted(array, values, side=&quot;left&quot;)\n    \n    # find indexes where previous index is closer\n    prev_idx_is_less = ((idxs == len(array))|(np.fabs(values - array[np.maximum(idxs-1, 0)]) &lt; np.fabs(values - array[np.minimum(idxs, len(array)-1)])))\n    idxs[prev_idx_is_less] -= 1\n    \n    return array[idxs]\n</code></pre>\n<p><strong>Benchmarks</strong></p>\n<p>&gt; 100 times faster than using a <code>for</code> loop with @Demitri's solution`</p>\n<pre><code>&gt;&gt;&gt; %timeit ar=get_closest(np.linspace(1, 1000, 100), np.random.randint(0, 1050, (1000, 1000)))\n139 ms \u00b1 4.04 ms per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\n\n&gt;&gt;&gt; %timeit ar=[find_nearest(np.linspace(1, 1000, 100), value) for value in np.random.randint(0, 1050, 1000*1000)]\ntook 21.4 seconds\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4205763,
                                "reputation": 813,
                                "user_id": 3444703,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "amc"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1636824707,
                            "post_id": 50414108,
                            "comment_id": 123662662,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/50414108#comment123662662_50414108",
                            "body": "This is incredibly insightful, thank you!"
                        }
                    ],
                    "owner": {
                        "account_id": 1654881,
                        "reputation": 83,
                        "user_id": 9796787,
                        "user_type": "registered",
                        "display_name": "Soumen"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 6,
                    "last_activity_date": 1526765319,
                    "last_edit_date": 1526765319,
                    "creation_date": 1526655374,
                    "answer_id": 50414108,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/50414108#50414108",
                    "body": "<p>All the answers are beneficial to gather the information to write efficient code. However, I have written a small Python script to optimize for various cases. It will be the best case if the provided array is sorted. If one searches the index of the nearest point of a specified value, then <code>bisect</code> module is the most time efficient. When one search the indices correspond to an array, the <code>numpy searchsorted</code> is most efficient.</p>\n\n<pre><code>import numpy as np\nimport bisect\nxarr = np.random.rand(int(1e7))\n\nsrt_ind = xarr.argsort()\nxar = xarr.copy()[srt_ind]\nxlist = xar.tolist()\nbisect.bisect_left(xlist, 0.3)\n</code></pre>\n\n<p>In [63]: %time bisect.bisect_left(xlist, 0.3)\n   CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n   Wall time: 22.2 \u00b5s</p>\n\n<pre><code>np.searchsorted(xar, 0.3, side=\"left\")\n</code></pre>\n\n<p>In [64]: %time np.searchsorted(xar, 0.3, side=\"left\")\n   CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n   Wall time: 98.9 \u00b5s</p>\n\n<pre><code>randpts = np.random.rand(1000)\nnp.searchsorted(xar, randpts, side=\"left\")\n</code></pre>\n\n<p>%time np.searchsorted(xar, randpts, side=\"left\")\nCPU times: user 4 ms, sys: 0 ns, total: 4 ms\nWall time: 1.2 ms</p>\n\n<p>If we follow the multiplicative rule, then numpy should take ~100 ms which implies ~83X faster.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 13742947,
                                "reputation": 2398,
                                "user_id": 9917504,
                                "user_type": "registered",
                                "display_name": "Tristo"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1536401695,
                            "post_id": 52234197,
                            "comment_id": 91417245,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/52234197#comment91417245_52234197",
                            "body": "Hi, welcome to Stack Overflow. <a href=\"https://stackoverflow.com/help/how-to-answer\">Check out how to write a good answer</a>. Try giving a short description of what you did in the context of the question!"
                        }
                    ],
                    "owner": {
                        "account_id": 14306341,
                        "reputation": 1,
                        "user_id": 10334122,
                        "user_type": "registered",
                        "display_name": "kareem mohamed"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1536401178,
                    "creation_date": 1536401178,
                    "answer_id": 52234197,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/52234197#52234197",
                    "body": "<pre><code>import numpy as np\ndef find_nearest(array, value):\n    array = np.array(array)\n    z=np.abs(array-value)\n    y= np.where(z == z.min())\n    m=np.array(y)\n    x=m[0,0]\n    y=m[1,0]\n    near_value=array[x,y]\n\n    return near_value\n\narray =np.array([[60,200,30],[3,30,50],[20,1,-50],[20,-500,11]])\nprint(array)\nvalue = 0\nprint(find_nearest(array, value))\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 4767878,
                        "reputation": 1352,
                        "user_id": 3853537,
                        "user_type": "registered",
                        "display_name": "Zhanwen Chen"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1541124078,
                    "creation_date": 1541124078,
                    "answer_id": 53111759,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/53111759#53111759",
                    "body": "<p>This is a vectorized version of <a href=\"https://stackoverflow.com/a/2566508/3853537\">unutbu's answer</a>:</p>\n\n<pre><code>def find_nearest(array, values):\n    array = np.asarray(array)\n\n    # the last dim must be 1 to broadcast in (array - values) below.\n    values = np.expand_dims(values, axis=-1) \n\n    indices = np.abs(array - values).argmin(axis=-1)\n\n    return array[indices]\n\n\nimage = plt.imread('example_3_band_image.jpg')\n\nprint(image.shape) # should be (nrows, ncols, 3)\n\nquantiles = np.linspace(0, 255, num=2 ** 2, dtype=np.uint8)\n\nquantiled_image = find_nearest(quantiles, image)\n\nprint(quantiled_image.shape) # should be (nrows, ncols, 3)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1870746,
                                "reputation": 1131,
                                "user_id": 1693021,
                                "user_type": "registered",
                                "display_name": "Vadim"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1624033656,
                            "post_id": 53801761,
                            "comment_id": 120256030,
                            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/53801761#comment120256030_53801761",
                            "body": "Nice and simple."
                        }
                    ],
                    "owner": {
                        "account_id": 7069560,
                        "reputation": 2164,
                        "user_id": 5411664,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Gusev Slava"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1544960481,
                    "creation_date": 1544960481,
                    "answer_id": 53801761,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/53801761#53801761",
                    "body": "<p>Maybe helpful for <code>ndarrays</code>:</p>\n\n<pre><code>def find_nearest(X, value):\n    return X[np.unravel_index(np.argmin(np.abs(X - value)), X.shape)]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 5959849,
                        "reputation": 51,
                        "user_id": 4685339,
                        "user_type": "registered",
                        "display_name": "Eduardo S. Pereira"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1561483209,
                    "creation_date": 1561483209,
                    "answer_id": 56759115,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/56759115#56759115",
                    "body": "<p>For 2d array, to determine the i, j position of nearest element:</p>\n\n<pre><code>import numpy as np\ndef find_nearest(a, a0):\n    idx = (np.abs(a - a0)).argmin()\n    w = a.shape[1]\n    i = idx // w\n    j = idx - i * w\n    return a[i,j], i, j\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 6386261,
                        "reputation": 338,
                        "user_id": 4954083,
                        "user_type": "registered",
                        "accept_rate": 50,
                        "display_name": "boof"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1611274229,
                    "creation_date": 1611274229,
                    "answer_id": 65837585,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/65837585#65837585",
                    "body": "<p>Here is a version that works with 2D arrays, using scipy's <a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cdist.html\" rel=\"nofollow noreferrer\">cdist</a> function if the user has it, and a simpler distance calculation if they don't.</p>\n<p>By default, the output is the index that is closest to the value you input, but you can change that with the <code>output</code> keyword to be one of <code>'index'</code>, <code>'value'</code>, or <code>'both'</code>, where <code>'value'</code> outputs <code>array[index]</code> and <code>'both'</code> outputs <code>index, array[index]</code>.</p>\n<p>For very large arrays, you may need to use <code>kind='euclidean'</code>, as the default scipy cdist function may run out of memory.</p>\n<p>This is maybe not the absolute fastest solution, but it is quite close.</p>\n<pre><code>def find_nearest_2d(array, value, kind='cdist', output='index'):\n    # 'array' must be a 2D array\n    # 'value' must be a 1D array with 2 elements\n    # 'kind' defines what method to use to calculate the distances. Can choose one\n    #    of 'cdist' (default) or 'euclidean'. Choose 'euclidean' for very large\n    #    arrays. Otherwise, cdist is much faster.\n    # 'output' defines what the output should be. Can be 'index' (default) to return\n    #    the index of the array that is closest to the value, 'value' to return the\n    #    value that is closest, or 'both' to return index,value\n    import numpy as np\n    if kind == 'cdist':\n        try: from scipy.spatial.distance import cdist\n        except ImportError:\n            print(&quot;Warning (find_nearest_2d): Could not import cdist. Reverting to simpler distance calculation&quot;)\n            kind = 'euclidean'\n    index = np.where(array == value)[0] # Make sure the value isn't in the array\n    if index.size == 0:\n        if kind == 'cdist': index = np.argmin(cdist([value],array)[0])\n        elif kind == 'euclidean': index = np.argmin(np.sum((np.array(array)-np.array(value))**2.,axis=1))\n        else: raise ValueError(&quot;Keyword 'kind' must be one of 'cdist' or 'euclidean'&quot;)\n    if output == 'index': return index\n    elif output == 'value': return array[index]\n    elif output == 'both': return index,array[index]\n    else: raise ValueError(&quot;Keyword 'output' must be one of 'index', 'value', or 'both'&quot;)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 15621854,
                        "reputation": 1931,
                        "user_id": 11671779,
                        "user_type": "registered",
                        "display_name": "Muhammad Yasirroni"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1617507272,
                    "creation_date": 1617507272,
                    "answer_id": 66937801,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/66937801#66937801",
                    "body": "<p>For those searching for multiple nearest, modifying the accepted answer:</p>\n<pre><code>import numpy as np\ndef find_nearest(array, value, k):\n    array = np.asarray(array)\n    idx = np.argsort(abs(array - value))[:k]\n    return array[idx]\n</code></pre>\n<p>See:\n<a href=\"https://stackoverflow.com/a/66937734/11671779\">https://stackoverflow.com/a/66937734/11671779</a></p>\n"
                },
                {
                    "owner": {
                        "account_id": 31530,
                        "reputation": 21799,
                        "user_id": 86643,
                        "user_type": "registered",
                        "accept_rate": 45,
                        "display_name": "denis"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1635156140,
                    "last_edit_date": 1635156140,
                    "creation_date": 1633603034,
                    "answer_id": 69479668,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/69479668#69479668",
                    "body": "<p>This one handles any number of queries, using <a href=\"https://numpy.org/doc/stable/reference/generated/numpy.searchsorted.html\" rel=\"nofollow noreferrer\">numpy                                                                                    searchsorted</a>, so after sorting the input arrays, is just as fast.\nIt works on regular grids in 2d, 3d ... too:\n<a href=\"https://i.stack.imgur.com/LAXCn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LAXCn.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>#!/usr/bin/env python3\n# keywords: nearest-neighbor regular-grid python numpy searchsorted Voronoi\n\nimport numpy as np\n\n#...............................................................................\nclass Near_rgrid( object ):\n    &quot;&quot;&quot; nearest neighbors on a Manhattan aka regular grid\n    1d:\n    near = Near_rgrid( x: sorted 1d array )\n    nearix = near.query( q: 1d ) -&gt; indices of the points x_i nearest each q_i\n        x[nearix[0]] is the nearest to q[0]\n        x[nearix[1]] is the nearest to q[1] ...\n        nearpoints = x[nearix] is near q\n    If A is an array of e.g. colors at x[0] x[1] ...,\n    A[nearix] are the values near q[0] q[1] ...\n    Query points &lt; x[0] snap to x[0], similarly &gt; x[-1].\n\n    2d: on a Manhattan aka regular grid,\n        streets running east-west at y_i, avenues north-south at x_j,\n    near = Near_rgrid( y, x: sorted 1d arrays, e.g. latitide longitude )\n    I, J = near.query( q: nq \u00d7 2 array, columns qy qx )\n    -&gt; nq \u00d7 2 indices of the gridpoints y_i x_j nearest each query point\n        gridpoints = np.column_stack(( y[I], x[J] ))  # e.g. street corners\n        diff = gridpoints - querypoints\n        distances = norm( diff, axis=1, ord= )\n    Values at an array A definded at the gridpoints y_i x_j nearest q: A[I,J]\n\n    3d: Near_rgrid( z, y, x: 1d axis arrays ) .query( q: nq \u00d7 3 array )\n\n    See Howitworks below, and the plot Voronoi-random-regular-grid.\n    &quot;&quot;&quot;\n\n    def __init__( self, *axes: &quot;1d arrays&quot; ):\n        axarrays = []\n        for ax in axes:\n            axarray = np.asarray( ax ).squeeze()\n            assert axarray.ndim == 1, &quot;each axis should be 1d, not %s &quot; % (\n                    str( axarray.shape ))\n            axarrays += [axarray]\n        self.midpoints = [_midpoints( ax ) for ax in axarrays]\n        self.axes = axarrays\n        self.ndim = len(axes)\n\n    def query( self, queries: &quot;nq \u00d7 dim points&quot; ) -&gt; &quot;nq \u00d7 dim indices&quot;:\n        &quot;&quot;&quot; -&gt; the indices of the nearest points in the grid &quot;&quot;&quot;\n        queries = np.asarray( queries ).squeeze()  # or list x y z ?\n        if self.ndim == 1:\n            assert queries.ndim &lt;= 1, queries.shape\n            return np.searchsorted( self.midpoints[0], queries )  # scalar, 0d ?\n        queries = np.atleast_2d( queries )\n        assert queries.shape[1] == self.ndim, [\n                queries.shape, self.ndim]\n        return [np.searchsorted( mid, q )  # parallel: k axes, k processors\n                for mid, q in zip( self.midpoints, queries.T )]\n\n    def snaptogrid( self, queries: &quot;nq \u00d7 dim points&quot; ):\n        &quot;&quot;&quot; -&gt; the nearest points in the grid, 2d [[y_j x_i] ...] &quot;&quot;&quot;\n        ix = self.query( queries )\n        if self.ndim == 1:\n            return self.axes[0][ix]\n        else:\n            axix = [ax[j] for ax, j in zip( self.axes, ix )]\n            return np.array( axix )\n\n\ndef _midpoints( points: &quot;array-like 1d, *must be sorted*&quot; ) -&gt; &quot;1d&quot;:\n    points = np.asarray( points ).squeeze()\n    assert points.ndim == 1, points.shape\n    diffs = np.diff( points )\n    assert np.nanmin( diffs ) &gt; 0, &quot;the input array must be sorted, not %s &quot; % (\n            points.round( 2 ))\n    return (points[:-1] + points[1:]) / 2  # floats\n\n#...............................................................................\nHowitworks = \\\n&quot;&quot;&quot;\nHow Near_rgrid works in 1d:\nConsider the midpoints halfway between fenceposts | | |\nThe interval [left midpoint .. | .. right midpoint] is what's nearest each post --\n\n    |   |       |                     |   points\n    | . |   .   |          .          |   midpoints\n      ^^^^^^               .            nearest points[1]\n            ^^^^^^^^^^^^^^^             nearest points[2]  etc.\n\n2d:\n    I, J = Near_rgrid( y, x ).query( q )\n    I = nearest in `x`\n    J = nearest in `y` independently / in parallel.\n    The points nearest [yi xj] in a regular grid (its Voronoi cell)\n    form a rectangle [left mid x .. right mid x] \u00d7 [left mid y .. right mid y]\n    (in any norm ?)\n    See the plot Voronoi-random-regular-grid.\n\nNotes\n-----\nIf a query point is exactly halfway between two data points,\ne.g. on a grid of ints, the lines (x + 1/2) U (y + 1/2),\nwhich &quot;nearest&quot; you get is implementation-dependent, unpredictable.\n\n&quot;&quot;&quot;\n\nMurky = \\\n&quot;&quot;&quot; NaNs in points, in queries ?\n&quot;&quot;&quot;\n\n__version__ = &quot;2021-10-25 oct  denis-bz-py&quot;\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 2785849,
                        "reputation": 97,
                        "user_id": 2397283,
                        "user_type": "registered",
                        "display_name": "MatteoLacki"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1678082482,
                    "creation_date": 1678082482,
                    "answer_id": 75647497,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/75647497#75647497",
                    "body": "<p>I have here a version for sorted inputs, that for a some values in A finds the indices of closest elements in B:</p>\n<pre class=\"lang-py prettyprint-override\"><code>from cmath import inf\n\nimport numba\nimport numpy as np\n\n\n@numba.njit\ndef get_indices_of_closest_questioned_points(\n    interogators: npt.NDArray,\n    questioned: npt.NDArray,\n) -&gt; npt.NDArray:\n    &quot;&quot;&quot;For each element in `interogators` get the index of the closest element in set `questioned`.\n    &quot;&quot;&quot;\n    res = np.empty(shape=interogators.shape, dtype=np.uint32)\n    N = len(interogators)\n    M = len(questioned)\n    n = m = 0\n    closest_left_to_x = -inf\n    while n &lt; N and m &lt; M:\n        x = interogators[n]\n        y = questioned[m]\n        if y &lt; x:\n            closest_left_to_x = y\n            m += 1\n        else:\n            res[n] = m - (x - closest_left_to_x &lt; y - x)\n            n += 1\n    while n &lt; N:\n        res[n] = M - 1\n        n += 1\n    return res\n</code></pre>\n<p>sorting is a heavily optimized operation, that runs in O(nlogn) or O(n) depending on the input and used algorithm.\nAbove code is obviously also O(n), <code>numba</code> makes it run faster to <code>numpy</code> speeds.</p>\n<p>Below an examplary usage:</p>\n<pre><code>In [12]: get_indices_of_closest_questioned_points(np.array([0,5,10]), np.array([-1,2,6,8,9,10]))\nOut[12]: array([0, 2, 5], dtype=uint32)\n</code></pre>\n<p>The result is <code>0 2 5</code> because -1 is closest to 0 and it's the 0th element of the second array, 5 is closest to 6 that is the 2th element in the second array, and so on.</p>\n<p>In case of an input such as <code>[0]</code> and <code>[-1,1]</code>, the first of closest elements, <code>-1</code>, will be returned.</p>\n<p>Best wishes,</p>\n"
                },
                {
                    "owner": {
                        "account_id": 16407690,
                        "reputation": 402,
                        "user_id": 11851843,
                        "user_type": "registered",
                        "display_name": "Titus Buckworth"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1713864082,
                    "creation_date": 1713864082,
                    "answer_id": 78371217,
                    "question_id": 2566412,
                    "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array/78371217#78371217",
                    "body": "<p>Here's a really simple answer that works for different shapes:</p>\n<pre><code>def round_to_nearest_in(a, b):\n    n = len(b)\n    shp = list(a.shape) + [n]\n\n    broad = np.repeat(a, n).reshape((shp))\n    diffs = np.abs(broad - b)\n\n    return b[diffs.argmin(-1)]\n</code></pre>\n<p>For example:</p>\n<pre><code>a = np.random.rand(10).reshape((5,2))\nb = np.array([-1, 0, 1])\nround_to_nearest_in(a, b)\n</code></pre>\n<p>The only caveat is that it will create an intermediate array with size <code>= a.size*len(b)</code> which could get quite large for big <code>a</code> and <code>b</code>.</p>\n"
                }
            ],
            "owner": {
                "account_id": 252935,
                "reputation": 7315,
                "user_id": 307633,
                "user_type": "registered",
                "accept_rate": 80,
                "display_name": "Fookatchu"
            },
            "comment_count": 0,
            "is_answered": true,
            "accepted_answer_id": 2566508,
            "answer_count": 21,
            "score": 490,
            "last_activity_date": 1713864082,
            "creation_date": 1270208303,
            "last_edit_date": 1655694729,
            "question_id": 2566412,
            "link": "https://stackoverflow.com/questions/2566412/find-nearest-value-in-numpy-array",
            "title": "Find nearest value in numpy array",
            "body": "<p>How do I find the <em>nearest value</em> in a numpy array? Example:</p>\n<pre><code>np.find_nearest(array, value)\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9715
}