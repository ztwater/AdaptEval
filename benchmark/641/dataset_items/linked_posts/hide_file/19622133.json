{
    "items": [
        {
            "tags": [
                "python",
                "windows",
                "hide",
                "ctypes",
                "python-2.x"
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 237126,
                                "reputation": 607852,
                                "user_id": 505088,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "David Heffernan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382906590,
                            "post_id": 19622903,
                            "comment_id": 29131721,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29131721_19622903",
                            "body": "Surely this can be done without raw win32 in a platform independent way"
                        },
                        {
                            "owner": {
                                "account_id": 3427184,
                                "reputation": 161,
                                "user_id": 2872661,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "IKA"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382907771,
                            "post_id": 19622903,
                            "comment_id": 29132131,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29132131_19622903",
                            "body": "David Heffernan, how? If it not a secret? :)"
                        },
                        {
                            "owner": {
                                "account_id": 3427184,
                                "reputation": 161,
                                "user_id": 2872661,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "IKA"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382909639,
                            "post_id": 19622903,
                            "comment_id": 29132720,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29132720_19622903",
                            "body": "Just one more qustion - why 0x02 and not just 2?"
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382921673,
                            "post_id": 19622903,
                            "comment_id": 29135941,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29135941_19622903",
                            "body": "I wrote it that way because there&#39;s a <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa365535%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">bunch of other ones</a> that correspond to different bits being on and that&#39;s easier to see in hexadecimal the decimal. Please consider also up-voting my answer if you think it&#39;s worthy."
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "reply_to_user": {
                                "account_id": 237126,
                                "reputation": 607852,
                                "user_id": 505088,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "David Heffernan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382922937,
                            "post_id": 19622903,
                            "comment_id": 29136233,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29136233_19622903",
                            "body": "@David: You might think that, however the only thing in the standard library that would do something like this that I know of is <a href=\"http://docs.python.org/2/library/os.html?highlight=chflags#os.chflags\" rel=\"nofollow noreferrer\"><code>os.chflags()</code></a>, but it&#39;s not available on Windows - I just tried it and got an <code>AttributeError: &#39;module&#39; object has no attribute &#39;chflags&#39;</code>."
                        },
                        {
                            "owner": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382929005,
                            "post_id": 19622903,
                            "comment_id": 29137622,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29137622_19622903",
                            "body": "If you set the function&#39;s <code>argtypes</code> to use <code>ctypes.wintypes.LPCWSTR</code> (i.e. <code>ctypes.c_wchar_p</code>), as should be done anyway, then you can also use a byte string here. In 2.x <code>ctypes.set_conversion_mode</code> can be used to set the conversion <code>encoding</code> and <code>errors</code>. On Windows it defaults to &#39;mbcs&#39; and &#39;ignore&#39;."
                        },
                        {
                            "owner": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1382929270,
                            "post_id": 19622903,
                            "comment_id": 29137707,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29137707_19622903",
                            "body": "Also if the call fails just  <code>raise ctypes.WinError()</code>. The <code>WinError()</code> function defaults to using <code>ctypes.GetLastError</code> and <code>ctypes.FormatError</code> to return a <code>WindowsError</code> exception."
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "reply_to_user": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382930661,
                            "post_id": 19622903,
                            "comment_id": 29138056,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29138056_19622903",
                            "body": "@eryksun: How would you change an existing function&#39;s <code>argtypes</code> (in Python 2.x)?"
                        },
                        {
                            "owner": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1382931389,
                            "post_id": 19622903,
                            "comment_id": 29138225,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29138225_19622903",
                            "body": "<code>argtypes</code> is an attribute of the ctypes function pointer. Just assign a sequence of ctypes data types. The descriptor is implemented by <a href=\"http://hg.python.org/cpython/file/ab05e7dd2788/Modules/_ctypes/_ctypes.c#l3083\" rel=\"nofollow noreferrer\"><code>PyCFuncPtr_set_argtypes</code></a> and <a href=\"http://hg.python.org/cpython/file/ab05e7dd2788/Modules/_ctypes/_ctypes.c#l3106\" rel=\"nofollow noreferrer\"><code>PyCFuncPtr_get_argtypes</code></a>."
                        },
                        {
                            "owner": {
                                "account_id": 3427184,
                                "reputation": 161,
                                "user_id": 2872661,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "IKA"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382945345,
                            "post_id": 19622903,
                            "comment_id": 29141971,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29141971_19622903",
                            "body": "As BSD general command CHFLAGS works fine on OS X. CHFLAGS HIDDEN ~/PathToFolder."
                        },
                        {
                            "owner": {
                                "account_id": 3427184,
                                "reputation": 161,
                                "user_id": 2872661,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "IKA"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382945682,
                            "post_id": 19622903,
                            "comment_id": 29142103,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29142103_19622903",
                            "body": "@martineau, Your answer is very useful and it solved my problem and I would like to vote up but my reputation don&#39;t permit this action(need 15)"
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "reply_to_user": {
                                "account_id": 3427184,
                                "reputation": 161,
                                "user_id": 2872661,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "IKA"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382946262,
                            "post_id": 19622903,
                            "comment_id": 29142321,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29142321_19622903",
                            "body": "@iRex&quot; Yes, <code>os.chflags()</code> works on Unix and derivative OSs. I understand about the lack of rep issue -- no worries."
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382947135,
                            "post_id": 19622903,
                            "comment_id": 29142635,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29142635_19622903",
                            "body": "FWIW, raising <code>ctypes.WinError()</code> when the return code is zero results in the error message: <code>WindowsError: [Error 123] The filename, directory name, or volume label syntax is incorrect</code> being printed, so I have to agree that might be an easier way to handle call failures."
                        },
                        {
                            "owner": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382955720,
                            "post_id": 19622903,
                            "comment_id": 29146769,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29146769_19622903",
                            "body": "<code>windll</code> is a <code>LibraryLoader</code> for <code>WinDLL</code>, which subclasses <code>CDLL</code>. Its <code>__getattr__</code> binds a function pointer that has <code>restype == c_int</code> and <code>argtypes == None</code>. There are defaults for converting some built-in Python objects as arguments, but explicit is better, and often necessary."
                        },
                        {
                            "owner": {
                                "account_id": 145428,
                                "reputation": 121960,
                                "user_id": 355230,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "martineau"
                            },
                            "reply_to_user": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1382971418,
                            "post_id": 19622903,
                            "comment_id": 29156315,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29156315_19622903",
                            "body": "@eryksun: That sounds fine as a default for an unknown API function, but it seems like the user-base is large enough and the API stable enough for the proper argument types of most if not all known functions to have done already -- rather than everyone having to reinvent the wheel whenever they want to use one from Python."
                        },
                        {
                            "owner": {
                                "account_id": 71068,
                                "reputation": 33830,
                                "user_id": 205580,
                                "user_type": "registered",
                                "display_name": "Eryk Sun"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1382973300,
                            "post_id": 19622903,
                            "comment_id": 29157521,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment29157521_19622903",
                            "body": "It sounds like you want something like <a href=\"https://bitbucket.org/jaraco/jaraco.windows/overview\" rel=\"nofollow noreferrer\"><code>jaraco.windows</code></a>. I haven&#39;t used it. PyWin32 also works, but it&#39;s a big dependency: <code>win32file.SetFileAttributes(r&#39;G:\\Dir\\folder1&#39;, win32file.FILE_ATTRIBUTE_HIDDEN)</code>."
                        },
                        {
                            "owner": {
                                "account_id": 2595965,
                                "reputation": 1740,
                                "user_id": 2769997,
                                "user_type": "registered",
                                "display_name": "Tahlor"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1498229767,
                            "post_id": 19622903,
                            "comment_id": 76431322,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment76431322_19622903",
                            "body": "Using os.walk I think returns windows-1252 path strings for me, I&#39;m using path.decode(&quot;windows-1252&quot;) to get the unicode path."
                        },
                        {
                            "owner": {
                                "account_id": 103824,
                                "reputation": 1268,
                                "user_id": 277882,
                                "user_type": "registered",
                                "display_name": "ntninja"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1583866541,
                            "post_id": 19622903,
                            "comment_id": 107255074,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#comment107255074_19622903",
                            "body": "Can anybody verify that the Unicode variant still works in Python 3, it seems sketchy to me at best? (Python 3.3+ will alternative the internal Unicode representation based on the storage requirements of the largest scalar value [\u201ccharacter\u201d], hence the question.)"
                        }
                    ],
                    "owner": {
                        "account_id": 145428,
                        "reputation": 121960,
                        "user_id": 355230,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "martineau"
                    },
                    "comment_count": 18,
                    "is_accepted": true,
                    "score": 13,
                    "last_activity_date": 1612548644,
                    "last_edit_date": 1612548644,
                    "creation_date": 1382904412,
                    "answer_id": 19622903,
                    "question_id": 19622133,
                    "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/19622903#19622903",
                    "body": "<p>There are two things wrong with your code, both having to do with the folder name literal. The <code>SetFileAttributesW()</code> function requires a Unicode string argument. You can specify one of those by prefixing a string with the character <code>u</code>. Secondly, any literal backslash characters in the string will have to be doubled or you could [also] add an <code>r</code> prefix to it. A dual prefix is used in the code immediately below.</p>\n<pre><code>import ctypes\nFILE_ATTRIBUTE_HIDDEN = 0x02\n\nret = ctypes.windll.kernel32.SetFileAttributesW(ur'G:\\Dir\\folder1',\n                                                FILE_ATTRIBUTE_HIDDEN)\nif ret:\n    print('attribute set to Hidden')\nelse:  # return code of zero indicates failure -- raise a Windows error\n    raise ctypes.WinError()\n</code></pre>\n<p>You can find Windows' system error codes <a href=\"https://learn.microsoft.com/en-us/windows/win32/debug/system-error-codes\" rel=\"nofollow noreferrer\">here</a>. To see the results of the attribute change in Explorer, make sure its &quot;Show hidden files&quot; option <em>isn't</em> enabled.</p>\n<p>To illustrate what @Eryk Sun said in a comment about arranging for the conversion to Unicode from byte strings to happen automatically, you would need to perform the following assignment <em>before</em> calling the function to specify the proper conversion of its arguments. @Eryk Sun also has an explanation for why this isn't the default for pointers-to-strings in the <code>W</code> versions of the WinAPI functions -- see the comments.</p>\n<pre><code>ctypes.windll.kernel32.SetFileAttributesW.argtypes = (ctypes.c_wchar_p, ctypes.c_uint32)\n</code></pre>\n<p>Then, after doing that, the following will work (note that an <code>r</code> prefix is still required due to the backslashes):</p>\n<pre><code>ret = ctypes.windll.kernel32.SetFileAttributesW(r'G:\\Dir\\folder1',\n                                                FILE_ATTRIBUTE_HIDDEN)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 103824,
                                "reputation": 1268,
                                "user_id": 277882,
                                "user_type": "registered",
                                "display_name": "ntninja"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1583866323,
                            "post_id": 43154373,
                            "comment_id": 107254962,
                            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/43154373#comment107254962_43154373",
                            "body": "downvote as this contains an obvious shell injection"
                        }
                    ],
                    "owner": {
                        "account_id": 10590056,
                        "reputation": 29,
                        "user_id": 7800966,
                        "user_type": "unregistered",
                        "display_name": "Nightwing"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1520979572,
                    "last_edit_date": 1520979572,
                    "creation_date": 1491033902,
                    "answer_id": 43154373,
                    "question_id": 19622133,
                    "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os/43154373#43154373",
                    "body": "<p>Try this code:</p>\n\n<pre><code>import os\nos.system(\"attrib +h \" + \"your file name\")\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 3427184,
                "reputation": 161,
                "user_id": 2872661,
                "user_type": "registered",
                "accept_rate": 82,
                "display_name": "IKA"
            },
            "comment_count": 0,
            "is_answered": true,
            "accepted_answer_id": 19622903,
            "answer_count": 2,
            "score": 5,
            "last_activity_date": 1615210692,
            "creation_date": 1382900465,
            "last_edit_date": 1615210692,
            "question_id": 19622133,
            "link": "https://stackoverflow.com/questions/19622133/set-hide-attribute-on-folders-in-windows-os",
            "title": "Set &quot;hide&quot; attribute on folders in windows OS?",
            "body": "<p>Trying to hide folder without success. I've found this :</p>\n\n<pre><code>import ctypes\nctypes.windll.kernel32.SetFileAttributesW('G:\\Dir\\folder1', 2)\n</code></pre>\n\n<p>but it did not work for me. What am I doing wrong?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 8890
}