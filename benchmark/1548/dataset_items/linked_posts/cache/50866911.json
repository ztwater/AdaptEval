{
    "items": [
        {
            "tags": [
                "python",
                "caching"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 4258097,
                        "reputation": 50870,
                        "user_id": 3483203,
                        "user_type": "registered",
                        "accept_rate": 78,
                        "display_name": "user3483203"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1529016303,
                    "post_id": 50866911,
                    "comment_id": 88736072,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736072_50866911",
                    "body": "If you&#39;re on a unix based system, I would recommend using <code>cron</code> to handle this."
                },
                {
                    "owner": {
                        "account_id": 4796820,
                        "reputation": 1588,
                        "user_id": 3874512,
                        "user_type": "registered",
                        "display_name": "BowlingHawk95"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1529016304,
                    "post_id": 50866911,
                    "comment_id": 88736073,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736073_50866911",
                    "body": "What&#39;s the reason for not liking <code>lru_cache</code>?  It&#39;s oriented around the number of calls rather than time duration, but that&#39;s not a huge difference.  If nothing else, you could look at the implementation of <code>lru_cache</code> for ideas on how to write your own."
                },
                {
                    "owner": {
                        "account_id": 3217674,
                        "reputation": 971,
                        "user_id": 2715898,
                        "user_type": "registered",
                        "accept_rate": 58,
                        "display_name": "user2715898"
                    },
                    "reply_to_user": {
                        "account_id": 4258097,
                        "reputation": 50870,
                        "user_id": 3483203,
                        "user_type": "registered",
                        "accept_rate": 78,
                        "display_name": "user3483203"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1529016461,
                    "post_id": 50866911,
                    "comment_id": 88736121,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736121_50866911",
                    "body": "not on unix sadly @user"
                },
                {
                    "owner": {
                        "account_id": 3217674,
                        "reputation": 971,
                        "user_id": 2715898,
                        "user_type": "registered",
                        "accept_rate": 58,
                        "display_name": "user2715898"
                    },
                    "reply_to_user": {
                        "account_id": 4796820,
                        "reputation": 1588,
                        "user_id": 3874512,
                        "user_type": "registered",
                        "display_name": "BowlingHawk95"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1529016520,
                    "post_id": 50866911,
                    "comment_id": 88736137,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736137_50866911",
                    "body": "@BowlingHawk95 looking for ideas if there is already something implemented along these lines rather than writing my own stuff"
                },
                {
                    "owner": {
                        "account_id": 258701,
                        "reputation": 112482,
                        "user_id": 541038,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "display_name": "Joran Beasley"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1529016539,
                    "post_id": 50866911,
                    "comment_id": 88736141,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736141_50866911",
                    "body": "what have you tried ? can you cache it forever and you dont know how to add a timelimit? start by caching it forever"
                },
                {
                    "owner": {
                        "account_id": 258701,
                        "reputation": 112482,
                        "user_id": 541038,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "display_name": "Joran Beasley"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1529016573,
                    "post_id": 50866911,
                    "comment_id": 88736149,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment88736149_50866911",
                    "body": "@user2715898 google &quot;python memoization decorator&quot; hopefully you can take one of the existing solutions and understand it ... and figure out how you might add a timelimit"
                },
                {
                    "owner": {
                        "account_id": 2078887,
                        "reputation": 149359,
                        "user_id": 1906307,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "Louis"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1567179780,
                    "post_id": 50866911,
                    "comment_id": 101899766,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python#comment101899766_50866911",
                    "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31771286/python-in-memory-cache-with-time-to-live\">Python in-memory cache with time to live</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529016789,
                            "post_id": 50866968,
                            "comment_id": 88736210,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#comment88736210_50866968",
                            "body": "this works fine assuming you don&#39;t want to cache multiple results for different arguments to the function.  Would highly recommend 1. turning this into a decorator to wrap around a function doing the computation and 2. turning that decorator into an instance of a class with a <code>__call__</code> implementation, so that way the statefulness of the cache is hidden inside a object&#39;s member variables rather than globals."
                        },
                        {
                            "owner": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "reply_to_user": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529016887,
                            "post_id": 50866968,
                            "comment_id": 88736235,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#comment88736235_50866968",
                            "body": "@BowlingHawk95 Sure, I wrote the simplest version first because that&#39;s what the OP explicitly asked for."
                        },
                        {
                            "owner": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017011,
                            "post_id": 50866968,
                            "comment_id": 88736261,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#comment88736261_50866968",
                            "body": "right, hence why I didn&#39;t downvote; just proposing improvements :) see Joran&#39;s answer above"
                        },
                        {
                            "owner": {
                                "account_id": 258701,
                                "reputation": 112482,
                                "user_id": 541038,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Joran Beasley"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017034,
                            "post_id": 50866968,
                            "comment_id": 88736262,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#comment88736262_50866968",
                            "body": "oooo fancy ... nonlocal (first time ive actually seen that ...thats cool) (also this doesnt really account for function args kwargs ... but im sure you know that and can easily extend it to (ie different args = different cache value)"
                        },
                        {
                            "owner": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "reply_to_user": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017307,
                            "post_id": 50866968,
                            "comment_id": 88736329,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#comment88736329_50866968",
                            "body": "@BowlingHawk95 OK, I added first a decorator, then a version that handles args and kwargs if they&#39;re all hashable, then some comments on what other features you might want and how to find most of them in the <code>lru_cache</code> source, because I&#39;m not going to keep going until I include every feature anyone might want."
                        }
                    ],
                    "owner": {
                        "account_id": 808621,
                        "reputation": 360780,
                        "user_id": 908494,
                        "user_type": "registered",
                        "accept_rate": 25,
                        "display_name": "abarnert"
                    },
                    "comment_count": 5,
                    "is_accepted": true,
                    "score": 12,
                    "last_activity_date": 1529017853,
                    "last_edit_date": 1529017853,
                    "creation_date": 1529016591,
                    "answer_id": 50866968,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50866968#50866968",
                    "body": "<p>Building a single-element cache with a time-to-live is pretty trivial:</p>\n\n<pre><code>_last_result_time = None\n_last_result_value = None\ndef result(val):\n    global _last_result_time\n    global _last_result_value\n    now = datetime.datetime.now()\n    if not _last_result_time or now - _last_result_time &gt; datetime.timedelta(hours=1):\n        _last_result_value = &lt;expensive computation here&gt;\n        _last_result_time = now\n    return _last_result_value\n</code></pre>\n\n<p>If you want to generalize this as a decorator, it's not much harder:</p>\n\n<pre><code>def cache(ttl=datetime.timedelta(hours=1)):\n    def wrap(func):\n        time, value = None, None\n        @functools.wraps(func)\n        def wrapped(*args, **kw):\n            nonlocal time\n            nonlocal value\n            now = datetime.datetime.now()\n            if not time or now - time &gt; ttl:\n                value = func(*args, **kw)\n                time = now\n            return value\n        return wrapped\n    return wrap\n</code></pre>\n\n<p>If you want it to handle different arguments, storing a time-to-live for each one:</p>\n\n<pre><code>def cache(ttl=datetime.timedelta(hours=1)):\n    def wrap(func):\n        cache = {}\n        @functools.wraps(func)\n        def wrapped(*args, **kw):\n            now = datetime.datetime.now()\n            # see lru_cache for fancier alternatives\n            key = tuple(args), frozenset(kw.items()) \n            if key not in cache or now - cache[key][0] &gt; ttl:\n                value = func(*args, **kw)\n                cache[key] = (now, value)\n            return cache[key][1]\n        return wrapped\n    return wrap\n</code></pre>\n\n<p>You can of course key adding features to it\u2014give it a max size and evict by time of storage or by LRU or whatever else you want, expose cache stats as attributes on the decorated function, etc. The implementation of <a href=\"https://github.com/python/cpython/blob/3.6/Lib/functools.py#L448\" rel=\"noreferrer\"><code>lru_cache</code></a> in the stdlib should help show you how to do most of the trickier things (since it does almost all of them).</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017198,
                            "post_id": 50867000,
                            "comment_id": 88736309,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736309_50867000",
                            "body": "The recursive setup with <code>partial</code> is clever, but IMO uglier than just having another layer of closure.  You&#39;re now allowing <code>cache</code> to be called in two different ways: <code>cache(time_to_live=___)(function)</code> or <code>cache(function, time_to_live=___)</code>.  Just a matter of taste, though, and I like the solution."
                        },
                        {
                            "owner": {
                                "account_id": 258701,
                                "reputation": 112482,
                                "user_id": 541038,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Joran Beasley"
                            },
                            "reply_to_user": {
                                "account_id": 4796820,
                                "reputation": 1588,
                                "user_id": 3874512,
                                "user_type": "registered",
                                "display_name": "BowlingHawk95"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017362,
                            "post_id": 50867000,
                            "comment_id": 88736336,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736336_50867000",
                            "body": "you sould only really call it as <code>@cache</code> or <code>@cache(time_to_live=1000)</code> ... but yeah you have a good point ... i dislike nesting functions ... and in general i like this as a solution so I always use it when accepting kwargs for a decorator (I <b>DISLIKE</b> <code>@cache(1000)</code> and want to not allow it)"
                        },
                        {
                            "owner": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1529017513,
                            "post_id": 50867000,
                            "comment_id": 88736373,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736373_50867000",
                            "body": "If you want to ban <code>@cache(1000)</code>, this doesn&#39;t do so nearly as clearly as making <code>time_to_live</code> a keyword-only parameter."
                        },
                        {
                            "owner": {
                                "account_id": 258701,
                                "reputation": 112482,
                                "user_id": 541038,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Joran Beasley"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017531,
                            "post_id": 50867000,
                            "comment_id": 88736376,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736376_50867000",
                            "body": "but then you need a pyhton that supports that :P (which TBH they should have... but theres no guarantee or indication from the problem statement)"
                        },
                        {
                            "owner": {
                                "account_id": 258701,
                                "reputation": 112482,
                                "user_id": 541038,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Joran Beasley"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017685,
                            "post_id": 50867000,
                            "comment_id": 88736404,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736404_50867000",
                            "body": "Im also not sure i agree <code>def cache(*ignore, time_to_live=XXX)</code> is actually any more clear"
                        },
                        {
                            "owner": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1529017689,
                            "post_id": 50867000,
                            "comment_id": 88736406,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736406_50867000",
                            "body": "@JoranBeasley I assumed you were writing for Python 3, because before 3.6+, <code>kwargs</code> is explicitly in arbitrary order, so you either want <code>tuple(sorted(kwargs.items()))</code> or <code>frozenset(kwargs.items())</code>. And also because it&#39;s not 2008 anymore."
                        },
                        {
                            "owner": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017808,
                            "post_id": 50867000,
                            "comment_id": 88736428,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736428_50867000",
                            "body": "Not <code>*ignore</code>, just <code>*</code>; there&#39;s no reason to allow but ignore extra positional arguments just because you want keyword-only arguments."
                        },
                        {
                            "owner": {
                                "account_id": 258701,
                                "reputation": 112482,
                                "user_id": 541038,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Joran Beasley"
                            },
                            "reply_to_user": {
                                "account_id": 808621,
                                "reputation": 360780,
                                "user_id": 908494,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "abarnert"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529017846,
                            "post_id": 50867000,
                            "comment_id": 88736434,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#comment88736434_50867000",
                            "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173182/discussion-between-joran-beasley-and-abarnert\">continue this discussion in chat</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 258701,
                        "reputation": 112482,
                        "user_id": 541038,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "display_name": "Joran Beasley"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 7,
                    "last_activity_date": 1529018657,
                    "last_edit_date": 1529018657,
                    "creation_date": 1529016848,
                    "answer_id": 50867000,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867000#50867000",
                    "body": "<p>A decorator usually solves this nicely</p>\n\n<pre><code>def cache(fn=None,time_to_live=3600*24): # one DAY default (or whatever)\n    if not fn: return functools.partial(cache,time_to_live=time_to_live)\n    my_cache = {}\n    def _inner_fn(*args,**kwargs)\n        kws = sorted(kwargs.items()) # in python3.6+ you dont need sorted\n        key = tuple(args)+tuple(kw) \n        if key not in my_cache or time.time() &gt; my_cache[key]['expires']:\n               my_cache[key] = {\"value\":fn(*args,**kwargs),\"expires\":time.time()+ time_to_live}\n        return my_cache[key]\n    return __inner_fn\n\n@cache(time_to_live=3600) # an hour\ndef my_sqrt(x):\n    return x**0.5\n\n@cache(time_to_live=60*30) # 30 mins\ndef get_new_emails():\n    return my_stmp.get_email_count()\n</code></pre>\n\n<p>as an aside this is built into memcache and that may be a better solution (im not sure what problem domain you are working in)</p>\n\n<p>you can use nested functions also </p>\n\n<pre><code>def cache(time_to_live=3600*24): # one DAY default (or whatever)\n    def _wrap(fn):\n        my_cache = {}\n        def _inner_fn(*args,**kwargs)\n            kws = sorted(kwargs.items()) # in python3.6+ you dont need sorted\n            key = tuple(args)+tuple(kw) \n            if key not in my_cache or time.time() &gt; my_cache[key]['expires']:\n                 my_cache[key] = {\"value\":fn(*args,**kwargs),\"expires\":time.time()+ time_to_live}\n            return my_cache[key]\n         return _inner_fn\n    return _wrap\n</code></pre>\n"
                },
                {
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user8008353"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1529017699,
                    "last_edit_date": 1529017699,
                    "creation_date": 1529016935,
                    "answer_id": 50867008,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/50867008#50867008",
                    "body": "<p>Create a function that acts as a cache, we'll call it <code>result_cacher</code>.</p>\n\n<pre><code>import time \nlastResultCache = 0 \nresultCache = None\ndef result_cacher():\n    if time.time() - lastResultCache &gt;= 3600: #Checks if 3600 sec (1 hour) has passed since the last cache \n        lastResultCache = time.time()\n        resultCache = result()\n    return resultCache \n</code></pre>\n\n<p>This function checks if an hour has passed, updates the cache if it has, and then returns the cache.</p>\n\n<p>If you want to apply the caching for each individual input instead of for whenever the function is called, use dictionaries for <code>lastResultCache</code> and <code>resultCache</code>.</p>\n\n<pre><code>import time \nlastResultCache = {}\nresultCache = {}\ndef result_cacher(val):\n    #.get() gets value for key from dict, but if the key is not in the dict, it returns 0\n    if time.time() - lastResultCache.get(val, 0) &gt;= 3600: #Checks if 3600 sec (1 hour) has passed since the last cache \n        lastResultCache[val] = time.time()\n        resultCache[val] = result(val)\n    return resultCache.get(val)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 441885,
                        "reputation": 60711,
                        "user_id": 832230,
                        "user_type": "registered",
                        "display_name": "Asclepius"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 30,
                    "last_activity_date": 1556555229,
                    "last_edit_date": 1556555229,
                    "creation_date": 1548375078,
                    "answer_id": 54357266,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/54357266#54357266",
                    "body": "<p>The <a href=\"https://cachetools.readthedocs.io/en/latest/#cachetools.func.ttl_cache\" rel=\"noreferrer\"><code>ttl_cache</code></a> decorator in <a href=\"https://pypi.org/project/cachetools\" rel=\"noreferrer\"><code>cachetools==3.1.0</code></a> works a lot like <a href=\"https://docs.python.org/3/library/functools.html#functools.lru_cache\" rel=\"noreferrer\"><code>functools.lru_cache</code></a>, but with a <a href=\"https://en.wikipedia.org/wiki/Time_to_live\" rel=\"noreferrer\">time to live</a>.</p>\n\n<pre><code>import cachetools.func\n\n@cachetools.func.ttl_cache(maxsize=128, ttl=10 * 60)\ndef example_function(key):\n    return get_expensively_computed_value(key)\n\n\nclass ExampleClass:\n    EXP = 2\n\n    @classmethod\n    @cachetools.func.ttl_cache()\n    def example_classmethod(cls, i):\n        return i* cls.EXP\n\n    @staticmethod\n    @cachetools.func.ttl_cache()\n    def example_staticmethod(i):\n        return i * 3\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1992538,
                        "reputation": 1014,
                        "user_id": 1786241,
                        "user_type": "registered",
                        "display_name": "youknowone"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1557233126,
                    "creation_date": 1557233126,
                    "answer_id": 56022954,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/56022954#56022954",
                    "body": "<p>A solution using <a href=\"https://ring-cache.readthedocs.io/en/stable/\" rel=\"nofollow noreferrer\"><code>ring</code></a></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>@ring.lru(expire=60*60)  # seconds\ndef cached_function(keys):\n    return ...\n</code></pre>\n\n<p>If you don't need LRU policy,</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>@ring.dict(expire=60*60)  # seconds\ndef cached_function(keys):\n    return ...\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4727647,
                                "reputation": 569,
                                "user_id": 3824093,
                                "user_type": "registered",
                                "display_name": "csm10495"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1646549240,
                            "post_id": 68951862,
                            "comment_id": 126147981,
                            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/68951862#comment126147981_68951862",
                            "body": "This answer is interesting but it doesn&#39;t actually delete the cached item unless someone runs the loop. In other words if it falls into the get_event_loop block, unless you start the loop, the cache won&#39;t expire."
                        }
                    ],
                    "owner": {
                        "account_id": 19275031,
                        "reputation": 1869,
                        "user_id": 14088251,
                        "user_type": "registered",
                        "display_name": "Jonathan1609"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": -1,
                    "last_activity_date": 1630060034,
                    "creation_date": 1630060034,
                    "answer_id": 68951862,
                    "question_id": 50866911,
                    "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python/68951862#68951862",
                    "body": "<p>You can create a mechanism like this:</p>\n<pre class=\"lang-py prettyprint-override\"><code>from asyncio import get_running_loop, get_event_loop\nfrom functools import partial\n\n\nclass Cache(dict):\n    def __init__(self, default_time, loop=None, *args, **kwargs):\n        if not loop:\n            try:\n                loop = get_running_loop()\n            except RuntimeError:\n                loop = get_event_loop()\n        self.loop = loop\n        self.default_time = default_time\n        super().__init__(*args, **kwargs)\n\n    def insert(self, key, value, ttl: int = -1):\n        if ttl == -1:\n            ttl = self.default_time\n\n        self[key] = value\n        self.loop.call_later(ttl, partial(self.delete, key))\n\n    def delete(self, key):\n        del self[key]\n</code></pre>\n<p>Which lets you create a cache along with your async application.\nAll you need to do is:</p>\n<pre class=\"lang-py prettyprint-override\"><code>TTL = 60 * 60 # one hour\ncache = Cache(TTL)\ncache.insert(key, value)\n\n# check again after an hour\n\nif key in cache:\n    print(cache[key])\n</code></pre>\n<p>The key will disappear automatically from the cache (dictionary) after the TTL.</p>\n<p>Well, it doesn't have to be with an async application, just the mechanism of the TTL is async.</p>\n"
                }
            ],
            "owner": {
                "account_id": 3217674,
                "reputation": 971,
                "user_id": 2715898,
                "user_type": "registered",
                "accept_rate": 58,
                "display_name": "user2715898"
            },
            "comment_count": 7,
            "is_answered": true,
            "accepted_answer_id": 50866968,
            "answer_count": 6,
            "score": 10,
            "last_activity_date": 1630060034,
            "creation_date": 1529016109,
            "last_edit_date": 1548375155,
            "question_id": 50866911,
            "link": "https://stackoverflow.com/questions/50866911/caching-in-memory-with-a-time-limit-in-python",
            "title": "Caching in-memory with a time limit in python",
            "body": "<p>I have a function that returns a list, say list_x.</p>\n\n<pre><code>def result(val):\n    ..\n    return(list_x)\n</code></pre>\n\n<p>I am calling result() every minute and storing the list.</p>\n\n<pre><code>def other_func():\n    #called every minute\n    new_list = result(val)\n</code></pre>\n\n<p>I would like to store the value of new_list for an hour (in some sort of in-memory cache may be?) and then update it again, basically call results() after an hour and not every minute.I read about functools.lru_cache but that will not help here I think. Any ideas?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7033
}