{
    "items": [
        {
            "tags": [
                "python",
                "amazon-web-services",
                "amazon-s3",
                "download",
                "boto3"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 11865327,
                        "reputation": 77,
                        "user_id": 8682996,
                        "user_type": "registered",
                        "display_name": "Yoav Gaudin"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1523441424,
                    "post_id": 49772151,
                    "comment_id": 86559492,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3#comment86559492_49772151",
                    "body": "Possibly duplicate- <a href=\"https://stackoverflow.com/questions/31918960/boto3-to-download-all-files-from-a-s3-bucket/31960438\" title=\"boto3 to download all files from a s3 bucket\">stackoverflow.com/questions/31918960/&hellip;</a>"
                },
                {
                    "owner": {
                        "account_id": 76648,
                        "reputation": 5144,
                        "user_id": 219265,
                        "user_type": "registered",
                        "accept_rate": 80,
                        "display_name": "Vincent de Lagabbe"
                    },
                    "edited": false,
                    "score": 3,
                    "creation_date": 1548253583,
                    "post_id": 49772151,
                    "comment_id": 95476729,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3#comment95476729_49772151",
                    "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31918960/boto3-to-download-all-files-from-a-s3-bucket\">Boto3 to download all files from a S3 Bucket</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2177468,
                                "reputation": 2122,
                                "user_id": 1927794,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Arkady"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1561623491,
                            "post_id": 54672690,
                            "comment_id": 100127643,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment100127643_54672690",
                            "body": "But you didn&#39;t set credentials!"
                        },
                        {
                            "owner": {
                                "account_id": 13593235,
                                "reputation": 1350,
                                "user_id": 9806031,
                                "user_type": "registered",
                                "display_name": "Konstantinos Katsantonis"
                            },
                            "reply_to_user": {
                                "account_id": 2177468,
                                "reputation": 2122,
                                "user_id": 1927794,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Arkady"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1561630328,
                            "post_id": 54672690,
                            "comment_id": 100131699,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment100131699_54672690",
                            "body": "@Arkady  The credentials are set under ~/.aws/credentials or as Environment variables  You can find more info <a href=\"https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html\" rel=\"nofollow noreferrer\">here</a>"
                        },
                        {
                            "owner": {
                                "account_id": 9736846,
                                "reputation": 369,
                                "user_id": 7219837,
                                "user_type": "registered",
                                "display_name": "Patrick P&#246;tz"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1570626061,
                            "post_id": 54672690,
                            "comment_id": 102971600,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment102971600_54672690",
                            "body": "Credentials can be set in different ways. See <a href=\"https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html?highlight=credentials\" rel=\"nofollow noreferrer\">boto3.amazonaws.com/v1/documentation/api/latest/guide/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 8712167,
                                "reputation": 521,
                                "user_id": 6518026,
                                "user_type": "registered",
                                "display_name": "Vidura Dantanarayana"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1579585878,
                            "post_id": 54672690,
                            "comment_id": 105805094,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment105805094_54672690",
                            "body": "you can declare aws credentials when creating s3 resource as following   <code>s3_resource = boto3.resource(&#39;s3&#39;, aws_access_key_id=access_key, aws_secret_access_key=secret_key) </code>"
                        },
                        {
                            "owner": {
                                "account_id": 6526463,
                                "reputation": 1150,
                                "user_id": 7042945,
                                "user_type": "registered",
                                "display_name": "Dinero"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1602004863,
                            "post_id": 54672690,
                            "comment_id": 113580555,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment113580555_54672690",
                            "body": "I posted a similar question <a href=\"https://stackoverflow.com/questions/64226700/download-entire-content-of-a-subfolder-in-a-s3-bucket\" title=\"download entire content of a subfolder in a s3 bucket\">stackoverflow.com/questions/64226700/&hellip;</a> is your suggested answer the best way i can solve my problem ?"
                        },
                        {
                            "owner": {
                                "account_id": 13593235,
                                "reputation": 1350,
                                "user_id": 9806031,
                                "user_type": "registered",
                                "display_name": "Konstantinos Katsantonis"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1602070663,
                            "post_id": 54672690,
                            "comment_id": 113602108,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment113602108_54672690",
                            "body": "Well there is almost never absolute best :)."
                        },
                        {
                            "owner": {
                                "account_id": 2048169,
                                "reputation": 895,
                                "user_id": 1827796,
                                "user_type": "registered",
                                "display_name": "Ioannis Tsiokos"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1603870670,
                            "post_id": 54672690,
                            "comment_id": 114169724,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment114169724_54672690",
                            "body": "to make this recursive (for directories inside directories), only download file if not obj.key.endswith(&#39;/&#39;):"
                        },
                        {
                            "owner": {
                                "account_id": 543843,
                                "reputation": 26164,
                                "user_id": 913098,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Gulzar"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1672143933,
                            "post_id": 54672690,
                            "comment_id": 132228300,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#comment132228300_54672690",
                            "body": "This is exactly what I was trying to avoid when looking this up"
                        }
                    ],
                    "owner": {
                        "account_id": 13593235,
                        "reputation": 1350,
                        "user_id": 9806031,
                        "user_type": "registered",
                        "display_name": "Konstantinos Katsantonis"
                    },
                    "comment_count": 8,
                    "is_accepted": true,
                    "score": 96,
                    "last_activity_date": 1597672911,
                    "last_edit_date": 1597672911,
                    "creation_date": 1550068499,
                    "answer_id": 54672690,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/54672690#54672690",
                    "body": "<p>quick and dirty but it works:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import boto3\nimport os \n\ndef downloadDirectoryFroms3(bucketName, remoteDirectoryName):\n    s3_resource = boto3.resource('s3')\n    bucket = s3_resource.Bucket(bucketName) \n    for obj in bucket.objects.filter(Prefix = remoteDirectoryName):\n        if not os.path.exists(os.path.dirname(obj.key)):\n            os.makedirs(os.path.dirname(obj.key))\n        bucket.download_file(obj.key, obj.key) # save to same path\n</code></pre>\n<p>Assuming you want to download the directory foo/bar from s3 then the for-loop will iterate all the files whose path starts with the Prefix=foo/bar.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 16102064,
                                "reputation": 437,
                                "user_id": 11622551,
                                "user_type": "registered",
                                "display_name": "Zach Rieck"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1595962920,
                            "post_id": 61187665,
                            "comment_id": 111654485,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/61187665#comment111654485_61187665",
                            "body": "Better to avoid putting your keys in your code file. At worst, you can put your keys in a separate protected file and import them. It&#39;s also possible to use boto3 without any credentials cached and instead use either s3fs or just rely on the config file (<a href=\"https://www.reddit.com/r/aws/comments/73212m/has_anyone_found_a_way_to_hide_boto3_credentials/\" rel=\"nofollow noreferrer\">reddit.com/r/aws/comments/73212m/&hellip;</a>)"
                        }
                    ],
                    "owner": {
                        "account_id": 8920579,
                        "reputation": 605,
                        "user_id": 6657314,
                        "user_type": "registered",
                        "display_name": "Soulduck"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1586780104,
                    "creation_date": 1586780104,
                    "answer_id": 61187665,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/61187665#61187665",
                    "body": "<p>Using <code>boto3</code> you can set aws credentials and download dataset from S3</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import boto3\nimport os \n\n# set aws credentials \ns3r = boto3.resource('s3', aws_access_key_id='xxxxxxxxxxxxxxxxx',\n    aws_secret_access_key='xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')\nbucket = s3r.Bucket('bucket_name')\n\n# downloading folder \nprefix = 'dirname'\nfor object in bucket.objects.filter(Prefix = 'dirname'):\n    if object.key == prefix:\n        os.makedirs(os.path.dirname(object.key), exist_ok=True)\n        continue;\n    bucket.download_file(object.key, object.key)\n</code></pre>\n\n<p>If you cannot find ur <code>access_key</code> and <code>secret_access_key</code>, refer to this <a href=\"https://aws.amazon.com/ko/blogs/security/wheres-my-secret-access-key/\" rel=\"noreferrer\">page </a> <br>\nI hope it will helps. <br>\nthank you.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 2826975,
                        "reputation": 1231,
                        "user_id": 2429426,
                        "user_type": "registered",
                        "display_name": "bjc"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 53,
                    "last_activity_date": 1712354913,
                    "last_edit_date": 1712354913,
                    "creation_date": 1594947175,
                    "answer_id": 62945526,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/62945526#62945526",
                    "body": "<p>A slightly less dirty modification of the accepted answer by Konstantinos Katsantonis:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import boto3\nimport os\ns3 = boto3.resource('s3') # assumes credentials &amp; configuration are handled outside python in .aws directory or environment variables\n\ndef download_s3_folder(bucket_name, s3_folder, local_dir=None):\n    &quot;&quot;&quot;\n    Download the contents of a folder directory\n    Args:\n        bucket_name: the name of the s3 bucket\n        s3_folder: the folder path in the s3 bucket\n        local_dir: a relative or absolute directory path in the local file system\n    &quot;&quot;&quot;\n    bucket = s3.Bucket(bucket_name)\n    for obj in bucket.objects.filter(Prefix=s3_folder):\n        target = obj.key if local_dir is None \\\n            else os.path.join(local_dir, os.path.relpath(obj.key, s3_folder))\n        if not os.path.exists(os.path.dirname(target)):\n            os.makedirs(os.path.dirname(target))\n        if obj.key[-1] == '/':\n            continue\n        bucket.download_file(obj.key, target)\n</code></pre>\n<p>This downloads nested subdirectories, too.  I was able to download a directory with over 3000 files in it.  You'll find other solutions at <a href=\"https://stackoverflow.com/questions/31918960/boto3-to-download-all-files-from-a-s3-bucket/31929277\">Boto3 to download all files from a S3 Bucket</a>, but I don't know if they're any better.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 5814815,
                        "reputation": 1077,
                        "user_id": 4584809,
                        "user_type": "registered",
                        "display_name": "Matthew Cox"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 6,
                    "last_activity_date": 1611843436,
                    "creation_date": 1611843436,
                    "answer_id": 65938923,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/65938923#65938923",
                    "body": "<p>Another approach building on the answer from @bjc that leverages the built in Path library and parses the s3 uri for you:</p>\n<pre><code>import boto3\nfrom pathlib import Path\nfrom urllib.parse import urlparse\n\ndef download_s3_folder(s3_uri, local_dir=None):\n    &quot;&quot;&quot;\n    Download the contents of a folder directory\n    Args:\n        s3_uri: the s3 uri to the top level of the files you wish to download\n        local_dir: a relative or absolute directory path in the local file system\n    &quot;&quot;&quot;\n    s3 = boto3.resource(&quot;s3&quot;)\n    bucket = s3.Bucket(urlparse(s3_uri).hostname)\n    s3_path = urlparse(s3_uri).path.lstrip('/')\n    if local_dir is not None:\n        local_dir = Path(local_dir)\n    for obj in bucket.objects.filter(Prefix=s3_path):\n        target = obj.key if local_dir is None else local_dir / Path(obj.key).relative_to(s3_path)\n        target.parent.mkdir(parents=True, exist_ok=True)\n        if obj.key[-1] == '/':\n            continue\n        bucket.download_file(obj.key, str(target))\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 9223596,
                        "reputation": 175,
                        "user_id": 6852081,
                        "user_type": "registered",
                        "display_name": "Shahar Gino"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1614840013,
                    "creation_date": 1614840013,
                    "answer_id": 66469837,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66469837#66469837",
                    "body": "<p>The above solutions are good, and rely on S3 Resource.<br />\nThe following solution, achieves the same goal, but with applying s3_client.<br />\nYou might find it useful for your end (I've tested it, and it works well).</p>\n<pre><code>import boto3\nfrom os import path, makedirs\nfrom botocore.exceptions import ClientError\nfrom boto3.exceptions import S3TransferFailedError\n\ndef download_s3_folder(s3_folder, local_dir, aws_access_key_id, aws_secret_access_key, aws_bucket, debug_en):\n    &quot;&quot;&quot; Download the contents of a folder directory into a local area &quot;&quot;&quot;\n\n    success = True\n\n    print('[INFO] Downloading %s from bucket %s...' % (s3_folder, aws_bucket))\n\n    def get_all_s3_objects(s3, **base_kwargs):\n        continuation_token = None\n        while True:\n            list_kwargs = dict(MaxKeys=1000, **base_kwargs)\n            if continuation_token:\n                list_kwargs['ContinuationToken'] = continuation_token\n            response = s3.list_objects_v2(**list_kwargs)\n            yield from response.get('Contents', [])\n            if not response.get('IsTruncated'):\n                break\n            continuation_token = response.get('NextContinuationToken')\n\n    s3_client = boto3.client('s3',\n                             aws_access_key_id=aws_access_key_id,\n                             aws_secret_access_key=aws_secret_access_key)\n\n    all_s3_objects_gen = get_all_s3_objects(s3_client, Bucket=aws_bucket)\n\n    for obj in all_s3_objects_gen:\n        source = obj['Key']\n        if source.startswith(s3_folder):\n            destination = path.join(local_dir, source)\n            if not path.exists(path.dirname(destination)):\n                makedirs(path.dirname(destination))\n            try:\n                s3_client.download_file(aws_bucket, source, destination)\n            except (ClientError, S3TransferFailedError) as e:\n                print('[ERROR] Could not download file &quot;%s&quot;: %s' % (source, e))\n                success = False\n            if debug_en:\n                print('[DEBUG] Downloading: %s --&gt; %s' % (source, destination))\n\n    return success\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 15192781,
                                "reputation": 1061,
                                "user_id": 10963057,
                                "user_type": "registered",
                                "display_name": "Alex"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1628714843,
                            "post_id": 66513705,
                            "comment_id": 121498636,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment121498636_66513705",
                            "body": "does somebody know, if AWS counts this as one request for the billing?!"
                        },
                        {
                            "owner": {
                                "account_id": 1870312,
                                "reputation": 2503,
                                "user_id": 1692709,
                                "user_type": "registered",
                                "display_name": "hume"
                            },
                            "reply_to_user": {
                                "account_id": 15192781,
                                "reputation": 1061,
                                "user_id": 10963057,
                                "user_type": "registered",
                                "display_name": "Alex"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1628726157,
                            "post_id": 66513705,
                            "comment_id": 121501165,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment121501165_66513705",
                            "body": "Probably not. It should work out to about same as looping over each key with <code>boto3</code> (maybe with an added call to list objects, but you need that in both cases)"
                        },
                        {
                            "owner": {
                                "account_id": 15914722,
                                "reputation": 592,
                                "user_id": 11483674,
                                "user_type": "registered",
                                "display_name": "Luiz Tauffer"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639684908,
                            "post_id": 66513705,
                            "comment_id": 124418914,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment124418914_66513705",
                            "body": "for me it only worked without the trailing <code>&#47;</code>... in the example above it would be: <code>cp = CloudPath(&quot;s3:&#47;&#47;bucket&#47;folder&#47;folder2&quot;)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 6958514,
                                "reputation": 397,
                                "user_id": 5338792,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "trungducng"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1641539336,
                            "post_id": 66513705,
                            "comment_id": 124834729,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment124834729_66513705",
                            "body": "@hume Can I pass the relative path to the CloudPath. For example: &quot;s3://bucket/*/*/device/&quot; ?"
                        },
                        {
                            "owner": {
                                "account_id": 1870312,
                                "reputation": 2503,
                                "user_id": 1692709,
                                "user_type": "registered",
                                "display_name": "hume"
                            },
                            "reply_to_user": {
                                "account_id": 6958514,
                                "reputation": 397,
                                "user_id": 5338792,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "trungducng"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1642707267,
                            "post_id": 66513705,
                            "comment_id": 125150119,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment125150119_66513705",
                            "body": "@trungducng There is a <code>glob</code> method like with a normal <code>Path</code> that you can use to loop over those files and call <code>download_to</code> on each one individually. <a href=\"https://cloudpathlib.drivendata.org/stable/api-reference/s3path/#cloudpathlib.s3.s3path.S3Path.glob\" rel=\"nofollow noreferrer\">cloudpathlib.drivendata.org/stable/api-reference/s3path/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 3272514,
                                "reputation": 195,
                                "user_id": 2755526,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "user2755526"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1645120640,
                            "post_id": 66513705,
                            "comment_id": 125792900,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#comment125792900_66513705",
                            "body": "Why isn&#39;t this the top solution!! This tool is awesome."
                        }
                    ],
                    "owner": {
                        "account_id": 1870312,
                        "reputation": 2503,
                        "user_id": 1692709,
                        "user_type": "registered",
                        "display_name": "hume"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 20,
                    "last_activity_date": 1615097140,
                    "creation_date": 1615097140,
                    "answer_id": 66513705,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/66513705#66513705",
                    "body": "<p>You could also use <a href=\"https://cloudpathlib.drivendata.org/\" rel=\"noreferrer\"><code>cloudpathlib</code></a> which, for S3, wraps <code>boto3</code>. For your use case, it's pretty simple:</p>\n<pre class=\"lang-py prettyprint-override\"><code>from cloudpathlib import CloudPath\n\ncp = CloudPath(&quot;s3://bucket/folder/folder2/&quot;)\ncp.download_to(&quot;local_folder&quot;)\n\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7523593,
                        "reputation": 316,
                        "user_id": 5714661,
                        "user_type": "registered",
                        "display_name": "Roman Mirochnik"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1625729695,
                    "creation_date": 1625729695,
                    "answer_id": 68297406,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/68297406#68297406",
                    "body": "<p>You can call the awscli cp command from python to download an entire folder</p>\n<pre><code> import os\n import subprocess\n\n remote_folder_name = 's3://my-bucket/my-dir'\n local_path = '.'\n if not os.path.exists(local_path):\n     os.makedirs(local_path)\n subprocess.run(['aws', 's3', 'cp', remote_folder_name, local_path, '--recursive'])\n</code></pre>\n<p>Some notes regarding this solution:</p>\n<ol>\n<li>You should install awscli (<code>pip install awscli</code>) and configure it. more info <a href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html\" rel=\"nofollow noreferrer\">here</a></li>\n<li>If you don't want to override existing files if they weren't changed, you can use <code>sync</code> instead of <code>cp</code> <code>subprocess.run(['aws', 's3', 'sync', remote_folder_name, local_path])</code></li>\n<li>Tested on python 3.6. on earlier versions of python you might need to replace <code>subprocess.run</code> with <code>subprocess.call</code> or <code>os.system</code></li>\n<li>The cli command that is executed by this code is <code>aws s3 cp s3://my-bucket/my-dir . --recursive</code></li>\n</ol>\n"
                },
                {
                    "owner": {
                        "account_id": 18954954,
                        "reputation": 11,
                        "user_id": 13831735,
                        "user_type": "registered",
                        "display_name": "Joji Miki Okada"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1651783481,
                    "last_edit_date": 1651783481,
                    "creation_date": 1649422438,
                    "answer_id": 71797381,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/71797381#71797381",
                    "body": "<p>I had some problems with this version.\nModified variable destination and included variable for filter to files type.</p>\n<pre><code>from sre_constants import SUCCESS\nimport boto3 \nfrom os import path, makedirs \nfrom botocore.exceptions import ClientError\nfrom boto3.exceptions import S3TransferFailedError\n\ndef download_s3_folder(s3_folder, local_dir, aws_access_key_id, aws_secret_access_key, aws_bucket, debug_en, datatype):\n&quot;&quot;&quot;&quot;&quot; Download the contents of a folder directory into a local area &quot;&quot;&quot;&quot;&quot;\n\nsuccess = True\n# Start do processo de copia\nprint('[INFO] Downloading %s from bucket %s...' % (s3_folder, aws_bucket))\n\n# Metodo que lista todos os objetos do Bucket. \ndef get_all_s3_objects(s3, **base_kwargs):\n    continuation_token = None\n    while True:\n        list_kwargs = dict(MaxKeys=1000, **base_kwargs)\n        if continuation_token:\n            list_kwargs['ContinuationToken'] = continuation_token\n        response = s3.list_objects_v2(**list_kwargs)\n        yield from response.get('Contents', [])\n        if not response.get('IsTruncated'):\n            break\n        continuation_token = response.get('NextContinuationToken')\n\ns3_client = boto3.client('s3',\n                         aws_access_key_id=aws_access_key_id,\n                         aws_secret_access_key=aws_secret_access_key)\n\nall_s3_objects_gen = get_all_s3_objects(s3_client, Bucket=aws_bucket)\n\n# Loop into os objetos do S3,\nfor obj in all_s3_objects_gen:\n    source = obj['Key']\n    if source.startswith(s3_folder):\n        # Transform path to using fo SO\n        destination = path.join(local_dir,source).replace('/','\\\\')\n        \n        if not path.exists(path.dirname(destination)):\n            makedirs(path.dirname(destination))\n        try:\n            #print('copy')\n            if destination.endswith(datatype):\n                #print(destination)\n                print('Copia do arquivo &quot;%s&quot; Sucesso' % (destination))\n                s3_client.download_file(aws_bucket, source, destination)\n        except (ClientError, S3TransferFailedError) as e:\n            print('[ERROR] Could not download file &quot;%s&quot;: %s' % (source, e))\n            success = False\n        if debug_en:\n            print(f&quot;[DEBUG] Downloading: {source} --&gt; {destination}&quot;)\n\nreturn success\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4862056,
                                "reputation": 1459,
                                "user_id": 9301805,
                                "user_type": "registered",
                                "display_name": "user88484"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1659016248,
                            "post_id": 72405960,
                            "comment_id": 129199264,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/72405960#comment129199264_72405960",
                            "body": "It does not work for me. I get: <code>AssertionError                            Traceback (most recent call last) Input In [34], in &lt;cell line: 1&gt;() ----&gt; 1 download_s3_dir(bucket_name, remote_folder_name, local_path)  Input In [23], in download_s3_dir(bucketName, remote_dir, local_dir)       5 def download_s3_dir(bucketName, remote_dir, local_dir):       6     assert remote_dir.endswith(&#39;&#47;&#39;) ----&gt; 7     assert local_dir.endswith(&#39;&#47;&#39;)       8     s3_resource = boto3.resource(&#39;s3&#39;)       9     bucket = s3_resource.Bucket(bucketName)   AssertionError:</code>"
                        },
                        {
                            "owner": {
                                "account_id": 8258680,
                                "reputation": 345,
                                "user_id": 6210975,
                                "user_type": "registered",
                                "display_name": "Greg7000"
                            },
                            "reply_to_user": {
                                "account_id": 4862056,
                                "reputation": 1459,
                                "user_id": 9301805,
                                "user_type": "registered",
                                "display_name": "user88484"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1659353327,
                            "post_id": 72405960,
                            "comment_id": 129267018,
                            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/72405960#comment129267018_72405960",
                            "body": "@user88484, mare sure your remote_dir and loca_dir endswith a &#39;/&#39;"
                        }
                    ],
                    "owner": {
                        "account_id": 8258680,
                        "reputation": 345,
                        "user_id": 6210975,
                        "user_type": "registered",
                        "display_name": "Greg7000"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1653936833,
                    "last_edit_date": 1653936833,
                    "creation_date": 1653656940,
                    "answer_id": 72405960,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/72405960#72405960",
                    "body": "<p>Here is my approach inspired by <a href=\"https://stackoverflow.com/users/2429426/bjc\">konstantinos-katsantonis</a> and <a href=\"https://stackoverflow.com/users/2429426/bjc\">bjc</a> answers.</p>\n<pre><code>import os\nimport boto3\nfrom pathlib import Path\n\ndef download_s3_dir(bucketName, remote_dir, local_dir):\n    assert remote_dir.endswith('/')\n    assert local_dir.endswith('/')\n    s3_resource = boto3.resource('s3')\n    bucket = s3_resource.Bucket(bucketName) \n    objs = bucket.objects.filter(Prefix=remote_dir)\n    sorted_objs = sorted(objs, key=attrgetter(&quot;key&quot;))\n    for obj in sorted_objs:\n        path = Path(os.path.dirname(local_dir + obj.key))\n        path.mkdir(parents=True, exist_ok=True)\n        if not obj.key.endswith(&quot;/&quot;):\n            bucket.download_file(obj.key, str(path) + &quot;/&quot; + os.path.split(obj.key)[1])\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 22582051,
                        "reputation": 21,
                        "user_id": 16766570,
                        "user_type": "registered",
                        "display_name": "Pratik Bhadane"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1671604976,
                    "creation_date": 1671604976,
                    "answer_id": 74872172,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/74872172#74872172",
                    "body": "<p>Here I've written a script to download any files with any extension (.csv in the code), you can change the file extension according to the type of files you need to download</p>\n<pre><code>import boto3\nimport os\nimport shutil\n\nsession = boto3.Session(\n    aws_access_key_id='',\n    aws_secret_access_key='',\n)\n\n\ndef download_directory(bucket_name, s3_folder_name):\n    s3_resource = session.resource('s3')\n    bucket = s3_resource.Bucket(bucket_name)\n    objs = list(bucket.objects.filter(Prefix=s3_folder_name))\n    for obj in objs:\n        print(&quot;Try to Downloading &quot; + obj.key)\n        if not os.path.exists(os.path.dirname(obj.key)):\n            os.makedirs(os.path.dirname(obj.key))\n        out_name = obj.key.split('/')[-1]\n        if out_name[-4:] == &quot;.csv&quot;:\n            bucket.download_file(obj.key, out_name)\n            print(f&quot;Downloaded {out_name}&quot;)\n            dest_path = ('/').join(obj.key.split('/')[0:-1])\n            shutil.move(out_name, dest_path)\n            print(f&quot;Moved File to {dest_path}&quot;)\n        else:\n            print(f&quot;Skipping {out_name}&quot;)\n\n\ndownload_directory(&quot;mybucket&quot;, &quot;myfolder&quot;)\n</code></pre>\n<p>Please feel free to ask me for help if you can't understand what to do exactly.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 27040732,
                        "reputation": 489,
                        "user_id": 20595559,
                        "user_type": "registered",
                        "display_name": "Muhammad Ali"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1702530289,
                    "creation_date": 1702530289,
                    "answer_id": 77657872,
                    "question_id": 49772151,
                    "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3/77657872#77657872",
                    "body": "<p>I hope, it will give you a better understanding of uploading, downloading and getting an s3 object</p>\n<pre><code># libraries import\nimport boto3\nimport pandas as pd\n\n# configure aws on command line\n# aws configure\n# enter your access key, access secret and region in which you create your bucket\n# You get your access key and access password from security credentials under the iam\n# if its disabled delete the previous one and then create the new one\n\ns3_obj = boto3.client(&quot;s3&quot;) # object for accessing s3\n\n# Downloading file code\ns3_obj.download_file(\n    Filename=&quot;./local_file_name_which_you_download_from_s3.csv&quot;,\n    Bucket=&quot;your_bucket_name&quot;,\n    Key=&quot;file_in_s3_bucket.csv&quot;\n# )\ndf = pd.read_csv('./local_file_name_which_you_download_from_s3.csv')\ndf.head()\n\n# Uploading file code\ns3_obj.upload_file(\n    Filename=&quot;./local_file_name_which_you_download_from_s3.csv&quot;,\n    Bucket=&quot;your_bucket_name&quot;,\n    Key=&quot;file_in_s3_bucket.csv&quot;\n)\n\ns3_obj_file = s3_obj.get_object(Bucket='bucket_name', Key='file_in_s3_bucket')['Body'].read()\ndf_upload = pd.read_excel(s3_obj_file)\ndf_upload.head()\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 6547737,
                "reputation": 1671,
                "user_id": 5063171,
                "user_type": "registered",
                "display_name": "El Fadel Anas"
            },
            "comment_count": 2,
            "is_answered": true,
            "accepted_answer_id": 54672690,
            "answer_count": 11,
            "score": 65,
            "last_activity_date": 1712354913,
            "creation_date": 1523440975,
            "last_edit_date": 1642539810,
            "question_id": 49772151,
            "link": "https://stackoverflow.com/questions/49772151/download-a-folder-from-s3-using-boto3",
            "title": "Download a folder from S3 using Boto3",
            "body": "<p>Using <code>Boto3 Python SDK</code>, I was able to download files using the method <code>bucket.download_file()</code></p>\n\n<p>Is there a way to download an entire folder?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 8364
}