{
    "items": [
        {
            "tags": [
                "python",
                "sockets",
                "ipc",
                "port"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 22779,
                        "reputation": 130073,
                        "user_id": 56541,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "David Z"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1251851584,
                    "post_id": 1365265,
                    "comment_id": 1203284,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number#comment1203284_1365265",
                    "body": "Incidentally, if you just pick a random or random-ish port number (preferably higher than 1024), it&#39;ll probably be available.  You can even use port 80 or 21 or whatever, as long as no other program is listening on it.  At any given time, on a normal system, only a small fraction of ports are in use."
                },
                {
                    "owner": {
                        "account_id": 47906,
                        "reputation": 560,
                        "user_id": 142110,
                        "user_type": "registered",
                        "display_name": "Corehpf"
                    },
                    "edited": false,
                    "score": 26,
                    "creation_date": 1251851808,
                    "post_id": 1365265,
                    "comment_id": 1203298,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number#comment1203298_1365265",
                    "body": "Picking a random port is not a good idea - let the OS pick one for you."
                },
                {
                    "owner": {
                        "account_id": 481416,
                        "reputation": 365940,
                        "user_id": 895245,
                        "user_type": "registered",
                        "accept_rate": 49,
                        "display_name": "Ciro Santilli OurBigBook.com"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1450539030,
                    "post_id": 1365265,
                    "comment_id": 56486402,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number#comment56486402_1365265",
                    "body": "On POSIX: <a href=\"http://stackoverflow.com/questions/913501/how-to-let-kernel-choose-a-port-number-in-the-range-1024-5000-in-tcp-socket-pr\" title=\"how to let kernel choose a port number in the range 1024 5000 in tcp socket pr\">stackoverflow.com/questions/913501/&hellip;</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 12710625,
                                "reputation": 67,
                                "user_id": 9234367,
                                "user_type": "registered",
                                "display_name": "UltraRadiantx"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1666100063,
                            "post_id": 1365281,
                            "comment_id": 130851505,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365281#comment130851505_1365281",
                            "body": "how did you get to know about this specific range of port numbers you mentioned, any references? @Havenard"
                        },
                        {
                            "owner": {
                                "account_id": 52474,
                                "reputation": 27520,
                                "user_id": 156811,
                                "user_type": "registered",
                                "display_name": "Havenard"
                            },
                            "reply_to_user": {
                                "account_id": 12710625,
                                "reputation": 67,
                                "user_id": 9234367,
                                "user_type": "registered",
                                "display_name": "UltraRadiantx"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1666127167,
                            "post_id": 1365281,
                            "comment_id": 130861242,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365281#comment130861242_1365281",
                            "body": "The range 0-1023 is reserved by TCP/IP for the &quot;well-known ports&quot;, the ones commonly used by system and network services, so they won&#39;t be picked at random and you can only use them if the process is run with elevated privileges."
                        }
                    ],
                    "owner": {
                        "account_id": 52474,
                        "reputation": 27520,
                        "user_id": 156811,
                        "user_type": "registered",
                        "display_name": "Havenard"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 50,
                    "last_activity_date": 1324536955,
                    "last_edit_date": 1324536955,
                    "creation_date": 1251850373,
                    "answer_id": 1365281,
                    "question_id": 1365265,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365281#1365281",
                    "body": "<p>Bind the socket to port 0. A random free port from 1024 to 65535 will be selected. You may retrieve the selected port with <code>getsockname()</code> right after <code>bind()</code>.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 53575,
                        "reputation": 3280,
                        "user_id": 160205,
                        "user_type": "registered",
                        "accept_rate": 82,
                        "display_name": "Walt W"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1251850928,
                    "last_edit_date": 1251850928,
                    "creation_date": 1251850405,
                    "answer_id": 1365283,
                    "question_id": 1365265,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365283#1365283",
                    "body": "<p>You can listen on whatever port you want; generally, user applications should listen to ports 1024 and above (through 65535).  The main thing if you have a variable number of listeners is to allocate a range to your app - say 20000-21000, and <em>CATCH EXCEPTIONS</em>.  That is how you will know if a port is unusable (used by another process, in other words) on your computer.  </p>\n\n<p>However, in your case, you shouldn't have a problem using a single hard-coded port for your listener, as long as you print an error message if the bind fails.</p>\n\n<p>Note also that most of your sockets (for the slaves) do not need to be explicitly bound to specific port numbers - only sockets that wait for incoming connections (like your master here) will need to be made a listener and bound to a port.  If a port is not specified for a socket before it is used, the OS will assign a useable port to the socket.  When the master wants to respond to a slave that sends it data, the address of the sender is accessible when the listener receives data.</p>\n\n<p>I presume you will be using UDP for this?</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 438602,
                                "reputation": 5696,
                                "user_id": 3538289,
                                "user_type": "registered",
                                "display_name": "cevaris"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1447038757,
                            "post_id": 1365284,
                            "comment_id": 54979247,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment54979247_1365284",
                            "body": "See <a href=\"http://stackoverflow.com/a/2838309/3538289\">stackoverflow.com/a/2838309/3538289</a> for an example of <code>sock.bind((&#39;&#39;,0))</code>"
                        },
                        {
                            "owner": {
                                "account_id": 1511325,
                                "reputation": 1879,
                                "user_id": 1413374,
                                "user_type": "registered",
                                "accept_rate": 17,
                                "display_name": "Sebastian"
                            },
                            "edited": false,
                            "score": 19,
                            "creation_date": 1457381708,
                            "post_id": 1365284,
                            "comment_id": 59371980,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment59371980_1365284",
                            "body": "How do you pass on the number to the slaves? Sounds like a chicken and egg problem to me."
                        },
                        {
                            "owner": {
                                "account_id": 38971,
                                "reputation": 60005,
                                "user_id": 112212,
                                "user_type": "registered",
                                "display_name": "mark4o"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1457389248,
                            "post_id": 1365284,
                            "comment_id": 59376070,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment59376070_1365284",
                            "body": "If the slaves are created after binding, you can just pass it as a parameter when creating them.  Alternatively you could write it to some shared memory or a file that both can access, or a central server accessed via some well known port number could keep track of it."
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1614966782,
                            "post_id": 1365284,
                            "comment_id": 117556020,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment117556020_1365284",
                            "body": "what is <code>sock</code>? can you show a full example with an import statement please?"
                        },
                        {
                            "owner": {
                                "account_id": 11655662,
                                "reputation": 949,
                                "user_id": 8535456,
                                "user_type": "registered",
                                "display_name": "Sherry869"
                            },
                            "reply_to_user": {
                                "account_id": 1511325,
                                "reputation": 1879,
                                "user_id": 1413374,
                                "user_type": "registered",
                                "accept_rate": 17,
                                "display_name": "Sebastian"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1628933895,
                            "post_id": 1365284,
                            "comment_id": 121556650,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment121556650_1365284",
                            "body": "@Sebastian It depends on your case, and is troubling to discuss generally. In my case I just store it in a local text file."
                        },
                        {
                            "owner": {
                                "account_id": 1193354,
                                "reputation": 1998,
                                "user_id": 1165643,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "pete"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1666580055,
                            "post_id": 1365284,
                            "comment_id": 130963326,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#comment130963326_1365284",
                            "body": "@mark4o lol Mark but don&#39;t you see see if we did have some method of passing info to the recipients then we wouldn&#39;t have needed to make this http connection in the first place? Is there something I&#39;m missing here?"
                        }
                    ],
                    "owner": {
                        "account_id": 38971,
                        "reputation": 60005,
                        "user_id": 112212,
                        "user_type": "registered",
                        "display_name": "mark4o"
                    },
                    "comment_count": 6,
                    "is_accepted": true,
                    "score": 303,
                    "last_activity_date": 1640496394,
                    "last_edit_date": 1640496394,
                    "creation_date": 1251850454,
                    "answer_id": 1365284,
                    "question_id": 1365265,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/1365284#1365284",
                    "body": "<p>Do not bind to a specific port. Instead, bind to port 0:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import socket\nsock = socket.socket()\nsock.bind(('', 0))\nsock.getsockname()[1]\n</code></pre>\n<p>The OS will then pick an available port for you.  You can get the port that was chosen using <code>sock.getsockname()[1]</code>, and pass it on to the slaves so that they can connect back.</p>\n<p><code>sock</code> is the socket that you created, returned by <code>socket.socket</code>.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4885471,
                                "reputation": 418,
                                "user_id": 3938078,
                                "user_type": "registered",
                                "display_name": "codeskyblue"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1508223467,
                            "post_id": 45690594,
                            "comment_id": 80514651,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment80514651_45690594",
                            "body": "if on localhost: maybe <code>s.bind((&#39;localhost&#39;, 0))</code> is better"
                        },
                        {
                            "owner": {
                                "account_id": 466738,
                                "reputation": 418,
                                "user_id": 871666,
                                "user_type": "registered",
                                "display_name": "jonEbird"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1529436809,
                            "post_id": 45690594,
                            "comment_id": 88869996,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment88869996_45690594",
                            "body": "Also good to add the following so you can quickly re-use that port before your return statement: <code>s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 39785,
                                "reputation": 3354,
                                "user_id": 114926,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Karl Bartel"
                            },
                            "reply_to_user": {
                                "account_id": 466738,
                                "reputation": 418,
                                "user_id": 871666,
                                "user_type": "registered",
                                "display_name": "jonEbird"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1582043844,
                            "post_id": 45690594,
                            "comment_id": 106637267,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment106637267_45690594",
                            "body": "@jonEbird Does <code>socket.SO_REUSEADDR</code> really help in this case? From what I read, it is only relevant that the socket which is trying to bind has <code>SO_REUSEADDR</code> and it is irrelevant whether that flag is set on the lingering socket."
                        },
                        {
                            "owner": {
                                "account_id": 16837067,
                                "reputation": 1174,
                                "user_id": 12173451,
                                "user_type": "registered",
                                "display_name": "hldev"
                            },
                            "reply_to_user": {
                                "account_id": 39785,
                                "reputation": 3354,
                                "user_id": 114926,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Karl Bartel"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1647274612,
                            "post_id": 45690594,
                            "comment_id": 126324690,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment126324690_45690594",
                            "body": "@KarlBartel in linux the subprocess will be able to reuse the given addr only if it was bound with <code>SO_REUSEADDR</code>. I tried not using <code>SO_REUSEADDR</code> and the subprocess (google chrome browser) got <code>EADDRINUSE</code> error."
                        },
                        {
                            "owner": {
                                "account_id": 232826,
                                "reputation": 24798,
                                "user_id": 497934,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Maxpm"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1664550101,
                            "post_id": 45690594,
                            "comment_id": 130504573,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment130504573_45690594",
                            "body": "This will close the socket before returning the port. Won&#39;t that release the port and leave it available to be acquired by somebody else? So by the time the caller of this function receives the return value, that port is no longer guaranteed to be free for its use?"
                        },
                        {
                            "owner": {
                                "account_id": 8427355,
                                "reputation": 687,
                                "user_id": 7354351,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "Pythonist"
                            },
                            "reply_to_user": {
                                "account_id": 232826,
                                "reputation": 24798,
                                "user_id": 497934,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Maxpm"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1665487151,
                            "post_id": 45690594,
                            "comment_id": 130706935,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#comment130706935_45690594",
                            "body": "@Maxpm you&#39;re right, port is freed as soon as the socked is closed. Mihai Capot\u0103 answer is much better"
                        }
                    ],
                    "owner": {
                        "account_id": 794804,
                        "reputation": 24367,
                        "user_id": 2072035,
                        "user_type": "registered",
                        "display_name": "saaj"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 102,
                    "last_activity_date": 1548334881,
                    "last_edit_date": 1548334881,
                    "creation_date": 1502791102,
                    "answer_id": 45690594,
                    "question_id": 1365265,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/45690594#45690594",
                    "body": "<p>For the sake of snippet of what the guys have explained above:</p>\n\n<pre><code>import socket\nfrom contextlib import closing\n\ndef find_free_port():\n    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:\n        s.bind(('', 0))\n        s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n        return s.getsockname()[1]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 886538,
                                "reputation": 685,
                                "user_id": 925854,
                                "user_type": "registered",
                                "display_name": "Jonathan Liuti"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1648311308,
                            "post_id": 61685162,
                            "comment_id": 126594372,
                            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/61685162#comment126594372_61685162",
                            "body": "This solution is simpler and implies less code but it is also significantly slower than the accepted answer.  Accepted answer gives -&gt; 20.2 &#181;s &#177; 1.5 &#181;s per loop (mean &#177; std. dev. of 7 runs, 10,000 loops each)   This solution gives -&gt; 191 &#181;s &#177; 3.41 &#181;s per loop (mean &#177; std. dev. of 7 runs, 10,000 loops each) ```"
                        }
                    ],
                    "owner": {
                        "account_id": 68667,
                        "reputation": 2411,
                        "user_id": 200234,
                        "user_type": "registered",
                        "display_name": "Mihai Capot\u0103"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 13,
                    "last_activity_date": 1588960677,
                    "creation_date": 1588960677,
                    "answer_id": 61685162,
                    "question_id": 1365265,
                    "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number/61685162#61685162",
                    "body": "<p>If you only need to find a free port for later use, here is a snippet similar to <a href=\"https://stackoverflow.com/a/45690594/200234\">a previous answer</a>, but shorter, using <a href=\"https://docs.python.org/3/library/socketserver.html\" rel=\"noreferrer\">socketserver</a>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import socketserver\n\nwith socketserver.TCPServer((\"localhost\", 0), None) as s:\n    free_port = s.server_address[1]\n</code></pre>\n\n<p>Note that the port is not guaranteed to remain free, so you may need to put this snippet and the code using it in a loop.</p>\n"
                }
            ],
            "owner": {
                "account_id": 561103,
                "reputation": 2477,
                "user_id": 166939,
                "user_type": "unregistered",
                "accept_rate": 100,
                "display_name": "Anton L."
            },
            "comment_count": 3,
            "is_answered": true,
            "accepted_answer_id": 1365284,
            "answer_count": 5,
            "score": 216,
            "last_activity_date": 1640496394,
            "creation_date": 1251850034,
            "last_edit_date": 1606145618,
            "question_id": 1365265,
            "link": "https://stackoverflow.com/questions/1365265/on-localhost-how-do-i-pick-a-free-port-number",
            "title": "On localhost, how do I pick a free port number?",
            "body": "<p>I'm trying to play with inter-process communication and since I could not figure out how to use named pipes under Windows I thought I'll use network sockets. Everything happens locally. The server is able to launch slaves in a separate process and listens on some port. The slaves do their work and submit the result to the master. How do I figure out which port is available? I assume I cannot listen on port 80 or 21?</p>\n<p>I'm using Python, if that cuts the choices down.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9598
}