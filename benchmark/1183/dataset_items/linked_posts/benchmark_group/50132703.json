{
    "items": [
        {
            "tags": [
                "python",
                "unit-testing",
                "pytest"
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 5690173,
                                "reputation": 9330,
                                "user_id": 4498470,
                                "user_type": "registered",
                                "display_name": "Donal"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1525357329,
                            "post_id": 50135020,
                            "comment_id": 87332511,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment87332511_50135020",
                            "body": "Thanks @hoefling  That&#39;s what I wanted. I never understood the autouse fixture functionality. I understand now. Cheers."
                        },
                        {
                            "owner": {
                                "account_id": 3133056,
                                "reputation": 63405,
                                "user_id": 2650249,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hoefling"
                            },
                            "reply_to_user": {
                                "account_id": 5690173,
                                "reputation": 9330,
                                "user_id": 4498470,
                                "user_type": "registered",
                                "display_name": "Donal"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1525439400,
                            "post_id": 50135020,
                            "comment_id": 87368515,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment87368515_50135020",
                            "body": "Glad I could help you!"
                        },
                        {
                            "owner": {
                                "account_id": 4202455,
                                "reputation": 6216,
                                "user_id": 3442256,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "Ken4scholars"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1547522739,
                            "post_id": 50135020,
                            "comment_id": 95212219,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment95212219_50135020",
                            "body": "@hoefling for some reason this never works for me. The test methods seem to be getting a new instance and <code>self</code> does not have the attributes in the setup method. Just for context, I&#39;m using 2 <code>pytext.mark...</code> on the class."
                        },
                        {
                            "owner": {
                                "account_id": 3133056,
                                "reputation": 63405,
                                "user_id": 2650249,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hoefling"
                            },
                            "reply_to_user": {
                                "account_id": 4202455,
                                "reputation": 6216,
                                "user_id": 3442256,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "Ken4scholars"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1547539577,
                            "post_id": 50135020,
                            "comment_id": 95216549,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment95216549_50135020",
                            "body": "@Ken4scholars best is to ask a separate question, including a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the failing test setup you have. Can you do that?"
                        },
                        {
                            "owner": {
                                "account_id": 4202455,
                                "reputation": 6216,
                                "user_id": 3442256,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "Ken4scholars"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1547544430,
                            "post_id": 50135020,
                            "comment_id": 95218695,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment95218695_50135020",
                            "body": "@hoefling, sure. Please check this question. Though it is another issue there, but it has the description of this issue. <a href=\"https://stackoverflow.com/questions/54192519/django-channels-postgres-interfaceerror-connection-already-closed\" title=\"django channels postgres interfaceerror connection already closed\">stackoverflow.com/questions/54192519/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1596213761,
                            "post_id": 50135020,
                            "comment_id": 111750048,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111750048_50135020",
                            "body": "@hoefling, When I set the scope  _request_google_page to &#39;class&#39; and the scope of google to &quot;module&quot;, I see the following error inside the function &quot;def test_alive(self):&quot;  AttributeError: &#39;TestGoogle&#39; object has no attribute &#39;_response&#39;  Any idea?"
                        },
                        {
                            "owner": {
                                "account_id": 3133056,
                                "reputation": 63405,
                                "user_id": 2650249,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hoefling"
                            },
                            "reply_to_user": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1596218111,
                            "post_id": 50135020,
                            "comment_id": 111751797,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111751797_50135020",
                            "body": "@PrashantPathak I have added a snippet with adjusted scopes at the end of the answer, check it out. It will work when you copy it as-is."
                        },
                        {
                            "owner": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1596293945,
                            "post_id": 50135020,
                            "comment_id": 111768912,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111768912_50135020",
                            "body": "@hoefling, Thanks, So it means the function should be outside the class scope."
                        },
                        {
                            "owner": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1596294237,
                            "post_id": 50135020,
                            "comment_id": 111768994,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111768994_50135020",
                            "body": "@hoefling Can you also help me to understand one concept? which I am getting hard time to clear. So in the above code def _request_google_page() does not return anything still we are able to use response object in def test_alive(). So how the &quot;request.cls._response&quot; is getting accessed inside the class test methods, how is the call follow?"
                        },
                        {
                            "owner": {
                                "account_id": 3133056,
                                "reputation": 63405,
                                "user_id": 2650249,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hoefling"
                            },
                            "reply_to_user": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1596364575,
                            "post_id": 50135020,
                            "comment_id": 111782941,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111782941_50135020",
                            "body": "@PrashantPathak this is part of test collection and preparation. <code>request.cls</code> will be <code>TestGoogle</code> when the <code>_request_google_page</code> fixture is evaluated on test collection, so after <code>TestGoogle</code> is collected, <code>TestGoogle._response</code> will be initialized; after that, <code>TestGoogle().test_alive()</code> is executed and <code>self._response</code> is available. It&#39;s a class variable, actually."
                        },
                        {
                            "owner": {
                                "account_id": 8877922,
                                "reputation": 173,
                                "user_id": 7187965,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Prashant Pathak"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1596641162,
                            "post_id": 50135020,
                            "comment_id": 111877967,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment111877967_50135020",
                            "body": "@hoefling, Ohh I see so this &quot;self&quot; here is not an instance variable it&#39;s basically pointing to the class variable. Got it now. Thanks for your clarification"
                        },
                        {
                            "owner": {
                                "account_id": 5447446,
                                "reputation": 2361,
                                "user_id": 4333480,
                                "user_type": "registered",
                                "display_name": "Anurag jain"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1618252670,
                            "post_id": 50135020,
                            "comment_id": 118541426,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment118541426_50135020",
                            "body": "I am facing another issue with it   ScopeMismatch: You tried to access the &#39;function&#39; scoped fixture  with a &#39;class&#39; scoped request object, involved factories"
                        },
                        {
                            "owner": {
                                "account_id": 3133056,
                                "reputation": 63405,
                                "user_id": 2650249,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hoefling"
                            },
                            "reply_to_user": {
                                "account_id": 5447446,
                                "reputation": 2361,
                                "user_id": 4333480,
                                "user_type": "registered",
                                "display_name": "Anurag jain"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1618255160,
                            "post_id": 50135020,
                            "comment_id": 118542370,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment118542370_50135020",
                            "body": "@Anuragjain this means you have broadened the scope in a chain of fixtures invocation, which isn&#39;t allowed. This is not an issue with the code in the answer; if you need help, ask a new question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."
                        },
                        {
                            "owner": {
                                "account_id": 83273,
                                "reputation": 556,
                                "user_id": 233595,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Marcin Krupowicz"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1669907403,
                            "post_id": 50135020,
                            "comment_id": 131753784,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#comment131753784_50135020",
                            "body": "The last example is horrendous. Please don&#39;t do this. Tests (well, all the code) should be easy to understand. Remember: &quot;Explicit is better than implicit&quot;"
                        }
                    ],
                    "owner": {
                        "account_id": 3133056,
                        "reputation": 63405,
                        "user_id": 2650249,
                        "user_type": "registered",
                        "accept_rate": 95,
                        "display_name": "hoefling"
                    },
                    "comment_count": 14,
                    "is_accepted": true,
                    "score": 104,
                    "last_activity_date": 1596218076,
                    "last_edit_date": 1596218076,
                    "creation_date": 1525265220,
                    "answer_id": 50135020,
                    "question_id": 50132703,
                    "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#50135020",
                    "body": "<p>Sure, just use an autouse fixture. <a href=\"https://docs.pytest.org/en/latest/unittest.html#using-autouse-fixtures-and-accessing-other-fixtures\" rel=\"noreferrer\">Here is the relevant spot in <code>pytest</code> docs</a>. In your example, the change would be introducing an extra fixture (I named it <code>_request_google_page</code>):</p>\n<pre><code>from bs4 import BeautifulSoup\nimport pytest\nimport requests\n\n@pytest.fixture()\ndef google():\n    return requests.get(&quot;https://www.google.com&quot;)\n\n\nclass TestGoogle:\n\n    @pytest.fixture(autouse=True)\n    def _request_google_page(self, google):\n        self._response = google\n\n    def test_alive(self):\n        assert self._response.status_code == 200\n\n    def test_html_title(self):\n        soup = BeautifulSoup(self._response.content, &quot;html.parser&quot;)\n        assert soup.title.text.upper() == &quot;GOOGLE&quot;\n</code></pre>\n<p>You could even drop the <code>google</code> fixture completely and move the code to <code>_request_google_page</code>:</p>\n<pre><code>@pytest.fixture(autouse=True)\ndef _request_google_page(self):\n    self._response = requests.get(&quot;https://www.google.com&quot;)\n</code></pre>\n<p>Note that <code>_request_google_page</code> will be called once per test by default, so each test will get a new response. If you want the response to be initialized once and reused throughout all tests in the <code>TestGoogle</code> class, adjust the fixture scopes (<code>scope='class'</code> for <code>_request_google_page </code> and <code>scope='module'</code> or <code>scope='session'</code> for <code>google</code>). Example:</p>\n<pre><code>from bs4 import BeautifulSoup\nimport pytest\nimport requests\n\n\n@pytest.fixture(scope='module')\ndef google():\n    return requests.get(&quot;https://www.google.com&quot;)\n\n\n@pytest.fixture(autouse=True, scope='class')\ndef _request_google_page(request, google):\n    request.cls._response = google\n\n\nclass TestGoogle:\n\n    def test_alive(self):\n        assert self._response.status_code == 200\n\n    def test_html_title(self):\n        soup = BeautifulSoup(self._response.content, &quot;html.parser&quot;)\n        assert soup.title.text.upper() == &quot;GOOGLE&quot;\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1401707,
                                "reputation": 4681,
                                "user_id": 1330355,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "MohitC"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1612472273,
                            "post_id": 63047695,
                            "comment_id": 116785333,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/63047695#comment116785333_63047695",
                            "body": "However there is not way to set the value of <code>self.variable</code> through this?"
                        },
                        {
                            "owner": {
                                "account_id": 3404135,
                                "reputation": 806,
                                "user_id": 2855649,
                                "user_type": "registered",
                                "display_name": "makeiteasy"
                            },
                            "reply_to_user": {
                                "account_id": 1401707,
                                "reputation": 4681,
                                "user_id": 1330355,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "MohitC"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1612519387,
                            "post_id": 63047695,
                            "comment_id": 116797737,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/63047695#comment116797737_63047695",
                            "body": "@MohitC I don&#39;t think there is and I can&#39;t think of a case when it would be needed and <code>cls</code> wouldn&#39;t work"
                        },
                        {
                            "owner": {
                                "account_id": 4865515,
                                "reputation": 81,
                                "user_id": 3923914,
                                "user_type": "registered",
                                "display_name": "Jorrit Smit"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1617621292,
                            "post_id": 63047695,
                            "comment_id": 118346227,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/63047695#comment118346227_63047695",
                            "body": "i actually want exactly this behaviour. set the value of the self.variable in a test and use that result in following tests"
                        },
                        {
                            "owner": {
                                "account_id": 5653761,
                                "reputation": 143,
                                "user_id": 4473522,
                                "user_type": "registered",
                                "display_name": "Jan Sakalos"
                            },
                            "reply_to_user": {
                                "account_id": 4865515,
                                "reputation": 81,
                                "user_id": 3923914,
                                "user_type": "registered",
                                "display_name": "Jorrit Smit"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1621013909,
                            "post_id": 63047695,
                            "comment_id": 119376372,
                            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/63047695#comment119376372_63047695",
                            "body": "@JorritSmit sounds strange to set a value in one test to be used in other tests. A test should test not generate values for other tests."
                        }
                    ],
                    "owner": {
                        "account_id": 3404135,
                        "reputation": 806,
                        "user_id": 2855649,
                        "user_type": "registered",
                        "display_name": "makeiteasy"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 35,
                    "last_activity_date": 1595498047,
                    "last_edit_date": 1595498047,
                    "creation_date": 1595483427,
                    "answer_id": 63047695,
                    "question_id": 50132703,
                    "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/63047695#63047695",
                    "body": "<p>I had to solve a similar problem and the accepted solution didn't work for me with a class-scoped fixture.</p>\n<p>I wanted to call a fixture once per test class and re-use the value in test methods using <code>self</code>. This is actually what the OP was intending to do as well.</p>\n<p>You can use the <code>request</code> fixture to access the class that's using it (<code>request.cls</code>) and assign the fixture value in a class attribute. Then you can access this attribute from <code>self</code>. Here's the full snippet:</p>\n<pre><code>from bs4 import BeautifulSoup\nimport pytest\nimport requests\n\n@pytest.fixture(scope=&quot;class&quot;)\ndef google(request):\n    request.cls.google = requests.get(&quot;https://www.google.com&quot;)\n\n\n@pytest.mark.usefixtures(&quot;google&quot;)\nclass TestGoogle:\n    def test_alive(self):\n        assert self.google.status_code == 200\n\n    def test_html_title(self):\n        soup = BeautifulSoup(self.google.content, &quot;html.parser&quot;)\n        assert soup.title.text.upper() == &quot;GOOGLE&quot;\n</code></pre>\n<p>Hope that helps anyone else coming to this question.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 19044543,
                        "reputation": 6953,
                        "user_id": 13903942,
                        "user_type": "registered",
                        "display_name": "Federico Ba&#249;"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1679474418,
                    "creation_date": 1679474418,
                    "answer_id": 75809984,
                    "question_id": 50132703,
                    "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/75809984#75809984",
                    "body": "<h4>Share same instance of object to all tests (or modular tests) using combination of <code>conftest.py</code> , fixtures and plain class</h4>\n<p>I'd like to share my solution, which comes from the Pytest documentation (7.2 currently)</p>\n<h3><a href=\"https://docs.pytest.org/en/7.2.x/how-to/fixtures.html#modularity-using-fixtures-from-a-fixture-function\" rel=\"nofollow noreferrer\">Modularity: using fixtures from a fixture function</a></h3>\n<p>Now, if we combine it with a <code>conftest.py</code> this is what we could do:\nFirst having this structure (just to show sub-module and that, object is instanciated once for all tests)</p>\n<pre><code>\n\u251c\u2500\u2500 conftest.py\n\u251c\u2500\u2500 sub_folder\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test_sub_1.py\n\u251c\u2500\u2500 test_1.py\n\u251c\u2500\u2500 test_2.py\n</code></pre>\n<p>This is the content\n<strong>conftest.py</strong></p>\n<pre><code>&quot;&quot;&quot;tests/conftest.py&quot;&quot;&quot;\nimport pytest\n\n\nclass MockServer():\n    def get(self, url):\n        return &quot;hello-world&quot;\n\nclass App:\n    def __init__(self, http_connection):\n        print(&quot;APP CREATED&quot;)\n        self.http_connection = http_connection\n\n@pytest.fixture(scope=&quot;session&quot;)\ndef http_connection():\n    print(&quot;HTTP_CONNECTION FIXTURE&quot;)\n    return MockServer()\n\n@pytest.fixture(scope=&quot;session&quot;)\ndef app(http_connection):\n    print(&quot;CREATE APP&quot;)\n    return App(http_connection)\n\n</code></pre>\n<p><strong>tests/test_1.py</strong></p>\n<pre><code>class TestClass1:\n\n    def test_1(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n    def test_2(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n</code></pre>\n<p><strong>tests/test_2.py</strong></p>\n<pre><code>class TestClass2:\n\n    def test_1(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n    def test_2(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n</code></pre>\n<p><strong>tests/sub_folder/test_sub_1.py</strong></p>\n<pre><code>&quot;&quot;&quot;tests/sub_folder/test_sub_1.py&quot;&quot;&quot;\n\nclass TestSubClass1:\n\n    def test_sub_1(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n    def test_sub_2(self, app):\n        http_connection = app.http_connection\n\n        assert http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n</code></pre>\n<p>Now, lets run</p>\n<pre><code>pytest -rP\n</code></pre>\n<p>The output should be something like</p>\n<pre><code>tests/test_1.py::TestClass1::test_1 PASSED                                                                                               [ 16%]\ntests/test_1.py::TestClass1::test_2 PASSED                                                                                               [ 33%]\ntests/test_2.py::TestClass2::test_1 PASSED                                                                                               [ 50%]\ntests/test_2.py::TestClass2::test_2 PASSED                                                                                               [ 66%]\ntests/sub_folder/test_sub_1.py::TestSubClass1::test_sub_1 PASSED                                                                         [ 83%]\ntests/sub_folder/test_sub_1.py::TestSubClass1::test_sub_2 PASSED                                                                         [100%]\n\n==================================================================== PASSES ====================================================================\n______________________________________________________________ TestClass1.test_1 _______________________________________________________________\n------------------------------------------------------------ Captured stdout setup -------------------------------------------------------------\nHTTP_CONNECTION FIXTURE\nCREATE APP\nAPP CREATED\n============================================================== 6 passed in 0.23s ===============================================================\n</code></pre>\n<p>As you can see, by the output, (HTTP_CONNECTION FIXTURE, CREATE APP, APP CREATED) is run <strong>only once.</strong> That's good when we need to share reasource across all tests.\nHaving said that, now let's combine it with <a href=\"https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#50135020\">hoefling</a> answer, I only add <strong>tests/test_1.py</strong></p>\n<p><strong>tests/test_1.py</strong></p>\n<pre><code>&quot;&quot;&quot;tests/test_1.py&quot;&quot;&quot;\nimport pytest\n\nclass TestClass1:\n    @pytest.fixture(autouse=True)\n    def _app(self, app):\n        self.app = app\n\n    def test_1(self):\n        assert self.app.http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n    def test_2(self):\n        assert self.app.http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n</code></pre>\n<p>That's already better, but we can take it a step further, let's have a Base test class and having our test inherit from it\n<strong>conftest.py</strong></p>\n<pre><code>&quot;&quot;&quot;tests/conftest.py&quot;&quot;&quot;\nimport pytest\n\n\nclass MockServer():\n    def get(self, url):\n        return &quot;hello-world&quot;\n\nclass App:\n    def __init__(self, http_connection):\n        print(&quot;APP CREATED&quot;)\n        self.http_connection = http_connection\n\n@pytest.fixture(scope=&quot;session&quot;)\ndef http_connection():\n    print(&quot;HTTP_CONNECTION FIXTURE&quot;)\n    return MockServer()\n\n@pytest.fixture(scope=&quot;session&quot;)\ndef app(http_connection):\n    print(&quot;CREATE APP&quot;)\n    return App(http_connection)\n\n\nclass Base:\n    @pytest.fixture(autouse=True)\n    def _app(self, app):\n        self.app = app\n\n</code></pre>\n<p>Now &quot;&quot;&quot;tests/test_1.py&quot;&quot;&quot; can look like</p>\n<pre><code>&quot;&quot;&quot;tests/test_1.py&quot;&quot;&quot;\nfrom conftest import Base\n\nclass TestClass1(Base):\n\n    def test_1(self):\n        assert self.app.http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n    def test_2(self):\n        assert self.app.http_connection.get(&quot;my-url&quot;) ==  &quot;hello-world&quot;\n\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 5690173,
                "reputation": 9330,
                "user_id": 4498470,
                "user_type": "registered",
                "display_name": "Donal"
            },
            "comment_count": 0,
            "is_answered": true,
            "accepted_answer_id": 50135020,
            "answer_count": 3,
            "score": 78,
            "last_activity_date": 1679474418,
            "creation_date": 1525257744,
            "question_id": 50132703,
            "link": "https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument",
            "title": "Pytest fixture for a class through self not as method argument",
            "body": "<p>Often I'll write a test class that uses a pytest fixture in every method. Here's an example. I'd like to be able to avoid having to write the fixture name in the signature of every method. It's not DRY. How can this be done? </p>\n\n<p>I would like to be able to access the fixture by giving the fixture as an attribute of the test class. In this example, I would like to see the google fixture as an attribute of TestGoogle. Is this possible?</p>\n\n<pre><code>from bs4 import BeautifulSoup\nimport pytest\nimport requests\n\n@pytest.fixture()\ndef google():\n    return requests.get(\"https://www.google.com\")\n\n\nclass TestGoogle:\n    def test_alive(self, google):\n        assert google.status_code == 200\n\n    def test_html_title(self, google):\n        soup = BeautifulSoup(google.content, \"html.parser\")\n        assert soup.title.text.upper() == \"GOOGLE\"\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7805
}