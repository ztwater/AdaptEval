{
    "items": [
        {
            "tags": [
                "python",
                "regex",
                "string"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 60200,
                        "reputation": 484308,
                        "user_id": 179910,
                        "user_type": "registered",
                        "display_name": "Jerry Coffin"
                    },
                    "edited": false,
                    "score": 4,
                    "creation_date": 1266937141,
                    "post_id": 2319019,
                    "comment_id": 2287162,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment2287162_2319019",
                    "body": "There&#39;s really only one reasonable reply: <a href=\"http://kore-nordmann.de/blog/do_NOT_parse_using_regexp.html\" rel=\"nofollow noreferrer\">kore-nordmann.de/blog/do_NOT_parse_using_regexp.html</a>. He was talking about a different language, but his conclusion remains valid."
                },
                {
                    "owner": {
                        "user_type": "does_not_exist",
                        "display_name": "user180247"
                    },
                    "reply_to_user": {
                        "account_id": 60200,
                        "reputation": 484308,
                        "user_id": 179910,
                        "user_type": "registered",
                        "display_name": "Jerry Coffin"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1266945834,
                    "post_id": 2319019,
                    "comment_id": 2288567,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment2288567_2319019",
                    "body": "@Jerry - Strictly speaking, you can often guess a reasonable nesting limit, and define a regular approximation of the language. Many compilers have a comment-nesting limit anyway. But - what limit is safe? Also, I don&#39;t want to debug the regex. Good link either way."
                },
                {
                    "owner": {
                        "account_id": 60200,
                        "reputation": 484308,
                        "user_id": 179910,
                        "user_type": "registered",
                        "display_name": "Jerry Coffin"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1266948428,
                    "post_id": 2319019,
                    "comment_id": 2289011,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment2289011_2319019",
                    "body": "@Steve314: you can guess at a reasonable nesting limit (e.g. in C, comments simply don&#39;t nest at all), but that does little good. Just for an obvious example, a comment delimiter in a string literal doesn&#39;t count, but a comment delimiter broken across lines (with a back-slash between the characters) <i>does</i> count. Taking either into account correctly in an RE is non-trivial at best."
                },
                {
                    "owner": {
                        "account_id": 273943,
                        "reputation": 24229,
                        "user_id": 565877,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "Devin Rhode"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1354941440,
                    "post_id": 2319019,
                    "comment_id": 18938633,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment18938633_2319019",
                    "body": "Some of your regex above just saved my life ;)"
                },
                {
                    "owner": {
                        "account_id": 125888,
                        "reputation": 26747,
                        "user_id": 321973,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "Tobias Kienzler"
                    },
                    "reply_to_user": {
                        "account_id": 60200,
                        "reputation": 484308,
                        "user_id": 179910,
                        "user_type": "registered",
                        "display_name": "Jerry Coffin"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1377178667,
                    "post_id": 2319019,
                    "comment_id": 26993602,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment26993602_2319019",
                    "body": "@JerryCoffin Actually, the reasonable reply would be <a href=\"http://stackoverflow.com/a/1732454/321973\">stackoverflow.com/a/1732454/321973</a>"
                },
                {
                    "owner": {
                        "account_id": 125888,
                        "reputation": 26747,
                        "user_id": 321973,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "Tobias Kienzler"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1377179093,
                    "post_id": 2319019,
                    "comment_id": 26993919,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment26993919_2319019",
                    "body": "On a different note, couldn&#39;t you just use a C++ preprocessor?"
                },
                {
                    "owner": {
                        "account_id": 59890,
                        "reputation": 27822,
                        "user_id": 179081,
                        "user_type": "registered",
                        "accept_rate": 87,
                        "display_name": "Frames Catherine White"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1377180223,
                    "post_id": 2319019,
                    "comment_id": 26994805,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment26994805_2319019",
                    "body": "Tobias, yes, iirc GCC -E"
                },
                {
                    "owner": {
                        "account_id": 125888,
                        "reputation": 26747,
                        "user_id": 321973,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "Tobias Kienzler"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1377241383,
                    "post_id": 2319019,
                    "comment_id": 27019158,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files#comment27019158_2319019",
                    "body": "I see, but that&#39;s probably not intended to be used in your case. Anyway, I see <a href=\"http://stackoverflow.com/a/18381470/321973\">Onur YILDIRIM&#39;s answer</a> even manages quotes and comments interleaving"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user180247"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266937806,
                            "post_id": 2319054,
                            "comment_id": 2287264,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2287264_2319054",
                            "body": "Of course one of the common expected differences between a lexer and a parser is that a lexer only supports a regular language. Not always true of course (e.g. see Ragel) as with regex. A good lexer can do the job, but as with using a parser, it seems like massive overkill just for comment stripping."
                        },
                        {
                            "owner": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266939906,
                            "post_id": 2319054,
                            "comment_id": 2287630,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2287630_2319054",
                            "body": "@Steve314, If by &quot;overkill&quot; you mean <i>totally the right tool for the job</i>, then yeah. All of the regexps posted here are extremely buggy and will not do the right thing when faced with valid, realistic C(++) code."
                        },
                        {
                            "owner": {
                                "account_id": 33136,
                                "reputation": 27982,
                                "user_id": 92493,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Otto Allmendinger"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266943844,
                            "post_id": 2319054,
                            "comment_id": 2288324,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2288324_2319054",
                            "body": "Read up about the lexer, removed my recommendation of a lexer"
                        },
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user180247"
                            },
                            "reply_to_user": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266945211,
                            "post_id": 2319054,
                            "comment_id": 2288489,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2288489_2319054",
                            "body": "@Mike - On second thoughts, I agree - but the specific reason hasn&#39;t been mentioned (though it&#39;s a special case of your &quot;valid, realistic&quot; point). I just thought about things that look like comment markers, but are actually just characters in string literals. Avoiding those without the right tools would be a nasty job. Grab an existing C lexer (as long as it preserves the whitespace) - not so bad."
                        },
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user180247"
                            },
                            "reply_to_user": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266945279,
                            "post_id": 2319054,
                            "comment_id": 2288499,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2288499_2319054",
                            "body": "@Mike - my own answer deleted as a result - considered harmful."
                        },
                        {
                            "owner": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266947573,
                            "post_id": 2319054,
                            "comment_id": 2288845,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#comment2288845_2319054",
                            "body": "@Steve314, That is the obvious valid, realistic code. (Like the example I posted in reply to msanders earlier.)"
                        }
                    ],
                    "owner": {
                        "account_id": 33136,
                        "reputation": 27982,
                        "user_id": 92493,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "Otto Allmendinger"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1266941192,
                    "last_edit_date": 1266941192,
                    "creation_date": 1266937085,
                    "answer_id": 2319054,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319054#2319054",
                    "body": "<p>You are doing it wrong. </p>\n\n<p>Regex is for <a href=\"http://en.wikipedia.org/wiki/Regular_language\" rel=\"nofollow noreferrer\">Regular Languages</a>, which C isn't. </p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 66177,
                                "reputation": 33358,
                                "user_id": 194311,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "jathanism"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266937850,
                            "post_id": 2319078,
                            "comment_id": 2287270,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#comment2287270_2319078",
                            "body": "Regex is bad, but parsing is overkill?  I am confused; what else is there?"
                        },
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user180247"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266945432,
                            "post_id": 2319078,
                            "comment_id": 2288520,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#comment2288520_2319078",
                            "body": "I was looking at the problem wrong - searching based on a simple alternation regex is much easier than writing a parser. That said, it doesn&#39;t address confusion caused by things in strings. A parser (or Lexer) as Mike commented may be exactly the right tool for the job."
                        },
                        {
                            "owner": {
                                "account_id": 66177,
                                "reputation": 33358,
                                "user_id": 194311,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "jathanism"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266953905,
                            "post_id": 2319078,
                            "comment_id": 2289837,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#comment2289837_2319078",
                            "body": "Yeah, Regex is &quot;easy&quot; if your input is easy such as things with consistent format like IP addresses or phone numbers. For all other things: lexer."
                        },
                        {
                            "owner": {
                                "account_id": 58364,
                                "reputation": 299717,
                                "user_id": 174728,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "John La Rooy"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266975354,
                            "post_id": 2319078,
                            "comment_id": 2292320,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#comment2292320_2319078",
                            "body": "I don&#39;t think it&#39;s leave an extra newline - the newline just isn&#39;t part of the comment so it&#39;s not stripped, and it&#39;s not necessarily safe to do so as newline <i>can</i> be used as significant whitespace in C"
                        },
                        {
                            "owner": {
                                "account_id": 66177,
                                "reputation": 33358,
                                "user_id": 194311,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "jathanism"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1267024684,
                            "post_id": 2319078,
                            "comment_id": 2296636,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#comment2296636_2319078",
                            "body": "Ah, that is a good observation and now that I look at it again I agree. :)"
                        }
                    ],
                    "owner": {
                        "account_id": 66177,
                        "reputation": 33358,
                        "user_id": 194311,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "jathanism"
                    },
                    "comment_count": 5,
                    "is_accepted": false,
                    "score": 24,
                    "last_activity_date": 1266955431,
                    "last_edit_date": 1266955431,
                    "creation_date": 1266937210,
                    "answer_id": 2319078,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319078#2319078",
                    "body": "<p>I would suggest using a REAL parser like <a href=\"http://pypi.python.org/pypi/SimpleParse/2.1.1a2\" rel=\"noreferrer\">SimpleParse</a> or <a href=\"http://pypi.python.org/pypi/pyparsing/1.5.2\" rel=\"noreferrer\">PyParsing</a>.  SimpleParse requires that you actually know EBNF, but is very fast.  PyParsing has its own EBNF-like syntax but that is adapted for Python and makes it a breeze to build powerfully accurate parsers.</p>\n\n<p><strong>Edit:</strong> </p>\n\n<p>Here is an example of how easy it is to use PyParsing in this context:</p>\n\n<pre><code>&gt;&gt;&gt; test = '/* spam * spam */ eggs'\n&gt;&gt;&gt; import pyparsing\n&gt;&gt;&gt; comment = pyparsing.nestedExpr(\"/*\", \"*/\").suppress()\n&gt;&gt;&gt; print comment.transformString(test)         \n' eggs'\n</code></pre>\n\n<p>Here is a more complex example using single and multi-line comments.</p>\n\n<p>Before:</p>\n\n<pre><code>/*\n * multiline comments\n * abc 2323jklj\n * this is the worst C code ever!!\n*/\nvoid\ndo_stuff ( int shoe, short foot ) {\n    /* this is a comment\n     * multiline again! \n     */\n    exciting_function(whee);\n} /* extraneous comment */\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>&gt;&gt;&gt; print comment.transformString(code)   \n\nvoid\ndo_stuff ( int shoe, short foot ) {\n\n     exciting_function(whee);\n} \n</code></pre>\n\n<p>It leaves an extra newline wherever it stripped comments, but that could be addressed.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1266940058,
                            "post_id": 2319116,
                            "comment_id": 2287668,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment2287668_2319116",
                            "body": "<code>char *note = &quot;You can make a one-line comment with &#47;&#47;&quot;;</code> Oops."
                        },
                        {
                            "owner": {
                                "account_id": 770,
                                "reputation": 5849,
                                "user_id": 1002,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "msanders"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266941751,
                            "post_id": 2319116,
                            "comment_id": 2288003,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment2288003_2319116",
                            "body": "Indeed. This only answers why the OP&#39;s function returned nothing."
                        },
                        {
                            "owner": {
                                "account_id": 59890,
                                "reputation": 27822,
                                "user_id": 179081,
                                "user_type": "registered",
                                "accept_rate": 87,
                                "display_name": "Frames Catherine White"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266997276,
                            "post_id": 2319116,
                            "comment_id": 2293732,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment2293732_2319116",
                            "body": "this is the technically correct answer to the question. Maybe using a phasor is a better way to solve my problem, but this made my code work."
                        },
                        {
                            "owner": {
                                "account_id": 44378,
                                "reputation": 6117,
                                "user_id": 130221,
                                "user_type": "registered",
                                "accept_rate": 76,
                                "display_name": "Nicholas Franceschina"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1297292706,
                            "post_id": 2319116,
                            "comment_id": 5523581,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment5523581_2319116",
                            "body": "string = re.sub(re.compile(&quot;^//.*?$&quot;, re.MULTILINE ) ,&quot;&quot; ,string)"
                        },
                        {
                            "owner": {
                                "account_id": 1762936,
                                "reputation": 11030,
                                "user_id": 1609514,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Bill"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1426448066,
                            "post_id": 2319116,
                            "comment_id": 46366150,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment46366150_2319116",
                            "body": "The code above doesn&#39;t work for me for single-line comments.  removeComments(&quot;// single-line comments&quot;) returns &#39;// single-line comments&#39;"
                        },
                        {
                            "owner": {
                                "account_id": 1066462,
                                "reputation": 2054,
                                "user_id": 1066891,
                                "user_type": "registered",
                                "display_name": "Gombat"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1445430723,
                            "post_id": 2319116,
                            "comment_id": 54319819,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment54319819_2319116",
                            "body": "Is this because the text <code>&quot;&#47;&#47; single-line comments&quot;</code> has no newline as the last symbol?"
                        },
                        {
                            "owner": {
                                "account_id": 1508549,
                                "reputation": 6201,
                                "user_id": 2516916,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "Gillespie"
                            },
                            "reply_to_user": {
                                "account_id": 65561,
                                "reputation": 75437,
                                "user_id": 192839,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Mike Graham"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1659378261,
                            "post_id": 2319116,
                            "comment_id": 129275765,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#comment129275765_2319116",
                            "body": "@MikeGraham it&#39;s so simple though that if your use case can reasonably have the constraint &quot;no comments inside of strings&quot;, then it&#39;s an excellent solution. I can think of exactly zero times in my career where I&#39;ve had to both strip comments from a file <i>and</i> the file contained strings containing comments. My use case for this is stripping comments from jsonc files before parsing, and this solution works great and doesn&#39;t require me to pull in a 3rd party package."
                        }
                    ],
                    "owner": {
                        "account_id": 770,
                        "reputation": 5849,
                        "user_id": 1002,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "msanders"
                    },
                    "comment_count": 7,
                    "is_accepted": true,
                    "score": 49,
                    "last_activity_date": 1554652310,
                    "last_edit_date": 1554652310,
                    "creation_date": 1266937487,
                    "answer_id": 2319116,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319116#2319116",
                    "body": "<p><code>re.sub</code> returns a string, so changing your code to the following will give results:</p>\n\n<pre><code>def removeComments(string):\n    string = re.sub(re.compile(\"/\\*.*?\\*/\",re.DOTALL ) ,\"\" ,string) # remove all occurrences streamed comments (/*COMMENT */) from string\n    string = re.sub(re.compile(\"//.*?\\n\" ) ,\"\" ,string) # remove all occurrence single-line comments (//COMMENT\\n ) from string\n    return string\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 60200,
                                "reputation": 484308,
                                "user_id": 179910,
                                "user_type": "registered",
                                "display_name": "Jerry Coffin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1266948738,
                            "post_id": 2319146,
                            "comment_id": 2289058,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319146#comment2289058_2319146",
                            "body": "Unless I&#39;ve missed something, this would miss a comment delimiter spliced across lines (slash, backslash, new-line, asterisk or asterisk, backslash, newline, slash). Worse, that backslash can be generated as the trigraph sequence <code>??&#47;</code> (though I&#39;ll admit trigraphs are pretty rare)."
                        }
                    ],
                    "owner": {
                        "account_id": 100575,
                        "reputation": 1779,
                        "user_id": 271047,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "MatsT"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1266937650,
                    "creation_date": 1266937650,
                    "answer_id": 2319146,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319146#2319146",
                    "body": "<p>I would recommend you read this page that has a quite detailed analyzis of the problem and gives a good understanding on why your approach doesn't work: <a href=\"http://ostermiller.org/findcomment.html\" rel=\"nofollow noreferrer\">http://ostermiller.org/findcomment.html</a></p>\n\n<p>Short version: The regex you are looking for is this:</p>\n\n<pre><code>(/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)\n</code></pre>\n\n<p>This should match both types of comment blocks. If you are having troubles following it read the page i linked.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 83096,
                        "reputation": 69,
                        "user_id": 233200,
                        "user_type": "registered",
                        "display_name": "jhoon"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1266937680,
                    "creation_date": 1266937680,
                    "answer_id": 2319150,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2319150#2319150",
                    "body": "<p>I see several things you might want to revise.</p>\n\n<p>First, Python passes objects by value, but some object types are immutable. Strings and integers are among these immutable types. So if you pass a string to a function, any changes to the string you make within the function won't affect the string you passed in. You should try returning a string instead. Furthermore, within the removeComments() function, you need to assign the value returned by re.sub() to a new variable -- like any function that takes a string as an argument, re.sub() will not modify the string.</p>\n\n<p>Second, I would echo what others have said about parsing C code. Regular expressions are not the best way to go here.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 60200,
                        "reputation": 484308,
                        "user_id": 179910,
                        "user_type": "registered",
                        "display_name": "Jerry Coffin"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1266949443,
                    "last_edit_date": 1495542749,
                    "creation_date": 1266949443,
                    "answer_id": 2320670,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2320670#2320670",
                    "body": "<p>As noted in one of my other comments, comment nesting isn't really the problem (in C, comments don't nest, though a few compilers to support nested comments anyway). The problem is with things like string literals, that can contain the exact same character sequence as a comment delimiter without actually being one.</p>\n\n<p>As Mike Graham said, the right tool for the job is a lexer. A parser is unnecessary and would be overkill, but a lexer is exactly the right thing. As it happens, I posted a (partial) <a href=\"https://stackoverflow.com/questions/2318347/library-to-parse-c-c-source-code/2319255#2319255\">lexer</a> for C (and C++) earlier this morning. It doesn't attempt to correctly identify all lexical elements (i.e. all keywords and operators) but it's entirely sufficient for stripping comments. It won't do any good on the \"using Python\" front though, as it's written entirely in C (it predates my using C++ for much more than experimental code).</p>\n"
                },
                {
                    "owner": {
                        "account_id": 44762,
                        "reputation": 335363,
                        "user_id": 131527,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "ghostdog74"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1266971504,
                    "creation_date": 1266971504,
                    "answer_id": 2322860,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/2322860#2322860",
                    "body": "<pre><code>mystring=\"\"\"\nblah1 /* comments with\nmultiline */\n\nblah2\nblah3\n// double slashes comments\nblah4 // some junk comments\n\n\"\"\"\nfor s in mystring.split(\"*/\"):\n    s=s[:s.find(\"/*\")]\n    print s[:s.find(\"//\")]\n</code></pre>\n\n<p>output</p>\n\n<pre><code>$ ./python.py\n\nblah1\n\n\nblah2\nblah3\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3075369,
                                "reputation": 305,
                                "user_id": 2604880,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "harishli2020"
                            },
                            "reply_to_user": {
                                "account_id": 1869515,
                                "reputation": 10597,
                                "user_id": 1692107,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hivert"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1374438924,
                            "post_id": 17776351,
                            "comment_id": 25927778,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/17776351#comment25927778_17776351",
                            "body": "Sorry, didn&#39;t understand what is PO?"
                        },
                        {
                            "owner": {
                                "account_id": 1869515,
                                "reputation": 10597,
                                "user_id": 1692107,
                                "user_type": "registered",
                                "accept_rate": 95,
                                "display_name": "hivert"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1374438995,
                            "post_id": 17776351,
                            "comment_id": 25927800,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/17776351#comment25927800_17776351",
                            "body": "Sorry I meant OP (<a href=\"http://meta.stackexchange.com/questions/79804/whats-stackexchange-ese-for-op\" title=\"whats stackexchange ese for op\">meta.stackexchange.com/questions/79804/&hellip;</a>)"
                        },
                        {
                            "owner": {
                                "account_id": 6694112,
                                "reputation": 2144,
                                "user_id": 5506400,
                                "user_type": "registered",
                                "display_name": "run_the_race"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1636738305,
                            "post_id": 17776351,
                            "comment_id": 123645277,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/17776351#comment123645277_17776351",
                            "body": "The people probably downvoted you because you read and write from the file multiple times. Should rather read into memory once, perform your operations, then when done write to file once. Its much faster to work from memory."
                        }
                    ],
                    "owner": {
                        "account_id": 3075369,
                        "reputation": 305,
                        "user_id": 2604880,
                        "user_type": "registered",
                        "accept_rate": 78,
                        "display_name": "harishli2020"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": -2,
                    "last_activity_date": 1374439527,
                    "last_edit_date": 1374439527,
                    "creation_date": 1374436903,
                    "answer_id": 17776351,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/17776351#17776351",
                    "body": "<p>This program removes comments with // and /* */ from the given file:</p>\n\n<pre><code>#! /usr/bin/python3\nimport sys\nimport re\nif len(sys.argv)!=2:\n     exit(\"Syntax:python3 exe18.py inputfile.cc \")\nelse:\n     print ('The following files are given by you:',sys.argv[0],sys.argv[1])\nwith open(sys.argv[1],'r') as ifile:\n    newstring=re.sub(r'/\\*.*?\\*/',' ',ifile.read(),flags=re.S)\nwith open(sys.argv[1],'w') as ifile:\n    ifile.write(newstring)\nprint('/* */ have been removed from the inputfile')\nwith open(sys.argv[1],'r') as ifile:\n      newstring1=re.sub(r'//.*',' ',ifile.read())\nwith open(sys.argv[1],'w') as ifile:\n      ifile.write(newstring1)\nprint('// have been removed from the inputfile')\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 125888,
                                "reputation": 26747,
                                "user_id": 321973,
                                "user_type": "registered",
                                "accept_rate": 81,
                                "display_name": "Tobias Kienzler"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1377178897,
                            "post_id": 18381470,
                            "comment_id": 26993777,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment26993777_18381470",
                            "body": "What about <code>&#47;* Maybe we &#47;&#47; &quot;shouldn&#39;t &#47;* do this *&#47;&#47;&#47; but let&#39;s do it *&#47; &#47;&#47;&quot; anyway</code> (insert linebreacks at will)"
                        },
                        {
                            "owner": {
                                "account_id": 125888,
                                "reputation": 26747,
                                "user_id": 321973,
                                "user_type": "registered",
                                "accept_rate": 81,
                                "display_name": "Tobias Kienzler"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1377241152,
                            "post_id": 18381470,
                            "comment_id": 27019032,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment27019032_18381470",
                            "body": "Neat, it even manages interleaving &#224; la <code>&#39;a = &#47;* a &quot;-nested string *&#47; &quot;comments can end with *&#47;&quot; &#47;&#47; comment2&#39;</code>! I see grouping makes regexes much more powerful <i>and</i> understandable. I wonder whether one could still construct valid C-code that makes your regex fail ;) But that would probably involve some very nasty precompiler stuff..."
                        },
                        {
                            "owner": {
                                "account_id": 260502,
                                "reputation": 1836,
                                "user_id": 544099,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "ishmael"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1394477654,
                            "post_id": 18381470,
                            "comment_id": 33898237,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment33898237_18381470",
                            "body": "This method fails if you have escaped quotes, e.g. <code>&quot;some 2\\&quot; string&quot; &#47;* remove this *&#47; &quot;another string&quot;</code>"
                        },
                        {
                            "owner": {
                                "account_id": 260502,
                                "reputation": 1836,
                                "user_id": 544099,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "ishmael"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1394478593,
                            "post_id": 18381470,
                            "comment_id": 33898808,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment33898808_18381470",
                            "body": "Here&#39;s an improved regex that does a negative lookbehind to avoid escaped quotes. <code>r&quot;(\\&quot;.*?(?&lt;!\\\\)\\&quot;|\\&#39;.*?(?&lt;!\\\\)\\&#39;)|(&#47;\\*.*?\\*&#47;|&#47;&#47;[^\\r\\n]*$)&quot;</code>"
                        },
                        {
                            "owner": {
                                "account_id": 6885817,
                                "reputation": 6471,
                                "user_id": 5290909,
                                "user_type": "registered",
                                "display_name": "Mariano"
                            },
                            "reply_to_user": {
                                "account_id": 260502,
                                "reputation": 1836,
                                "user_id": 544099,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "ishmael"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1444035846,
                            "post_id": 18381470,
                            "comment_id": 53714625,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment53714625_18381470",
                            "body": "@ishmael What about <code>&quot;string with backslash \\\\&quot; &#47;* remove this *&#47;  &quot;...&quot;</code>?"
                        },
                        {
                            "owner": {
                                "account_id": 6784526,
                                "reputation": 6281,
                                "user_id": 5223757,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "wizzwizz4"
                            },
                            "reply_to_user": {
                                "account_id": 6885817,
                                "reputation": 6471,
                                "user_id": 5290909,
                                "user_type": "registered",
                                "display_name": "Mariano"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522596715,
                            "post_id": 18381470,
                            "comment_id": 86206417,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment86206417_18381470",
                            "body": "@Mariano Replace the look-behind with <a href=\"https://stackoverflow.com/a/24209736/5223757\">this</a> look-behind."
                        },
                        {
                            "owner": {
                                "account_id": 6784526,
                                "reputation": 6281,
                                "user_id": 5223757,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "wizzwizz4"
                            },
                            "reply_to_user": {
                                "account_id": 6885817,
                                "reputation": 6471,
                                "user_id": 5290909,
                                "user_type": "registered",
                                "display_name": "Mariano"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522604332,
                            "post_id": 18381470,
                            "comment_id": 86208770,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment86208770_18381470",
                            "body": "@Mariano Why would it be better to unroll the loop? Regular expressions are powerful enough to do the job, and they fulfill the question requirements."
                        },
                        {
                            "owner": {
                                "account_id": 6885817,
                                "reputation": 6471,
                                "user_id": 5290909,
                                "user_type": "registered",
                                "display_name": "Mariano"
                            },
                            "reply_to_user": {
                                "account_id": 6784526,
                                "reputation": 6281,
                                "user_id": 5223757,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "wizzwizz4"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522604503,
                            "post_id": 18381470,
                            "comment_id": 86208815,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment86208815_18381470",
                            "body": "@wizzwizz4 unrolling the loop is a technique that also applies to regex. Check <a href=\"https://stackoverflow.com/search?tab=votes&amp;q=%5bregex%5d%20unrolling%20the%20loop\">some of the answers</a>"
                        },
                        {
                            "owner": {
                                "account_id": 6784526,
                                "reputation": 6281,
                                "user_id": 5223757,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "wizzwizz4"
                            },
                            "reply_to_user": {
                                "account_id": 6885817,
                                "reputation": 6471,
                                "user_id": 5290909,
                                "user_type": "registered",
                                "display_name": "Mariano"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522605017,
                            "post_id": 18381470,
                            "comment_id": 86208994,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment86208994_18381470",
                            "body": "@Mariano So it should really be replaced by <a href=\"https://stackoverflow.com/a/5696141/5223757\">this</a> one?"
                        },
                        {
                            "owner": {
                                "account_id": 3804433,
                                "reputation": 317,
                                "user_id": 3157230,
                                "user_type": "registered",
                                "display_name": "Dubrzr"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1634804560,
                            "post_id": 18381470,
                            "comment_id": 123125860,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#comment123125860_18381470",
                            "body": "I wanted to match SQL comments, I modified it a little and line returns were not included for me, I used this: <code>(\\&quot;.*?(?&lt;!\\\\)\\&quot;|\\&#39;.*?(?&lt;!\\\\)\\&#39;)|(\\&#47;\\*[\\S\\n\\t\\v ]*?\\*\\&#47;|--[^\\r\\n]*$)</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 39114,
                        "reputation": 33186,
                        "user_id": 112731,
                        "user_type": "registered",
                        "accept_rate": 76,
                        "display_name": "Onur Y\u0131ld\u0131r\u0131m"
                    },
                    "comment_count": 10,
                    "is_accepted": false,
                    "score": 57,
                    "last_activity_date": 1579312950,
                    "last_edit_date": 1579312950,
                    "creation_date": 1377177139,
                    "answer_id": 18381470,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/18381470#18381470",
                    "body": "<p>What about <code>\"//comment-like strings inside quotes\"</code>?</p>\n\n<p>OP is asking how to do do it using regular expressions; so: \n</p>\n\n<pre><code>def remove_comments(string):\n    pattern = r\"(\\\".*?\\\"|\\'.*?\\')|(/\\*.*?\\*/|//[^\\r\\n]*$)\"\n    # first group captures quoted strings (double or single)\n    # second group captures comments (//single-line or /* multi-line */)\n    regex = re.compile(pattern, re.MULTILINE|re.DOTALL)\n    def _replacer(match):\n        # if the 2nd group (capturing comments) is not None,\n        # it means we have captured a non-quoted (real) comment string.\n        if match.group(2) is not None:\n            return \"\" # so we will return empty to remove the comment\n        else: # otherwise, we will return the 1st group\n            return match.group(1) # captured quoted-string\n    return regex.sub(_replacer, string)\n</code></pre>\n\n<p>This <strong>WILL</strong> remove:</p>\n\n<ul>\n<li><code>/* multi-line comments */</code></li>\n<li><code>// single-line comments</code></li>\n</ul>\n\n<p><strong>Will NOT</strong> remove:</p>\n\n<ul>\n<li><code>String var1 = \"this is /* not a comment. */\";</code></li>\n<li><code>char *var2 = \"this is // not a comment, either.\";</code></li>\n<li><code>url = 'http://not.comment.com';</code></li>\n</ul>\n\n<p><strong><em>Note</strong>: This will also work for <strong>Javascript</strong> source.</em></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 14309001,
                                "reputation": 11357,
                                "user_id": 10335956,
                                "user_type": "registered",
                                "display_name": "E.Coms"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1540132766,
                            "post_id": 52916095,
                            "comment_id": 92742785,
                            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/52916095#comment92742785_52916095",
                            "body": "Why is the related to original question?"
                        }
                    ],
                    "owner": {
                        "account_id": 9569183,
                        "reputation": 119,
                        "user_id": 7107396,
                        "user_type": "registered",
                        "display_name": "Saurabh Kukreti"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1540130966,
                    "last_edit_date": 1540130966,
                    "creation_date": 1540130515,
                    "answer_id": 52916095,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/52916095#52916095",
                    "body": "<p>Just want add another regex where we have to remove anything between * and ; in python</p>\n\n<p>data = re.sub(re.compile(\"*.*?\\;\",re.DOTALL),' ',data)</p>\n\n<p>there is backslash before * to escape the meta character.  </p>\n"
                },
                {
                    "owner": {
                        "account_id": 4787757,
                        "reputation": 139,
                        "user_id": 3867739,
                        "user_type": "registered",
                        "display_name": "Gokul"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1616604139,
                    "creation_date": 1616604139,
                    "answer_id": 66785534,
                    "question_id": 2319019,
                    "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files/66785534#66785534",
                    "body": "<p>Found another solution with pyparsing following Jathanism.</p>\n<pre><code>import pyparsing\n\ntest = &quot;&quot;&quot;\n/* Code my code\nxx to remove comments in C++\nor C or python */\n\ninclude &lt;iostream&gt; // Some comment\n\nint main (){\n    cout &lt;&lt; &quot;hello world&quot; &lt;&lt; std::endl; // comment\n}\n&quot;&quot;&quot;\ncommentFilter = pyparsing.cppStyleComment.suppress()\n# To filter python style comment, use\n# commentFilter = pyparsing.pythonStyleComment.suppress()\n# To filter C style comment, use\n# commentFilter = pyparsing.cStyleComment.suppress()\n\nnewtest = commentFilter.transformString(test)\nprint(newest)\n</code></pre>\n<p>Produces the following output:</p>\n<pre><code>include &lt;iostream&gt; \n\nint main (){\n    cout &lt;&lt; &quot;hello world&quot; &lt;&lt; std::endl; \n}\n</code></pre>\n<p>Can also use pythonStyleComment, javaStyleComment, cppStyleComment. Found it pretty useful.</p>\n"
                }
            ],
            "owner": {
                "account_id": 59890,
                "reputation": 27822,
                "user_id": 179081,
                "user_type": "registered",
                "accept_rate": 87,
                "display_name": "Frames Catherine White"
            },
            "comment_count": 8,
            "is_answered": true,
            "accepted_answer_id": 2319116,
            "answer_count": 11,
            "score": 34,
            "last_activity_date": 1616608691,
            "creation_date": 1266936774,
            "last_edit_date": 1616608691,
            "question_id": 2319019,
            "link": "https://stackoverflow.com/questions/2319019/using-regex-to-remove-comments-from-source-files",
            "title": "Using regex to remove comments from source files",
            "body": "<p>I'm making a program to automate the writing of some C code, (I'm writing to parse strings into enumerations with the same name)\nC's handling of strings is not that great.\nSo some people have been nagging me to try python.</p>\n<p>I made a function that is supposed to remove C-style <code>/* COMMENT */</code> and <code>//COMMENT</code>\nfrom a string:\nHere is the code:</p>\n<pre><code>def removeComments(string):\n    re.sub(re.compile(&quot;/\\*.*?\\*/&quot;,re.DOTALL ) ,&quot;&quot; ,string) # remove all occurance streamed comments (/*COMMENT */) from string\n    re.sub(re.compile(&quot;//.*?\\n&quot; ) ,&quot;&quot; ,string) # remove all occurance singleline comments (//COMMENT\\n ) from string\n</code></pre>\n<p>So I tried this code out.</p>\n<pre><code>str=&quot;/* spam * spam */ eggs&quot;\nremoveComments(str)\nprint str\n</code></pre>\n<p>And it apparently did nothing.</p>\n<p>Any suggestions as to what I've done wrong?</p>\n<p>There's a saying I've heard a couple of times:</p>\n<blockquote>\n<p>If you have a problem and you try to solve it with Regex you end up with two problems.</p>\n</blockquote>\n<hr />\n<p>EDIT:\nLooking back at this years later. (after a fair bit more parsing experience)</p>\n<p>I think regex may have been the right solution.\nAnd the simple regex used here &quot;good enough&quot;.\nI may not have emphasized this enough in the question.\nThis was for a single specific file. That had no tricky situations.\nI think it would be a lot less maintenance to keep the file being parsed simple enough for the regex, than to complicate the regex, into an unreadable symbol soup. (e.g. require that the file only use <code>//</code> single line comments.)</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9581
}