{
    "items": [
        {
            "tags": [
                "pytorch",
                "normal-distribution"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 3885495,
                        "reputation": 8810,
                        "user_id": 3216980,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "TYZ"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1581716124,
                    "post_id": 60233216,
                    "comment_id": 106542614,
                    "link": "https://stackoverflow.com/questions/60233216/how-to-make-a-truncated-normal-distribution-in-pytorch#comment106542614_60233216",
                    "body": "This seems to be helpful, you can basically replicate the equivalent scipy version: <a href=\"https://discuss.pytorch.org/t/implementing-truncated-normal-initializer/4778/20\" rel=\"nofollow noreferrer\">discuss.pytorch.org/t/implementing-truncated-normal-initiali&zwnj;&#8203;zer/&hellip;</a>"
                }
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 13908586,
                        "reputation": 66,
                        "user_id": 10042365,
                        "user_type": "registered",
                        "display_name": "Sachin Yadav"
                    },
                    "comment_count": 0,
                    "is_accepted": true,
                    "score": 3,
                    "last_activity_date": 1634231672,
                    "creation_date": 1634231672,
                    "answer_id": 69574790,
                    "question_id": 60233216,
                    "link": "https://stackoverflow.com/questions/60233216/how-to-make-a-truncated-normal-distribution-in-pytorch/69574790#69574790",
                    "body": "<p>Use <code>torch.nn.init.trunc_normal_</code>.</p>\n<p>Description as given <a href=\"https://github.com/pytorch/pytorch/blob/a40812de534b42fcf0eb57a5cecbfdc7a70100cf/torch/nn/init.py#L153\" rel=\"nofollow noreferrer\">Here</a>:</p>\n<blockquote>\n<p>Fills the input Tensor with values drawn from a truncated\nnormal distribution. The values are effectively drawn from the\nnormal distribution :math:<code>\\mathcal{N}(\\text{mean}, \\text{std}^2)</code>\nwith values outside :math:<code>[a, b]</code> redrawn until they are within\nthe bounds. The method used for generating the random values works\nbest when :math:<code>a \\leq \\text{mean} \\leq b</code>.</p>\n</blockquote>\n"
                },
                {
                    "owner": {
                        "account_id": 20576474,
                        "reputation": 1,
                        "user_id": 15103536,
                        "user_type": "registered",
                        "display_name": "WANGHAO"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1654583794,
                    "last_edit_date": 1654583794,
                    "creation_date": 1654583674,
                    "answer_id": 72526816,
                    "question_id": 60233216,
                    "link": "https://stackoverflow.com/questions/60233216/how-to-make-a-truncated-normal-distribution-in-pytorch/72526816#72526816",
                    "body": "<p>I know the best solution must be <code>torch.nn.init.trunc_normal_</code>.\nBut the problem is that the func cannot be called.\nMay we can create this func by copying src code.</p>\n<pre><code>def _no_grad_trunc_normal_(tensor, mean, std, a, b):\n    # Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf\n    def norm_cdf(x):\n        # Computes standard normal cumulative distribution function\n        return (1. + math.erf(x / math.sqrt(2.))) / 2.\n\n    if (mean &lt; a - 2 * std) or (mean &gt; b + 2 * std):\n        warnings.warn(&quot;mean is more than 2 std from [a, b] in nn.init.trunc_normal_. &quot;\n                      &quot;The distribution of values may be incorrect.&quot;,\n                      stacklevel=2)\n\n    with torch.no_grad():\n        # Values are generated by using a truncated uniform distribution and\n        # then using the inverse CDF for the normal distribution.\n        # Get upper and lower cdf values\n        l = norm_cdf((a - mean) / std)\n        u = norm_cdf((b - mean) / std)\n\n        # Uniformly fill tensor with values from [l, u], then translate to\n        # [2l-1, 2u-1].\n        tensor.uniform_(2 * l - 1, 2 * u - 1)\n\n        # Use inverse cdf transform for normal distribution to get truncated\n        # standard normal\n        tensor.erfinv_()\n\n        # Transform to proper mean, std\n        tensor.mul_(std * math.sqrt(2.))\n        tensor.add_(mean)\n\n        # Clamp to ensure it's in the proper range\n        tensor.clamp_(min=a, max=b)\n        return tensor\n\ndef trunc_normal_(tensor: Tensor, mean: float = 0., std: float = 1., a: float = -2., b: float = 2.) -&gt; Tensor:\n    r&quot;&quot;&quot;Fills the input Tensor with values drawn from a truncated\n    normal distribution. The values are effectively drawn from the\n    normal distribution :math:`\\mathcal{N}(\\text{mean}, \\text{std}^2)`\n    with values outside :math:`[a, b]` redrawn until they are within\n    the bounds. The method used for generating the random values works\n    best when :math:`a \\leq \\text{mean} \\leq b`.\n\n    Args:\n        tensor: an n-dimensional `torch.Tensor`\n        mean: the mean of the normal distribution\n        std: the standard deviation of the normal distribution\n        a: the minimum cutoff value\n        b: the maximum cutoff value\n\n    Examples:\n        &gt;&gt;&gt; w = torch.empty(3, 5)\n        &gt;&gt;&gt; nn.init.trunc_normal_(w)\n    &quot;&quot;&quot;\n    return _no_grad_trunc_normal_(tensor, mean, std, a, b)\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 10782883,
                "reputation": 916,
                "user_id": 7932866,
                "user_type": "registered",
                "accept_rate": 85,
                "display_name": "Lupos"
            },
            "comment_count": 1,
            "is_answered": true,
            "accepted_answer_id": 69574790,
            "answer_count": 2,
            "score": 6,
            "last_activity_date": 1654583794,
            "creation_date": 1581712674,
            "question_id": 60233216,
            "link": "https://stackoverflow.com/questions/60233216/how-to-make-a-truncated-normal-distribution-in-pytorch",
            "title": "How to make a Truncated normal distribution in pytorch?",
            "body": "<p>I want to create a <strong>Truncated normal distribution</strong>(that is Gaussian distribution with a range) in PyTorch.<br>\nI want to be able to change the mean, std, and range.<br>\nIs there a PyTorch method for that?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 5963
}