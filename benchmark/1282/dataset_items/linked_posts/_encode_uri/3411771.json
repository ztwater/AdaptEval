{
    "items": [
        {
            "tags": [
                "python",
                "string",
                "replace"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 169293,
                        "reputation": 18177,
                        "user_id": 395287,
                        "user_type": "registered",
                        "accept_rate": 81,
                        "display_name": "Tim McNamara"
                    },
                    "edited": false,
                    "score": 4,
                    "creation_date": 1280982946,
                    "post_id": 3411771,
                    "comment_id": 3550520,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string#comment3550520_3411771",
                    "body": "See <a href=\"http://stackoverflow.com/questions/3367809/efficiently-carry-out-multiple-string-replacements-in-python\" title=\"efficiently carry out multiple string replacements in python\">stackoverflow.com/questions/3367809/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/3411006/fastest-implementation-to-do-multiple-string-substitutions-in-python\" title=\"fastest implementation to do multiple string substitutions in python\">stackoverflow.com/questions/3411006/&hellip;</a>"
                }
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 79153,
                        "reputation": 518021,
                        "user_id": 224671,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "kennytm"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 18,
                    "last_activity_date": 1280983147,
                    "creation_date": 1280983147,
                    "answer_id": 3411790,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3411790#3411790",
                    "body": "<p>Are you always going to prepend a backslash? If so, try</p>\n\n<pre><code>import re\nrx = re.compile('([&amp;#])')\n#                  ^^ fill in the characters here.\nstrs = rx.sub('\\\\\\\\\\\\1', strs)\n</code></pre>\n\n<p>It may not be the most efficient method but I think it is the easiest.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2833886,
                                "reputation": 1078,
                                "user_id": 2434875,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "axolotl"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1466145481,
                            "post_id": 3412090,
                            "comment_id": 63205060,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment63205060_3412090",
                            "body": "Why was a double backslash needed? Why doesn&#39;t just &quot;\\&quot; work?"
                        },
                        {
                            "owner": {
                                "account_id": 1086777,
                                "reputation": 1260,
                                "user_id": 1082309,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Riet"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1469105701,
                            "post_id": 3412090,
                            "comment_id": 64408113,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment64408113_3412090",
                            "body": "The double backslash escapes the backslash, otherwise python would interpret &quot;\\&quot; as a literal quotation character within a still-open string."
                        },
                        {
                            "owner": {
                                "account_id": 8775315,
                                "reputation": 2297,
                                "user_id": 6560773,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "MattSom"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1492134831,
                            "post_id": 3412090,
                            "comment_id": 73868781,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment73868781_3412090",
                            "body": "Why do you need to <code>string=string.replace(ch,&quot;\\\\&quot;+ch)</code>? Isn&#39;t just <code>string.replace(ch,&quot;\\\\&quot;+ch)</code> enough?"
                        },
                        {
                            "owner": {
                                "account_id": 1627429,
                                "reputation": 220,
                                "user_id": 1502657,
                                "user_type": "registered",
                                "display_name": "Ben Brian"
                            },
                            "reply_to_user": {
                                "account_id": 8775315,
                                "reputation": 2297,
                                "user_id": 6560773,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "MattSom"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1492643778,
                            "post_id": 3412090,
                            "comment_id": 74069805,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment74069805_3412090",
                            "body": "@MattSom replace() doesn&#39;t modify the original string, but returns a copy. So you need the assignment for the code to have any effect."
                        },
                        {
                            "owner": {
                                "account_id": 13112934,
                                "reputation": 131,
                                "user_id": 9473285,
                                "user_type": "registered",
                                "display_name": "Mick_"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1522704770,
                            "post_id": 3412090,
                            "comment_id": 86245279,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment86245279_3412090",
                            "body": "why are you using <code>string</code> as a variable name?"
                        },
                        {
                            "owner": {
                                "account_id": 1821978,
                                "reputation": 1660,
                                "user_id": 1765397,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "kdubs"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1530106044,
                            "post_id": 3412090,
                            "comment_id": 89117962,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment89117962_3412090",
                            "body": "string is okay as a variable name. &quot;str&quot; is the type in python. you can use it as a variable name, but it would be confusing to the reader."
                        },
                        {
                            "owner": {
                                "account_id": 1898040,
                                "reputation": 566,
                                "user_id": 1714538,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "lorenzo"
                            },
                            "edited": false,
                            "score": 7,
                            "creation_date": 1530358384,
                            "post_id": 3412090,
                            "comment_id": 89215253,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#comment89215253_3412090",
                            "body": "Do you really need the if? It looks like a duplication of what the replace will be doing anyway."
                        }
                    ],
                    "owner": {
                        "account_id": 44762,
                        "reputation": 335363,
                        "user_id": 131527,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "ghostdog74"
                    },
                    "comment_count": 7,
                    "is_accepted": false,
                    "score": 82,
                    "last_activity_date": 1280987694,
                    "creation_date": 1280987694,
                    "answer_id": 3412090,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/3412090#3412090",
                    "body": "<pre><code>&gt;&gt;&gt; string=\"abc&amp;def#ghi\"\n&gt;&gt;&gt; for ch in ['&amp;','#']:\n...   if ch in string:\n...      string=string.replace(ch,\"\\\\\"+ch)\n...\n&gt;&gt;&gt; print string\nabc\\&amp;def\\#ghi\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 87964,
                        "reputation": 3512,
                        "user_id": 243611,
                        "user_type": "registered",
                        "display_name": "jonesy"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1297826522,
                    "creation_date": 1297826522,
                    "answer_id": 5012200,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/5012200#5012200",
                    "body": "<pre><code>&gt;&gt;&gt; a = '&amp;#'\n&gt;&gt;&gt; print a.replace('&amp;', r'\\&amp;')\n\\&amp;#\n&gt;&gt;&gt; print a.replace('#', r'\\#')\n&amp;\\#\n&gt;&gt;&gt; \n</code></pre>\n\n<p>You want to use a 'raw' string (denoted by the 'r' prefixing the replacement string), since raw strings to not treat the backslash specially. </p>\n"
                },
                {
                    "owner": {
                        "account_id": 81234,
                        "reputation": 1488,
                        "user_id": 229181,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Victor Olex"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1297833454,
                    "creation_date": 1297833454,
                    "answer_id": 5012757,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/5012757#5012757",
                    "body": "<p>You may consider writing a generic escape function:</p>\n\n<pre><code>def mk_esc(esc_chars):\n    return lambda s: ''.join(['\\\\' + c if c in esc_chars else c for c in s])\n\n&gt;&gt;&gt; esc = mk_esc('&amp;#')\n&gt;&gt;&gt; print esc('Learn &amp; be #1')\nLearn \\&amp; be \\#1\n</code></pre>\n\n<p>This way you can make your function configurable with a list of character that should be escaped.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 1219964,
                        "reputation": 237255,
                        "user_id": 1903116,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "thefourtheye"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 49,
                    "last_activity_date": 1399635972,
                    "creation_date": 1399635972,
                    "answer_id": 23563806,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/23563806#23563806",
                    "body": "<p>Simply chain the <code>replace</code> functions like this</p>\n\n<pre><code>strs = \"abc&amp;def#ghi\"\nprint strs.replace('&amp;', '\\&amp;').replace('#', '\\#')\n# abc\\&amp;def\\#ghi\n</code></pre>\n\n<p>If the replacements are going to be more in number, you can do this in this generic way</p>\n\n<pre><code>strs, replacements = \"abc&amp;def#ghi\", {\"&amp;\": \"\\&amp;\", \"#\": \"\\#\"}\nprint \"\".join([replacements.get(c, c) for c in strs])\n# abc\\&amp;def\\#ghi\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2860523,
                                "reputation": 105256,
                                "user_id": 2455888,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "haccks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1509174505,
                            "post_id": 27086669,
                            "comment_id": 80921181,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment80921181_27086669",
                            "body": "Is <code>if c in text:</code> necessary in <code>ba</code>?"
                        },
                        {
                            "owner": {
                                "account_id": 374134,
                                "reputation": 28664,
                                "user_id": 724176,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Hugo"
                            },
                            "reply_to_user": {
                                "account_id": 2860523,
                                "reputation": 105256,
                                "user_id": 2455888,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "haccks"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1509199254,
                            "post_id": 27086669,
                            "comment_id": 80927547,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment80927547_27086669",
                            "body": "@haccks It&#39;s not necessary, but it&#39;s 2-3x quicker with it.   Short string, with: <code>1.45 usec per loop</code>, and without: <code>5.3 usec per loop</code>,  Long string, with: <code>4.38 usec per loop</code> and without: <code>7.03 usec per loop</code>. (Note these aren&#39;t directly comparable with the results above, because it&#39;s a different machine etc.)"
                        },
                        {
                            "owner": {
                                "account_id": 2860523,
                                "reputation": 105256,
                                "user_id": 2455888,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "haccks"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1509200911,
                            "post_id": 27086669,
                            "comment_id": 80928067,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment80928067_27086669",
                            "body": "@Hugo;  I think this difference in time is because of <code>replace</code> is called only when <code>c</code> is found in <code>text</code> in case of <code>ba</code> while it is called in every iteration in <code>ab</code>."
                        },
                        {
                            "owner": {
                                "account_id": 374134,
                                "reputation": 28664,
                                "user_id": 724176,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Hugo"
                            },
                            "reply_to_user": {
                                "account_id": 2860523,
                                "reputation": 105256,
                                "user_id": 2455888,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "haccks"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1509260602,
                            "post_id": 27086669,
                            "comment_id": 80941854,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment80941854_27086669",
                            "body": "@haccks Thanks, I&#39;ve updated my answer with further timings: adding the check is better for both, but the biggest lesson is Python 3 is up to 3x faster!"
                        },
                        {
                            "owner": {
                                "account_id": 273108,
                                "reputation": 9944,
                                "user_id": 564509,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Eugene Pakhomov"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1510556308,
                            "post_id": 27086669,
                            "comment_id": 81467885,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment81467885_27086669",
                            "body": "In my case (replacing <code>&quot;_&quot;</code> and <code>&quot; &quot;</code> with a <code>&quot;-&quot;</code> in a string up to ~1000 symbols), <code>str.translate</code> is faster than all of the described methods."
                        },
                        {
                            "owner": {
                                "account_id": 6396905,
                                "reputation": 11022,
                                "user_id": 4960953,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Mikhail_Sam"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1534247022,
                            "post_id": 27086669,
                            "comment_id": 90634159,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment90634159_27086669",
                            "body": "@Hugo by the way - how you print this pretty table at the end of your post? :)"
                        },
                        {
                            "owner": {
                                "account_id": 374134,
                                "reputation": 28664,
                                "user_id": 724176,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Hugo"
                            },
                            "reply_to_user": {
                                "account_id": 6396905,
                                "reputation": 11022,
                                "user_id": 4960953,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Mikhail_Sam"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1534318733,
                            "post_id": 27086669,
                            "comment_id": 90661719,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment90661719_27086669",
                            "body": "@Mikhail_Sam I probably used something like <a href=\"https://webapps.stackexchange.com/a/55240/54092\">webapps.stackexchange.com/a/55240/54092</a> or <a href=\"https://ozh.github.io/ascii-tables/\" rel=\"nofollow noreferrer\">ozh.github.io/ascii-tables</a> or <a href=\"https://www.tablesgenerator.com/text_tables\" rel=\"nofollow noreferrer\">tablesgenerator.com/text_tables</a>"
                        },
                        {
                            "owner": {
                                "account_id": 374134,
                                "reputation": 28664,
                                "user_id": 724176,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Hugo"
                            },
                            "reply_to_user": {
                                "account_id": 6396905,
                                "reputation": 11022,
                                "user_id": 4960953,
                                "user_type": "registered",
                                "accept_rate": 94,
                                "display_name": "Mikhail_Sam"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1534321597,
                            "post_id": 27086669,
                            "comment_id": 90662945,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment90662945_27086669",
                            "body": "@Mikhail_Sam If you want a Python module, have a look at pytablewriter: <a href=\"https://pytablewriter.readthedocs.io/en/latest/pages/examples/basic.html\" rel=\"nofollow noreferrer\">pytablewriter.readthedocs.io/en/latest/pages/examples/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 107672,
                                "reputation": 5712,
                                "user_id": 286182,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Romuald Brunet"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1539185676,
                            "post_id": 27086669,
                            "comment_id": 92412294,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment92412294_27086669",
                            "body": "For the record, when not using a reference as replacement <b>and</b> a single character, the <b>d</b> method (regexp.sub) seems to be faster here. In my case <code>a = re.compile(&#39;[abc]&#39;); b = re.sub(&#39;?&#39;, &#39;foobar&#39;)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 1565664,
                                "reputation": 703,
                                "user_id": 1454536,
                                "user_type": "registered",
                                "display_name": "parity3"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1557527014,
                            "post_id": 27086669,
                            "comment_id": 98809110,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment98809110_27086669",
                            "body": "a faster version of <code>ba()</code> is to prep the chars and replacements as <code>rep_pairs = zip(chars, &quot;\\\\&quot; * len(chars))</code> in setup, then iterate it in function: <code>for c, r in rep_pairs: if c in text: text = text.replace(c, r)</code>. Python is super efficient about expanding tups in for loops. This removes the add operation when doing the replace.  It&#39;s only about 25% faster though."
                        },
                        {
                            "owner": {
                                "account_id": 4616483,
                                "reputation": 3141,
                                "user_id": 3742823,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "The Wanderer"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1598907476,
                            "post_id": 27086669,
                            "comment_id": 112603788,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment112603788_27086669",
                            "body": "@Hugo: <a href=\"https://i.pinimg.com/originals/ed/55/82/ed55823437fe37e7adeb9558fce593e4.gif\" rel=\"nofollow noreferrer\">i.pinimg.com/originals/ed/55/82/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 7800675,
                                "reputation": 494,
                                "user_id": 5900230,
                                "user_type": "registered",
                                "display_name": "Lo Bellin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1611051118,
                            "post_id": 27086669,
                            "comment_id": 116319136,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#comment116319136_27086669",
                            "body": "Couldn&#39;t <code>b()</code> be improved with a tuple? Checking for membership and iterating should be faster."
                        }
                    ],
                    "owner": {
                        "account_id": 374134,
                        "reputation": 28664,
                        "user_id": 724176,
                        "user_type": "registered",
                        "accept_rate": 50,
                        "display_name": "Hugo"
                    },
                    "comment_count": 12,
                    "is_accepted": true,
                    "score": 745,
                    "last_activity_date": 1572438547,
                    "last_edit_date": 1572438547,
                    "creation_date": 1416728269,
                    "answer_id": 27086669,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/27086669#27086669",
                    "body": "<h1>Replacing two characters</h1>\n\n<p>I timed all the methods in the current answers along with one extra.</p>\n\n<p>With an input string of <code>abc&amp;def#ghi</code> and replacing &amp; -> \\&amp; and # -> \\#, the fastest way was to chain together the replacements like this: <code>text.replace('&amp;', '\\&amp;').replace('#', '\\#')</code>.</p>\n\n<p>Timings for each function:</p>\n\n<ul>\n<li>a) 1000000 loops, best of 3: 1.47 \u03bcs per loop</li>\n<li>b) 1000000 loops, best of 3: 1.51 \u03bcs per loop</li>\n<li>c) 100000 loops, best of 3: 12.3 \u03bcs per loop</li>\n<li>d) 100000 loops, best of 3: 12 \u03bcs per loop</li>\n<li>e) 100000 loops, best of 3: 3.27 \u03bcs per loop</li>\n<li><strong>f) 1000000 loops, best of 3: 0.817 \u03bcs per loop</strong></li>\n<li>g) 100000 loops, best of 3: 3.64 \u03bcs per loop</li>\n<li><strong>h) 1000000 loops, best of 3: 0.927 \u03bcs per loop</strong></li>\n<li><strong>i) 1000000 loops, best of 3: 0.814 \u03bcs per loop</strong></li>\n</ul>\n\n<p>Here are the functions:</p>\n\n<pre><code>def a(text):\n    chars = \"&amp;#\"\n    for c in chars:\n        text = text.replace(c, \"\\\\\" + c)\n\n\ndef b(text):\n    for ch in ['&amp;','#']:\n        if ch in text:\n            text = text.replace(ch,\"\\\\\"+ch)\n\n\nimport re\ndef c(text):\n    rx = re.compile('([&amp;#])')\n    text = rx.sub(r'\\\\\\1', text)\n\n\nRX = re.compile('([&amp;#])')\ndef d(text):\n    text = RX.sub(r'\\\\\\1', text)\n\n\ndef mk_esc(esc_chars):\n    return lambda s: ''.join(['\\\\' + c if c in esc_chars else c for c in s])\nesc = mk_esc('&amp;#')\ndef e(text):\n    esc(text)\n\n\ndef f(text):\n    text = text.replace('&amp;', '\\&amp;').replace('#', '\\#')\n\n\ndef g(text):\n    replacements = {\"&amp;\": \"\\&amp;\", \"#\": \"\\#\"}\n    text = \"\".join([replacements.get(c, c) for c in text])\n\n\ndef h(text):\n    text = text.replace('&amp;', r'\\&amp;')\n    text = text.replace('#', r'\\#')\n\n\ndef i(text):\n    text = text.replace('&amp;', r'\\&amp;').replace('#', r'\\#')\n</code></pre>\n\n<p>Timed like this:</p>\n\n<pre><code>python -mtimeit -s\"import time_functions\" \"time_functions.a('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.b('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.c('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.d('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.e('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.f('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.g('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.h('abc&amp;def#ghi')\"\npython -mtimeit -s\"import time_functions\" \"time_functions.i('abc&amp;def#ghi')\"\n</code></pre>\n\n<hr>\n\n<h1>Replacing 17 characters</h1>\n\n<p>Here's similar code to do the same but with more characters to escape (\\`*_{}>#+-.!$):</p>\n\n<pre><code>def a(text):\n    chars = \"\\\\`*_{}[]()&gt;#+-.!$\"\n    for c in chars:\n        text = text.replace(c, \"\\\\\" + c)\n\n\ndef b(text):\n    for ch in ['\\\\','`','*','_','{','}','[',']','(',')','&gt;','#','+','-','.','!','$','\\'']:\n        if ch in text:\n            text = text.replace(ch,\"\\\\\"+ch)\n\n\nimport re\ndef c(text):\n    rx = re.compile('([&amp;#])')\n    text = rx.sub(r'\\\\\\1', text)\n\n\nRX = re.compile('([\\\\`*_{}[]()&gt;#+-.!$])')\ndef d(text):\n    text = RX.sub(r'\\\\\\1', text)\n\n\ndef mk_esc(esc_chars):\n    return lambda s: ''.join(['\\\\' + c if c in esc_chars else c for c in s])\nesc = mk_esc('\\\\`*_{}[]()&gt;#+-.!$')\ndef e(text):\n    esc(text)\n\n\ndef f(text):\n    text = text.replace('\\\\', '\\\\\\\\').replace('`', '\\`').replace('*', '\\*').replace('_', '\\_').replace('{', '\\{').replace('}', '\\}').replace('[', '\\[').replace(']', '\\]').replace('(', '\\(').replace(')', '\\)').replace('&gt;', '\\&gt;').replace('#', '\\#').replace('+', '\\+').replace('-', '\\-').replace('.', '\\.').replace('!', '\\!').replace('$', '\\$')\n\n\ndef g(text):\n    replacements = {\n        \"\\\\\": \"\\\\\\\\\",\n        \"`\": \"\\`\",\n        \"*\": \"\\*\",\n        \"_\": \"\\_\",\n        \"{\": \"\\{\",\n        \"}\": \"\\}\",\n        \"[\": \"\\[\",\n        \"]\": \"\\]\",\n        \"(\": \"\\(\",\n        \")\": \"\\)\",\n        \"&gt;\": \"\\&gt;\",\n        \"#\": \"\\#\",\n        \"+\": \"\\+\",\n        \"-\": \"\\-\",\n        \".\": \"\\.\",\n        \"!\": \"\\!\",\n        \"$\": \"\\$\",\n    }\n    text = \"\".join([replacements.get(c, c) for c in text])\n\n\ndef h(text):\n    text = text.replace('\\\\', r'\\\\')\n    text = text.replace('`', r'\\`')\n    text = text.replace('*', r'\\*')\n    text = text.replace('_', r'\\_')\n    text = text.replace('{', r'\\{')\n    text = text.replace('}', r'\\}')\n    text = text.replace('[', r'\\[')\n    text = text.replace(']', r'\\]')\n    text = text.replace('(', r'\\(')\n    text = text.replace(')', r'\\)')\n    text = text.replace('&gt;', r'\\&gt;')\n    text = text.replace('#', r'\\#')\n    text = text.replace('+', r'\\+')\n    text = text.replace('-', r'\\-')\n    text = text.replace('.', r'\\.')\n    text = text.replace('!', r'\\!')\n    text = text.replace('$', r'\\$')\n\n\ndef i(text):\n    text = text.replace('\\\\', r'\\\\').replace('`', r'\\`').replace('*', r'\\*').replace('_', r'\\_').replace('{', r'\\{').replace('}', r'\\}').replace('[', r'\\[').replace(']', r'\\]').replace('(', r'\\(').replace(')', r'\\)').replace('&gt;', r'\\&gt;').replace('#', r'\\#').replace('+', r'\\+').replace('-', r'\\-').replace('.', r'\\.').replace('!', r'\\!').replace('$', r'\\$')\n</code></pre>\n\n<p>Here's the results for the same input string <code>abc&amp;def#ghi</code>:</p>\n\n<ul>\n<li>a) 100000 loops, best of 3: 6.72 \u03bcs per loop</li>\n<li>b) <strong>100000 loops, best of 3: 2.64 \u03bcs per loop</strong></li>\n<li>c) 100000 loops, best of 3: 11.9 \u03bcs per loop</li>\n<li>d) 100000 loops, best of 3: 4.92 \u03bcs per loop</li>\n<li>e) <strong>100000 loops, best of 3: 2.96 \u03bcs per loop</strong></li>\n<li>f) 100000 loops, best of 3: 4.29 \u03bcs per loop</li>\n<li>g) 100000 loops, best of 3: 4.68 \u03bcs per loop</li>\n<li>h) 100000 loops, best of 3: 4.73 \u03bcs per loop</li>\n<li>i) 100000 loops, best of 3: 4.24 \u03bcs per loop</li>\n</ul>\n\n<p>And with a longer input string (<code>## *Something* and [another] thing in a longer sentence with {more} things to replace$</code>):</p>\n\n<ul>\n<li>a) 100000 loops, best of 3: 7.59 \u03bcs per loop</li>\n<li>b) 100000 loops, best of 3: 6.54 \u03bcs per loop</li>\n<li>c) 100000 loops, best of 3: 16.9 \u03bcs per loop</li>\n<li>d) 100000 loops, best of 3: 7.29 \u03bcs per loop</li>\n<li>e) 100000 loops, best of 3: 12.2 \u03bcs per loop</li>\n<li>f) <strong>100000 loops, best of 3: 5.38 \u03bcs per loop</strong></li>\n<li>g) 10000 loops, best of 3: 21.7 \u03bcs per loop</li>\n<li>h) <strong>100000 loops, best of 3: 5.7 \u03bcs per loop</strong></li>\n<li>i) <strong>100000 loops, best of 3: 5.13 \u03bcs per loop</strong></li>\n</ul>\n\n<p>Adding a couple of variants:</p>\n\n<pre><code>def ab(text):\n    for ch in ['\\\\','`','*','_','{','}','[',']','(',')','&gt;','#','+','-','.','!','$','\\'']:\n        text = text.replace(ch,\"\\\\\"+ch)\n\n\ndef ba(text):\n    chars = \"\\\\`*_{}[]()&gt;#+-.!$\"\n    for c in chars:\n        if c in text:\n            text = text.replace(c, \"\\\\\" + c)\n</code></pre>\n\n<p>With the shorter input:</p>\n\n<ul>\n<li>ab) 100000 loops, best of 3: 7.05 \u03bcs per loop</li>\n<li>ba) 100000 loops, best of 3: 2.4 \u03bcs per loop</li>\n</ul>\n\n<p>With the longer input:</p>\n\n<ul>\n<li>ab) 100000 loops, best of 3: 7.71 \u03bcs per loop</li>\n<li>ba) 100000 loops, best of 3: 6.08 \u03bcs per loop</li>\n</ul>\n\n<p>So I'm going to use <code>ba</code> for readability and speed.</p>\n\n<h1>Addendum</h1>\n\n<p>Prompted by haccks in the comments, one difference between <code>ab</code> and <code>ba</code> is the <code>if c in text:</code> check. Let's test them against two more variants:</p>\n\n<pre><code>def ab_with_check(text):\n    for ch in ['\\\\','`','*','_','{','}','[',']','(',')','&gt;','#','+','-','.','!','$','\\'']:\n        if ch in text:\n            text = text.replace(ch,\"\\\\\"+ch)\n\ndef ba_without_check(text):\n    chars = \"\\\\`*_{}[]()&gt;#+-.!$\"\n    for c in chars:\n        text = text.replace(c, \"\\\\\" + c)\n</code></pre>\n\n<p>Times in \u03bcs per loop on Python 2.7.14 and 3.6.3, and on a different machine from the earlier set, so cannot be compared directly.</p>\n\n<pre><code>\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2565\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Py, input  \u2551  ab  \u2502 ab_with_check \u2502  ba  \u2502 ba_without_check \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502 Py2, short \u2551 8.81 \u2502    4.22       \u2502 3.45 \u2502    8.01          \u2502\n\u2502 Py3, short \u2551 5.54 \u2502    1.34       \u2502 1.46 \u2502    5.34          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256b\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Py2, long  \u2551 9.3  \u2502    7.15       \u2502 6.85 \u2502    8.55          \u2502\n\u2502 Py3, long  \u2551 7.43 \u2502    4.38       \u2502 4.41 \u2502    7.02          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>\n\n<p>We can conclude that:</p>\n\n<ul>\n<li><p>Those with the check are up to 4x faster than those without the check</p></li>\n<li><p><code>ab_with_check</code> is slightly in the lead on Python 3, but <code>ba</code> (with check) has a greater lead on Python 2</p></li>\n<li><p>However, the biggest lesson here is <strong>Python 3 is up to 3x faster than Python 2</strong>! There's not a huge difference between the slowest on Python 3 and fastest on Python 2!</p></li>\n</ul>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1326961,
                                "reputation": 86,
                                "user_id": 1271591,
                                "user_type": "registered",
                                "display_name": "Craig Andrews"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1513076516,
                            "post_id": 35095534,
                            "comment_id": 82502846,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/35095534#comment82502846_35095534",
                            "body": "&quot;functional programming&quot; doesn&#39;t mean &quot;using as many functions as possible&quot;, you know."
                        },
                        {
                            "owner": {
                                "account_id": 1326961,
                                "reputation": 86,
                                "user_id": 1271591,
                                "user_type": "registered",
                                "display_name": "Craig Andrews"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1513077695,
                            "post_id": 35095534,
                            "comment_id": 82503524,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/35095534#comment82503524_35095534",
                            "body": "This is a perfectly good, pure functional multi-char replacer: <a href=\"https://gist.github.com/anonymous/4577424f586173fc6b91a215ea2ce89e\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/4577424f586173fc6b91a215ea2ce89e</a>  No allocations, no mutations, no side effects. Readable, too."
                        }
                    ],
                    "owner": {
                        "account_id": 1565664,
                        "reputation": 703,
                        "user_id": 1454536,
                        "user_type": "registered",
                        "display_name": "parity3"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1454108026,
                    "creation_date": 1454108026,
                    "answer_id": 35095534,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/35095534#35095534",
                    "body": "<p>FYI, this is of little or no use to the OP but it may be of use to other readers (please do not downvote, I'm aware of this).</p>\n\n<p>As a somewhat ridiculous but interesting exercise, wanted to see if I could use python functional programming to replace multiple chars. I'm pretty sure this does NOT beat just calling replace() twice. And if performance was an issue, you could easily beat this in rust, C, julia, perl, java, javascript and maybe even awk. It uses an external 'helpers' package called <a href=\"https://toolz.readthedocs.org/en/latest/\" rel=\"nofollow\">pytoolz</a>, accelerated via cython (<a href=\"https://pypi.python.org/pypi/cytoolz\" rel=\"nofollow\">cytoolz, it's a pypi package</a>).</p>\n\n<pre><code>from cytoolz.functoolz import compose\nfrom cytoolz.itertoolz import chain,sliding_window\nfrom itertools import starmap,imap,ifilter\nfrom operator import itemgetter,contains\ntext='&amp;hello#hi&amp;yo&amp;'\nchar_index_iter=compose(partial(imap, itemgetter(0)), partial(ifilter, compose(partial(contains, '#&amp;'), itemgetter(1))), enumerate)\nprint '\\\\'.join(imap(text.__getitem__, starmap(slice, sliding_window(2, chain((0,), char_index_iter(text), (len(text),))))))\n</code></pre>\n\n<p>I'm not even going to explain this because no one would bother using this to accomplish multiple replace. Nevertheless, I felt somewhat accomplished in doing this and thought it might inspire other readers or win a code obfuscation contest.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 16272615,
                                "reputation": 2455,
                                "user_id": 11750716,
                                "user_type": "registered",
                                "display_name": "Jean Monet"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1595937804,
                            "post_id": 48500921,
                            "comment_id": 111640846,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48500921#comment111640846_48500921",
                            "body": "To add the &#39;if&#39; condition (variant <code>ba</code> mentioned by Hugo): <code>lambda text, ptuple: text.replace(ptuple[0], ptuple[1]) if ptuple[0] in text else text</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 3944983,
                        "reputation": 651,
                        "user_id": 4047298,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "CasualCoder3"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1517227722,
                    "creation_date": 1517227722,
                    "answer_id": 48500921,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48500921#48500921",
                    "body": "<p>Using reduce which is available in python2.7 and python3.* you can easily replace mutiple substrings in a clean and pythonic way.</p>\n\n<pre><code># Lets define a helper method to make it easy to use\ndef replacer(text, replacements):\n    return reduce(\n        lambda text, ptuple: text.replace(ptuple[0], ptuple[1]), \n        replacements, text\n    )\n\nif __name__ == '__main__':\n    uncleaned_str = \"abc&amp;def#ghi\"\n    cleaned_str = replacer(uncleaned_str, [(\"&amp;\",\"\\&amp;\"),(\"#\",\"\\#\")])\n    print(cleaned_str) # \"abc\\&amp;def\\#ghi\"\n</code></pre>\n\n<p>In python2.7 you don't have to import reduce but in python3.* you have to import it from the functools module.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2602906,
                                "reputation": 790,
                                "user_id": 2729778,
                                "user_type": "registered",
                                "display_name": "Changaco"
                            },
                            "edited": false,
                            "score": 11,
                            "creation_date": 1518782036,
                            "post_id": 48716798,
                            "comment_id": 84655922,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment84655922_48716798",
                            "body": "This is a good answer, but in practice doing one <code>.translate()</code> appears to be slower than three chained <code>.replace()</code> (using CPython 3.6.4)."
                        },
                        {
                            "owner": {
                                "account_id": 408085,
                                "reputation": 9342,
                                "user_id": 778533,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "tommy.carstensen"
                            },
                            "reply_to_user": {
                                "account_id": 2602906,
                                "reputation": 790,
                                "user_id": 2729778,
                                "user_type": "registered",
                                "display_name": "Changaco"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1523507428,
                            "post_id": 48716798,
                            "comment_id": 86591056,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment86591056_48716798",
                            "body": "@Changaco Thanks for timing it \ud83d\udc4d In practice I would use <code>replace()</code> myself, but I added this answer for the sake of completeness."
                        },
                        {
                            "owner": {
                                "account_id": 517898,
                                "reputation": 7061,
                                "user_id": 4042267,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Graipher"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1541586548,
                            "post_id": 48716798,
                            "comment_id": 93264545,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment93264545_48716798",
                            "body": "For large strings and many replacements this should be faster, though some testing would be nice..."
                        },
                        {
                            "owner": {
                                "account_id": 517898,
                                "reputation": 7061,
                                "user_id": 4042267,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Graipher"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1541587681,
                            "post_id": 48716798,
                            "comment_id": 93265066,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment93265066_48716798",
                            "body": "Well, its not on my  machine (same for 2 and 17 replacements)."
                        },
                        {
                            "owner": {
                                "account_id": 1565664,
                                "reputation": 703,
                                "user_id": 1454536,
                                "user_type": "registered",
                                "display_name": "parity3"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1557520365,
                            "post_id": 48716798,
                            "comment_id": 98807227,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment98807227_48716798",
                            "body": "how is <code>&#39;\\#&#39;</code> valid? shouldn&#39;t it be <code>r&#39;\\#&#39;</code> or <code>&#39;\\\\#&#39;</code>? Could be a code block formatting issue perhaps."
                        },
                        {
                            "owner": {
                                "account_id": 337016,
                                "reputation": 101,
                                "user_id": 665025,
                                "user_type": "registered",
                                "display_name": "adavid"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1582009278,
                            "post_id": 48716798,
                            "comment_id": 106617940,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment106617940_48716798",
                            "body": "This method allows to perform &quot;clobbering replacements&quot; that the chained versions do not. E.g., replace &quot;a&quot; with &quot;b&quot; and &quot;b&quot; with &quot;a&quot;."
                        },
                        {
                            "owner": {
                                "account_id": 408085,
                                "reputation": 9342,
                                "user_id": 778533,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "tommy.carstensen"
                            },
                            "reply_to_user": {
                                "account_id": 1565664,
                                "reputation": 703,
                                "user_id": 1454536,
                                "user_type": "registered",
                                "display_name": "parity3"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1672747033,
                            "post_id": 48716798,
                            "comment_id": 132340027,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment132340027_48716798",
                            "body": "@parity3 It works fine for me. With which version of Python do you have an issue?"
                        },
                        {
                            "owner": {
                                "account_id": 1565664,
                                "reputation": 703,
                                "user_id": 1454536,
                                "user_type": "registered",
                                "display_name": "parity3"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1675019535,
                            "post_id": 48716798,
                            "comment_id": 132833599,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#comment132833599_48716798",
                            "body": "@tommy.carstensen You&#39;re right; python will pass any unrecognized escapes &quot;as-is&quot; so r&#39;\\#&#39;, &#39;\\\\#&#39; and &#39;\\#&#39; happen to be equivalent. It was just throwing me off."
                        }
                    ],
                    "owner": {
                        "account_id": 408085,
                        "reputation": 9342,
                        "user_id": 778533,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "tommy.carstensen"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 88,
                    "last_activity_date": 1518231589,
                    "creation_date": 1518231589,
                    "answer_id": 48716798,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/48716798#48716798",
                    "body": "<p>Here is a python3 method using <a href=\"https://docs.python.org/3/library/stdtypes.html#str.translate\" rel=\"noreferrer\"><code>str.translate</code></a> and <a href=\"https://docs.python.org/3/library/stdtypes.html#str.maketrans\" rel=\"noreferrer\"><code>str.maketrans</code></a>:</p>\n\n<pre><code>s = \"abc&amp;def#ghi\"\nprint(s.translate(str.maketrans({'&amp;': '\\&amp;', '#': '\\#'})))\n</code></pre>\n\n<p>The printed string is <code>abc\\&amp;def\\#ghi</code>.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 1359328,
                        "reputation": 1455,
                        "user_id": 1296980,
                        "user_type": "registered",
                        "accept_rate": 71,
                        "display_name": "Sebastialonso"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 21,
                    "last_activity_date": 1553902599,
                    "creation_date": 1553902599,
                    "answer_id": 55426710,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/55426710#55426710",
                    "body": "<p>Late to the party, but I lost a lot of time with this issue until I found my answer.</p>\n\n<p><strong>Short and sweet, <code>translate</code> is superior to <code>replace</code></strong>. If you're more interested in funcionality over time optimization, do not use <code>replace</code>. </p>\n\n<p><em>Also use <code>translate</code> if you don't know if the set of characters to be replaced overlaps the set of characters used to replace.</em> </p>\n\n<p>Case in point:</p>\n\n<p>Using <code>replace</code> you would naively expect the snippet <code>\"1234\".replace(\"1\", \"2\").replace(\"2\", \"3\").replace(\"3\", \"4\")</code> to return <code>\"2344\"</code>, but it will return in fact <code>\"4444\"</code>. </p>\n\n<p>Translation seems to perform what OP originally desired. </p>\n"
                },
                {
                    "owner": {
                        "account_id": 14384914,
                        "reputation": 51,
                        "user_id": 10391194,
                        "user_type": "registered",
                        "display_name": "Tiago Wutzke de Oliveira"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1582640703,
                    "creation_date": 1582640703,
                    "answer_id": 60396815,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/60396815#60396815",
                    "body": "<p>Maybe a simple loop for chars to replace:</p>\n\n<pre><code>a = '&amp;#'\n\nto_replace = ['&amp;', '#']\n\nfor char in to_replace:\n    a = a.replace(char, \"\\\\\"+char)\n\nprint(a)\n\n&gt;&gt;&gt; \\&amp;\\#\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 16340715,
                        "reputation": 1118,
                        "user_id": 11801683,
                        "user_type": "registered",
                        "display_name": "jewishmoses"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1584594324,
                    "last_edit_date": 1584594324,
                    "creation_date": 1584593939,
                    "answer_id": 60751154,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/60751154#60751154",
                    "body": "<p>How about this?</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def replace_all(dict, str):\n    for key in dict:\n        str = str.replace(key, dict[key])\n    return str\n</code></pre>\n\n<p>then</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>print(replace_all({\"&amp;\":\"\\&amp;\", \"#\":\"\\#\"}, \"&amp;#\"))\n</code></pre>\n\n<p>output</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>\\&amp;\\#\n</code></pre>\n\n<p>similar to <a href=\"https://stackoverflow.com/a/48716798\">answer</a></p>\n"
                },
                {
                    "owner": {
                        "account_id": 11115038,
                        "reputation": 284,
                        "user_id": 9280722,
                        "user_type": "registered",
                        "display_name": "Ahmed4end"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1594051452,
                    "creation_date": 1594051452,
                    "answer_id": 62759967,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/62759967#62759967",
                    "body": "<p>advanced way using regex</p>\n<pre><code>import re\ntext = &quot;hello ,world!&quot;\nreplaces = {&quot;hello&quot;: &quot;hi&quot;, &quot;world&quot;:&quot; 2020&quot;, &quot;!&quot;:&quot;.&quot;}\nregex = re.sub(&quot;|&quot;.join(replaces.keys()), lambda match: replaces[match.string[match.start():match.end()]], text)\nprint(regex)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 9914032,
                                "reputation": 3646,
                                "user_id": 7339624,
                                "user_type": "registered",
                                "display_name": "Peyman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1670726848,
                            "post_id": 64500851,
                            "comment_id": 131939435,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/64500851#comment131939435_64500851",
                            "body": "Actually, my code showed that stacked replace functions are faster. <a href=\"https://i.stack.imgur.com/6sel0.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/6sel0.png</a>"
                        },
                        {
                            "owner": {
                                "account_id": 6968589,
                                "reputation": 907,
                                "user_id": 5345699,
                                "user_type": "registered",
                                "display_name": "krm"
                            },
                            "reply_to_user": {
                                "account_id": 9914032,
                                "reputation": 3646,
                                "user_id": 7339624,
                                "user_type": "registered",
                                "display_name": "Peyman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1670822241,
                            "post_id": 64500851,
                            "comment_id": 131954052,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/64500851#comment131954052_64500851",
                            "body": "Interesting. Which Python version is this? And can you share the comparison code?"
                        },
                        {
                            "owner": {
                                "account_id": 9914032,
                                "reputation": 3646,
                                "user_id": 7339624,
                                "user_type": "registered",
                                "display_name": "Peyman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1670824204,
                            "post_id": 64500851,
                            "comment_id": 131954369,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/64500851#comment131954369_64500851",
                            "body": "It&#39;s Python 3.8. Here it is. Should be run in Jupyter notebook. <a href=\"https://gist.github.com/kiasar/0c1bfcff7646a78b15268a5345d3faaa\" rel=\"nofollow noreferrer\">gist.github.com/kiasar/0c1bfcff7646a78b15268a5345d3faaa</a>"
                        },
                        {
                            "owner": {
                                "account_id": 6968589,
                                "reputation": 907,
                                "user_id": 5345699,
                                "user_type": "registered",
                                "display_name": "krm"
                            },
                            "reply_to_user": {
                                "account_id": 9914032,
                                "reputation": 3646,
                                "user_id": 7339624,
                                "user_type": "registered",
                                "display_name": "Peyman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1672397101,
                            "post_id": 64500851,
                            "comment_id": 132281892,
                            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/64500851#comment132281892_64500851",
                            "body": "Ah! The difference seems to be the use of a loop for replacing items in a list instead of manually chaining each item to be replaced. I guess if the items to be replaced never change, then chaining multiple replace calls (your way) is the the fastest way to do this. @Peyman"
                        }
                    ],
                    "owner": {
                        "account_id": 6968589,
                        "reputation": 907,
                        "user_id": 5345699,
                        "user_type": "registered",
                        "display_name": "krm"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 10,
                    "last_activity_date": 1638471779,
                    "last_edit_date": 1638471779,
                    "creation_date": 1603459315,
                    "answer_id": 64500851,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/64500851#64500851",
                    "body": "<p>For Python 3.8 and above, one can use assignment expressions</p>\n<pre><code>[text := text.replace(s, f&quot;\\\\{s}&quot;) for s in &quot;&amp;#&quot; if s in text];\n</code></pre>\n<p>Although, I am quite unsure if this would be considered &quot;appropriate use&quot; of assignment expressions as described in <a href=\"https://www.python.org/dev/peps/pep-0572/#simplifying-list-comprehensions\" rel=\"noreferrer\">PEP 572</a>, but looks clean and reads quite well (to my eyes). The semicolon at the end suppresses output if you run this in a REPL.</p>\n<p>This would be &quot;appropriate&quot; if you wanted all intermediate strings as well. For example, (removing all lowercase vowels):</p>\n<pre><code>text = &quot;Lorem ipsum dolor sit amet&quot;\nintermediates = [text := text.replace(i, &quot;&quot;) for i in &quot;aeiou&quot; if i in text]\n\n['Lorem ipsum dolor sit met',\n 'Lorm ipsum dolor sit mt',\n 'Lorm psum dolor st mt',\n 'Lrm psum dlr st mt',\n 'Lrm psm dlr st mt']\n</code></pre>\n<p>On the plus side, it does seem (unexpectedly?) faster than some of the faster methods in the accepted answer, and seems to perform nicely with both increasing strings length and an increasing number of substitutions.</p>\n<p><a href=\"https://i.stack.imgur.com/Pq6dJ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Pq6dJ.png\" alt=\"Comparison\" /></a></p>\n<p>The code for the above comparison is below. I am using random strings to make my life a bit simpler, and the characters to replace are chosen randomly from the string itself. (Note: I am using ipython's %timeit magic here, so run this in ipython/jupyter).</p>\n<pre><code>import random, string\n\ndef make_txt(length):\n    &quot;makes a random string of a given length&quot;\n    return &quot;&quot;.join(random.choices(string.printable, k=length))\n\ndef get_substring(s, num):\n    &quot;gets a substring&quot;\n    return &quot;&quot;.join(random.choices(s, k=num))\n\ndef a(text, replace): # one of the better performing approaches from the accepted answer\n    for i in replace:\n        if i in text:\n             text = text.replace(i, &quot;&quot;)\n\ndef b(text, replace):\n    _ = (text := text.replace(i, &quot;&quot;) for i in replace if i in text) \n\n\ndef compare(strlen, replace_length):\n    &quot;use ipython / jupyter for the %timeit functionality&quot;\n\n    times_a, times_b = [], []\n\n    for i in range(*strlen):\n        el = make_txt(i)\n        et = get_substring(el, replace_length)\n\n        res_a = %timeit -n 1000 -o a(el, et) # ipython magic\n\n        el = make_txt(i)\n        et = get_substring(el, replace_length)\n        \n        res_b = %timeit -n 1000 -o b(el, et) # ipython magic\n\n        times_a.append(res_a.average * 1e6)\n        times_b.append(res_b.average * 1e6)\n        \n    return times_a, times_b\n\n#----run\nt2 = compare((2*2, 1000, 50), 2)\nt10 = compare((2*10, 1000, 50), 10)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 3673142,
                        "reputation": 90,
                        "user_id": 3059803,
                        "user_type": "registered",
                        "display_name": "Crawsome"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1609361230,
                    "creation_date": 1609361230,
                    "answer_id": 65513379,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/65513379#65513379",
                    "body": "<p>This will help someone looking for a simple solution.</p>\n<pre><code>def replacemany(our_str, to_be_replaced:tuple, replace_with:str):\n    for nextchar in to_be_replaced:\n        our_str = our_str.replace(nextchar, replace_with)\n    return our_str\n\nos = 'the rain in spain falls mainly on the plain ttttttttt sssssssssss nnnnnnnnnn'\ntbr = ('a','t','s','n')\nrw = ''\n\nprint(replacemany(os,tbr,rw))\n</code></pre>\n<p>Output:</p>\n<blockquote>\n<p>he ri i pi fll mily o he pli</p>\n</blockquote>\n"
                },
                {
                    "owner": {
                        "account_id": 9934922,
                        "reputation": 4953,
                        "user_id": 7353562,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "Arpan Saini"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1667282748,
                    "creation_date": 1667282748,
                    "answer_id": 74272106,
                    "question_id": 3411771,
                    "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string/74272106#74272106",
                    "body": "<p>Example is given below for the or condition, it will delete all ' and , from the given string. pass as many characters as you want separated by |</p>\n<pre><code>import re\ntest = re.sub(&quot;('|,)&quot;,&quot;&quot;,str(jsonAtrList))\n</code></pre>\n<p><strong>Before:</strong>\n<a href=\"https://i.stack.imgur.com/JabPD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JabPD.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>After:</strong>\n<a href=\"https://i.stack.imgur.com/PWJ8i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PWJ8i.png\" alt=\"enter image description here\" /></a></p>\n"
                }
            ],
            "owner": {
                "account_id": 95531,
                "reputation": 187175,
                "user_id": 260127,
                "user_type": "registered",
                "accept_rate": 93,
                "display_name": "prosseek"
            },
            "comment_count": 1,
            "is_answered": true,
            "accepted_answer_id": 27086669,
            "answer_count": 16,
            "score": 372,
            "last_activity_date": 1667282748,
            "creation_date": 1280982856,
            "last_edit_date": 1567609657,
            "question_id": 3411771,
            "link": "https://stackoverflow.com/questions/3411771/best-way-to-replace-multiple-characters-in-a-string",
            "title": "Best way to replace multiple characters in a string?",
            "body": "<p>I need to replace some characters as follows: <code>&amp;</code> \u2794 <code>\\&amp;</code>, <code>#</code> \u2794 <code>\\#</code>, ...</p>\n\n<p>I coded as follows, but I guess there should be some better way. Any hints?</p>\n\n<pre><code>strs = strs.replace('&amp;', '\\&amp;')\nstrs = strs.replace('#', '\\#')\n...\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7629
}