{
    "items": [
        {
            "tags": [
                "python",
                "stack-trace",
                "introspection"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 22422,
                        "reputation": 83464,
                        "user_id": 55246,
                        "user_type": "registered",
                        "accept_rate": 69,
                        "display_name": "Sridhar Ratnakumar"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1247013394,
                    "post_id": 1095543,
                    "comment_id": 909933,
                    "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python#comment909933_1095543",
                    "body": "Assume that some other entry point script invokes bar.py .. and thus <code>caller_name</code> cannot be <code>__main__</code>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 22422,
                                "reputation": 83464,
                                "user_id": 55246,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "Sridhar Ratnakumar"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1247024318,
                            "post_id": 1095621,
                            "comment_id": 910429,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment910429_1095621",
                            "body": "So how do you get the <code>__name__</code> attribute of this module using the <code>inspect</code> module? For example, how do I get back <code>myapp.foo</code> (not <code>myapp&#47;foo.py</code>) in my above example? I already tried using the inspect module before posting at SO."
                        },
                        {
                            "owner": {
                                "account_id": 7760,
                                "reputation": 31512,
                                "user_id": 13564,
                                "user_type": "registered",
                                "accept_rate": 52,
                                "display_name": "Glyph"
                            },
                            "edited": false,
                            "score": 8,
                            "creation_date": 1247138645,
                            "post_id": 1095621,
                            "comment_id": 917912,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment917912_1095621",
                            "body": "Be aware that this will interact strangely with import hooks, won&#39;t work on ironpython, and may behave in surprising ways on jython.  It&#39;s best if you can avoid magic like this."
                        },
                        {
                            "owner": {
                                "account_id": 8375,
                                "reputation": 20121,
                                "user_id": 15061,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "Kamil Kisiel"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1289339929,
                            "post_id": 1095621,
                            "comment_id": 4463436,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment4463436_1095621",
                            "body": "Also note that keeping a reference to a stack frame can prevent Python&#39;s GC from working correctly. See warning here: <a href=\"http://docs.python.org/library/inspect.html#the-interpreter-stack\" rel=\"nofollow noreferrer\">docs.python.org/library/inspect.html#the-interpreter-stack</a>"
                        },
                        {
                            "owner": {
                                "account_id": 210958,
                                "reputation": 6173,
                                "user_id": 462865,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Amir Ali Akbari"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1359879541,
                            "post_id": 1095621,
                            "comment_id": 20506376,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment20506376_1095621",
                            "body": "Note that if the caller function is decorated (@...), you need to access <code>inspect.stack()[2]</code> for the real caller."
                        },
                        {
                            "owner": {
                                "account_id": 95257,
                                "reputation": 7779,
                                "user_id": 259538,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "panofish"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1413469130,
                            "post_id": 1095621,
                            "comment_id": 41462112,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment41462112_1095621",
                            "body": "Also note that this logic fails to work properly when you compile your python code into an exe using pyinstaller."
                        },
                        {
                            "owner": {
                                "account_id": 60342,
                                "reputation": 3327,
                                "user_id": 180295,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Andy Smith"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1426073035,
                            "post_id": 1095621,
                            "comment_id": 46219256,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment46219256_1095621",
                            "body": "I found this did not work when I was running my python code inside eggs"
                        },
                        {
                            "owner": {
                                "account_id": 1855263,
                                "reputation": 2585,
                                "user_id": 1680996,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "Bertrand Caron"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1508376562,
                            "post_id": 1095621,
                            "comment_id": 80590587,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment80590587_1095621",
                            "body": "This does not seem to work with lambdas whose name have been set (for instance <code>f = lambda x: x; f.__name__ = &#39;my_function&#39;</code>, can anyone confirm?"
                        },
                        {
                            "owner": {
                                "account_id": 6090175,
                                "reputation": 5142,
                                "user_id": 4752883,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "alpha_989"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1533152038,
                            "post_id": 1095621,
                            "comment_id": 90246503,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment90246503_1095621",
                            "body": "Seems like if have a breakpoint using something like <code>import ipdb; ipdb.set_trace()</code>, the location is at the <code>11th</code> place, not the <code>1st</code>."
                        },
                        {
                            "owner": {
                                "account_id": 248321,
                                "reputation": 61329,
                                "user_id": 523612,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Karl Knechtel"
                            },
                            "reply_to_user": {
                                "account_id": 210958,
                                "reputation": 6173,
                                "user_id": 462865,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Amir Ali Akbari"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1643904062,
                            "post_id": 1095621,
                            "comment_id": 125468186,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment125468186_1095621",
                            "body": "@AmirAliAkbari Not so. Assuming that the decorator works by calling the original function, <code>inspect.stack()[1]</code> refers to the original function; <code>inspect.stack()[2]</code> refers to <i>the decorator</i>. Since the decorator is doing the calling, it will be lower down on the stack. It can&#39;t be above, anyway, because the original function code doesn&#39;t know about the decorator."
                        },
                        {
                            "owner": {
                                "account_id": 248321,
                                "reputation": 61329,
                                "user_id": 523612,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Karl Knechtel"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1643904621,
                            "post_id": 1095621,
                            "comment_id": 125468454,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#comment125468454_1095621",
                            "body": "You <i>would</i> have the problem if you wanted to <i>use the decorator to call <code>info</code> on the decorated function&#39;s behalf</i>, though."
                        }
                    ],
                    "owner": {
                        "account_id": 1895,
                        "reputation": 122146,
                        "user_id": 2611,
                        "user_type": "registered",
                        "display_name": "ars"
                    },
                    "comment_count": 10,
                    "is_accepted": true,
                    "score": 172,
                    "last_activity_date": 1602296043,
                    "last_edit_date": 1602296043,
                    "creation_date": 1247015022,
                    "answer_id": 1095621,
                    "question_id": 1095543,
                    "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095621#1095621",
                    "body": "<p>Check out the inspect module:</p>\n<p><code>inspect.stack()</code> will return the stack information.</p>\n<p>Inside a function, <code>inspect.stack()[1]</code> will return your caller's stack.  From there, you can get more information about the caller's function name, module, etc.</p>\n<p>See the docs for details:</p>\n<p><a href=\"http://docs.python.org/library/inspect.html\" rel=\"noreferrer\">http://docs.python.org/library/inspect.html</a></p>\n<p>Also, Doug Hellmann has a nice writeup of the inspect module in his PyMOTW series:</p>\n<p><a href=\"http://pymotw.com/2/inspect/index.html#module-inspect\" rel=\"noreferrer\">http://pymotw.com/2/inspect/index.html#module-inspect</a></p>\n<p>EDIT: Here's some code which does what you want, I think:</p>\n<pre><code>import inspect \n\ndef info(msg):\n    frm = inspect.stack()[1]\n    mod = inspect.getmodule(frm[0])\n    print '[%s] %s' % (mod.__name__, msg)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 22422,
                                "reputation": 83464,
                                "user_id": 55246,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "Sridhar Ratnakumar"
                            },
                            "edited": false,
                            "score": 13,
                            "creation_date": 1247023711,
                            "post_id": 1095711,
                            "comment_id": 910395,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095711#comment910395_1095711",
                            "body": "Filename is not the same as <code>__name__</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 6007,
                        "reputation": 27578,
                        "user_id": 9940,
                        "user_type": "registered",
                        "accept_rate": 78,
                        "display_name": "Mark Roddy"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1247016732,
                    "creation_date": 1247016732,
                    "answer_id": 1095711,
                    "question_id": 1095543,
                    "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/1095711#1095711",
                    "body": "<p>I don't recommend do this, but you can accomplish your goal with the following method:</p>\n\n<pre><code>def caller_name():\n    frame=inspect.currentframe()\n    frame=frame.f_back.f_back\n    code=frame.f_code\n    return code.co_filename\n</code></pre>\n\n<p>Then update your existing method as follows:</p>\n\n<pre><code>def info(msg):\n    caller = caller_name()\n    print '[%s] %s' % (caller, msg)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 95257,
                                "reputation": 7779,
                                "user_id": 259538,
                                "user_type": "registered",
                                "accept_rate": 82,
                                "display_name": "panofish"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1413469786,
                            "post_id": 5071539,
                            "comment_id": 41462507,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/5071539#comment41462507_5071539",
                            "body": "note: the inspect.stack code FAILS after compile to exe using pyinstaller, but using sys._current_frames WORKS FINE... so this is the preferred technique for me."
                        },
                        {
                            "owner": {
                                "account_id": 165197,
                                "reputation": 3240,
                                "user_id": 388449,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "hooblei"
                            },
                            "edited": false,
                            "score": 14,
                            "creation_date": 1444141967,
                            "post_id": 5071539,
                            "comment_id": 53770224,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/5071539#comment53770224_5071539",
                            "body": "I think it&#39;s easier to get the previous frame by <a href=\"https://docs.python.org/3/library/sys.html#sys._getframe\" rel=\"nofollow noreferrer\"><code>sys._getframe(1)</code></a>, instead of calling <code>sys._current_frames()</code> (btw which returns a frame mapping for every thread)."
                        },
                        {
                            "owner": {
                                "account_id": 152938,
                                "reputation": 5594,
                                "user_id": 367837,
                                "user_type": "registered",
                                "display_name": "Louis LC"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1444155390,
                            "post_id": 5071539,
                            "comment_id": 53778770,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/5071539#comment53778770_5071539",
                            "body": "Thank you hooblei, I haven&#39;t tested it yet but seems very useful for multi-threaded situations."
                        },
                        {
                            "owner": {
                                "account_id": 1265583,
                                "reputation": 41759,
                                "user_id": 1222951,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "Aran-Fey"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1524924569,
                            "post_id": 5071539,
                            "comment_id": 87170940,
                            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/5071539#comment87170940_5071539",
                            "body": "I prefer to use <a href=\"https://docs.python.org/3/library/inspect.html#inspect.currentframe\" rel=\"nofollow noreferrer\"><code>inspect.currentframe()</code></a> instead of <code>sys._current_frames().values()[0]</code>."
                        }
                    ],
                    "owner": {
                        "account_id": 152938,
                        "reputation": 5594,
                        "user_id": 367837,
                        "user_type": "registered",
                        "display_name": "Louis LC"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 31,
                    "last_activity_date": 1525631834,
                    "last_edit_date": 1525631834,
                    "creation_date": 1298324129,
                    "answer_id": 5071539,
                    "question_id": 1095543,
                    "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/5071539#5071539",
                    "body": "<p>Confronted with a similar problem, I have found that <strong>sys._current_frames()</strong> from the sys module contains interesting information that can help you, without the need to import inspect, at least in specific use cases.</p>\n\n<pre><code>&gt;&gt;&gt; sys._current_frames()\n{4052: &lt;frame object at 0x03200C98&gt;}\n</code></pre>\n\n<p>You can then \"move up\" using f_back :</p>\n\n<pre><code>&gt;&gt;&gt; f = sys._current_frames().values()[0]\n&gt;&gt;&gt; # for python3: f = list(sys._current_frames().values())[0]\n\n&gt;&gt;&gt; print f.f_back.f_globals['__file__']\n'/base/data/home/apps/apricot/1.6456165165151/caller.py'\n\n&gt;&gt;&gt; print f.f_back.f_globals['__name__']\n'__main__'\n</code></pre>\n\n<p>For the filename you can also use f.f_back.f_code.co_filename, as suggested by Mark Roddy above. I am not sure of the limits and caveats of this method (multiple threads will most likely be a problem) but I intend to use it in my case.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 15220632,
                        "reputation": 1,
                        "user_id": 10982616,
                        "user_type": "registered",
                        "display_name": "Alex Kim"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1665016732,
                    "creation_date": 1665016732,
                    "answer_id": 73967594,
                    "question_id": 1095543,
                    "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python/73967594#73967594",
                    "body": "<p>As for me, following line was enough to get callers'name.</p>\n<pre><code>import inspect\nframe = inspect.stack()[-1]\nprint(frame.filename)\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 22422,
                "reputation": 83464,
                "user_id": 55246,
                "user_type": "registered",
                "accept_rate": 69,
                "display_name": "Sridhar Ratnakumar"
            },
            "comment_count": 1,
            "is_answered": true,
            "accepted_answer_id": 1095621,
            "answer_count": 4,
            "score": 135,
            "last_activity_date": 1665016732,
            "creation_date": 1247013047,
            "last_edit_date": 1516696073,
            "question_id": 1095543,
            "link": "https://stackoverflow.com/questions/1095543/get-name-of-calling-functions-module-in-python",
            "title": "Get __name__ of calling function&#39;s module in Python",
            "body": "<p>Suppose <code>myapp/foo.py</code> contains:</p>\n\n<pre><code>def info(msg):\n    caller_name = ????\n    print '[%s] %s' % (caller_name, msg)\n</code></pre>\n\n<p>And <code>myapp/bar.py</code> contains:</p>\n\n<pre><code>import foo\nfoo.info('Hello') # =&gt; [myapp.bar] Hello\n</code></pre>\n\n<p>I want <code>caller_name</code> to be set to the <code>__name__</code> attribute of the calling functions' module (which is 'myapp.foo') in this case. How can this be done?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7632
}