{
    "items": [
        {
            "tags": [
                "python",
                "opencv",
                "image-processing",
                "rotation"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 6004821,
                        "reputation": 89,
                        "user_id": 4717084,
                        "user_type": "registered",
                        "display_name": "Salim Azak"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1563463570,
                    "post_id": 43892506,
                    "comment_id": 100717106,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides#comment100717106_43892506",
                    "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22041699/rotate-an-image-without-cropping-in-opencv-in-c\">Rotate an image without cropping in OpenCV in C++</a>"
                },
                {
                    "owner": {
                        "account_id": 9938133,
                        "reputation": 50612,
                        "user_id": 7355741,
                        "user_type": "registered",
                        "display_name": "fmw42"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1654546137,
                    "post_id": 43892506,
                    "comment_id": 128111795,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides#comment128111795_43892506",
                    "body": "See <a href=\"https://pyimagesearch.com/2017/01/02/rotate-images-correctly-with-opencv-and-python/\" rel=\"nofollow noreferrer\">pyimagesearch.com/2017/01/02/&hellip;</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 9830160,
                                "reputation": 401,
                                "user_id": 7281983,
                                "user_type": "registered",
                                "display_name": "Fosheus Badabu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1494420017,
                            "post_id": 43892651,
                            "comment_id": 74819471,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/43892651#comment74819471_43892651",
                            "body": "Is imutils part of OpenCV or should I add it?"
                        },
                        {
                            "owner": {
                                "account_id": 9497683,
                                "reputation": 237,
                                "user_id": 7060067,
                                "user_type": "registered",
                                "display_name": "mkorbi"
                            },
                            "reply_to_user": {
                                "account_id": 9830160,
                                "reputation": 401,
                                "user_id": 7281983,
                                "user_type": "registered",
                                "display_name": "Fosheus Badabu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1494420397,
                            "post_id": 43892651,
                            "comment_id": 74819776,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/43892651#comment74819776_43892651",
                            "body": "You will need to install it via <code>pip install imutils</code>, and to import it of course <code>import imutils</code> into your python code"
                        },
                        {
                            "owner": {
                                "account_id": 9830160,
                                "reputation": 401,
                                "user_id": 7281983,
                                "user_type": "registered",
                                "display_name": "Fosheus Badabu"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1494420866,
                            "post_id": 43892651,
                            "comment_id": 74820181,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/43892651#comment74820181_43892651",
                            "body": "Ok Thank you, I will try that !"
                        },
                        {
                            "owner": {
                                "account_id": 2087078,
                                "reputation": 1141,
                                "user_id": 1857802,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "ygesher"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1585776820,
                            "post_id": 43892651,
                            "comment_id": 107886415,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/43892651#comment107886415_43892651",
                            "body": "Oddly enough, that method assumes you want the picture in portrait mode. i.e. giving <code>0.0</code> as the rotation angle will make sure the longer dimension is now the height, even if that means rotating it up to 90 degrees."
                        }
                    ],
                    "owner": {
                        "account_id": 9497683,
                        "reputation": 237,
                        "user_id": 7060067,
                        "user_type": "registered",
                        "display_name": "mkorbi"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 15,
                    "last_activity_date": 1494419617,
                    "creation_date": 1494419617,
                    "answer_id": 43892651,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/43892651#43892651",
                    "body": "<p>As I don't know your code I still would guess that using the <code>imutils.rotate_bound</code>function will solve the problem. E.g.: <code>rotate = imutils.rotate_bound(image, angle)</code></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 10180037,
                                "reputation": 3476,
                                "user_id": 7517192,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "Alex"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1522524214,
                            "post_id": 47248339,
                            "comment_id": 86190803,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47248339#comment86190803_47248339",
                            "body": "This is more general than the OP asked for, but it&#39;s a great solution and I think it should be the accepted answer."
                        },
                        {
                            "owner": {
                                "account_id": 1849422,
                                "reputation": 135,
                                "user_id": 1676300,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "user1676300"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1559398993,
                            "post_id": 47248339,
                            "comment_id": 99412282,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47248339#comment99412282_47248339",
                            "body": "Use &quot;borderMode=&quot; flag on warpAffine to control how borders are filled (if any are present in result)."
                        },
                        {
                            "owner": {
                                "account_id": 5697379,
                                "reputation": 2199,
                                "user_id": 4503491,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "Red Riding Hood"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1662835522,
                            "post_id": 47248339,
                            "comment_id": 130099897,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47248339#comment130099897_47248339",
                            "body": "bound_w = int(height * abs_sin + width * abs_cos)  Is it supposed to use height here as first parameter? Should be width?"
                        },
                        {
                            "owner": {
                                "account_id": 22225922,
                                "reputation": 4639,
                                "user_id": 16462878,
                                "user_type": "registered",
                                "display_name": "cards"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1689632999,
                            "post_id": 47248339,
                            "comment_id": 135238548,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47248339#comment135238548_47248339",
                            "body": "notice that <code>cv2</code> contains a <code>numpy</code> alias so no extra import is needed: for ex <code>MM = cv2.numpy.absolute(M[:,:2])</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 11610404,
                        "reputation": 1200,
                        "user_id": 8504799,
                        "user_type": "registered",
                        "display_name": "en_lorithai"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 49,
                    "last_activity_date": 1689632704,
                    "last_edit_date": 1689632704,
                    "creation_date": 1510486693,
                    "answer_id": 47248339,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47248339#47248339",
                    "body": "<p>This is by far the best solution i have found for rotating images while avoiding cropping the image.</p>\n<p><a href=\"https://stackoverflow.com/questions/22041699/rotate-an-image-without-cropping-in-opencv-in-c/33564950#33564950\">Rotate an image without cropping in OpenCV in C++</a></p>\n<pre><code>import cv2\n\ndef rotate_image(mat, angle):\n    &quot;&quot;&quot;\n    Rotates an image (angle in degrees) and expands image to avoid cropping\n    &quot;&quot;&quot;\n    \n    height, width = mat.shape[:2] # image shape has 3 dimensions\n    image_center = (width/2, height/2) # getRotationMatrix2D needs coordinates in reverse order (width, height) compared to shape\n    \n    rotation_mat = cv2.getRotationMatrix2D(image_center, angle, 1.)\n    \n    # rotation calculates the cos and sin, taking absolutes of those.\n    abs_cos = abs(rotation_mat[0,0]) \n    abs_sin = abs(rotation_mat[0,1])\n    \n    # find the new width and height bounds\n    bound_w = int(height * abs_sin + width * abs_cos)\n    bound_h = int(height * abs_cos + width * abs_sin)\n    \n    # subtract old image center (bringing image back to origo) and adding the new image center coordinates\n    rotation_mat[0, 2] += bound_w/2 - image_center[0]\n    rotation_mat[1, 2] += bound_h/2 - image_center[1]\n    \n    # rotate image with the new bounds and translated rotation matrix\n    rotated_mat = cv2.warpAffine(mat, rotation_mat, (bound_w, bound_h))\n    return rotated_mat\n</code></pre>\n<p>You can add checks to avoid some calculations when the angles are 90*n, but this function will work for any angle as is.</p>\n<hr />\n<p>Taking advantage of <code>numpy</code> vectorization</p>\n<pre><code>def rotate_image(img, angle):\n    size_reverse = np.array(img.shape[1::-1]) # swap x with y\n    M = cv2.getRotationMatrix2D(tuple(size_reverse / 2.), angle, 1.)\n    MM = np.absolute(M[:,:2])\n    size_new = MM @ size_reverse\n    M[:,-1] += (size_new - size_reverse) / 2.\n    return cv2.warpAffine(img, M, tuple(size_new.astype(int)))\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7716798,
                        "reputation": 515,
                        "user_id": 7330813,
                        "user_type": "registered",
                        "display_name": "Kaan E."
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1510677601,
                    "creation_date": 1510677601,
                    "answer_id": 47290920,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/47290920#47290920",
                    "body": "<p>You can also use padding as well, that is, add borders to the sides of the image, then rotate it to avoid cropping from the original image.</p>\n\n<pre><code>def rotate_im(image, angle)\n    image_height = image.shape[0]\n    image_width = image.shape[1]\n    diagonal_square = (image_width*image_width) + (\n        image_height* image_height\n    )\n    #\n    diagonal = round(sqrt(diagonal_square))\n    padding_top = round((diagonal-image_height) / 2)\n    padding_bottom = round((diagonal-image_height) / 2)\n    padding_right = round((diagonal-image_width) / 2)\n    padding_left = round((diagonal-image_width) / 2)\n    padded_image = cv2.copyMakeBorder(image,\n                                      top=padding_top,\n                                      bottom=padding_bottom,\n                                      left=padding_left,\n                                      right=padding_right,\n                                      borderType=cv2.BORDER_CONSTANT,\n                                      value=0\n            )\n    padded_height = padded_image.shape[0]\n    padded_width = padded_image.shape[1]\n    transform_matrix = cv2.getRotationMatrix2D(\n                (padded_height/2,\n                 padded_width/2), # center\n                angle, # angle\n      1.0) # scale\n    rotated_image = cv2.warpAffine(padded_image,\n                                   transform_matrix,\n                                   (diagonal, diagonal),\n                                   flags=cv2.INTER_LANCZOS4)\n    return rotated_image\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 12687127,
                        "reputation": 11,
                        "user_id": 9218519,
                        "user_type": "registered",
                        "display_name": "Sandeep Daulatabad"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1526977132,
                    "creation_date": 1526977132,
                    "answer_id": 50462955,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/50462955#50462955",
                    "body": "<p>its simple no need of any warpaffine or any calculation check this code out</p>\n\n<pre><code>import numpy as np\nfrom PIL import ImageGrab\nimport cv2\n\nangle = -90\nscale = 1.0\n\nwhile True:\n    img = ImageGrab.grab()\n    img_np = np.array(img)\n    frame = cv2.cvtColor(img_np, cv2.COLOR_BGR2RGB)\n    new = cv2.rotate(frame,rotateCode = 0)# this is the line to rotate the image\n    true = cv2.resize(new, (0,0), fx = 0.6, fy = 0.6) # with fxand fy u can control the size\n    cv2.imshow('output', true)\n    if cv2.waitKey(1) == 27:\n        break\n\n\ncv2.destroyAllWindows()\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4917222,
                                "reputation": 3848,
                                "user_id": 3960850,
                                "user_type": "registered",
                                "accept_rate": 97,
                                "display_name": "matousc"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1561114983,
                            "post_id": 54299591,
                            "comment_id": 99967701,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/54299591#comment99967701_54299591",
                            "body": "Some functions (cv.rectangle for example) will not work after this."
                        },
                        {
                            "owner": {
                                "account_id": 9440749,
                                "reputation": 888,
                                "user_id": 7021322,
                                "user_type": "registered",
                                "display_name": "Ryan Jay"
                            },
                            "reply_to_user": {
                                "account_id": 4917222,
                                "reputation": 3848,
                                "user_id": 3960850,
                                "user_type": "registered",
                                "accept_rate": 97,
                                "display_name": "matousc"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1562388350,
                            "post_id": 54299591,
                            "comment_id": 100366635,
                            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/54299591#comment100366635_54299591",
                            "body": "You can fix with: np.ascontiguousarray(np.rot90(im))  or: np.rot90(im).copy()"
                        }
                    ],
                    "owner": {
                        "account_id": 9440749,
                        "reputation": 888,
                        "user_id": 7021322,
                        "user_type": "registered",
                        "display_name": "Ryan Jay"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 25,
                    "last_activity_date": 1548116425,
                    "creation_date": 1548116425,
                    "answer_id": 54299591,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/54299591#54299591",
                    "body": "<p>If you only care about 90 degree rotations numpy instead. It's much easier and works on opencv input:</p>\n\n<pre><code>import numpy as np\nrotated_image = np.rot90(im)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 14826978,
                        "reputation": 131,
                        "user_id": 10707641,
                        "user_type": "registered",
                        "display_name": "sahaj patel"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1562094158,
                    "last_edit_date": 1562094158,
                    "creation_date": 1562091864,
                    "answer_id": 56858207,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/56858207#56858207",
                    "body": "<p>This is the easiest way to rotate image frames by using cv2.rotate(frame,rotateCode = 1) and rescale or resizing by using cv2.CAP_PROP_FRAME_WIDTH and cv2.CAP_PROP_FRAME_HEIGHT of the frame.</p>\n\n<pre><code>import numpy as np\nimport cv2\n\ncam = cv2.VideoCapture(2)\n\nwhile(True):\n    # Capture frame-by-frame\n    cam.set(cv2.CAP_PROP_FRAME_WIDTH, 640) # You can change frame width by chaning number.\n\n    cam.set(cv2.CAP_PROP_FRAME_HEIGHT, 480) # You can change frame height by chaning number.\n\n    ret, frame = cam.read()\n\n    new_frame=cv2.rotate(frame,rotateCode = 1) \n</code></pre>\n\n<h1>You can enter rotateCode= 0 or 1 or 2. Depends on your rotation. It's gonna give you 0 or 90 or 180 or 270 angles</h1>\n\n<pre><code>    # Display the resulting frame\n    cv2.imshow('frame',new_frame)\n\n    if cv2.waitKey(1) &amp; 0xFF == ord('q'):\n        break\n\n# When everything done, release the capture\ncam.release()\ncv2.destroyAllWindows()\n</code></pre>\n\n<p>Hopefully, it with help you.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 979979,
                        "reputation": 2266,
                        "user_id": 999951,
                        "user_type": "registered",
                        "accept_rate": 83,
                        "display_name": "Do Not Track Me"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1636491253,
                    "creation_date": 1636491253,
                    "answer_id": 69904953,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/69904953#69904953",
                    "body": "<p>While this question was asked for CV2, you can do this with python's native image library.</p>\n<pre><code>rotate_degrees = -90\nimg = Image.open(input_file_path)\nimg2 = img.rotate(rotate_degrees, expand=True)\nimg2.save(output_file_path)\n</code></pre>\n<p>If you leave out <code>expand=True</code> in the rotate command you will get a result that looks like OP's right hand photo.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 6199398,
                        "reputation": 20775,
                        "user_id": 6885902,
                        "user_type": "registered",
                        "display_name": "Jeru Luke"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1654545791,
                    "creation_date": 1654545791,
                    "answer_id": 72522918,
                    "question_id": 43892506,
                    "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides/72522918#72522918",
                    "body": "<p>Here is an alternative from <code>ndimage.rotate</code> from <a href=\"https://scipy.org/\" rel=\"nofollow noreferrer\">SciPy</a></p>\n<p><a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.rotate.html\" rel=\"nofollow noreferrer\">Related documentation</a></p>\n<pre><code>from scipy.ndimage import rotate as rotate_image\n\n#rotation angle in degree\nrotated_img1 = rotate_image(img,90)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/U8Xdh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U8Xdh.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>rotated_img2 = rotate_image(img,-110)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/4lo1d.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4lo1d.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>rotated_img3 = rotate_image(img,-45)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/c6Lq0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c6Lq0.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code># angles extending beyond 360 are calculated appropriately:\nrotated_img4 = rotate_image(img,390)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/O2rYM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O2rYM.jpg\" alt=\"enter image description here\" /></a></p>\n"
                }
            ],
            "owner": {
                "account_id": 9830160,
                "reputation": 401,
                "user_id": 7281983,
                "user_type": "registered",
                "display_name": "Fosheus Badabu"
            },
            "comment_count": 2,
            "is_answered": true,
            "answer_count": 8,
            "score": 25,
            "last_activity_date": 1689632704,
            "creation_date": 1494419223,
            "last_edit_date": 1654881923,
            "question_id": 43892506,
            "link": "https://stackoverflow.com/questions/43892506/opencv-python-rotate-image-without-cropping-sides",
            "title": "OpenCV Python : rotate image without cropping sides",
            "body": "<p>Imagine I have these images :</p>\n\n<p><a href=\"https://i.stack.imgur.com/jjRfe.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jjRfe.png\" alt=\"ttps://i.stack.imgur.com/jjRfe.png\"></a></p>\n\n<p>I want the image from left to be rotated like the image of the middle, not the right one. How do I do this using Python and OpenCV. I looked at <code>getRotationMatrix2D</code> and <code>warpAffine</code> but the examples about it transform my image to the right one.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7662
}