{
    "items": [
        {
            "tags": [
                "python",
                "collections"
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 141491,
                                "reputation": 104604,
                                "user_id": 348545,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Jonathan Livni"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1318407959,
                            "post_id": 5029958,
                            "comment_id": 9415184,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment9415184_5029958",
                            "body": "it works great! could you explain the rational behind this syntax?"
                        },
                        {
                            "owner": {
                                "account_id": 95256,
                                "reputation": 69061,
                                "user_id": 479633,
                                "user_type": "registered",
                                "display_name": "mouad"
                            },
                            "reply_to_user": {
                                "account_id": 141491,
                                "reputation": 104604,
                                "user_id": 348545,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Jonathan Livni"
                            },
                            "edited": false,
                            "score": 47,
                            "creation_date": 1318429508,
                            "post_id": 5029958,
                            "comment_id": 9421357,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment9421357_5029958",
                            "body": "@Jonathan: Yes sure, the argument of a <code>defaultdict</code> (in this case is <code>lambda : defaultdict(int)</code>) will be called when you try to access a key that don&#39;t exist and the return value of it will be set as the new value of this key which mean in our case the value of <code>d[Key_dont_exist]</code> will be <code>defaultdict(int)</code>, and if you try to access a key from this last defaultdict i.e. <code>d[Key_dont_exist][Key_dont_exist]</code> it will return 0 which is the return value of the argument of the last <code>defaultdict</code> i.e. <code>int()</code>, Hope this was helpful."
                        },
                        {
                            "owner": {
                                "account_id": 442111,
                                "reputation": 2275,
                                "user_id": 832573,
                                "user_type": "registered",
                                "display_name": "has2k1"
                            },
                            "edited": false,
                            "score": 35,
                            "creation_date": 1348289152,
                            "post_id": 5029958,
                            "comment_id": 16886896,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment16886896_5029958",
                            "body": "The argument to <code>defaultdict</code> should be a function. <code>defaultdict(int)</code> is a dictionary, while <code>lambda: defaultdict(int)</code> is function that returns a dictionary."
                        },
                        {
                            "owner": {
                                "account_id": 24114,
                                "reputation": 9111,
                                "user_id": 61109,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "Niels Bom"
                            },
                            "reply_to_user": {
                                "account_id": 442111,
                                "reputation": 2275,
                                "user_id": 832573,
                                "user_type": "registered",
                                "display_name": "has2k1"
                            },
                            "edited": false,
                            "score": 37,
                            "creation_date": 1358867485,
                            "post_id": 5029958,
                            "comment_id": 20142614,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment20142614_5029958",
                            "body": "@has2k1 That is incorrect. The argument to defaultdict needs to be a callable. A lambda is a callable."
                        },
                        {
                            "owner": {
                                "account_id": 105720,
                                "reputation": 7690,
                                "user_id": 281965,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Ricky Levi"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1553418531,
                            "post_id": 5029958,
                            "comment_id": 97370787,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment97370787_5029958",
                            "body": "this will work for only 2nd hierarchy, if you&#39;ll try to run: <code>d[&#39;a&#39;][&#39;b&#39;][&#39;c&#39;]</code> - it will again throw an error for a missing Key ..."
                        },
                        {
                            "owner": {
                                "account_id": 5416096,
                                "reputation": 490,
                                "user_id": 4311206,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "darophi"
                            },
                            "reply_to_user": {
                                "account_id": 105720,
                                "reputation": 7690,
                                "user_id": 281965,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Ricky Levi"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1553613665,
                            "post_id": 5029958,
                            "comment_id": 97445209,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment97445209_5029958",
                            "body": "@RickyLevi, if you want to have that working you can just say:  <code>defaultdict(lambda: defaultdict(lambda: defaultdict(int)))</code>"
                        },
                        {
                            "owner": {
                                "account_id": 3010079,
                                "reputation": 189,
                                "user_id": 2553801,
                                "user_type": "registered",
                                "display_name": "marie"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1626917840,
                            "post_id": 5029958,
                            "comment_id": 121021792,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment121021792_5029958",
                            "body": "To make it simpler, you can use<code>defaultdict(Counter)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 6785303,
                                "reputation": 69,
                                "user_id": 5224309,
                                "user_type": "registered",
                                "display_name": "Morteza Mirzai"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1637858391,
                            "post_id": 5029958,
                            "comment_id": 123943191,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment123943191_5029958",
                            "body": "The solution is excellent, but the problem for me is that I couldn&#39;t serialize the object with <a href=\"https://docs.python.org/3/library/pickle.html\" rel=\"nofollow noreferrer\">pickle</a> because there is lambda. How can I serialize it?"
                        },
                        {
                            "owner": {
                                "account_id": 5448431,
                                "reputation": 2271,
                                "user_id": 4334120,
                                "user_type": "registered",
                                "display_name": "Anatoly Alekseev"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1671233027,
                            "post_id": 5029958,
                            "comment_id": 132062855,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment132062855_5029958",
                            "body": "Using lambda will get you in trouble once attempting to pickle such object. Better use a named function, otherwise will have to change default_factory afterwards. @moaud maybe you could add this suggestion?"
                        },
                        {
                            "owner": {
                                "account_id": 363723,
                                "reputation": 11355,
                                "user_id": 9769953,
                                "user_type": "registered",
                                "display_name": "9769953"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1674479520,
                            "post_id": 5029958,
                            "comment_id": 132715936,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment132715936_5029958",
                            "body": "For people having problems using this in a multiprocessing environment, or generally problems pickling this (lambda&#39;s can&#39;t be pickled, as they are unnamed functions): see <a href=\"https://stackoverflow.com/a/5030081/9769953\">this solution</a>, just a bit below this answer, using <code>functools.partial</code>."
                        },
                        {
                            "owner": {
                                "account_id": 9283008,
                                "reputation": 50,
                                "user_id": 6893713,
                                "user_type": "registered",
                                "display_name": "HarvB"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1691914697,
                            "post_id": 5029958,
                            "comment_id": 135553268,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#comment135553268_5029958",
                            "body": "Not surprisingly it worked for me too with <code>defaultdict(lambda: default(list))</code>. Thanks @mouad"
                        }
                    ],
                    "owner": {
                        "account_id": 95256,
                        "reputation": 69061,
                        "user_id": 479633,
                        "user_type": "registered",
                        "display_name": "mouad"
                    },
                    "comment_count": 11,
                    "is_accepted": true,
                    "score": 861,
                    "last_activity_date": 1519128617,
                    "last_edit_date": 1519128617,
                    "creation_date": 1297951579,
                    "answer_id": 5029958,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029958#5029958",
                    "body": "<p>Yes like this:</p>\n\n<pre><code>defaultdict(lambda: defaultdict(int))\n</code></pre>\n\n<p>The argument of a <code>defaultdict</code> (in this case is <code>lambda: defaultdict(int)</code>) will be called when you try to access a key that doesn't exist. The return value of it will be set as the new value of this key, which means in our case the value of <code>d[Key_doesnt_exist]</code> will be <code>defaultdict(int)</code>.</p>\n\n<p>If you try to access a key from this last defaultdict i.e. <code>d[Key_doesnt_exist][Key_doesnt_exist]</code> it will return 0, which is the return value of the argument of the last defaultdict i.e. <code>int()</code>.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 371289,
                                "reputation": 1128,
                                "user_id": 719726,
                                "user_type": "registered",
                                "display_name": "gumption"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1403290232,
                            "post_id": 5029989,
                            "comment_id": 37616739,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029989#comment37616739_5029989",
                            "body": "Just to complete the circle here, you would want to use <code>d = defaultdict(lambda : Counter())</code> rather than <code>d = defaultdict(lambda : defaultdict(int))</code> to specifically address the problem as originally posed."
                        },
                        {
                            "owner": {
                                "account_id": 5905531,
                                "reputation": 1098,
                                "user_id": 4647470,
                                "user_type": "registered",
                                "display_name": "Deb"
                            },
                            "reply_to_user": {
                                "account_id": 371289,
                                "reputation": 1128,
                                "user_id": 719726,
                                "user_type": "registered",
                                "display_name": "gumption"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1501836817,
                            "post_id": 5029989,
                            "comment_id": 77965303,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029989#comment77965303_5029989",
                            "body": "@gumption you can just use <code>d = defaultdict(Counter())</code> no need for a lambda in this case"
                        },
                        {
                            "owner": {
                                "account_id": 8274254,
                                "reputation": 7324,
                                "user_id": 6221024,
                                "user_type": "registered",
                                "display_name": "Dillon Davis"
                            },
                            "reply_to_user": {
                                "account_id": 5905531,
                                "reputation": 1098,
                                "user_id": 4647470,
                                "user_type": "registered",
                                "display_name": "Deb"
                            },
                            "edited": false,
                            "score": 10,
                            "creation_date": 1533970844,
                            "post_id": 5029989,
                            "comment_id": 90551578,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029989#comment90551578_5029989",
                            "body": "@Deb you have a slight error- remove the inner parentheses so you pass a callable instead of a <code>Counter</code> object. That is: <code>d = defaultdict(Counter)</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 9119,
                        "reputation": 5371,
                        "user_id": 16718,
                        "user_type": "registered",
                        "display_name": "yanjost"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 59,
                    "last_activity_date": 1358873688,
                    "last_edit_date": 1358873688,
                    "creation_date": 1297951714,
                    "answer_id": 5029989,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5029989#5029989",
                    "body": "<p>The parameter to the defaultdict constructor is the function which will be called for building new elements. So let's use a lambda !</p>\n\n<pre><code>&gt;&gt;&gt; from collections import defaultdict\n&gt;&gt;&gt; d = defaultdict(lambda : defaultdict(int))\n&gt;&gt;&gt; print d[0]\ndefaultdict(&lt;type 'int'&gt;, {})\n&gt;&gt;&gt; print d[0][\"x\"]\n0\n</code></pre>\n\n<p>Since Python 2.7, there's an <a href=\"http://docs.python.org/2.7/library/collections#collections.Counter\" rel=\"noreferrer\">even better solution using Counter</a>:</p>\n\n<pre><code>&gt;&gt;&gt; from collections import Counter\n&gt;&gt;&gt; c = Counter()\n&gt;&gt;&gt; c[\"goodbye\"]+=1\n&gt;&gt;&gt; c[\"and thank you\"]=42\n&gt;&gt;&gt; c[\"for the fish\"]-=5\n&gt;&gt;&gt; c\nCounter({'and thank you': 42, 'goodbye': 1, 'for the fish': -5})\n</code></pre>\n\n<p>Some bonus features</p>\n\n<pre><code>&gt;&gt;&gt; c.most_common()[:2]\n[('and thank you', 42), ('goodbye', 1)]\n</code></pre>\n\n<p>For more information see <a href=\"http://www.doughellmann.com/PyMOTW/collections/counter.html\" rel=\"noreferrer\">PyMOTW - Collections - Container data types</a> and <a href=\"http://docs.python.org/library/collections.html\" rel=\"noreferrer\">Python Documentation - collections</a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 8882285,
                                "reputation": 2152,
                                "user_id": 6631906,
                                "user_type": "registered",
                                "display_name": "Campi"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1547899316,
                            "post_id": 5030081,
                            "comment_id": 95357060,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030081#comment95357060_5030081",
                            "body": "Partial is also better than lambda here because it can be applied recursively :) see my answer below for a generic nested defaultdict factory method."
                        },
                        {
                            "owner": {
                                "account_id": 73090,
                                "reputation": 12590,
                                "user_id": 695591,
                                "user_type": "registered",
                                "accept_rate": 76,
                                "display_name": "Cl&#233;ment"
                            },
                            "reply_to_user": {
                                "account_id": 8882285,
                                "reputation": 2152,
                                "user_id": 6631906,
                                "user_type": "registered",
                                "display_name": "Campi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1574712009,
                            "post_id": 5030081,
                            "comment_id": 104321209,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030081#comment104321209_5030081",
                            "body": "@Campi you don&#39;t need partial for recursive applications, AFAICT"
                        },
                        {
                            "owner": {
                                "account_id": 7304658,
                                "reputation": 733,
                                "user_id": 5565980,
                                "user_type": "registered",
                                "display_name": "Alex Sax"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1652841384,
                            "post_id": 5030081,
                            "comment_id": 127701606,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030081#comment127701606_5030081",
                            "body": "This is also better because it can be pickled (lambdas don&#39;t play nice with pickling + multiprocessing)"
                        }
                    ],
                    "owner": {
                        "account_id": 171501,
                        "reputation": 122212,
                        "user_id": 398968,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "Katriel"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 37,
                    "last_activity_date": 1297952146,
                    "creation_date": 1297952146,
                    "answer_id": 5030081,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030081#5030081",
                    "body": "<p>I find it slightly more elegant to use <code>partial</code>:</p>\n\n<pre><code>import functools\ndd_int = functools.partial(defaultdict, int)\ndefaultdict(dd_int)\n</code></pre>\n\n<p>Of course, this is the same as a lambda.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 151,
                                "reputation": 35399,
                                "user_id": 188,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Matthew Schinckel"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1297998173,
                            "post_id": 5030636,
                            "comment_id": 5635649,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030636#comment5635649_5030636",
                            "body": "This solution means it isn&#39;t simple to get all of d[x.a], as you need to introspect every key to see if it has x.a as the first element of the tuple."
                        },
                        {
                            "owner": {
                                "account_id": 151,
                                "reputation": 35399,
                                "user_id": 188,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Matthew Schinckel"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1297998218,
                            "post_id": 5030636,
                            "comment_id": 5635652,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030636#comment5635652_5030636",
                            "body": "If you wanted nesting 3 levels deep, then just define it as 3 levels: d = defaultdict(lambda: defaultdict( lambda: defaultdict(int)))"
                        }
                    ],
                    "owner": {
                        "account_id": 161001,
                        "reputation": 45391,
                        "user_id": 1322401,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Steven Rumbalski"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 8,
                    "last_activity_date": 1297954993,
                    "creation_date": 1297954993,
                    "answer_id": 5030636,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/5030636#5030636",
                    "body": "<p>Others have answered correctly your question of how to get the following to work:</p>\n\n<pre><code>for x in stuff:\n    d[x.a][x.b] += x.c_int\n</code></pre>\n\n<p>An alternative would be to use tuples for keys:</p>\n\n<pre><code>d = defaultdict(int)\nfor x in stuff:\n    d[x.a,x.b] += x.c_int\n    # ^^^^^^^ tuple key\n</code></pre>\n\n<p>The nice thing about this approach is that it is simple and can be easily expanded.  If you need a mapping three levels deep, just use a three item tuple for the key.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 433926,
                                "reputation": 8390,
                                "user_id": 819544,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "David Marx"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1550175249,
                            "post_id": 54266841,
                            "comment_id": 96183642,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/54266841#comment96183642_54266841",
                            "body": "Can you give a usage example? Not working the way I expected this to. <code>ndd = nested_defaultdict(dict) ....  ndd[&#39;a&#39;][&#39;b&#39;][&#39;c&#39;][&#39;d&#39;] = &#39;e&#39;</code> throws <code>KeyError: &#39;b&#39;</code>"
                        },
                        {
                            "owner": {
                                "account_id": 8882285,
                                "reputation": 2152,
                                "user_id": 6631906,
                                "user_type": "registered",
                                "display_name": "Campi"
                            },
                            "reply_to_user": {
                                "account_id": 433926,
                                "reputation": 8390,
                                "user_id": 819544,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "David Marx"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1550311295,
                            "post_id": 54266841,
                            "comment_id": 96228285,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/54266841#comment96228285_54266841",
                            "body": "Hey David, you need to define the depth of your dictionary, in your example 3 (as you defined the default_factory to be a dictionary too. nested_defaultdict(dict, 3) will work for you."
                        },
                        {
                            "owner": {
                                "account_id": 9164548,
                                "reputation": 2027,
                                "user_id": 6814713,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Brendan"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1572479069,
                            "post_id": 54266841,
                            "comment_id": 103577000,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/54266841#comment103577000_54266841",
                            "body": "This was super helpful, thanks! One thing I noticed is that this creates a default_dict at <code>depth=0</code>, which may not always be desired if the depth is unknown at the time of calling. Easily fixable by adding a line <code>if not depth: return default_factory()</code>, at the top of the function, though there&#39;s probably a more elegant solution."
                        },
                        {
                            "owner": {
                                "account_id": 73090,
                                "reputation": 12590,
                                "user_id": 695591,
                                "user_type": "registered",
                                "accept_rate": 76,
                                "display_name": "Cl&#233;ment"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1659656953,
                            "post_id": 54266841,
                            "comment_id": 129352513,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/54266841#comment129352513_54266841",
                            "body": "Why not <code>for _ in range(depth - 1):</code>?"
                        }
                    ],
                    "owner": {
                        "account_id": 8882285,
                        "reputation": 2152,
                        "user_id": 6631906,
                        "user_type": "registered",
                        "display_name": "Campi"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 18,
                    "last_activity_date": 1550311198,
                    "last_edit_date": 1550311198,
                    "creation_date": 1547899146,
                    "answer_id": 54266841,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/54266841#54266841",
                    "body": "<p>For reference, it's possible to implement a generic nested <code>defaultdict</code> factory method through:</p>\n\n<pre><code>from collections import defaultdict\nfrom functools import partial\nfrom itertools import repeat\n\n\ndef nested_defaultdict(default_factory, depth=1):\n    result = partial(defaultdict, default_factory)\n    for _ in repeat(None, depth - 1):\n        result = partial(defaultdict, result)\n    return result()\n</code></pre>\n\n<p>The depth defines the number of nested dictionary before the type defined in <code>default_factory</code> is used.\nFor example:</p>\n\n<pre><code>my_dict = nested_defaultdict(list, 3)\nmy_dict['a']['b']['c'].append('e')\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 4122004,
                                "reputation": 783,
                                "user_id": 3385741,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "rosstex"
                            },
                            "edited": false,
                            "score": 12,
                            "creation_date": 1588990942,
                            "post_id": 59039243,
                            "comment_id": 109121624,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/59039243#comment109121624_59039243",
                            "body": "I love this. It&#39;s devilishly simple, but incredibly useful. Thanks!"
                        },
                        {
                            "owner": {
                                "account_id": 4007913,
                                "reputation": 928,
                                "user_id": 3302133,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "MonsieurBeilto"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1600973735,
                            "post_id": 59039243,
                            "comment_id": 113266434,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/59039243#comment113266434_59039243",
                            "body": "How can this be used for the following use case: the nth level needs to be an int or a list"
                        },
                        {
                            "owner": {
                                "account_id": 73090,
                                "reputation": 12590,
                                "user_id": 695591,
                                "user_type": "registered",
                                "accept_rate": 76,
                                "display_name": "Cl&#233;ment"
                            },
                            "reply_to_user": {
                                "account_id": 4007913,
                                "reputation": 928,
                                "user_id": 3302133,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "MonsieurBeilto"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1601311268,
                            "post_id": 59039243,
                            "comment_id": 113361664,
                            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/59039243#comment113361664_59039243",
                            "body": "@MonsieurBeilto &quot;previous answers have addressed how to make a two-levels or n-levels defaultdict&quot; \u2192 <a href=\"https://stackoverflow.com/a/54266841/695591\">stackoverflow.com/a/54266841/695591</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 73090,
                        "reputation": 12590,
                        "user_id": 695591,
                        "user_type": "registered",
                        "accept_rate": 76,
                        "display_name": "Cl&#233;ment"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 47,
                    "last_activity_date": 1574711950,
                    "creation_date": 1574711950,
                    "answer_id": 59039243,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/59039243#59039243",
                    "body": "<p>Previous answers have addressed how to make a two-levels or n-levels <code>defaultdict</code>.  In some cases you want an infinite one:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def ddict():\n    return defaultdict(ddict)\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>&gt;&gt;&gt; d = ddict()\n&gt;&gt;&gt; d[1]['a'][True] = 0.5\n&gt;&gt;&gt; d[1]['b'] = 3\n&gt;&gt;&gt; import pprint; pprint.pprint(d)\ndefaultdict(&lt;function ddict at 0x7fcac68bf048&gt;,\n            {1: defaultdict(&lt;function ddict at 0x7fcac68bf048&gt;,\n                            {'a': defaultdict(&lt;function ddict at 0x7fcac68bf048&gt;,\n                                              {True: 0.5}),\n                             'b': 3})})\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 151071,
                        "reputation": 150282,
                        "user_id": 364696,
                        "user_type": "registered",
                        "display_name": "ShadowRanger"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1714779311,
                    "last_edit_date": 1714779311,
                    "creation_date": 1698281878,
                    "answer_id": 77363576,
                    "question_id": 5029934,
                    "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict/77363576#77363576",
                    "body": "<p><code>defaultdict(lambda: defaultdict(int))</code> has a flaw, which is that it isn't <code>pickle</code> friendly, thanks to the <code>lambda</code>. While you could define the default function globally, e.g.:</p>\n<pre><code>def make_defaultdict_int():\n    return defaultdict(int)\ndd = defaultdict(make_defaultdict_int)\n</code></pre>\n<p>to work around this, that's rather verbose. Luckily, it's pretty easy to make this work in a <code>pickle</code>-friendly way without that:</p>\n<pre><code>dd = defaultdict(defaultdict(int).copy)\n</code></pre>\n<p>That makes a template empty <code>defaultdict(int)</code>, and passes a bound <code>copy</code> method from it as the factory function. Because <code>defaultdict</code> and <code>int</code> are pickleable, as are all bound methods of pickleable objects, that renders the structure fully pickleable without any custom definitions or additional imports. On some versions of Python, it's more performant than the equivalent <code>lambda</code> (depending on where the recent optimization efforts have been centered), but even when it isn't, the performance is comparable, and it's no more verbose, so it's my preferred approach even when pickling isn't a concern, simply because it means I don't need to change approaches if/when pickling becomes important.</p>\n"
                }
            ],
            "owner": {
                "account_id": 141491,
                "reputation": 104604,
                "user_id": 348545,
                "user_type": "registered",
                "accept_rate": 67,
                "display_name": "Jonathan Livni"
            },
            "comment_count": 0,
            "is_answered": true,
            "accepted_answer_id": 5029958,
            "answer_count": 7,
            "score": 489,
            "last_activity_date": 1714779311,
            "creation_date": 1297951462,
            "last_edit_date": 1593050406,
            "question_id": 5029934,
            "link": "https://stackoverflow.com/questions/5029934/defaultdict-of-defaultdict",
            "title": "defaultdict of defaultdict?",
            "body": "<p>Is there a way to have a <code>defaultdict(defaultdict(int))</code> in order to make the following code work?</p>\n\n<pre><code>for x in stuff:\n    d[x.a][x.b] += x.c_int\n</code></pre>\n\n<p><code>d</code> needs to be built ad-hoc, depending on <code>x.a</code> and <code>x.b</code> elements.</p>\n\n<p>I could use:</p>\n\n<pre><code>for x in stuff:\n    d[x.a,x.b] += x.c_int\n</code></pre>\n\n<p>but then I wouldn't be able to use:</p>\n\n<pre><code>d.keys()\nd[x.a].keys()\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9440
}