{
    "items": [
        {
            "tags": [
                "python",
                "argparse"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 191900,
                        "reputation": 66183,
                        "user_id": 432745,
                        "user_type": "registered",
                        "display_name": "pyfunc"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1286182081,
                    "post_id": 3853722,
                    "comment_id": 4096751,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text#comment4096751_3853722",
                    "body": "I don&#39;t have python 2.7 with me so I can test out my ideas. How about using help text in triple quotes (&quot;&quot;&quot; &quot;&quot;&quot;). Do the new lines survive using this?"
                },
                {
                    "owner": {
                        "account_id": 79153,
                        "reputation": 518011,
                        "user_id": 224671,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "kennytm"
                    },
                    "reply_to_user": {
                        "account_id": 191900,
                        "reputation": 66183,
                        "user_id": 432745,
                        "user_type": "registered",
                        "display_name": "pyfunc"
                    },
                    "edited": false,
                    "score": 6,
                    "creation_date": 1286182204,
                    "post_id": 3853722,
                    "comment_id": 4096766,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text#comment4096766_3853722",
                    "body": "@pyfunc: No. The stripping is done in runtime by <code>argparse</code>, not the interpreter, so switching to <code>&quot;&quot;&quot;...&quot;&quot;&quot;</code> won&#39;t help."
                },
                {
                    "owner": {
                        "account_id": 5383373,
                        "reputation": 7133,
                        "user_id": 4288043,
                        "user_type": "registered",
                        "accept_rate": 90,
                        "display_name": "cardamom"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1554892868,
                    "post_id": 3853722,
                    "comment_id": 97915420,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text#comment97915420_3853722",
                    "body": "<a href=\"https://stackoverflow.com/a/29485128/4288043\">This</a> worked for me"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 65549,
                                "reputation": 23644,
                                "user_id": 192812,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "intuited"
                            },
                            "edited": false,
                            "score": 7,
                            "creation_date": 1286182845,
                            "post_id": 3853776,
                            "comment_id": 4096826,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment4096826_3853776",
                            "body": "I think it&#39;s not.  You could subclass it, but unfortunately       <code>Only the name of this class is considered a public API. All the methods provided by the class are considered an implementation detail.</code>  So probably not a great idea, although it might not matter, since 2.7 is meant to be the last 2.x python and you&#39;ll be expected to refactor lots of things for 3.x anyway.  I&#39;m actually running 2.6 with <code>argparse</code> installed via <code>easy_install</code> so that documentation may itself be out of date."
                        },
                        {
                            "owner": {
                                "account_id": 185752,
                                "reputation": 18281,
                                "user_id": 422670,
                                "user_type": "registered",
                                "accept_rate": 74,
                                "display_name": "Stefano"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1321889672,
                            "post_id": 3853776,
                            "comment_id": 10098369,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment10098369_3853776",
                            "body": "Some links: for <a href=\"http://docs.python.org/library/argparse.html#formatter-class\" rel=\"nofollow noreferrer\">python 2.7</a>, and <a href=\"http://docs.python.org/dev/library/argparse.html#formatter-class\" rel=\"nofollow noreferrer\">python 3.*</a>. The 2.6 package should, according to <a href=\"http://code.google.com/p/argparse/\" rel=\"nofollow noreferrer\">its wiki</a>, comply with the official 2.7 one. From the doc: &quot;Passing RawDescriptionHelpFormatter as formatter_class= indicates that description and epilog are already correctly formatted and should not be line-wrapped&quot;"
                        },
                        {
                            "owner": {
                                "account_id": 358715,
                                "reputation": 1775,
                                "user_id": 699665,
                                "user_type": "registered",
                                "display_name": "MarkHu"
                            },
                            "edited": false,
                            "score": 122,
                            "creation_date": 1400906829,
                            "post_id": 3853776,
                            "comment_id": 36687355,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment36687355_3853776",
                            "body": "Try instead formatter_class=<code>RawDescriptionHelpFormatter</code> which only works on description and epilog rather than help text."
                        },
                        {
                            "owner": {
                                "account_id": 1836681,
                                "reputation": 1185,
                                "user_id": 1666926,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "MrMas"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1458317083,
                            "post_id": 3853776,
                            "comment_id": 59822408,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment59822408_3853776",
                            "body": "I have noticed that even with <code>RawTextHelpFormatter</code>, leading and trailing newlines are removed. To work around this, you can simply add two or more consecutive newlines; all but one newline will survive."
                        },
                        {
                            "owner": {
                                "account_id": 1073529,
                                "reputation": 1330,
                                "user_id": 1072212,
                                "user_type": "registered",
                                "display_name": "Terry Brown"
                            },
                            "edited": false,
                            "score": 29,
                            "creation_date": 1469724297,
                            "post_id": 3853776,
                            "comment_id": 64667625,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment64667625_3853776",
                            "body": "You can combine formatters too, e.g. <code>class Formatter(     argparse.ArgumentDefaultsHelpFormatter,     argparse.RawDescriptionHelpFormatter): pass</code> and then <code>formatter_class=Formatter</code>."
                        },
                        {
                            "owner": {
                                "account_id": 1164178,
                                "reputation": 1678,
                                "user_id": 1143126,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "RobertG"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1557077695,
                            "post_id": 3853776,
                            "comment_id": 98636680,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment98636680_3853776",
                            "body": "This is not working out for me (using python 3.6.8 on Ubuntu Linux 18.10). The linebreaks still don&#39;t show up, it&#39;s all one justified text block."
                        },
                        {
                            "owner": {
                                "account_id": 1164178,
                                "reputation": 1678,
                                "user_id": 1143126,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "RobertG"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1557145610,
                            "post_id": 3853776,
                            "comment_id": 98655877,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment98655877_3853776",
                            "body": "I found my mistake there: If subparsers are used (add_subparsers, later add_parser to define the subparser), the formatter_class has to be re-specified for each subparser"
                        },
                        {
                            "owner": {
                                "account_id": 5858722,
                                "reputation": 3903,
                                "user_id": 4615179,
                                "user_type": "registered",
                                "display_name": "Ma&#235;lan"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1654523996,
                            "post_id": 3853776,
                            "comment_id": 128104306,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#comment128104306_3853776",
                            "body": "On the other hand, be it <code>RawDescriptionHelpFormatter</code> or <code>RawTextHelpFormatter</code>, it doesn\u2019t strip leading indentation and doesn\u2019t reflow text. This dumps the doc-string literally."
                        }
                    ],
                    "owner": {
                        "account_id": 11419,
                        "reputation": 9454,
                        "user_id": 21998,
                        "user_type": "registered",
                        "accept_rate": 50,
                        "display_name": "Micha\u0142 Kwiatkowski"
                    },
                    "comment_count": 8,
                    "is_accepted": true,
                    "score": 587,
                    "last_activity_date": 1667936437,
                    "last_edit_date": 1667936437,
                    "creation_date": 1286182197,
                    "answer_id": 3853776,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/3853776#3853776",
                    "body": "<p>Try using <a href=\"https://docs.python.org/2/library/argparse.html#argparse.RawTextHelpFormatter\" rel=\"noreferrer\"><code>RawTextHelpFormatter</code></a> to preserve all of your formatting:</p>\n<pre><code>from argparse import RawTextHelpFormatter\nparser = ArgumentParser(description='test', formatter_class=RawTextHelpFormatter)\n</code></pre>\n<p>It's similar to <a href=\"https://docs.python.org/2/library/argparse.html#argparse.RawDescriptionHelpFormatter\" rel=\"noreferrer\"><code>RawDescriptionHelpFormatter</code></a> but instead of only applying to the description and epilog, <code>RawTextHelpFormatter</code> also applies to all help text (including arguments).</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 156202,
                                "reputation": 1513,
                                "user_id": 373348,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "mc_electron"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1396408452,
                            "post_id": 22157136,
                            "comment_id": 34769199,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment34769199_22157136",
                            "body": "I want to do this for a version message, but this SmartFormatter only seems to work with help text, not the special version text. <code>parser.add_argument(&#39;-v&#39;, &#39;--version&#39;, action=&#39;version&#39;,version=get_version_str())</code>  Is it possible to extend it to that case?"
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "reply_to_user": {
                                "account_id": 156202,
                                "reputation": 1513,
                                "user_id": 373348,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "mc_electron"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1396437482,
                            "post_id": 22157136,
                            "comment_id": 34784873,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment34784873_22157136",
                            "body": "@mc_electron the full version of the SmartFormatter also has its own <code>_split_lines</code> and preserves line breaks (no need to specify &quot;R|&quot; at the beginning, if you want that option, patch the <code>_VersionAction.__call__</code> method"
                        },
                        {
                            "owner": {
                                "account_id": 156202,
                                "reputation": 1513,
                                "user_id": 373348,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "mc_electron"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1396557956,
                            "post_id": 22157136,
                            "comment_id": 34855176,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment34855176_22157136",
                            "body": "I&#39;m not entirely grokking the first part of your comment, although I can see in <code>_VersionAction.__call__</code> that I would probably want it to just <code>parser.exit(message=version)</code> instead of using the formatted version. Is there any way to do that without releasing a patched copy of argparse though?"
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "reply_to_user": {
                                "account_id": 156202,
                                "reputation": 1513,
                                "user_id": 373348,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "mc_electron"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1396560963,
                            "post_id": 22157136,
                            "comment_id": 34856846,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment34856846_22157136",
                            "body": "@mc_electron I am referring to the improvements I published on bitbucket (as per the link to my improvements on argparse in the answer). But  you can also patch the <code>__call__</code> in <code>_VersionAction</code> by doing <code>argparse._VersionAction.__call__ = smart_version</code> after defining <code>def smart_version(self, parser, namespace, values, option_string=None): ...</code>"
                        },
                        {
                            "owner": {
                                "account_id": 23045,
                                "reputation": 4118,
                                "user_id": 57461,
                                "user_type": "registered",
                                "accept_rate": 55,
                                "display_name": "Pod"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1425399361,
                            "post_id": 22157136,
                            "comment_id": 45942765,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment45942765_22157136",
                            "body": "Great idea. Didn&#39;t help me as the epilog and description don&#39;t seem to run through _split_lines :("
                        },
                        {
                            "owner": {
                                "account_id": 4714688,
                                "reputation": 853,
                                "user_id": 3814202,
                                "user_type": "registered",
                                "accept_rate": 89,
                                "display_name": "svenevs"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1459015655,
                            "post_id": 22157136,
                            "comment_id": 60107983,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment60107983_22157136",
                            "body": "Hey this is sweet!  Though not present in the source code for the full version, the comment at the top of <code>_split_lines</code> that says <code># this is the RawTextHelpFormatter._split_lines</code> is a little misleading.  The comment may be less confusing if you move it to below the <code>if</code> statement since that is the original <code>RawTextHelpFormatter</code> return.  Regardless, this answer gave me exactly what I needed, thanks again!"
                        },
                        {
                            "owner": {
                                "account_id": 2148677,
                                "reputation": 537,
                                "user_id": 1905666,
                                "user_type": "registered",
                                "display_name": "Fotis Gimian"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1509664937,
                            "post_id": 22157136,
                            "comment_id": 81121848,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment81121848_22157136",
                            "body": "Really like this solution, but I feel it&#39;s more elegant to only apply this when a new line is found in the help text, sorta like this:  <code>class SmartFormatter(argparse.HelpFormatter):     def _split_lines(self, text, width):         if &#39;\\n&#39; in text:             return text.splitlines()         return argparse.HelpFormatter._split_lines(self, text, width)</code>  Sorry not sure how to preserve spaces in a reply here :)"
                        },
                        {
                            "owner": {
                                "account_id": 15601398,
                                "reputation": 2181,
                                "user_id": 11255447,
                                "user_type": "registered",
                                "display_name": "aparpara"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1694506167,
                            "post_id": 22157136,
                            "comment_id": 135895996,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#comment135895996_22157136",
                            "body": "Or this way (to split by double line breaks, like in TeX): <code>def _split_lines(self, text, width):   return [sln for ln in text.split(&#39;\\n\\n&#39;) for sln in argparse.HelpFormatter._split_lines(self, ln, width)]</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 1373414,
                        "reputation": 73737,
                        "user_id": 1307905,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "Anthon"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 104,
                    "last_activity_date": 1459026044,
                    "last_edit_date": 1459026044,
                    "creation_date": 1393879796,
                    "answer_id": 22157136,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/22157136#22157136",
                    "body": "<p>If you just want to override the one option, you should not use <code>RawTextHelpFormatter</code>. Instead subclass the <code>HelpFormatter</code> and provide a special intro for the options that should be handled \"raw\" (I use <code>\"R|rest of help\"</code>):</p>\n\n<pre><code>import argparse\n\nclass SmartFormatter(argparse.HelpFormatter):\n\n    def _split_lines(self, text, width):\n        if text.startswith('R|'):\n            return text[2:].splitlines()  \n        # this is the RawTextHelpFormatter._split_lines\n        return argparse.HelpFormatter._split_lines(self, text, width)\n</code></pre>\n\n<p>And use it:</p>\n\n<pre><code>from argparse import ArgumentParser\n\nparser = ArgumentParser(description='test', formatter_class=SmartFormatter)\n\nparser.add_argument('-g', choices=['a', 'b', 'g', 'd', 'e'], default='a',\n    help=\"R|Some option, where\\n\"\n         \" a = alpha\\n\"\n         \" b = beta\\n\"\n         \" g = gamma\\n\"\n         \" d = delta\\n\"\n         \" e = epsilon\")\n\nparser.parse_args()\n</code></pre>\n\n<p>Any other calls to <code>.add_argument()</code> where the help does not start with <code>R|</code> will be wrapped as normal.</p>\n\n<p>This is part of <a href=\"https://bitbucket.org/ruamel/std.argparse\">my improvements on argparse</a>. The full SmartFormatter also supports adding\nthe defaults to all options, and raw input of the utilities description. The full version\nhas its own <code>_split_lines</code> method, so that any formatting done to e.g. version strings is preserved:</p>\n\n<pre><code>parser.add_argument('--version', '-v', action=\"version\",\n                    version=\"version...\\n   42!\")\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 5524226,
                                "reputation": 2499,
                                "user_id": 4386239,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "Paul Gowder"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1448912288,
                            "post_id": 32974697,
                            "comment_id": 55768909,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/32974697#comment55768909_32974697",
                            "body": "This is wonderful --- happened on this after almost giving up and contemplating just reimplementing the help argument altogether... saved me a good amount of hassle."
                        },
                        {
                            "owner": {
                                "account_id": 1836681,
                                "reputation": 1185,
                                "user_id": 1666926,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "MrMas"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1458317642,
                            "post_id": 32974697,
                            "comment_id": 59822805,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/32974697#comment59822805_32974697",
                            "body": "subclassing <code>HelpFormatter</code> is problematic since the argparse developers only guarantee that the class name will survive in future versions of argparse. They&#39;ve basically written themselves a blank check so they can change method names if it would be convenient for them to do so. I find this frustrating; the least they could have done is exposed a few methods in the API."
                        },
                        {
                            "owner": {
                                "account_id": 109912,
                                "reputation": 2048,
                                "user_id": 291033,
                                "user_type": "registered",
                                "accept_rate": 38,
                                "display_name": "Huw Walters"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1552555839,
                            "post_id": 32974697,
                            "comment_id": 97057166,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/32974697#comment97057166_32974697",
                            "body": "Not quite what the OP was asking for, but <i>exactly</i> what I wanted, thanks!"
                        }
                    ],
                    "owner": {
                        "account_id": 5942070,
                        "reputation": 846,
                        "user_id": 4672928,
                        "user_type": "registered",
                        "display_name": "flaz14"
                    },
                    "comment_count": 3,
                    "is_accepted": false,
                    "score": 16,
                    "last_activity_date": 1445610431,
                    "last_edit_date": 1495541448,
                    "creation_date": 1444147927,
                    "answer_id": 32974697,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/32974697#32974697",
                    "body": "<p>I've faced similar issue (Python 2.7.6). I've tried to break down <strong>description</strong> section into several lines using <code>RawTextHelpFormatter</code>:</p>\n\n<pre><code>parser = ArgumentParser(description=\"\"\"First paragraph \n\n                                       Second paragraph\n\n                                       Third paragraph\"\"\",  \n                                       usage='%(prog)s [OPTIONS]', \n                                       formatter_class=RawTextHelpFormatter)\n\noptions = parser.parse_args()\n</code></pre>\n\n<p>And got:</p>\n\n<pre>\nusage: play-with-argparse.py [OPTIONS]\n\nFirst paragraph \n\n                        Second paragraph\n\n                        Third paragraph\n\noptional arguments:\n  -h, --help  show this help message and exit\n</pre>\n\n<p>So <code>RawTextHelpFormatter</code> is not a solution. Because it prints description as it appears in source code, preserving all whitespace characters (I want to keep extra tabs in my source code for readability but I don't want to print them all. Also raw formatter doesn't wrap line when it is too long, more than 80 characters for example).</p>\n\n<p>Thanks to @Anton who inspired the right direction <a href=\"https://stackoverflow.com/a/22157136/4672928\">above</a>. But that solution needs slight modification in order to format <strong>description</strong> section.</p>\n\n<p>Anyway, custom formatter is needed. I extended existing <code>HelpFormatter</code> class and overrode <code>_fill_text</code> method like this:</p>\n\n<pre><code>import textwrap as _textwrap\nclass MultilineFormatter(argparse.HelpFormatter):\n    def _fill_text(self, text, width, indent):\n        text = self._whitespace_matcher.sub(' ', text).strip()\n        paragraphs = text.split('|n ')\n        multiline_text = ''\n        for paragraph in paragraphs:\n            formatted_paragraph = _textwrap.fill(paragraph, width, initial_indent=indent, subsequent_indent=indent) + '\\n\\n'\n            multiline_text = multiline_text + formatted_paragraph\n        return multiline_text\n</code></pre>\n\n<p>Compare with the original source code coming from <a href=\"https://hg.python.org/cpython/file/2.7/Lib/argparse.py#l620\" rel=\"noreferrer\">argparse</a> module:</p>\n\n<pre><code>def _fill_text(self, text, width, indent):\n    text = self._whitespace_matcher.sub(' ', text).strip()\n    return _textwrap.fill(text, width, initial_indent=indent,\n                                       subsequent_indent=indent)\n</code></pre>\n\n<p>In the original code the whole description is being wrapped. In custom formatter above the whole text is split into several chunks, and each of them is formatted independently.</p>\n\n<p>So with aid of custom formatter:</p>\n\n<pre><code>parser = ArgumentParser(description= \"\"\"First paragraph \n                                        |n                              \n                                        Second paragraph\n                                        |n\n                                        Third paragraph\"\"\",  \n                usage='%(prog)s [OPTIONS]',\n                formatter_class=MultilineFormatter)\n\noptions = parser.parse_args()\n</code></pre>\n\n<p>the output is:</p>\n\n<pre>\nusage: play-with-argparse.py [OPTIONS]\n\nFirst paragraph\n\nSecond paragraph\n\nThird paragraph\n\noptional arguments:\n  -h, --help  show this help message and exit\n</pre>\n"
                },
                {
                    "owner": {
                        "account_id": 5679624,
                        "reputation": 1642,
                        "user_id": 4491330,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "display_name": "Wang Zong&#39;an"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 44,
                    "last_activity_date": 1461184755,
                    "creation_date": 1461184755,
                    "answer_id": 36754721,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/36754721#36754721",
                    "body": "<p>Another easy way to do it is to include <strong><a href=\"https://docs.python.org/2/library/textwrap.html\">textwrap</a></strong>.</p>\n\n<p>For example,</p>\n\n<pre><code>import argparse, textwrap\nparser = argparse.ArgumentParser(description='some information',\n        usage='use \"python %(prog)s --help\" for more information',\n        formatter_class=argparse.RawTextHelpFormatter)\n\nparser.add_argument('--argument', default=somedefault, type=sometype,\n        help= textwrap.dedent('''\\\n        First line\n        Second line\n        More lines ... '''))\n</code></pre>\n\n<p>In this way, we can avoid the long empty space in front of each output line.</p>\n\n<pre><code>usage: use \"python your_python_program.py --help\" for more information\n\nPrepare input file\n\noptional arguments:\n-h, --help            show this help message and exit\n--argument ARGUMENT\n                      First line\n                      Second line\n                      More lines ...\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 8239345,
                        "reputation": 5039,
                        "user_id": 6197439,
                        "user_type": "registered",
                        "accept_rate": 42,
                        "display_name": "sdbbs"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1490958064,
                    "creation_date": 1490958064,
                    "answer_id": 43139055,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/43139055#43139055",
                    "body": "<p>I wanted to have both manual line breaks in the description text, and auto wrapping of it; but none of the suggestions here worked for me - so I ended up modifying the SmartFormatter class given in the answers here; the issues with the argparse method names not being a public API notwithstanding, here is what I have (as a file called <code>test.py</code>):</p>\n\n<pre><code>import argparse\nfrom argparse import RawDescriptionHelpFormatter\n\n# call with: python test.py -h\n\nclass SmartDescriptionFormatter(argparse.RawDescriptionHelpFormatter):\n  #def _split_lines(self, text, width): # RawTextHelpFormatter, although function name might change depending on Python\n  def _fill_text(self, text, width, indent): # RawDescriptionHelpFormatter, although function name might change depending on Python\n    #print(\"splot\",text)\n    if text.startswith('R|'):\n      paragraphs = text[2:].splitlines()\n      rebroken = [argparse._textwrap.wrap(tpar, width) for tpar in paragraphs]\n      #print(rebroken)\n      rebrokenstr = []\n      for tlinearr in rebroken:\n        if (len(tlinearr) == 0):\n          rebrokenstr.append(\"\")\n        else:\n          for tlinepiece in tlinearr:\n            rebrokenstr.append(tlinepiece)\n      #print(rebrokenstr)\n      return '\\n'.join(rebrokenstr) #(argparse._textwrap.wrap(text[2:], width))\n    # this is the RawTextHelpFormatter._split_lines\n    #return argparse.HelpFormatter._split_lines(self, text, width)\n    return argparse.RawDescriptionHelpFormatter._fill_text(self, text, width, indent)\n\nparser = argparse.ArgumentParser(formatter_class=SmartDescriptionFormatter, description=\"\"\"R|Blahbla bla blah blahh/blahbla (bla blah-blabla) a blahblah bl a blaha-blah .blah blah\n\nBlah blah bla blahblah, bla blahblah blah blah bl blblah bl blahb; blah bl blah bl bl a blah, bla blahb bl:\n\n  blah blahblah blah bl blah blahblah\"\"\")\n\noptions = parser.parse_args()\n</code></pre>\n\n<p>This is how it works in 2.7 and 3.4:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ python test.py -h\nusage: test.py [-h]\n\nBlahbla bla blah blahh/blahbla (bla blah-blabla) a blahblah bl a blaha-blah\n.blah blah\n\nBlah blah bla blahblah, bla blahblah blah blah bl blblah bl blahb; blah bl\nblah bl bl a blah, bla blahb bl:\n\n  blah blahblah blah bl blah blahblah\n\noptional arguments:\n  -h, --help  show this help message and exit\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7867869,
                        "reputation": 121,
                        "user_id": 5946160,
                        "user_type": "registered",
                        "display_name": "ermitz"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1562142716,
                    "creation_date": 1562142716,
                    "answer_id": 56865996,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/56865996#56865996",
                    "body": "<p>Starting from SmartFomatter described above, I ended to that solution:</p>\n\n<pre><code>class SmartFormatter(argparse.HelpFormatter):\n    '''\n         Custom Help Formatter used to split help text when '\\n' was \n         inserted in it.\n    '''\n\n    def _split_lines(self, text, width):\n        r = []\n        for t in text.splitlines(): r.extend(argparse.HelpFormatter._split_lines(self, t, width))\n        return r\n</code></pre>\n\n<p>Note that strangely the formatter_class argument passed to top level parser is not inheritated by sub_parsers, one must pass it again for each created sub_parser.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 13767357,
                        "reputation": 6969,
                        "user_id": 9935654,
                        "user_type": "registered",
                        "display_name": "Carson"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1577414390,
                    "last_edit_date": 1577414390,
                    "creation_date": 1572416845,
                    "answer_id": 58619701,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/58619701#58619701",
                    "body": "<h1>Preface</h1>\n\n<p>For this question, <code>argparse.RawTextHelpFormatter</code> is helpful to me.</p>\n\n<p>Now, I want to share how do I use the <code>argparse</code>.</p>\n\n<p>I know it may not be related to question,</p>\n\n<p>but these questions have been bothered me for a while.</p>\n\n<p>So I want to share my experience, hope that will be helpful for someone.</p>\n\n<p>Here we go.</p>\n\n<h1>3rd Party Modules</h1>\n\n<p><a href=\"https://pypi.org/project/colorama/\" rel=\"nofollow noreferrer\">colorama</a>: for change the text color: <code>pip install colorama</code></p>\n\n<blockquote>\n  <p>Makes ANSI escape character sequences (for producing colored terminal text and cursor positioning) work under MS Windows</p>\n</blockquote>\n\n<h1>Example</h1>\n\n<pre><code>import colorama\nfrom colorama import Fore, Back\nfrom pathlib import Path\nfrom os import startfile, system\n\nSCRIPT_DIR = Path(__file__).resolve().parent\nTEMPLATE_DIR = SCRIPT_DIR.joinpath('.')\n\n\ndef main(args):\n    ...\n\n\nif __name__ == '__main__':\n    colorama.init(autoreset=True)\n\n    from argparse import ArgumentParser, RawTextHelpFormatter\n\n    format_text = FormatText([(20, '&lt;'), (60, '&lt;')])\n    yellow_dc = format_text.new_dc(fore_color=Fore.YELLOW)\n    green_dc = format_text.new_dc(fore_color=Fore.GREEN)\n    red_dc = format_text.new_dc(fore_color=Fore.RED, back_color=Back.LIGHTYELLOW_EX)\n\n    script_description = \\\n        '\\n'.join([desc for desc in\n                   [f'\\n{green_dc(f\"python {Path(__file__).name} [REFERENCE TEMPLATE] [OUTPUT FILE NAME]\")} to create template.',\n                    f'{green_dc(f\"python {Path(__file__).name} -l *\")} to get all available template',\n                    f'{green_dc(f\"python {Path(__file__).name} -o open\")} open template directory so that you can put your template file there.',\n                    # &lt;- add your own description\n                    ]])\n    arg_parser = ArgumentParser(description=yellow_dc('CREATE TEMPLATE TOOL'),\n                                # conflict_handler='resolve',\n                                usage=script_description, formatter_class=RawTextHelpFormatter)\n\n    arg_parser.add_argument(\"ref\", help=\"reference template\", nargs='?')\n    arg_parser.add_argument(\"outfile\", help=\"output file name\", nargs='?')\n    arg_parser.add_argument(\"action_number\", help=\"action number\", nargs='?', type=int)\n    arg_parser.add_argument('--list', \"-l\", dest='list',\n                            help=f\"example: {green_dc('-l *')} \\n\"\n                                 \"description: list current available template. (accept regex)\")\n\n    arg_parser.add_argument('--option', \"-o\", dest='option',\n                            help='\\n'.join([format_text(msg_data_list) for msg_data_list in [\n                                ['example', 'description'],\n                                [green_dc('-o open'), 'open template directory so that you can put your template file there.'],\n                                [green_dc('-o run'), '...'],\n                                [green_dc('-o ...'), '...'],\n                                # &lt;- add your own description\n                            ]]))\n\n    g_args = arg_parser.parse_args()\n    task_run_list = [[False, lambda: startfile('.')] if g_args.option == 'open' else None,\n                     [False, lambda: [print(template_file_path.stem) for template_file_path in TEMPLATE_DIR.glob(f'{g_args.list}.py')]] if g_args.list else None,\n                     # &lt;- add your own function\n                     ]\n    for leave_flag, func in [task_list for task_list in task_run_list if task_list]:\n        func()\n        if leave_flag:\n            exit(0)\n\n    # CHECK POSITIONAL ARGUMENTS\n    for attr_name, value in vars(g_args).items():\n        if attr_name.startswith('-') or value is not None:\n            continue\n        system('cls')\n        print(f'error required values of {red_dc(attr_name)} is None')\n        print(f\"if you need help, please use help command to help you: {red_dc(f'python {__file__} -h')}\")\n        exit(-1)\n    main(g_args)\n\n\n</code></pre>\n\n<p>Where the class of <code>FormatText</code> is the following</p>\n\n<pre><code>class FormatText:\n    __slots__ = ['align_list']\n\n    def __init__(self, align_list: list, autoreset=True):\n        \"\"\"\n        USAGE::\n\n            format_text = FormatText([(20, '&lt;'), (60, '&lt;')])\n            red_dc = format_text.new_dc(fore_color=Fore.RED)\n            print(red_dc(['column 1', 'column 2']))\n            print(red_dc('good morning'))\n        :param align_list:\n        :param autoreset:\n        \"\"\"\n        self.align_list = align_list\n        colorama.init(autoreset=autoreset)\n\n    def __call__(self, text_list: list):\n        if len(text_list) != len(self.align_list):\n            if isinstance(text_list, str):\n                return text_list\n            raise AttributeError\n        return ' '.join(f'{txt:{flag}{int_align}}' for txt, (int_align, flag) in zip(text_list, self.align_list))\n\n    def new_dc(self, fore_color: Fore = Fore.GREEN, back_color: Back = \"\"):  # DECORATOR\n        \"\"\"create a device context\"\"\"\n        def wrap(msgs):\n            return back_color + fore_color + self(msgs) + Fore.RESET\n        return wrap\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JXvAG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JXvAG.png\" alt=\"enter image description here\"></a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 29308,
                                "reputation": 11630,
                                "user_id": 79125,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "idbrii"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1667948661,
                            "post_id": 64102901,
                            "comment_id": 131289290,
                            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/64102901#comment131289290_64102901",
                            "body": "This is a great answer! But it doesn&#39;t apply to the argument help text in OP&#39;s question. I added that functionality <a href=\"https://stackoverflow.com/a/74368128/79125\">in my answer</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 4976466,
                        "reputation": 2003,
                        "user_id": 4002633,
                        "user_type": "registered",
                        "display_name": "Bernd Wechner"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 12,
                    "last_activity_date": 1626689388,
                    "last_edit_date": 1626689388,
                    "creation_date": 1601298704,
                    "answer_id": 64102901,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/64102901#64102901",
                    "body": "<p>I admit I found this a very frustrating experience as it seems many others have, given the number of solutions I see posted and the number of times I see this asked across the web. But I find most of these solutions far too complicated for my likes and I'd like share the tersest simplest solution I have for it.</p>\n<p>Here is the script to demonstrate:</p>\n<pre class=\"lang-py prettyprint-override\"><code>#!/usr/bin/python3\nimport textwrap\nfrom argparse import ArgumentParser, HelpFormatter\n\nclass RawFormatter(HelpFormatter):\n    def _fill_text(self, text, width, indent):\n        return &quot;\\n&quot;.join([textwrap.fill(line, width) for line in textwrap.indent(textwrap.dedent(text), indent).splitlines()])\n\nprogram_descripton = f'''\n    FunkyTool v1.0\n\n    Created by the Funky Guy on January 1 2020\n    Copyright 2020. All rights reserved.\n\n    Licensed under The Hippocratic License 2.1\n    https://firstdonoharm.dev/\n\n    Distributed on an &quot;AS IS&quot; basis without warranties\n    or conditions of any kind, either express or implied.\n\n    USAGE:\n    '''\n\nparser = ArgumentParser(description=program_descripton, formatter_class=RawFormatter)\nargs = parser.parse_args()\n</code></pre>\n<p>And here is what it looks like in <code>test.py</code>:</p>\n<pre><code>$ ./test.py --help\nusage: test.py [-h]\n\nFunkyTool v1.0\n\nCreated by the Funky Guy on January 1 2020\nCopyright 2020. All rights reserved.\n\nLicensed under The Hippocratic License 2.1\nhttps://firstdonoharm.dev/\n\nDistributed on an &quot;AS IS&quot; basis without warranties\nor conditions of any kind, either express or implied.\n\nUSAGE:\n\noptional arguments:\n  -h, --help  show this help message and exit\n</code></pre>\n<p>And so, all the basic formatting in the original description is preserved neatly and we've had, alas, to use a custom formatter, but it's a oneliner. It can be written more lucidly as:</p>\n<pre class=\"lang-py prettyprint-override\"><code>class RawFormatter(HelpFormatter):\n    def _fill_text(self, text, width, indent):\n        text = textwrap.dedent(text)          # Strip the indent from the original python definition that plagues most of us.\n        text = textwrap.indent(text, indent)  # Apply any requested indent.\n        text = text.splitlines()              # Make a list of lines\n        text = [textwrap.fill(line, width) for line in text] # Wrap each line \n        text = &quot;\\n&quot;.join(text)                # Join the lines again\n        return text\n</code></pre>\n<p>But I prefer it on one line myself.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 353545,
                        "reputation": 2213,
                        "user_id": 1007358,
                        "user_type": "registered",
                        "display_name": "Troy Grosfield"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1611603436,
                    "creation_date": 1611603436,
                    "answer_id": 65891304,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/65891304#65891304",
                    "body": "<p>The following python 3 formatter appends the default value if one exists and preserves line lengths.</p>\n<pre><code>from argparse import ArgumentParser, ArgumentDefaultsHelpFormatter, \\ \n                     RawTextHelpFormatter\nimport textwrap\n\nclass CustomArgumentFormatter(ArgumentDefaultsHelpFormatter, RawTextHelpFormatter):\n    &quot;&quot;&quot;Formats argument help which maintains line length restrictions as well as appends default value if present.&quot;&quot;&quot;\n\n    def _split_lines(self, text, width):\n        text = super()._split_lines(text, width)\n        new_text = []\n\n        # loop through all the lines to create the correct wrapping for each line segment.\n        for line in text:\n            if not line:\n                # this would be a new line.\n                new_text.append(line)\n                continue\n\n            # wrap the line's help segment which preserves new lines but ensures line lengths are\n            # honored\n            new_text.extend(textwrap.wrap(line, width))\n\n        return new_text\n</code></pre>\n<p>Then create your argument parser with your new formatter:</p>\n<pre><code>my_arg_parser = ArgumentParser(formatter_class=CustomArgumentFormatter)\n# ... add your arguments ...\nprint(my_arg_parser.format_help())\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 18196086,
                        "reputation": 121,
                        "user_id": 13241127,
                        "user_type": "registered",
                        "display_name": "Diferante"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 12,
                    "last_activity_date": 1640927130,
                    "creation_date": 1640927130,
                    "answer_id": 70539181,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/70539181#70539181",
                    "body": "<p>Yet another simple way of getting new lines using <code>RawTextHelpFormatter</code> and deal with the indentation is</p>\n<pre><code>import argparse\n\nparser = argparse.ArgumentParser(\n    description='test', formatter_class=argparse.RawTextHelpFormatter)\n\nparser.add_argument('-g', choices=['a', 'b', 'g', 'd', 'e'], default='a',\n                    help=('Some option, where\\n'\n                          ' a = alpha\\n'\n                          ' b = beta\\n'\n                          ' g = gamma\\n'\n                          ' d = delta\\n'\n                          ' e = epsilon'))\n\nparser.parse_args()\n\n</code></pre>\n<p>The output is</p>\n<pre><code>$ python2 x.py -h\nusage: x.py [-h] [-g {a,b,g,d,e}]\n\ntest\n\noptional arguments:\n  -h, --help      show this help message and exit\n  -g {a,b,g,d,e}  Some option, where\n                   a = alpha\n                   b = beta\n                   g = gamma\n                   d = delta\n                   e = epsilon\n\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 84517,
                        "reputation": 71,
                        "user_id": 236206,
                        "user_type": "registered",
                        "display_name": "Scott Main"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1663084874,
                    "creation_date": 1663084874,
                    "answer_id": 73706044,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/73706044#73706044",
                    "body": "<p>I came here looking for way to get the behavior of <code>ArgumentDefaultsHelpFormatter</code> but with newlines and tabs honored. Troy's code code got me close, but the final result ended up being a bit simpler:</p>\n<pre><code>class CustomArgumentFormatter(argparse.ArgumentDefaultsHelpFormatter):\n    &quot;&quot;&quot;\n    Formats help text to honor newlines and tabs (and show default values).\n    &quot;&quot;&quot;\n\n    # Match multiples of regular spaces only.\n    _SPACE_MATCHER = re.compile(r' +', re.ASCII)\n\n    def _split_lines(self, text, width):\n        new_text = []\n        for line in text.splitlines():\n          # For each newline in the help message, replace any multiples of\n          # whitespaces (due to indentation in source code) with one space.\n          line = self._SPACE_MATCHER.sub(' ', line).rstrip()\n          # Fit the line length to the console width\n          new_text.extend(textwrap.wrap(line, width))\n        return new_text\n</code></pre>\n<p>Then newlines and tabs will appear as intended:</p>\n<pre><code>parser = argparse.ArgumentParser(formatter_class=CustomArgumentFormatter)\n\nparser.add_argument(\n    '--ethernet_config', type=str, required=False, default=None,\n    help='Path to a text file that specifies Ethernet network IP settings \\\n      to use on the board. For example: \\\n      \\n\\t ip=192.0.2.100 \\\n      \\n\\t subnet_mask=255.255.255.0 \\\n      \\n\\t gateway=192.0.2.1')\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1849316,
                        "reputation": 1222,
                        "user_id": 1676217,
                        "user_type": "registered",
                        "accept_rate": 0,
                        "display_name": "Normadize"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1666630967,
                    "last_edit_date": 1666630967,
                    "creation_date": 1666630383,
                    "answer_id": 74184390,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/74184390#74184390",
                    "body": "<p># 12 years late to the party, but I needed this too.</p>\n<p>OP asked for new lines in <em>help</em> (not <em>description</em>) and as such the solutions here actually do not <em>fully</em> work, because if a line is longer than the screen width then it loses indentation when wrapped (gets wrapped to column 1 instead of preserving indentation of help text) which looks really ugly, or empty lines are gobbled, which I don't want as I need empty lines sometimes in long help texts.</p>\n<p>Working solution below:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import textwrap\n\nclass CustomHelpFormatter(argparse.ArgumentDefaultsHelpFormatter):\n    def _split_lines(self, text, width):\n        wrapper = textwrap.TextWrapper(width=width)\n        lines = []\n        for line in text.splitlines():\n            if len(line) &gt; width:\n                lines.extend(wrapper.wrap(line))\n            else:\n                lines.append(line)\n        return lines\n\nparser = argparse.ArgumentParser(formatter_class=CustomArgumentFormatter)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 29308,
                        "reputation": 11630,
                        "user_id": 79125,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "idbrii"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1667948512,
                    "creation_date": 1667948512,
                    "answer_id": 74368128,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/74368128#74368128",
                    "body": "<p><a href=\"https://stackoverflow.com/a/64102901/79125\">Bernd's answer</a> is very helpful, but doesn't apply to argument help strings. Here's an extension of it that applies to all help text (following the <a href=\"https://github.com/python/cpython/blob/2eee9d9cd7eb1e396fa9a4af7c5fadeeafbdaa38/Lib/argparse.py#L680\" rel=\"nofollow noreferrer\">example of RawTextHelpFormatter</a>).</p>\n<p>DescriptionWrappedNewlineFormatter is his original RawFormatter and WrappedNewlineFormatter will additionally wrap arguments.</p>\n<pre class=\"lang-py prettyprint-override\"><code>import argparse\nimport textwrap\n\nclass DescriptionWrappedNewlineFormatter(argparse.HelpFormatter):\n    &quot;&quot;&quot;An argparse formatter that:\n    * preserves newlines (like argparse.RawDescriptionHelpFormatter),\n    * removes leading indent (great for multiline strings),\n    * and applies reasonable text wrapping.\n\n    Source: https://stackoverflow.com/a/64102901/79125\n    &quot;&quot;&quot;\n    def _fill_text(self, text, width, indent):\n        # Strip the indent from the original python definition that plagues most of us.\n        text = textwrap.dedent(text)\n        text = textwrap.indent(text, indent)  # Apply any requested indent.\n        text = text.splitlines()  # Make a list of lines\n        text = [textwrap.fill(line, width) for line in text]  # Wrap each line\n        text = &quot;\\n&quot;.join(text)  # Join the lines again\n        return text\n\n\nclass WrappedNewlineFormatter(DescriptionWrappedNewlineFormatter):\n    &quot;&quot;&quot;An argparse formatter that:\n    * preserves newlines (like argparse.RawTextHelpFormatter),\n    * removes leading indent and applies reasonable text wrapping (like DescriptionWrappedNewlineFormatter),\n    * applies to all help text (description, arguments, epilogue).\n    &quot;&quot;&quot;\n    def _split_lines(self, text, width):\n        # Allow multiline strings to have common leading indentation.\n        text = textwrap.dedent(text)\n        text = text.splitlines()\n        lines = []\n        for line in text:\n            wrapped_lines = textwrap.fill(line, width).splitlines()\n            lines.extend(subline for subline in wrapped_lines)\n            if line:\n                lines.append(&quot;&quot;)  # Preserve line breaks.\n        return lines\n\n\nif __name__ == &quot;__main__&quot;:\n    def demo_formatter(formatter):\n        parser = argparse.ArgumentParser(\n            description=&quot;&quot;&quot;\n                A program that does things.\n                Lots of description that describes how the program works.\n\n                very long lines are wrapped. very long lines are wrapped. very long lines are wrapped. very long lines are wrapped. very long lines are wrapped. very long lines are wrapped.\n\n                existing wrapping will be preserved if within width. existing\n                wrapping is preserved. existing wrapping will be preserved.\n                existing wrapping is preserved. existing wrapping will be\n                preserved. existing wrapping is preserved. existing wrapping\n                will be preserved. existing wrapping is preserved unless it goes too long for the display width.\n                &quot;&quot;&quot;,\n            formatter_class=formatter,\n        )\n        parser.add_argument(\n            &quot;--option&quot;,\n            choices=[\n                &quot;red&quot;,\n                &quot;blue&quot;,\n            ],\n            help=&quot;&quot;&quot;\n                Lots of text describing different choices.\n                    red: a warning colour\n                    text on the next line\n\n                    blue: a longer blah blah keeps going going going going going going going going going going\n                &quot;&quot;&quot;,\n        )\n        print(&quot;\\n\\nDemo for {}\\n&quot;.format(formatter.__name__))\n        parser.print_help()\n\n    demo_formatter(DescriptionWrappedNewlineFormatter)\n    demo_formatter(WrappedNewlineFormatter)\n</code></pre>\n<h1>Demo output for WrappedNewlineFormatter</h1>\n<pre><code>usage: arg.py [-h] [--option {red,blue}]\n\nA program that does things.\nLots of description that describes how the program works.\n\nvery long lines are wrapped. very long lines are wrapped. very long lines are\nwrapped. very long lines are wrapped. very long lines are wrapped. very long\nlines are wrapped.\n\nexisting wrapping will be preserved if within width. existing\nwrapping is preserved. existing wrapping will be preserved.\nexisting wrapping is preserved. existing wrapping will be\npreserved. existing wrapping is preserved. existing wrapping\nwill be preserved. existing wrapping is preserved unless it goes too long for\nthe display width.\n\noptional arguments:\n  -h, --help           show this help message and exit\n                       \n  --option {red,blue}  Lots of text describing different choices.\n                       \n                           red: a warning colour\n                       \n                           text on the next line\n                       \n                           blue: a longer blah blah keeps going going going\n                       going going going going going going going\n                       \n</code></pre>\n<h1>Demo output for DescriptionWrappedNewlineFormatter</h1>\n<pre><code>usage: arg.py [-h] [--option {red,blue}]\n\nA program that does things.\nLots of description that describes how the program works.\n\nvery long lines are wrapped. very long lines are wrapped. very long lines are\nwrapped. very long lines are wrapped. very long lines are wrapped. very long\nlines are wrapped.\n\nexisting wrapping will be preserved if within width. existing\nwrapping is preserved. existing wrapping will be preserved.\nexisting wrapping is preserved. existing wrapping will be\npreserved. existing wrapping is preserved. existing wrapping\nwill be preserved. existing wrapping is preserved unless it goes too long for\nthe display width.\n\noptional arguments:\n  -h, --help           show this help message and exit\n  --option {red,blue}  Lots of text describing different choices. red: a\n                       warning colour text on the next line blue: a longer\n                       blah blah keeps going going going going going going\n                       going going going going\n                       ```\n\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 173533,
                        "reputation": 9745,
                        "user_id": 402281,
                        "user_type": "registered",
                        "accept_rate": 58,
                        "display_name": "Feuermurmel"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1675509953,
                    "creation_date": 1675509953,
                    "answer_id": 75344754,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/75344754#75344754",
                    "body": "<p>This is the simplest solution I found that keeps the ability to automatically wrap text to the terminal's with while keeping manual newlines intact. It boils down to replacing the default formatter's calls to <code>textwrap.wrap()</code> with a version that keeps the manual newlines.</p>\n<p>The <code>_split_lines()</code> and <code>_fill_text()</code> that I've overridden are of course implementation details of <code>argparse</code>, so this might break in the future. I'd be glad if you note so in the comments, if that happens to you! \ud83d\ude0a</p>\n<pre class=\"lang-py prettyprint-override\"><code>import textwrap\nfrom argparse import ArgumentParser, HelpFormatter\n\n\ndef wrap_paragraphs(text: str, width: int, indent: str):\n    &quot;&quot;&quot;\n    Wrapper around `textwrap.wrap()` which keeps newlines in the input string\n    intact.\n    &quot;&quot;&quot;\n    lines = list[str]()\n\n    for i in text.splitlines():\n        paragraph_lines = \\\n            textwrap.wrap(i, width, initial_indent=indent, subsequent_indent=indent)\n\n        # `textwrap.wrap()` will return an empty list when passed an empty\n        # string (which happens when there are two consecutive line breaks in\n        # the input string). This would lead to those line breaks being\n        # collapsed into a single line break, effectively removing empty lines\n        # from the input. Thus, we add an empty line in that case.\n        lines.extend(paragraph_lines or [''])\n\n    return lines\n\n\nclass Formatter(HelpFormatter):\n    def _split_lines(self, text, width):\n        return wrap_paragraphs(text, width, '')\n\n    def _fill_text(self, text, width, indent):\n        return '\\n'.join(wrap_paragraphs(text, width, indent))\n\n\nparser = ArgumentParser(\n    prog='guide',\n    formatter_class=Formatter,\n    description='The Hitch Hiker\\'s Guide to the Galaxy is a wholly remarkable '\n                'book. It has been compiled and recompiled many times over '\n                'many years and under many different editorships. It contains'\n                'contributions from countless numbers of travellers and '\n                'researchers.\\n'\n                '\\n'\n                'The introduction begins like this:\\n'\n                '\\n'\n                '&quot;Space,&quot; it says &quot;is big. Really big&quot;\\n')\n\nparser.add_argument(\n    '--probability',\n    help='&quot;But what does it mean?&quot; cried Arthur.\\n'\n         '&quot;What, the custard?&quot;\\n'\n         '&quot;No, the measurement of probability!&quot;\\n')\n\n\nparser.print_help()\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>usage: guide [-h] [--probability PROBABILITY]\n\nThe Hitch Hiker's Guide to the Galaxy is a wholly remarkable book. It has been\ncompiled and recompiled many times over many years and under many different\neditorships. It containscontributions from countless numbers of travellers and\nresearchers.\n\nThe introduction begins like this:\n\n&quot;Space,&quot; it says &quot;is big. Really big&quot;\n\noptions:\n  -h, --help            show this help message and exit\n  --probability PROBABILITY\n                        &quot;But what does it mean?&quot; cried Arthur.\n                        &quot;What, the custard?&quot;\n                        &quot;No, the measurement of probability!&quot;\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 3580374,
                        "reputation": 111083,
                        "user_id": 2988730,
                        "user_type": "registered",
                        "accept_rate": 96,
                        "display_name": "Mad Physicist"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1692801877,
                    "creation_date": 1692801877,
                    "answer_id": 76962505,
                    "question_id": 3853722,
                    "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text/76962505#76962505",
                    "body": "<p>I made a solution that's pretty similar to some of the suggested ones which preserves newlines and leading whitespace. The only catch is that it converts tabs to 4 spaces so that their impact on the width can be predicted.</p>\n<p>The main difference between this approach and the previous suggestions is that it delegates all of the formatting to the parent methods. It doesn't require knowledge of <code>textwrap</code> or really anything else from the base class besides some private method names.</p>\n<pre><code>from argparse import HelpFormatter\n\ndef lws(line):\n    prefix = line[:len(line) - len(line.lstrip())]\n    return len(prefix) + 3 * prefix.count('\\t')\n\nclass SmartHelpFormatter(HelpFormatter):\n    def _split_lines(self, text, width):\n        r = []\n        for line in lines():\n            n = lws(line)\n            r.extend(' ' * n + s for s in super()._split_lines(line, width - n))\n        return r\n\n    def _fill_text(self, text, width, indent):\n        r = []\n        for line in text.splitlines():\n            n = lws(line)\n            r.append(super()._fill_text(line, width, indent + ' ' * n))\n        return '\\n'.join(r)\n</code></pre>\n<p>You can find a slightly more flexible version of this in <a href=\"https://haggis.readthedocs.io/en/stable/api.html#haggis.args.SmartHelpFormatter\" rel=\"nofollow noreferrer\"><code>haggis.args.SmartHelpFormatter</code></a> (which I wrote and maintain).</p>\n"
                }
            ],
            "owner": {
                "account_id": 79153,
                "reputation": 518011,
                "user_id": 224671,
                "user_type": "registered",
                "accept_rate": 67,
                "display_name": "kennytm"
            },
            "comment_count": 3,
            "is_answered": true,
            "accepted_answer_id": 3853776,
            "answer_count": 15,
            "score": 500,
            "last_activity_date": 1692801877,
            "creation_date": 1286181600,
            "last_edit_date": 1614625960,
            "question_id": 3853722,
            "link": "https://stackoverflow.com/questions/3853722/how-to-insert-newlines-on-argparse-help-text",
            "title": "How to insert newlines on argparse help text?",
            "body": "<p>I'm using <a href=\"http://docs.python.org/library/argparse.html\" rel=\"noreferrer\"><code>argparse</code> in Python 2.7</a> for parsing input options. One of my options is a multiple choice. I want to make a list in its help text, e.g.</p>\n\n<pre><code>from argparse import ArgumentParser\n\nparser = ArgumentParser(description='test')\n\nparser.add_argument('-g', choices=['a', 'b', 'g', 'd', 'e'], default='a',\n    help=\"Some option, where\\n\"\n         \" a = alpha\\n\"\n         \" b = beta\\n\"\n         \" g = gamma\\n\"\n         \" d = delta\\n\"\n         \" e = epsilon\")\n\nparser.parse_args()\n</code></pre>\n\n<p>However, <code>argparse</code> strips all newlines and consecutive spaces. The result looks like</p>\n\n<pre>\n~/Downloads:52$ python2.7 x.py -h\nusage: x.py [-h] [-g {a,b,g,d,e}]\n\ntest\n\noptional arguments:\n  -h, --help      show this help message and exit\n  -g {a,b,g,d,e}  Some option, where a = alpha b = beta g = gamma d = delta e\n                  = epsilon\n</pre>\n\n<p>How to insert newlines in the help text?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9446
}