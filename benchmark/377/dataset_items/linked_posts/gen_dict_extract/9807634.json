{
    "items": [
        {
            "tags": [
                "python",
                "recursion",
                "dictionary",
                "traversal"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 18437,
                        "reputation": 31942,
                        "user_id": 42223,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "dreftymac"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1509393334,
                    "post_id": 9807634,
                    "comment_id": 80993384,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists#comment80993384_9807634",
                    "body": "<b>See also:</b> <a href=\"https://stackoverflow.com/questions/7681301/search-for-a-key-in-a-nested-python-dictionary\" title=\"search for a key in a nested python dictionary\">stackoverflow.com/questions/7681301/&hellip;</a> <a href=\"https://stackoverflow.com/a/16508328/42223\">stackoverflow.com/a/16508328/42223</a>"
                },
                {
                    "owner": {
                        "account_id": 69533,
                        "reputation": 33443,
                        "user_id": 202229,
                        "user_type": "registered",
                        "accept_rate": 74,
                        "display_name": "smci"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1525671341,
                    "post_id": 9807634,
                    "comment_id": 87432136,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists#comment87432136_9807634",
                    "body": "Most of your solutions blow up if we pass <code>None</code> as input. Do you care about robustness? (since this is now being used as canonical question)"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 460965,
                                "reputation": 13262,
                                "user_id": 862380,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "ovgolovin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1332344983,
                            "post_id": 9807955,
                            "comment_id": 12491660,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment12491660_9807955",
                            "body": "The only thing I would change is <code>for k in d</code> to <code>for k,value in d.items()</code> with the subsequent use of <code>value</code> instead of <code>d[k]</code>."
                        },
                        {
                            "owner": {
                                "account_id": 416994,
                                "reputation": 3867,
                                "user_id": 792734,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Matt Swain"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1332345543,
                            "post_id": 9807955,
                            "comment_id": 12491926,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment12491926_9807955",
                            "body": "Thanks, this works great. Required very slight modification because my lists can contain strings as well as dicts (which I didn&#39;t mention), but otherwise perfect."
                        },
                        {
                            "owner": {
                                "account_id": 40542,
                                "reputation": 68507,
                                "user_id": 117471,
                                "user_type": "registered",
                                "accept_rate": 31,
                                "display_name": "Bruno Bronosky"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1487564649,
                            "post_id": 9807955,
                            "comment_id": 71825395,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment71825395_9807955",
                            "body": "This fits a very narrow case, you owe it to yourself to consider the answer from &quot;hexerei software&quot; called <code>gen_dict_extract</code>"
                        },
                        {
                            "owner": {
                                "account_id": 11777779,
                                "reputation": 215,
                                "user_id": 8618545,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "xiaoshir"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529050285,
                            "post_id": 9807955,
                            "comment_id": 88744622,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment88744622_9807955",
                            "body": "I got the error &quot;TypeError: argument of type &#39;NoneType&#39; is not iterable&quot;"
                        },
                        {
                            "owner": {
                                "account_id": 254676,
                                "reputation": 3800,
                                "user_id": 534238,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Mike Williamson"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529435460,
                            "post_id": 9807955,
                            "comment_id": 88869412,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment88869412_9807955",
                            "body": "For anyone visiting this page now that Python 3 has taken over, remember that <code>iteritems</code> has become <code>items</code>."
                        },
                        {
                            "owner": {
                                "account_id": 66899,
                                "reputation": 11612,
                                "user_id": 196032,
                                "user_type": "registered",
                                "accept_rate": 49,
                                "display_name": "Alex R"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1551156565,
                            "post_id": 9807955,
                            "comment_id": 96526640,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment96526640_9807955",
                            "body": "This solution doesn&#39;t seem to support lists"
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "reply_to_user": {
                                "account_id": 66899,
                                "reputation": 11612,
                                "user_id": 196032,
                                "user_type": "registered",
                                "accept_rate": 49,
                                "display_name": "Alex R"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1554889033,
                            "post_id": 9807955,
                            "comment_id": 97913071,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment97913071_9807955",
                            "body": "@AlexR Indeed it doesn&#39;t.  If you do <code>d[&#39;nestedlist&#39;] = [d[&#39;nestedlist&#39;]]</code> you&#39;ll get a TypError. This answer incorrectly, and unnecessarily, assumes lists cannot be either at the root level of the data structure and also that they cannot be directly nested."
                        },
                        {
                            "owner": {
                                "account_id": 12377626,
                                "reputation": 5097,
                                "user_id": 9024698,
                                "user_type": "registered",
                                "accept_rate": 55,
                                "display_name": "Outcast"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1575735781,
                            "post_id": 9807955,
                            "comment_id": 104669415,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#comment104669415_9807955",
                            "body": "I think that this solution does not support (nested) lists."
                        }
                    ],
                    "owner": {
                        "account_id": 141612,
                        "reputation": 158744,
                        "user_id": 348785,
                        "user_type": "registered",
                        "accept_rate": 97,
                        "display_name": "kev"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 50,
                    "last_activity_date": 1332344450,
                    "creation_date": 1332344450,
                    "answer_id": 9807955,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9807955#9807955",
                    "body": "<pre><code>d = { \"id\" : \"abcde\",\n    \"key1\" : \"blah\",\n    \"key2\" : \"blah blah\",\n    \"nestedlist\" : [ \n    { \"id\" : \"qwerty\",\n        \"nestednestedlist\" : [ \n        { \"id\" : \"xyz\", \"keyA\" : \"blah blah blah\" },\n        { \"id\" : \"fghi\", \"keyZ\" : \"blah blah blah\" }],\n        \"anothernestednestedlist\" : [ \n        { \"id\" : \"asdf\", \"keyQ\" : \"blah blah\" },\n        { \"id\" : \"yuiop\", \"keyW\" : \"blah\" }] } ] } \n\n\ndef fun(d):\n    if 'id' in d:\n        yield d['id']\n    for k in d:\n        if isinstance(d[k], list):\n            for i in d[k]:\n                for j in fun(i):\n                    yield j\n</code></pre>\n\n<hr>\n\n<pre><code>&gt;&gt;&gt; list(fun(d))\n['abcde', 'qwerty', 'xyz', 'fghi', 'asdf', 'yuiop']\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1332345026,
                            "post_id": 9808122,
                            "comment_id": 12491675,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment12491675_9808122",
                            "body": "You can strip the dict-elif-branch if you like.  your case doesn&#39;t seem to have these."
                        },
                        {
                            "owner": {
                                "account_id": 416994,
                                "reputation": 3867,
                                "user_id": 792734,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Matt Swain"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1332346518,
                            "post_id": 9808122,
                            "comment_id": 12492385,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment12492385_9808122",
                            "body": "This works great as well, but likewise runs into issues if it encounters a list that directly contains a string (which I forgot to include in my example). I think adding in an <code>isinstance</code> check for a <code>dict</code> before the last two lines solves this."
                        },
                        {
                            "owner": {
                                "account_id": 2257110,
                                "reputation": 3140,
                                "user_id": 1988084,
                                "user_type": "registered",
                                "display_name": "hexerei software"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1429109433,
                            "post_id": 9808122,
                            "comment_id": 47446739,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment47446739_9808122",
                            "body": "@Alfe congratulations! see my answer, where i speed tested all functions, your function is outstanding, only overtaken by my adaption to your function, where i checked if given object has <code>iteritems()</code> function"
                        },
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1429171826,
                            "post_id": 9808122,
                            "comment_id": 47476139,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment47476139_9808122",
                            "body": "Thanks for the accolades, but I&#39;d be prouder to get them for the cleanliness of my code than for its speed."
                        },
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1480948638,
                            "post_id": 9808122,
                            "comment_id": 69162641,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment69162641_9808122",
                            "body": "95% of the time, yes.  The remaining (rare) occasions are the ones in which some time limitation might force me to choose a faster version over a cleaner one.  But I don&#39;t like this.  It always means to put a load of work onto my successor who will have to maintain that code.  It is a risk because my successor might get confused.  I will have to write a lot of comments then, maybe a whole document explaining my motivations, timing experiments, their results etc.  That&#39;s way more work for me and all colleagues to get it done properly.  Cleaner is way simpler."
                        },
                        {
                            "owner": {
                                "account_id": 77139,
                                "reputation": 1218,
                                "user_id": 220376,
                                "user_type": "registered",
                                "accept_rate": 25,
                                "display_name": "Saurabh Hirani"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1533451707,
                            "post_id": 9808122,
                            "comment_id": 90345673,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment90345673_9808122",
                            "body": "@Alfe - thanks for this answer. I had a need to extract all occurences of a string in a nested dict for a specific use case of Elasticsearch and this code was useful with a minor modification - <a href=\"https://stackoverflow.com/questions/40586020/get-the-number-of-fields-on-an-index/51692012#51692012\" title=\"get the number of fields on an index\">stackoverflow.com/questions/40586020/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1554889312,
                            "post_id": 9808122,
                            "comment_id": 97913255,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment97913255_9808122",
                            "body": "This completely <b>breaks</b> on lists directly contained in lists."
                        },
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "reply_to_user": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1554901348,
                            "post_id": 9808122,
                            "comment_id": 97920397,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment97920397_9808122",
                            "body": "@Anthon You are right.  I could change the implementation to also support nested lists but then it gets more complex and harder to understand, and the OP&#39;s case didn&#39;t have those anyway.  But thanks for point that out anyway."
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1554902778,
                            "post_id": 9808122,
                            "comment_id": 97921358,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment97921358_9808122",
                            "body": "I am not sure why you think it gets <b>more</b> complex, as in fact the character count would decrease by at least 5% and your line-count would stay the same for that function. It is just re-arranging of the lines you have, indenting accordingly, and changing one <code>elif</code> to <code>if</code>."
                        },
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1554910305,
                            "post_id": 9808122,
                            "comment_id": 97926023,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment97926023_9808122",
                            "body": "I added another version solving your issue of directly nested lists.  But I still believe the original version is easier to understand."
                        },
                        {
                            "owner": {
                                "account_id": 12377626,
                                "reputation": 5097,
                                "user_id": 9024698,
                                "user_type": "registered",
                                "accept_rate": 55,
                                "display_name": "Outcast"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1575736194,
                            "post_id": 9808122,
                            "comment_id": 104669531,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#comment104669531_9808122",
                            "body": "I think that your second version indeed works for nested lists - well done ;)"
                        }
                    ],
                    "owner": {
                        "account_id": 1339492,
                        "reputation": 58094,
                        "user_id": 1281485,
                        "user_type": "registered",
                        "accept_rate": 64,
                        "display_name": "Alfe"
                    },
                    "comment_count": 11,
                    "is_accepted": false,
                    "score": 29,
                    "last_activity_date": 1629706432,
                    "last_edit_date": 1629706432,
                    "creation_date": 1332344930,
                    "answer_id": 9808122,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/9808122#9808122",
                    "body": "<pre><code>def find(key, value):\n  for k, v in value.items():\n    if k == key:\n      yield v\n    elif isinstance(v, dict):\n      for result in find(key, v):\n        yield result\n    elif isinstance(v, list):\n      for d in v:\n        for result in find(key, d):\n          yield result\n</code></pre>\n<p>EDIT: @Anthon noticed that this will not work for directly nested lists.  If you have this in your input, you can use this:</p>\n<pre><code>def find(key, value):\n  for k, v in (value.items() if isinstance(value, dict) else\n               enumerate(value) if isinstance(value, list) else []):\n    if k == key:\n      yield v\n    elif isinstance(v, (dict, list)):\n      for result in find(key, v):\n        yield result\n</code></pre>\n<p>But I think the original version is easier to understand, so I will leave it.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "user_type": "does_not_exist",
                                "display_name": "user7548672"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1549249481,
                            "post_id": 19871956,
                            "comment_id": 95822841,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/19871956#comment95822841_19871956",
                            "body": "This example worked with every complex dictionary I tested. Well done."
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1554887406,
                            "post_id": 19871956,
                            "comment_id": 97912061,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/19871956#comment97912061_19871956",
                            "body": "This should be the accepted answer, it can find keys that are within dictionaries that are nested within list of lists etc."
                        },
                        {
                            "owner": {
                                "account_id": 2632900,
                                "reputation": 304,
                                "user_id": 3605584,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "Sophie"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1566867176,
                            "post_id": 19871956,
                            "comment_id": 101781466,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/19871956#comment101781466_19871956",
                            "body": "This works in Python3 as well, as long as the print statement at the end is modified. None of the solutions above this worked for an API response with lists nested inside dicts listed inside lists, etc, but this one worked beautifully."
                        },
                        {
                            "owner": {
                                "account_id": 5809959,
                                "reputation": 2599,
                                "user_id": 4581384,
                                "user_type": "registered",
                                "accept_rate": 92,
                                "display_name": "Leonardo Wildt"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1678890242,
                            "post_id": 19871956,
                            "comment_id": 133620888,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/19871956#comment133620888_19871956",
                            "body": "This solution is epic! Really delivered for me, thank you!"
                        }
                    ],
                    "owner": {
                        "account_id": 1918646,
                        "reputation": 1402,
                        "user_id": 1730644,
                        "user_type": "registered",
                        "display_name": "arainchi"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 42,
                    "last_activity_date": 1568325036,
                    "last_edit_date": 1568325036,
                    "creation_date": 1383966850,
                    "answer_id": 19871956,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/19871956#19871956",
                    "body": "<pre><code>d = { \"id\" : \"abcde\",\n    \"key1\" : \"blah\",\n    \"key2\" : \"blah blah\",\n    \"nestedlist\" : [\n    { \"id\" : \"qwerty\",\n        \"nestednestedlist\" : [\n        { \"id\" : \"xyz\", \"keyA\" : \"blah blah blah\" },\n        { \"id\" : \"fghi\", \"keyZ\" : \"blah blah blah\" }],\n        \"anothernestednestedlist\" : [\n        { \"id\" : \"asdf\", \"keyQ\" : \"blah blah\" },\n        { \"id\" : \"yuiop\", \"keyW\" : \"blah\" }] } ] }\n\n\ndef findkeys(node, kv):\n    if isinstance(node, list):\n        for i in node:\n            for x in findkeys(i, kv):\n               yield x\n    elif isinstance(node, dict):\n        if kv in node:\n            yield node[kv]\n        for j in node.values():\n            for x in findkeys(j, kv):\n                yield x\n\nprint(list(findkeys(d, 'id')))\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 8393113,
                                "reputation": 82,
                                "user_id": 6301218,
                                "user_type": "registered",
                                "display_name": "sapit"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1529059627,
                            "post_id": 20254898,
                            "comment_id": 88749413,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/20254898#comment88749413_20254898",
                            "body": "You could use fields_found.extend(more_results) instead of running another loop. Would look a bit cleaner in my opinion."
                        }
                    ],
                    "owner": {
                        "account_id": 3374151,
                        "reputation": 1564,
                        "user_id": 2832666,
                        "user_type": "registered",
                        "accept_rate": 0,
                        "display_name": "Becca Petrin"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 6,
                    "last_activity_date": 1611802839,
                    "last_edit_date": 1611802839,
                    "creation_date": 1385593770,
                    "answer_id": 20254898,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/20254898#20254898",
                    "body": "<p>This function recursively searches a dictionary containing nested dictionaries and lists. It builds a list called fields_found, which contains the value for every time the field is found. The 'field' is the key I'm looking for in the dictionary and its nested lists and dictionaries.</p>\n<pre class=\"lang-py prettyprint-override\"><code>def get_recursively(search_dict, field):\n    &quot;&quot;&quot;Takes a dict with nested lists and dicts,\n    and searches all dicts for a key of the field\n    provided.\n    &quot;&quot;&quot;\n    fields_found = []\n\n    for key, value in search_dict.iteritems():\n\n        if key == field:\n            fields_found.append(value)\n\n        elif isinstance(value, dict):\n            results = get_recursively(value, field)\n            for result in results:\n                fields_found.append(result)\n\n        elif isinstance(value, list):\n            for item in value:\n                if isinstance(item, dict):\n                    more_results = get_recursively(item, field)\n                    for another_result in more_results:\n                        fields_found.append(another_result)\n\n    return fields_found\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 124034,
                        "reputation": 15742,
                        "user_id": 318870,
                        "user_type": "registered",
                        "accept_rate": 87,
                        "display_name": "Dolan Antenucci"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 6,
                    "last_activity_date": 1414445274,
                    "creation_date": 1414445274,
                    "answer_id": 26597165,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/26597165#26597165",
                    "body": "<p>Another variation, which includes the nested path to the found results (<strong><em>note: this version doesn't consider lists</em></strong>):</p>\n\n<pre><code>def find_all_items(obj, key, keys=None):\n    \"\"\"\n    Example of use:\n    d = {'a': 1, 'b': 2, 'c': {'a': 3, 'd': 4, 'e': {'a': 9, 'b': 3}, 'j': {'c': 4}}}\n    for k, v in find_all_items(d, 'a'):\n        print \"* {} = {} *\".format('-&gt;'.join(k), v)    \n    \"\"\"\n    ret = []\n    if not keys:\n        keys = []\n    if key in obj:\n        out_keys = keys + [key]\n        ret.append((out_keys, obj[key]))\n    for k, v in obj.items():\n        if isinstance(v, dict):\n            found_items = find_all_items(v, key, keys=(keys+[k]))\n            ret += found_items\n    return ret\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 316578,
                        "reputation": 4311,
                        "user_id": 632827,
                        "user_type": "registered",
                        "accept_rate": 20,
                        "display_name": "AXE Labs"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1425506709,
                    "creation_date": 1425506709,
                    "answer_id": 28865949,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/28865949#28865949",
                    "body": "<p>Here is my stab at it:</p>\n\n<pre><code>def keyHole(k2b,o):\n  # print \"Checking for %s in \"%k2b,o\n  if isinstance(o, dict):\n    for k, v in o.iteritems():\n      if k == k2b and not hasattr(v, '__iter__'): yield v\n      else:\n        for r in  keyHole(k2b,v): yield r\n  elif hasattr(o, '__iter__'):\n    for r in [ keyHole(k2b,i) for i in o ]:\n      for r2 in r: yield r2\n  return\n</code></pre>\n\n<p><a href=\"http://repl.it/cmm\" rel=\"nofollow\">Ex.:</a></p>\n\n<pre><code>&gt;&gt;&gt; findMe = {'Me':{'a':2,'Me':'bop'},'z':{'Me':4}}\n&gt;&gt;&gt; keyHole('Me',findMe)\n&lt;generator object keyHole at 0x105eccb90&gt;\n&gt;&gt;&gt; [ x for x in keyHole('Me',findMe) ]\n['bop', 4]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 40542,
                                "reputation": 68507,
                                "user_id": 117471,
                                "user_type": "registered",
                                "accept_rate": 31,
                                "display_name": "Bruno Bronosky"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1487564523,
                            "post_id": 29652561,
                            "comment_id": 71825356,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment71825356_29652561",
                            "body": "This is the right answer for anyone but the OP&#39;s narrow case. This has worked on every nasty thing that <a href=\"http://jsonpickle.readthedocs.io/en/latest/\" rel=\"nofollow noreferrer\">jsonpickle</a> can throw at it."
                        },
                        {
                            "owner": {
                                "account_id": 40542,
                                "reputation": 68507,
                                "user_id": 117471,
                                "user_type": "registered",
                                "accept_rate": 31,
                                "display_name": "Bruno Bronosky"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1487564550,
                            "post_id": 29652561,
                            "comment_id": 71825365,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment71825365_29652561",
                            "body": "If you want to search for multiple keys as I did, just: (1) change to <code>gen_dict_extract(keys, var)</code> (2) put <code>for key in keys:</code> as line 2 &amp; indent the rest (3) change the first yield to <code>yield {key: v}</code>"
                        },
                        {
                            "owner": {
                                "account_id": 14652,
                                "reputation": 1265,
                                "user_id": 30368,
                                "user_type": "registered",
                                "display_name": "kaleissin"
                            },
                            "edited": false,
                            "score": 7,
                            "creation_date": 1500383411,
                            "post_id": 29652561,
                            "comment_id": 77303386,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment77303386_29652561",
                            "body": "You&#39;re comparing apples to oranges. Running a function that returns a generator takes less time than running a function that returns a finished result. Try timeit on <code>next(functionname(k, o)</code> for all the generator solutions."
                        },
                        {
                            "owner": {
                                "account_id": 3893097,
                                "reputation": 17375,
                                "user_id": 3222797,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "o-90"
                            },
                            "edited": false,
                            "score": 17,
                            "creation_date": 1504887398,
                            "post_id": 29652561,
                            "comment_id": 79203957,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment79203957_29652561",
                            "body": "<code>hasattr(var, &#39;items&#39;)</code> for python3"
                        },
                        {
                            "owner": {
                                "account_id": 1339492,
                                "reputation": 58094,
                                "user_id": 1281485,
                                "user_type": "registered",
                                "accept_rate": 64,
                                "display_name": "Alfe"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1510221402,
                            "post_id": 29652561,
                            "comment_id": 81346019,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment81346019_29652561",
                            "body": "Did you consider to strip the <code>if hasattr</code> part for a version using <code>try</code> to catch the exception in case the call fails (see <a href=\"https://pastebin.com/ZXvVtV0g\" rel=\"nofollow noreferrer\">pastebin.com/ZXvVtV0g</a> for a possible implementation)?  That would reduce the doubled lookup of the attribute <code>iteritems</code> (once for <code>hasattr()</code> and once for the call) and thus probably reduce the runtime (which seems important to you).  Didn&#39;t make any benchmarks, though."
                        },
                        {
                            "owner": {
                                "account_id": 4336192,
                                "reputation": 1911,
                                "user_id": 3540618,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Stack of Pancakes"
                            },
                            "reply_to_user": {
                                "account_id": 14652,
                                "reputation": 1265,
                                "user_id": 30368,
                                "user_type": "registered",
                                "display_name": "kaleissin"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1526911414,
                            "post_id": 29652561,
                            "comment_id": 87914260,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment87914260_29652561",
                            "body": "I have to agree with @kaleissin on this.  Those timeit results are absolutely meaningless.  It might have been the same dict and the same search term, but generators by their nature do <i>nothing</i> until you start iterating through them.  If the dict object had 1 entry, or 99 Quadrillion your generator would &quot;finish&quot; in the exact same amount of time, because all it did was find the first result and then it stopped processing.  The other solutions, namely &quot;get_recursively&quot;, <b>ACTUALLY</b> found all occurrences of the key, as the OP had asked.  As such, this answer is very misleading."
                        },
                        {
                            "owner": {
                                "account_id": 11777779,
                                "reputation": 215,
                                "user_id": 8618545,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "xiaoshir"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1529050557,
                            "post_id": 29652561,
                            "comment_id": 88744740,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment88744740_29652561",
                            "body": "I tried <code>list(gen_dict_extract(&#39;logging&#39;,o))</code>, but it returns an empty list, why is this?"
                        },
                        {
                            "owner": {
                                "account_id": 254676,
                                "reputation": 3800,
                                "user_id": 534238,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Mike Williamson"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1529435449,
                            "post_id": 29652561,
                            "comment_id": 88869408,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment88869408_29652561",
                            "body": "For anyone visiting this page now that Python 3 has taken over, remember that <code>iteritems</code> has become <code>items</code>."
                        },
                        {
                            "owner": {
                                "account_id": 254676,
                                "reputation": 3800,
                                "user_id": 534238,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Mike Williamson"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1529435638,
                            "post_id": 29652561,
                            "comment_id": 88869496,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment88869496_29652561",
                            "body": "I do not understand how this function actually solves all cases.  Bruno mentions in response to kev&#39;s answer that this is the better solution.  To me it seems <b>more</b> narrow: it does not look through lists (which don&#39;t have the <code>items</code> or in Py2 <code>iteritems</code> attributes).  Yet, kev&#39;s solution handles this.  What am I missing?"
                        },
                        {
                            "owner": {
                                "account_id": 2257110,
                                "reputation": 3140,
                                "user_id": 1988084,
                                "user_type": "registered",
                                "display_name": "hexerei software"
                            },
                            "reply_to_user": {
                                "account_id": 11777779,
                                "reputation": 215,
                                "user_id": 8618545,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "xiaoshir"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529937418,
                            "post_id": 29652561,
                            "comment_id": 89044444,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment89044444_29652561",
                            "body": "@edge27 as Mike Williamson has mentioned, you are most likely using Python 3 and therefore have to use &#39;iter&#39; instead of &#39;iteritems&#39;"
                        },
                        {
                            "owner": {
                                "account_id": 2257110,
                                "reputation": 3140,
                                "user_id": 1988084,
                                "user_type": "registered",
                                "display_name": "hexerei software"
                            },
                            "reply_to_user": {
                                "account_id": 254676,
                                "reputation": 3800,
                                "user_id": 534238,
                                "user_type": "registered",
                                "accept_rate": 83,
                                "display_name": "Mike Williamson"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1529937580,
                            "post_id": 29652561,
                            "comment_id": 89044564,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment89044564_29652561",
                            "body": "@MikeWilliamson Lists are not handled, as they are values in a dictionary and this function only handles returning what ever is set with given key. So it could return a list as value, but searching for a value with given key within a list is not supported"
                        },
                        {
                            "owner": {
                                "account_id": 1373414,
                                "reputation": 73737,
                                "user_id": 1307905,
                                "user_type": "registered",
                                "accept_rate": 75,
                                "display_name": "Anthon"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1554887696,
                            "post_id": 29652561,
                            "comment_id": 97912207,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment97912207_29652561",
                            "body": "What is really bad is that you assume the top-level is a dictionary (and not a list), but even worse, you also unnecessarily assume that lists have primitives or dicts as values. Typical case of premature optimisation for speed, when the algorithm doesn&#39;t work for all cases (which it easily could)"
                        },
                        {
                            "owner": {
                                "account_id": 12377626,
                                "reputation": 5097,
                                "user_id": 9024698,
                                "user_type": "registered",
                                "accept_rate": 55,
                                "display_name": "Outcast"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1575735867,
                            "post_id": 29652561,
                            "comment_id": 104669442,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment104669442_29652561",
                            "body": "Are you sure that your function works? - I am using your function and data and it returns empty list."
                        },
                        {
                            "owner": {
                                "account_id": 2257110,
                                "reputation": 3140,
                                "user_id": 1988084,
                                "user_type": "registered",
                                "display_name": "hexerei software"
                            },
                            "reply_to_user": {
                                "account_id": 472230,
                                "reputation": 12083,
                                "user_id": 880584,
                                "user_type": "registered",
                                "accept_rate": 58,
                                "display_name": "Patrick B."
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1590658193,
                            "post_id": 29652561,
                            "comment_id": 109764600,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment109764600_29652561",
                            "body": "@PatrickB. totally agree, cleary needs an update after five years, will write an update and add a notebook to allow playing around with as soon as I find the time"
                        },
                        {
                            "owner": {
                                "account_id": 4560785,
                                "reputation": 95,
                                "user_id": 3703181,
                                "user_type": "registered",
                                "display_name": "Squrppi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1622028300,
                            "post_id": 29652561,
                            "comment_id": 119670309,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment119670309_29652561",
                            "body": "This example would support lists like [&quot;a&quot;:{...}] if added this block at the end:      <code>elif isinstance(var, list):         for l in var:             for result in gen_dict_extract(key, l):                 yield result</code>"
                        },
                        {
                            "owner": {
                                "account_id": 11510608,
                                "reputation": 10379,
                                "user_id": 9926721,
                                "user_type": "registered",
                                "display_name": "funnydman"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1657535045,
                            "post_id": 29652561,
                            "comment_id": 128824848,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment128824848_29652561",
                            "body": "By the way, you can write yield from gen_dict_extract(key, d), instead of directly iterating over the result"
                        },
                        {
                            "owner": {
                                "account_id": 3033198,
                                "reputation": 690,
                                "user_id": 2571805,
                                "user_type": "registered",
                                "display_name": "Ricardo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1699708371,
                            "post_id": 29652561,
                            "comment_id": 136566905,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment136566905_29652561",
                            "body": "Why are you testing if it is a dictionary in two different ways? You do <code>hasattr(var,&#39;items&#39;)</code> and later <code>if isinstance(v, dict)</code>. Also, this fails if your initial <code>var</code> is a list. Also, <code>yield</code> rocks but comparing it to fully evaluated solutions is like comparing the blueprints to the house. And if you like performance so much, maybe you should not go with C-style <code>for</code> cycles where you keep comparing past finding. It&#39;s ok to criticise everybody else&#39;s solution, especially when (a) your solution is better and (b) it actually works."
                        },
                        {
                            "owner": {
                                "account_id": 2257110,
                                "reputation": 3140,
                                "user_id": 1988084,
                                "user_type": "registered",
                                "display_name": "hexerei software"
                            },
                            "reply_to_user": {
                                "account_id": 3033198,
                                "reputation": 690,
                                "user_id": 2571805,
                                "user_type": "registered",
                                "display_name": "Ricardo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1700060080,
                            "post_id": 29652561,
                            "comment_id": 136608603,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#comment136608603_29652561",
                            "body": "@Ricardo my post was never intended to be criticism to others solutions. In contrary, 9 years ago I was excited about the different approaches and just wanted to do a speed comparison as a learning experience to find the solution that best fits my use case back then. By now, the post definitely needs an update (which I promised 4 years ago) with py 3.11 and the valuable comments included."
                        }
                    ],
                    "owner": {
                        "account_id": 2257110,
                        "reputation": 3140,
                        "user_id": 1988084,
                        "user_type": "registered",
                        "display_name": "hexerei software"
                    },
                    "comment_count": 18,
                    "is_accepted": true,
                    "score": 109,
                    "last_activity_date": 1658914304,
                    "last_edit_date": 1658914304,
                    "creation_date": 1429106974,
                    "answer_id": 29652561,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/29652561#29652561",
                    "body": "<p>I found this Q/A very interesting, since it provides several different solutions for the same problem. I took all these functions and tested them with a complex dictionary object. I had to take two functions out of the test, because they had to many fail results and they did not support returning lists or dicts as values, which i find essential, since a function should be prepared for almost <em>any</em> data to come.</p>\n<p>So i pumped the other functions in 100.000 iterations through the <code>timeit</code> module and output came to following result:</p>\n<pre><code>0.11 usec/pass on gen_dict_extract(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n6.03 usec/pass on find_all_items(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n0.15 usec/pass on findkeys(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n1.79 usec/pass on get_recursively(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n0.14 usec/pass on find(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n0.36 usec/pass on dict_extract(k,o)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n</code></pre>\n<p>All functions had the same needle to search for ('logging') and the same dictionary object, which is constructed like this:</p>\n<pre><code>o = { 'temparature': '50', \n      'logging': {\n        'handlers': {\n          'console': {\n            'formatter': 'simple', \n            'class': 'logging.StreamHandler', \n            'stream': 'ext://sys.stdout', \n            'level': 'DEBUG'\n          }\n        },\n        'loggers': {\n          'simpleExample': {\n            'handlers': ['console'], \n            'propagate': 'no', \n            'level': 'INFO'\n          },\n         'root': {\n           'handlers': ['console'], \n           'level': 'DEBUG'\n         }\n       }, \n       'version': '1', \n       'formatters': {\n         'simple': {\n           'datefmt': &quot;'%Y-%m-%d %H:%M:%S'&quot;, \n           'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n         }\n       }\n     }, \n     'treatment': {'second': 5, 'last': 4, 'first': 4},   \n     'treatment_plan': [[4, 5, 4], [4, 5, 4], [5, 5, 5]]\n}\n</code></pre>\n<p>All functions delivered the same result, but the time differences are dramatic! The function <code>gen_dict_extract(k,o)</code> is my function adapted from the functions here, actually it is pretty much like the <code>find</code> function from Alfe, with the main difference, that i am checking if the given object has iteritems function, in case strings are passed during recursion:</p>\n<pre><code># python 2\ndef gen_dict_extract(key, var):\n    if hasattr(var,'iteritems'): # hasattr(var,'items') for python 3\n        for k, v in var.iteritems(): # var.items() for python 3\n            if k == key:\n                yield v\n            if isinstance(v, dict):\n                for result in gen_dict_extract(key, v):\n                    yield result\n            elif isinstance(v, list):\n                for d in v:\n                    for result in gen_dict_extract(key, d):\n                        yield result\n</code></pre>\n<p>So this variant is the fastest and safest of the functions here. And <code>find_all_items</code> is incredibly slow and far off the second slowest <code>get_recursivley</code> while the rest, except <code>dict_extract</code>, is close to each other. The functions <code>fun</code> and <code>keyHole</code> only work if you are looking for strings.</p>\n<p>Interesting learning aspect here :)</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1751690,
                                "reputation": 568,
                                "user_id": 1600630,
                                "user_type": "registered",
                                "display_name": "Cometsong"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1550241861,
                            "post_id": 50444005,
                            "comment_id": 96208759,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/50444005#comment96208759_50444005",
                            "body": "Excellent mod to @hexerei-software&#39;s answer: succinct and allows list-of-dicts!  I&#39;m using this along with @bruno-bronosky&#39;s suggestions in his comments to use <code>for key in keys</code>.  Also I added to the 2nd <code>isinstance</code> to <code>(list, tuple)</code> for even <i>more</i> variety. ;)"
                        },
                        {
                            "owner": {
                                "account_id": 4626602,
                                "reputation": 3779,
                                "user_id": 3750257,
                                "user_type": "registered",
                                "display_name": "pppery"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1667666557,
                            "post_id": 50444005,
                            "comment_id": 131222900,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/50444005#comment131222900_50444005",
                            "body": "From a suggested edit: &quot;Note: this appears to be about 50 times slower than the other gen_dict_extract&quot;"
                        }
                    ],
                    "owner": {
                        "account_id": 981016,
                        "reputation": 531,
                        "user_id": 1000734,
                        "user_type": "registered",
                        "display_name": "Chris"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 9,
                    "last_activity_date": 1526888043,
                    "creation_date": 1526888043,
                    "answer_id": 50444005,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/50444005#50444005",
                    "body": "<p>I just wanted to iterate on @hexerei-software's excellent answer using <code>yield from</code> and accepting top-level lists. </p>\n\n<pre><code>def gen_dict_extract(var, key):\n    if isinstance(var, dict):\n        for k, v in var.items():\n            if k == key:\n                yield v\n            if isinstance(v, (dict, list)):\n                yield from gen_dict_extract(v, key)\n    elif isinstance(var, list):\n        for d in var:\n            yield from gen_dict_extract(d, key)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 17781078,
                        "reputation": 1,
                        "user_id": 12912270,
                        "user_type": "registered",
                        "display_name": "Jo&#227;o Henriques"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1581939471,
                    "creation_date": 1581939471,
                    "answer_id": 60261620,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/60261620#60261620",
                    "body": "<p>Following up on @hexerei software's answer and\n @bruno-bronosky's comment, if you want to iterate over a list/set of keys:</p>\n\n<pre><code>def gen_dict_extract(var, keys):\n   for key in keys:\n      if hasattr(var, 'items'):\n         for k, v in var.items():\n            if k == key:\n               yield v\n            if isinstance(v, dict):\n               for result in gen_dict_extract([key], v):\n                  yield result\n            elif isinstance(v, list):\n               for d in v:\n                  for result in gen_dict_extract([key], d):\n                     yield result    \n</code></pre>\n\n<p>Note that I'm passing a list with a single element ([key]}, instead of the string key.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 19844883,
                                "reputation": 89,
                                "user_id": 16568273,
                                "user_type": "registered",
                                "display_name": "MiKK"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1641249863,
                            "post_id": 65495118,
                            "comment_id": 124753013,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/65495118#comment124753013_65495118",
                            "body": "Works the same as @arainchi answer above, plus there&#39;s a bunch of other functions in <a href=\"https://pypi.org/project/nested-lookup/\" rel=\"nofollow noreferrer\">nested-lookup</a> library. For the above example use <code>from nested_lookup import nested_lookup</code>"
                        }
                    ],
                    "owner": {
                        "account_id": 6155068,
                        "reputation": 730,
                        "user_id": 4798335,
                        "user_type": "registered",
                        "display_name": "VengaVenga"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 17,
                    "last_activity_date": 1609258092,
                    "creation_date": 1609258092,
                    "answer_id": 65495118,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/65495118#65495118",
                    "body": "<p><code>pip install nested-lookup</code>\ndoes exactly what you are looking for:</p>\n<pre><code>document = [ { 'taco' : 42 } , { 'salsa' : [ { 'burrito' : { 'taco' : 69 } } ] } ]\n\n&gt;&gt;&gt; print(nested_lookup('taco', document))\n[42, 69]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 19844883,
                                "reputation": 89,
                                "user_id": 16568273,
                                "user_type": "registered",
                                "display_name": "MiKK"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1641249385,
                            "post_id": 67666722,
                            "comment_id": 124752887,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/67666722#comment124752887_67666722",
                            "body": "Fresh approach but does not work with nested &lt;class &#39;dict&#39;&gt; such as mylist = {     &#39;sad&#39;: [[1,1.2],[2,1.3],[3,1.4]],     &#39;puppy&#39;: [[2,2.2],[3,2.3]],     &#39;happy&#39;:[[3,4.5],[5,6.7,{&#39;happy&#39;:[1,2,3]}]]}"
                        }
                    ],
                    "owner": {
                        "account_id": 7420194,
                        "reputation": 735,
                        "user_id": 5644892,
                        "user_type": "registered",
                        "display_name": "Justin"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1623555050,
                    "last_edit_date": 1623555050,
                    "creation_date": 1621830863,
                    "answer_id": 67666722,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/67666722#67666722",
                    "body": "<p>I was not able to get the solutions posted here to work out-of-the-box so I wanted to write something that is a little more flexible.</p>\n<p>The recursive function below that should allow you to collect all values that meet some regex pattern for a given key in an arbitrarily deeply set of nested dictionaries and lists.</p>\n<pre><code>import re\n\ndef search(dictionary, search_pattern, output=None):\n    &quot;&quot;&quot;\n    Search nested dictionaries and lists using a regex search\n    pattern to match a key and return the corresponding value(s).\n    &quot;&quot;&quot;\n    if output is None:\n        output = []\n\n    pattern = re.compile(search_pattern)\n    \n    for k, v in dictionary.items():\n        pattern_found = pattern.search(k)\n        if not pattern_found:\n            if isinstance(v, list):\n                for item in v:\n                    if isinstance(item, dict):\n                        search(item, search_pattern, output)\n            if isinstance(v, dict):\n                search(v, search_pattern, output)\n        else:\n            if pattern_found:\n                output.append(v)\n\n    return output\n</code></pre>\n<p>If you want to search for a specific term, you can always make your search pattern something like <code>r'\\bsome_term\\b'</code>.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 11510608,
                        "reputation": 10379,
                        "user_id": 9926721,
                        "user_type": "registered",
                        "display_name": "funnydman"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1657535946,
                    "creation_date": 1657535946,
                    "answer_id": 72937256,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/72937256#72937256",
                    "body": "<p>Since <a href=\"https://stackoverflow.com/questions/3323001/what-is-the-maximum-recursion-depth-in-python-and-how-to-increase-it\">there's a maximum recursion depth in Python</a> I would consider  implementing an iterative approach for arbitrary size:</p>\n<pre><code>def get_ids(data: Dict, key: str) -&gt; List:\n    stack = [data]\n    result = []\n    while stack:\n        elem = stack.pop()\n        if isinstance(elem, dict):\n            for k, v in elem.items():\n                if k == key:\n                    result.append(v)\n                if isinstance(elem, (list, dict)):\n                    stack.append(v)\n        elif isinstance(elem, list):\n            for obj in elem:\n                stack.append(obj)\n    return result\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3033198,
                                "reputation": 690,
                                "user_id": 2571805,
                                "user_type": "registered",
                                "display_name": "Ricardo"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1699875147,
                            "post_id": 76907025,
                            "comment_id": 136581609,
                            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/76907025#comment136581609_76907025",
                            "body": "THANK YOU SO MUCH! This <code>glom</code> is a life saver. I confess to reinventing a few wheels every now and then, just for fun, but this is great. And its author, Mahmoud, has a lot of other really cool stuff as well."
                        }
                    ],
                    "owner": {
                        "account_id": 3133056,
                        "reputation": 63405,
                        "user_id": 2650249,
                        "user_type": "registered",
                        "accept_rate": 95,
                        "display_name": "hoefling"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 4,
                    "last_activity_date": 1692111975,
                    "creation_date": 1692111975,
                    "answer_id": 76907025,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/76907025#76907025",
                    "body": "<p><a href=\"https://glom.readthedocs.io/\" rel=\"nofollow noreferrer\"><code>glom</code></a> is a great library for searching and restructuring that can also do nested lookups using globs. Example:</p>\n<pre><code>In [1]: import glom\n\nIn [2]: data = { &quot;id&quot; : &quot;abcde&quot;, &quot;key1&quot; : &quot;blah&quot;, ... }  # OP example\n\nIn [3]: glom.glom(data, '**.id')\nOut[3]: ['abcde', 'qwerty', 'xyz', 'fghi', 'asdf', 'yuiop']\n</code></pre>\n<p>The nesting levels are separated by dots (think of them as slashes in Unix globs), single star is a placeholder for one level, double star is a placeholder for multiple levels. In the above example, <code>**.id</code> means &quot;<code>id</code> key on any level&quot;. More examples:</p>\n<pre><code>In [4]: glom.glom(d, ('*.*.id', glom.Flatten()))\nOut[4]: ['qwerty']\n</code></pre>\n<p>This will go through all keys on third level only and extract the values for the <code>id</code>, whereas empty results are discarded (the nested results list is flattened).</p>\n<p>Another example that collects <code>id</code> values specifically in the <code>anothernestednestedlist</code> list only:</p>\n<pre><code>In [5]: glom.glom(d, ('nestedlist', [('anothernestednestedlist', ['id'])]))\nOut[5]: [['asdf', 'yuiop']]\n</code></pre>\n<p>However, the library can do a lot more than just that. Read the <a href=\"https://glom.readthedocs.io/\" rel=\"nofollow noreferrer\"><code>glom</code> docs</a> for more features.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 3033198,
                        "reputation": 690,
                        "user_id": 2571805,
                        "user_type": "registered",
                        "display_name": "Ricardo"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1699882394,
                    "creation_date": 1699882394,
                    "answer_id": 77474274,
                    "question_id": 9807634,
                    "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists/77474274#77474274",
                    "body": "<h1>Intro</h1>\n<p>With the benefit of a decade of Python evolution (working on 3.11) and after commenting on the most voted solution, I developed a variant that, after the fact, I realised walked the very steps of many of the proposed solutions. Still, my goal was to add context to the response in both depth and breadth.</p>\n<h1>XPath solution</h1>\n<p>My solution delivers both a sort of XPath to the found node, but also surrounding context on demand. To this end, it accepts an iterable of keys to be output together with the target key. Obviously, it delivers <code>key: value</code> dictionary elements, for the benefit of readability:</p>\n<pre class=\"lang-py prettyprint-override\"><code>def extract(var, key, context_keys=(), xpath=''):\n    if isinstance(var, dict):\n        if key in var:\n            yield {f'{xpath}.{key}': var[key]} | {f'{xpath}.{key}': value for key, value in var.items() if key in context_keys}\n        for subkey, value in var.items():\n            yield from extract(value, key, context_keys, f'{xpath}.{subkey}')\n    elif isinstance(var, list):\n        for i, elem in enumerate(var):\n            yield from extract(elem, key, context_keys, f'{xpath}[{i}]')\n</code></pre>\n<p>With this, looking for <code>'id'</code> would retrieve:</p>\n<pre class=\"lang-py prettyprint-override\"><code>[\n  {\n    &quot;.id&quot;: &quot;abcde&quot;\n  },\n  {\n    &quot;.nestedlist[0].id&quot;: &quot;qwerty&quot;\n  },\n  {\n    &quot;.nestedlist[0].nestednestedlist[0].id&quot;: &quot;xyz&quot;\n  },\n  {\n    &quot;.nestedlist[0].nestednestedlist[1].id&quot;: &quot;fghi&quot;\n  },\n  {\n    &quot;.nestedlist[0].anothernestednestedlist[0].id&quot;: &quot;asdf&quot;\n  },\n  {\n    &quot;.nestedlist[0].anothernestednestedlist[1].id&quot;: &quot;yuiop&quot;\n  }\n]\n</code></pre>\n<p>Obviously, since all keys represent different XPaths, we could unify the entries into a single dictionary, with either <code>reduce</code> or comprehension, getting this:</p>\n<pre class=\"lang-py prettyprint-override\"><code>{\n  &quot;.id&quot;: &quot;abcde&quot;,\n  &quot;.nestedlist[0].id&quot;: &quot;qwerty&quot;,\n  &quot;.nestedlist[0].nestednestedlist[0].id&quot;: &quot;xyz&quot;,\n  &quot;.nestedlist[0].nestednestedlist[1].id&quot;: &quot;fghi&quot;,\n  &quot;.nestedlist[0].anothernestednestedlist[0].id&quot;: &quot;asdf&quot;,\n  &quot;.nestedlist[0].anothernestednestedlist[1].id&quot;: &quot;yuiop&quot;\n}\n</code></pre>\n<p>The context could be used for something like this:</p>\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; pp(reduce(lambda acc, elem: acc | elem, extract(d, 'id', 'keyA')))\n{\n  &quot;.id&quot;: &quot;abcde&quot;,\n  &quot;.nestedlist[0].id&quot;: &quot;qwerty&quot;,\n  &quot;.nestedlist[0].nestednestedlist[0].id&quot;: &quot;xyz&quot;,\n  &quot;.nestedlist[0].nestednestedlist[0].keyA&quot;: &quot;blah blah blah&quot;, # &lt;-- HERE\n  &quot;.nestedlist[0].nestednestedlist[1].id&quot;: &quot;fghi&quot;,\n  &quot;.nestedlist[0].anothernestednestedlist[0].id&quot;: &quot;asdf&quot;,\n  &quot;.nestedlist[0].anothernestednestedlist[1].id&quot;: &quot;yuiop&quot;\n}\n</code></pre>\n<p>I'm working on a solution to return an object that has the same structure of the original, but only the wanted keys. If I get it to work, I'll add it here.</p>\n"
                }
            ],
            "owner": {
                "account_id": 416994,
                "reputation": 3867,
                "user_id": 792734,
                "user_type": "registered",
                "accept_rate": 91,
                "display_name": "Matt Swain"
            },
            "comment_count": 2,
            "is_answered": true,
            "accepted_answer_id": 29652561,
            "answer_count": 14,
            "score": 121,
            "last_activity_date": 1699882394,
            "creation_date": 1332343568,
            "last_edit_date": 1657536162,
            "question_id": 9807634,
            "link": "https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists",
            "title": "Find all occurrences of a key in nested dictionaries and lists",
            "body": "<p>I have a dictionary like this:</p>\n<pre><code>{\n    &quot;id&quot;: &quot;abcde&quot;,\n    &quot;key1&quot;: &quot;blah&quot;,\n    &quot;key2&quot;: &quot;blah blah&quot;,\n    &quot;nestedlist&quot;: [\n        {\n            &quot;id&quot;: &quot;qwerty&quot;,\n            &quot;nestednestedlist&quot;: [\n                {\n                    &quot;id&quot;: &quot;xyz&quot;,\n                    &quot;keyA&quot;: &quot;blah blah blah&quot;\n                },\n                {\n                    &quot;id&quot;: &quot;fghi&quot;,\n                    &quot;keyZ&quot;: &quot;blah blah blah&quot;\n                }\n            ],\n            &quot;anothernestednestedlist&quot;: [\n                {\n                    &quot;id&quot;: &quot;asdf&quot;,\n                    &quot;keyQ&quot;: &quot;blah blah&quot;\n                },\n                {\n                    &quot;id&quot;: &quot;yuiop&quot;,\n                    &quot;keyW&quot;: &quot;blah&quot;\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n<p>Basically a dictionary with nested lists, dictionaries, and strings, of arbitrary depth.</p>\n<p>What is the best way of traversing this to extract the values of every &quot;id&quot; key? I want to achieve the equivalent of an XPath query like &quot;//id&quot;. The value of &quot;id&quot; is always a string.</p>\n<p>So from my example, the output I need is basically:</p>\n<pre><code>[&quot;abcde&quot;, &quot;qwerty&quot;, &quot;xyz&quot;, &quot;fghi&quot;, &quot;asdf&quot;, &quot;yuiop&quot;]\n</code></pre>\n<p>Order is not important.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9419
}