{
    "items": [
        {
            "tags": [
                "python",
                "numpy",
                "interpolation"
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 151783,
                                "reputation": 28062,
                                "user_id": 365872,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "ffriend"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1376953410,
                            "post_id": 12729229,
                            "comment_id": 26894087,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment26894087_12729229",
                            "body": "Hi Alex, I was looking just for the same thing, and your implementation looks pretty good. I grasped basic usage, but can you please provide some advanced examples (with several coordinates) to make this answer even better?"
                        },
                        {
                            "owner": {
                                "account_id": 418473,
                                "reputation": 6362,
                                "user_id": 795053,
                                "user_type": "registered",
                                "accept_rate": 51,
                                "display_name": "Alex Flint"
                            },
                            "reply_to_user": {
                                "account_id": 151783,
                                "reputation": 28062,
                                "user_id": 365872,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "ffriend"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1377052374,
                            "post_id": 12729229,
                            "comment_id": 26934762,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment26934762_12729229",
                            "body": "@ffriend: $im$ is a 2D numpy array, and $x$ and $y$ are both ordinary python lists of doubles having the same length."
                        },
                        {
                            "owner": {
                                "account_id": 151783,
                                "reputation": 28062,
                                "user_id": 365872,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "ffriend"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1377114419,
                            "post_id": 12729229,
                            "comment_id": 26966669,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment26966669_12729229",
                            "body": "Thanks, Alex. I also found that the code works pretty well with 2D NumPy arrays. However, one should care about indexes and image boundaries. If, for example, <code>im.shape == (10, 10)</code>, and <code>x == 9</code>, then <code>x0 == 9</code> and <code>x1 == x0 + 1 == 10</code>, which will produce <code>IndexError</code>. Simplest way to fix it is to extend image to have one extra column and one extra row (say, with values <code>im[:, -1]</code> and <code>im[-1, :]</code>). Though in most practical cases (like affine transformation that I came with) more advanced techniques should be used. Anyway, thanks for this nice example of powerful vectorization."
                        },
                        {
                            "owner": {
                                "account_id": 418473,
                                "reputation": 6362,
                                "user_id": 795053,
                                "user_type": "registered",
                                "accept_rate": 51,
                                "display_name": "Alex Flint"
                            },
                            "reply_to_user": {
                                "account_id": 151783,
                                "reputation": 28062,
                                "user_id": 365872,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "ffriend"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1377203858,
                            "post_id": 12729229,
                            "comment_id": 27008740,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment27008740_12729229",
                            "body": "@ffriend: Thanks, have updated the code to check for out of range values."
                        },
                        {
                            "owner": {
                                "account_id": 1377321,
                                "reputation": 567,
                                "user_id": 1311069,
                                "user_type": "registered",
                                "display_name": "dooderson"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1430840517,
                            "post_id": 12729229,
                            "comment_id": 48229719,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment48229719_12729229",
                            "body": "Can this be used for images. For instance, if I wanted to stretch a 100x100 image to a 400x200 sized image? Is so, what would that code look like?"
                        },
                        {
                            "owner": {
                                "account_id": 199659,
                                "reputation": 4157,
                                "user_id": 445114,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "Ran"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1443450770,
                            "post_id": 12729229,
                            "comment_id": 53486695,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment53486695_12729229",
                            "body": "With this code, the edges can often be zero, because x (or y) will be equal to x0 and x1 after clipping. Any suggestions on how to deal with that? Thanks."
                        },
                        {
                            "owner": {
                                "account_id": 6188107,
                                "reputation": 4842,
                                "user_id": 4821622,
                                "user_type": "registered",
                                "display_name": "Pete Florence"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1517240588,
                            "post_id": 12729229,
                            "comment_id": 84003752,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment84003752_12729229",
                            "body": "Hey @AlexFlint, thanks for posting this and I have a small suggestion.  This small diff in just the last line will make this compatible with 2D grids of D-dimensional values, i.e. [WxHxD], as in a D=3 rgb image or higher:  <code>return (Ia.T*wa).T + (Ib.T*wb).T + (Ic.T*wc).T + (Id.T*wd).T</code>  Let me know if you have any questions?  Thanks!"
                        },
                        {
                            "owner": {
                                "account_id": 5636800,
                                "reputation": 1565,
                                "user_id": 4462051,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "ohad edelstain"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1577137155,
                            "post_id": 12729229,
                            "comment_id": 105104062,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment105104062_12729229",
                            "body": "@AlexFlint I am looking at the wiki definition: <a href=\"https://en.wikipedia.org/wiki/Bilinear_interpolation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bilinear_interpolation</a> and I am missing in your solution the devide by (y1-y0)*(x1-x0) what am I missing? is there a reason not to divide?"
                        },
                        {
                            "owner": {
                                "account_id": 11276669,
                                "reputation": 987,
                                "user_id": 8270535,
                                "user_type": "registered",
                                "display_name": "sebasth"
                            },
                            "reply_to_user": {
                                "account_id": 5636800,
                                "reputation": 1565,
                                "user_id": 4462051,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "ohad edelstain"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1578055783,
                            "post_id": 12729229,
                            "comment_id": 105324009,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment105324009_12729229",
                            "body": "@ohadedelstain note that in the answer <code>y1 = y0 + 1</code> and <code>x1 = x0 + 1</code>, therefore <code>(y1-y0)*(x1-x0)</code> is always 1."
                        },
                        {
                            "owner": {
                                "account_id": 2446619,
                                "reputation": 2571,
                                "user_id": 2133814,
                                "user_type": "registered",
                                "accept_rate": 54,
                                "display_name": "user2133814"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1621623304,
                            "post_id": 12729229,
                            "comment_id": 119561420,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment119561420_12729229",
                            "body": "this function returns 0 for <code>bilinear_interpolate(np.ones((2, 2)), 1.0, 1.0)</code> which is incorrect based on my understanding of the intention"
                        },
                        {
                            "owner": {
                                "account_id": 19441826,
                                "reputation": 789,
                                "user_id": 14220087,
                                "user_type": "registered",
                                "display_name": "Sam-gege "
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1635327932,
                            "post_id": 12729229,
                            "comment_id": 123265804,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment123265804_12729229",
                            "body": "It&#39;s because 1. and 1. are boundary. you may add or subtract a small number <code>eps=1e-5</code> when x or y is boundary: <code>if x==0: x+=eps</code> and <code>if x==im.shape[1]-1: x-=eps</code>, same for y. Then it will work as expected."
                        },
                        {
                            "owner": {
                                "account_id": 8233326,
                                "reputation": 92,
                                "user_id": 6193383,
                                "user_type": "registered",
                                "display_name": "pups"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1643046054,
                            "post_id": 12729229,
                            "comment_id": 125230607,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment125230607_12729229",
                            "body": "There is a bug here. wa..wd need to be computed before applying clipping to {x0, x1, y0, y1} otherwise the boundary cases are incorrect."
                        },
                        {
                            "owner": {
                                "account_id": 7805316,
                                "reputation": 263,
                                "user_id": 5903397,
                                "user_type": "registered",
                                "accept_rate": 0,
                                "display_name": "phil"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1645549903,
                            "post_id": 12729229,
                            "comment_id": 125899049,
                            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#comment125899049_12729229",
                            "body": "Can we use x0=floor(x) and x1 = x0+1 , because we are assuming that pixel size will always be 1X1? Is this assumption always met in the image context?"
                        }
                    ],
                    "owner": {
                        "account_id": 418473,
                        "reputation": 6362,
                        "user_id": 795053,
                        "user_type": "registered",
                        "accept_rate": 51,
                        "display_name": "Alex Flint"
                    },
                    "comment_count": 13,
                    "is_accepted": true,
                    "score": 40,
                    "last_activity_date": 1377203827,
                    "last_edit_date": 1377203827,
                    "creation_date": 1349359935,
                    "answer_id": 12729229,
                    "question_id": 12729228,
                    "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python/12729229#12729229",
                    "body": "<p>I found many questions on this topic and many answers, though none were efficient for the common case that the data consists of samples on a grid (i.e. a rectangular image) and represented as a numpy array. This function can take lists as both x and y coordinates and will perform the lookups and summations without need for loops.</p>\n\n<pre><code>def bilinear_interpolate(im, x, y):\n    x = np.asarray(x)\n    y = np.asarray(y)\n\n    x0 = np.floor(x).astype(int)\n    x1 = x0 + 1\n    y0 = np.floor(y).astype(int)\n    y1 = y0 + 1\n\n    x0 = np.clip(x0, 0, im.shape[1]-1);\n    x1 = np.clip(x1, 0, im.shape[1]-1);\n    y0 = np.clip(y0, 0, im.shape[0]-1);\n    y1 = np.clip(y1, 0, im.shape[0]-1);\n\n    Ia = im[ y0, x0 ]\n    Ib = im[ y1, x0 ]\n    Ic = im[ y0, x1 ]\n    Id = im[ y1, x1 ]\n\n    wa = (x1-x) * (y1-y)\n    wb = (x1-x) * (y-y0)\n    wc = (x-x0) * (y1-y)\n    wd = (x-x0) * (y-y0)\n\n    return wa*Ia + wb*Ib + wc*Ic + wd*Id\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 418473,
                "reputation": 6362,
                "user_id": 795053,
                "user_type": "registered",
                "accept_rate": 51,
                "display_name": "Alex Flint"
            },
            "comment_count": 0,
            "is_answered": true,
            "accepted_answer_id": 12729229,
            "answer_count": 1,
            "score": 14,
            "last_activity_date": 1384691336,
            "creation_date": 1349359935,
            "last_edit_date": 1349366461,
            "question_id": 12729228,
            "link": "https://stackoverflow.com/questions/12729228/simple-efficient-bilinear-interpolation-of-images-in-numpy-and-python",
            "title": "Simple, efficient bilinear interpolation of images in numpy and python",
            "body": "<p>How do I implement bilinear interpolation for image data represented as a numpy array in python?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 8164
}