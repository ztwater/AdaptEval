{
    "items": [
        {
            "tags": [
                "c++",
                "arrays",
                "numpy",
                "linear-algebra",
                "triangular"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 5148475,
                        "reputation": 2407,
                        "user_id": 4123703,
                        "user_type": "registered",
                        "display_name": "Louis Go"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1632290035,
                    "post_id": 69278755,
                    "comment_id": 122448360,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix#comment122448360_69278755",
                    "body": "You may come up with an algorithm from k to matrix index. What have you tried except search?"
                },
                {
                    "owner": {
                        "account_id": 20766410,
                        "reputation": 908,
                        "user_id": 15752941,
                        "user_type": "registered",
                        "display_name": "loopy walt"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1632294069,
                    "post_id": 69278755,
                    "comment_id": 122449695,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix#comment122449695_69278755",
                    "body": "You can easily get this from the row wise method you link: The second coordinate is correct alread and the first you can get by subtracting from the second: (y,x) -&gt; (x-1-y,x)."
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3338470,
                                "reputation": 74275,
                                "user_id": 2805305,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "bolov"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1632314402,
                            "post_id": 69280938,
                            "comment_id": 122457891,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69280938#comment122457891_69280938",
                            "body": "I appreciate the effort, but there are a few things I want to draw your attention toward. First the C++ form: usage of C strings should be discouraged; case in point your parameter <code>a</code> in <code>Func</code> is of type <code>int (*)[4]</code>; this doesn&#39;t affect your particular solution because you hard-coded the matrix size everywhere. Also the usage of the global variable is problematic."
                        },
                        {
                            "owner": {
                                "account_id": 3338470,
                                "reputation": 74275,
                                "user_id": 2805305,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "bolov"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1632314436,
                            "post_id": 69280938,
                            "comment_id": 122457908,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69280938#comment122457908_69280938",
                            "body": "Secondly regarding this solution: it isn&#39;t generic on <code>N</code> (works only for N 4), it has <code>O(N^2)</code> space complexity and <code>O(n^2)</code> time complexity and doesn&#39;t actually provide the desired solution - a mapping function from index to coordinates; to have that you would need another <code>O(n^2)</code> function to search in your matrix"
                        },
                        {
                            "owner": {
                                "account_id": 20881571,
                                "reputation": 225,
                                "user_id": 15339181,
                                "user_type": "registered",
                                "display_name": "Emin Niftiyev"
                            },
                            "reply_to_user": {
                                "account_id": 3338470,
                                "reputation": 74275,
                                "user_id": 2805305,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "bolov"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1632314805,
                            "post_id": 69280938,
                            "comment_id": 122458082,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69280938#comment122458082_69280938",
                            "body": "@bolov I agree with everything you said. I&#39;m starting to think about how to fix this"
                        },
                        {
                            "owner": {
                                "account_id": 14785790,
                                "reputation": 63,
                                "user_id": 10678012,
                                "user_type": "registered",
                                "display_name": "Mat"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1632358394,
                            "post_id": 69280938,
                            "comment_id": 122472830,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69280938#comment122472830_69280938",
                            "body": "@EminNiftiyev Thank you for taking the time to answer! I was indeed lookig for a generic function on N - it&#39;s not clear from my question, apologies!"
                        }
                    ],
                    "owner": {
                        "account_id": 20881571,
                        "reputation": 225,
                        "user_id": 15339181,
                        "user_type": "registered",
                        "display_name": "Emin Niftiyev"
                    },
                    "comment_count": 4,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1632300412,
                    "creation_date": 1632300412,
                    "answer_id": 69280938,
                    "question_id": 69278755,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69280938#69280938",
                    "body": "<p>I created a custom method for the array and value you gave.</p>\n<pre><code>int a[4][4] ={{-1, 0, 3, 5}, {-1, -1, 1, 4}, {-1, -1, -1, 2}, {-1, -1, -1, -1}};\n</code></pre>\n<p>The code is exactly like this. You give the array And whatever you give to the second value in the Func method, the indexes of the value in the upper diagonal will reach you.</p>\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint b[2] ={-1,-1};\n\nint Func(int a[4][4],int n)\n{\n    \n    for(int i =0;i&lt;4;i++)\n    {\n        for(int j=0;j&lt;4;j++)\n        {\n            if(a[i][j]==n)\n            {\n                if(i&lt;j)\n                {\n                    b[0]=i;\n                    b[1]=j;\n                    return 0;\n                }\n            }\n        }\n    }\n}\nint main()\n{\n    int a[4][4] ={{-1, 0, 3, 5}, {-1, -1, 1, 4}, {-1, -1, -1, 2}, {-1, -1, -1, -1}};\n    Func(a,5);\n    for(int i=0;i&lt;2;i++)\n    {\n        cout&lt;&lt;b[i]&lt;&lt;&quot; &quot;;\n    }\n    return 0;\n}\n</code></pre>\n<p>thank you <code>USEFUL</code> for feedback if it worked for you</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 14785790,
                                "reputation": 63,
                                "user_id": 10678012,
                                "user_type": "registered",
                                "display_name": "Mat"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1632358495,
                            "post_id": 69284016,
                            "comment_id": 122472854,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69284016#comment122472854_69284016",
                            "body": "Thank you for your answer! I now have the closed form answer."
                        }
                    ],
                    "owner": {
                        "account_id": 3338470,
                        "reputation": 74275,
                        "user_id": 2805305,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "display_name": "bolov"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1632313695,
                    "last_edit_date": 1632313695,
                    "creation_date": 1632312806,
                    "answer_id": 69284016,
                    "question_id": 69278755,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69284016#69284016",
                    "body": "<p>Maybe someone can come up with a math formula that doesn't require a loop, but until then I've come up with a <code>O(N)</code> solution:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;utility&gt;\n\nconstexpr std::pair&lt;int, int&gt; f(int n, int idx)\n{\n    int group_size = n - 1;\n    int rest = idx + 1;\n\n    while (rest &gt; group_size)\n    {\n        rest = rest - group_size;\n        --group_size;\n    }\n    return {(rest - 1) % group_size,\n            n - group_size +  (rest - 1) % group_size};\n}\n</code></pre>\n<pre class=\"lang-cpp prettyprint-override\"><code>/* 3x3\nX 0 2\nX X 1\nX X X\n*/\nstatic_assert(f(3, 0) == std::pair{0, 1});\nstatic_assert(f(3, 1) == std::pair{1, 2});\nstatic_assert(f(3, 2) == std::pair{0, 2});\n\n// 4x4\nstatic_assert(f(4, 0) == std::pair{0, 1});\nstatic_assert(f(4, 1) == std::pair{1, 2});\nstatic_assert(f(4, 2) == std::pair{2, 3});\nstatic_assert(f(4, 3) == std::pair{0, 2});\nstatic_assert(f(4, 4) == std::pair{1, 3});\nstatic_assert(f(4, 5) == std::pair{0, 3});\n\n/* 5x5\nX 0 4 7 9\nX X 1 5 8\nX X X 2 6\nX X X X 3\nX X X X X\n*/\nstatic_assert(f(5, 0) == std::pair{0, 1});\nstatic_assert(f(5, 1) == std::pair{1, 2});\nstatic_assert(f(5, 2) == std::pair{2, 3});\nstatic_assert(f(5, 3) == std::pair{3, 4});\nstatic_assert(f(5, 4) == std::pair{0, 2});\nstatic_assert(f(5, 5) == std::pair{1, 3});\nstatic_assert(f(5, 6) == std::pair{2, 4});\nstatic_assert(f(5, 7) == std::pair{0, 3});\nstatic_assert(f(5, 8) == std::pair{1, 4});\nstatic_assert(f(5, 9) == std::pair{0, 4});\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 14785790,
                        "reputation": 63,
                        "user_id": 10678012,
                        "user_type": "registered",
                        "display_name": "Mat"
                    },
                    "comment_count": 0,
                    "is_accepted": true,
                    "score": 2,
                    "last_activity_date": 1632358300,
                    "creation_date": 1632358300,
                    "answer_id": 69292749,
                    "question_id": 69278755,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69292749#69292749",
                    "body": "<p>Thanks to @loopy-walt's observation, we have an answer!\nUsing the result from <a href=\"https://stackoverflow.com/questions/27086195/linear-index-upper-triangular-matrix\">Linear index upper triangular matrix</a>, a transformation of the result</p>\n<pre><code>(i, j) |-&gt; (j-i-1, j)\n</code></pre>\n<p>Gives the expected outcome.</p>\n<p>Here is a C++ implementation.</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;tuple&gt;\n#include&lt;cmath&gt;\n\n// Linear indexing of the upper triangle, row by row\nstd::tuple&lt;size_t, size_t&gt; k2ij(size_t n, size_t k){\n  size_t i = n - 2 - (size_t)std::floor(std::sqrt(4*n*(n-1) - (8*k) -7)/2.0 - 0.5);\n  size_t j = k + i + 1 - n*(n-1)/2 + (n-i)*((n-i)-1)/2;\n  return {i,j};\n}\n\n// Linear indexing of the upper triangle, diagonal by diagonal\nstd::tuple&lt;size_t, size_t&gt; d2ij(size_t n, size_t d){\n  const auto [i, j] = k2ij(n, d);\n  return {j-i-1, j}; // Conversion from row by row to diag by diag\n}\n\n#include&lt;iostream&gt;\n#include&lt;set&gt;\nint main(int argc, char** argv) {\n\n  size_t n = 4;\n  size_t top = n*(n-1)/2;\n\n  for(size_t d=0; d&lt;top; ++d){\n    const auto [i,j] = d2ij(n, d);\n    std::cout &lt;&lt; &quot;d2ij(&quot; &lt;&lt; n &lt;&lt; &quot;, &quot; &lt;&lt; d &lt;&lt; &quot;) = (&quot; &lt;&lt; i &lt;&lt; &quot;, &quot; &lt;&lt; j &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;\n  }\n\n  return 0;\n}\n</code></pre>\n<p>Producing</p>\n<pre><code>d2ij(4, 0) = (0, 1)\nd2ij(4, 1) = (1, 2)\nd2ij(4, 2) = (2, 3)\nd2ij(4, 3) = (0, 2)\nd2ij(4, 4) = (1, 3)\nd2ij(4, 5) = (0, 3)\n</code></pre>\n<p>Note: if someone wishes the form <code>f(d)</code> instead, a lambda can be used to capture the dimension 'n'</p>\n<pre><code>auto f = [n](size_t d){return d2ij(n, d);};\nconst auto [i,j] = f(5);\n</code></pre>\n<p>Thanks to everybody that took the time to read and help!</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 14785790,
                                "reputation": 63,
                                "user_id": 10678012,
                                "user_type": "registered",
                                "display_name": "Mat"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1632531157,
                            "post_id": 69310120,
                            "comment_id": 122525956,
                            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69310120#comment122525956_69310120",
                            "body": "Thank you for taking the time to answer. Unfortunately, I was looking for a closed form (i.e. no recursion and no loop) of a different problem: a diagonal by diagonal run instead of a row by row one."
                        }
                    ],
                    "owner": {
                        "account_id": 160373,
                        "reputation": 28942,
                        "user_id": 380384,
                        "user_type": "registered",
                        "accept_rate": 92,
                        "display_name": "John Alexiou"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1632465374,
                    "last_edit_date": 1632465374,
                    "creation_date": 1632462520,
                    "answer_id": 69310120,
                    "question_id": 69278755,
                    "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix/69310120#69310120",
                    "body": "<p>So you want the inverse of the following function</p>\n<ul>\n<li><p>Zero-based indexing form of element <code>[i,j]</code> for a <code>n\u00d7n</code> upper triangular matrix including the diagonal</p>\n<pre><code>index = i*n-i*(i+1)/2+j\n\ni=0..4, j=0..4, index=\n|  0 |  1 |  2 |  3 |  4 |\n|  X |  5 |  6 |  7 |  8 |\n|  X |  X |  9 | 10 | 11 |\n|  X |  X |  X | 12 | 13 |\n|  X |  X |  X |  X | 14 |\n</code></pre>\n</li>\n</ul>\n<p>The easiest algorithm I can think of is to loop for all rows <code>i</code> and see if there is a match for the column <code>j</code> such that:</p>\n<ul>\n<li><code>i &lt;= j</code></li>\n<li><code>j&gt;=0</code></li>\n<li><code>j&lt;n</code></li>\n</ul>\n<p>Here is a sample code given <code>index</code> and <code>n</code></p>\n<pre><code>for(i=0; i&lt;n; i++)\n{\n    j = index - i*n + i*(i+1)/2\n    if( j&gt;=0 &amp;&amp; j&lt;n &amp;&amp; j&gt;= i)\n    {\n       break;\n    }\n}\n</code></pre>\n<p>And example with <code>n=7</code> and <code>[i,j]=[1,5]</code> produces <code>index=11</code>. Now the coordinates of this index are</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th><code>i</code></th>\n<th><code>j</code></th>\n<th><code>i&lt;=j &amp;&amp; j&gt;=0 &amp;&amp; j&lt;7</code></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>0</code></td>\n<td><code>11</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>1</code></td>\n<td><code>5</code></td>\n<td><strong>valid</strong></td>\n</tr>\n<tr>\n<td><code>2</code></td>\n<td><code>0</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>3</code></td>\n<td><code>-4</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>4</code></td>\n<td><code>-7</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>5</code></td>\n<td><code>-9</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>6</code></td>\n<td><code>-10</code></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n</div><hr />\n<p>If you want strictly the upper triangular elements, excluding the diagonal then</p>\n<ul>\n<li><p>Zero-based indexing form of element <code>[i,j]</code> for a <code>n\u00d7n</code> upper triangular matrix excluding the diagonal</p>\n<pre><code>index = i*n-i*(i+3)/2+j-1\n\ni=0..3, j=0..4, index=\n|  X |  0 |  1 |  2 |  3 |\n|  X |  X |  4 |  5 |  6 |\n|  X |  X |  X |  7 |  8 |\n|  X |  X |  X |  X |  9 |\n|  X |  X |  X |  X |  X |\n</code></pre>\n</li>\n</ul>\n<p>The algorithm now is to loop for all rows <code>i</code> and see if there is a match for the column <code>j</code> such that:</p>\n<ul>\n<li><code>i &lt; j</code></li>\n<li><code>j&gt;0</code></li>\n<li><code>j&lt;n</code></li>\n</ul>\n<p>Here is a sample code given <code>index</code> and <code>n</code></p>\n<pre><code>for(i=0; i&lt;n; i++)\n{\n    j = index - i*n + i*(i+3)/2 + 1\n    if( j&gt;0 &amp;&amp; j&lt;n &amp;&amp; j&gt;i)\n    {\n       break;\n    }\n}\n</code></pre>\n<p>And example with <code>n=7</code> and <code>[i,j]=[1,5]</code> produces <code>index=9</code>. Now the coordinates of this index are</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th><code>i</code></th>\n<th><code>j</code></th>\n<th><code>i&lt;j &amp;&amp; j&gt;0 &amp;&amp; j&lt;7</code></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>0</code></td>\n<td><code>10</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>1</code></td>\n<td><code>5</code></td>\n<td><strong>valid</strong></td>\n</tr>\n<tr>\n<td><code>2</code></td>\n<td><code>1</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>3</code></td>\n<td><code>-2</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>4</code></td>\n<td><code>-4</code></td>\n<td></td>\n</tr>\n<tr>\n<td><code>5</code></td>\n<td><code>-5</code></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n</div>"
                }
            ],
            "owner": {
                "account_id": 14785790,
                "reputation": 63,
                "user_id": 10678012,
                "user_type": "registered",
                "display_name": "Mat"
            },
            "comment_count": 2,
            "is_answered": true,
            "accepted_answer_id": 69292749,
            "answer_count": 4,
            "score": 1,
            "last_activity_date": 1632465374,
            "creation_date": 1632289322,
            "question_id": 69278755,
            "link": "https://stackoverflow.com/questions/69278755/linear-index-for-a-diagonal-run-of-an-upper-triangular-matrix",
            "title": "Linear index for a diagonal run of an upper triangular matrix",
            "body": "<p>Given a NxN matrix, I would like to linearly index into its upper right triangle,\nfollowing a diagonal by diagonal pattern, starting after the main diagonal.</p>\n<p>For example, given a 4x4 matrix</p>\n<pre><code>X 0 3 5\nX X 1 4\nX X X 2\nX X X X\n</code></pre>\n<p>I'm looking for a non recursive (closed form) function mapping linear indices from 0 to 5 to (x,y) achieving</p>\n<pre><code>f(0) = (0, 1)\nf(1) = (1, 2)\nf(2) = (2, 3)\nf(3) = (0, 2)\nf(4) = (1, 3)\nf(5) = (0, 3)\n</code></pre>\n<p>Related for row by row runs:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/27086195/linear-index-upper-triangular-matrix\">Linear index upper triangular matrix</a></li>\n<li><a href=\"https://stackoverflow.com/questions/242711/algorithm-for-index-numbers-of-triangular-matrix-coefficients\">algorithm for index numbers of triangular matrix coefficients</a></li>\n</ul>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 5782
}