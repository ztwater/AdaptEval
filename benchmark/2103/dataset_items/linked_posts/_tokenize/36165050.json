{
    "items": [
        {
            "tags": [
                "python",
                "format",
                "fortran",
                "ascii"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 37811,
                        "reputation": 105529,
                        "user_id": 108205,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "jsbueno"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1458680558,
                    "post_id": 36165050,
                    "comment_id": 59967435,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input#comment59967435_36165050",
                    "body": "Are the quotes mandatory for strings (i.e. - are they always there? )"
                },
                {
                    "owner": {
                        "account_id": 372540,
                        "reputation": 59091,
                        "user_id": 721644,
                        "user_type": "registered",
                        "accept_rate": 70,
                        "display_name": "Vladimir F \u0413\u0435\u0440\u043e\u044f\u043c \u0441\u043b\u0430\u0432\u0430"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1458682026,
                    "post_id": 36165050,
                    "comment_id": 59968239,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input#comment59968239_36165050",
                    "body": "It is not called free format, but <i>list-directed</i> I/O <a href=\"http://www.cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap02/read-1.html\" rel=\"nofollow noreferrer\">cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap02/read-1.html</a>"
                },
                {
                    "owner": {
                        "account_id": 3857736,
                        "reputation": 821,
                        "user_id": 4949262,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "display_name": "everythingfunctional"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1458755763,
                    "post_id": 36165050,
                    "comment_id": 60006096,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input#comment60006096_36165050",
                    "body": "jsbueno, no, the quotes are only required if there is a space or &quot;,&quot; in the string, to prevent it being treated as multiple fields."
                },
                {
                    "owner": {
                        "account_id": 3857736,
                        "reputation": 821,
                        "user_id": 4949262,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "display_name": "everythingfunctional"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1458755794,
                    "post_id": 36165050,
                    "comment_id": 60006116,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input#comment60006116_36165050",
                    "body": "Vladimir F, thanks for the clarification. Couldn&#39;t think of the term."
                },
                {
                    "owner": {
                        "account_id": 3804236,
                        "reputation": 31615,
                        "user_id": 3157076,
                        "user_type": "registered",
                        "display_name": "francescalus"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1458768560,
                    "post_id": 36165050,
                    "comment_id": 60013314,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input#comment60013314_36165050",
                    "body": "Reading your reply to Vladimir F as acquiescence, I&#39;ve updated the terminology in the question.  I&#39;ve also removed what could be considered an off-topic request for external resources.  If you&#39;re not happy with either of those, please roll that edit back."
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3804236,
                                "reputation": 31615,
                                "user_id": 3157076,
                                "user_type": "registered",
                                "display_name": "francescalus"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458688699,
                            "post_id": 36165201,
                            "comment_id": 59971266,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment59971266_36165201",
                            "body": "The behaviour of list-directed input is a <i>lot</i> more complicated than that link makes out."
                        },
                        {
                            "owner": {
                                "account_id": 37811,
                                "reputation": 105529,
                                "user_id": 108205,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "jsbueno"
                            },
                            "reply_to_user": {
                                "account_id": 3804236,
                                "reputation": 31615,
                                "user_id": 3157076,
                                "user_type": "registered",
                                "display_name": "francescalus"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458690812,
                            "post_id": 36165201,
                            "comment_id": 59972013,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment59972013_36165201",
                            "body": "Is this one complete enough? <a href=\"https://docs.oracle.com/cd/E19957-01/805-4939/6j4m0vnc5/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/805-4939/6j4m0vnc5/index.html</a>"
                        },
                        {
                            "owner": {
                                "account_id": 3804236,
                                "reputation": 31615,
                                "user_id": 3157076,
                                "user_type": "registered",
                                "display_name": "francescalus"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1458691524,
                            "post_id": 36165201,
                            "comment_id": 59972260,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment59972260_36165201",
                            "body": "A recent Fortran standard (drafts as linked in the tag wiki) will provide as much detail as you could want. It could be worth noting that if the hope is to provide an emulation of list-directed input rather than act like the statement of the question, one may have to be concerned about defined input procedures."
                        },
                        {
                            "owner": {
                                "account_id": 3857736,
                                "reputation": 821,
                                "user_id": 4949262,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "everythingfunctional"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458761391,
                            "post_id": 36165201,
                            "comment_id": 60009480,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60009480_36165201",
                            "body": "That&#39;s an interesting design. I was leaning towards a function that took as arguments, the file, and a list of variables to assign into. The tokenizer is decent start, but as you can see from the oracle page you linked to, it needs some more work to be a full emulation. I can probably implement one myself, it&#39;s just if I ever get around to it."
                        },
                        {
                            "owner": {
                                "account_id": 37811,
                                "reputation": 105529,
                                "user_id": 108205,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "jsbueno"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458766840,
                            "post_id": 36165201,
                            "comment_id": 60012471,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60012471_36165201",
                            "body": "As you should know before trying to code in Python, you can&#39;t &quot;pass variables&quot; to a function and have their values modified in the calling context - like one does with passing a variable address (pointer) in C.  There are several  cleaner alternatives (in respect of less colateral effects the function can cause on the calling environment)- the function could return a dictionary, or it could return a tuple you assign to your variables (this is the option I choose above)"
                        },
                        {
                            "owner": {
                                "account_id": 3857736,
                                "reputation": 821,
                                "user_id": 4949262,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "everythingfunctional"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458835308,
                            "post_id": 36165201,
                            "comment_id": 60042551,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60042551_36165201",
                            "body": "I was thinking you would probably need to implement classes for character, integer, and floating point types so it would more closely resemble Fortran&#39;s strict types, and at that point you CAN modify objects. The problem with returning a tuple of the values is, the function won&#39;t know how many return values it&#39;s looking for, and empty fields will end up modifying variables, which is not what happens in Fortran."
                        },
                        {
                            "owner": {
                                "account_id": 37811,
                                "reputation": 105529,
                                "user_id": 108205,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "jsbueno"
                            },
                            "reply_to_user": {
                                "account_id": 3857736,
                                "reputation": 821,
                                "user_id": 4949262,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "everythingfunctional"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458842064,
                            "post_id": 36165201,
                            "comment_id": 60046989,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60046989_36165201",
                            "body": "Sorry @Brad - if you look the code above the function <i>does</i> know how many return values it needs - the &quot;types&quot; tuple gives the type for each of them, And Python int, float, types can already work as constructors for the types  -  the character class is there because the reduced specification in that cs.mtu.edu link describes one can specify the string width - that is padded or truncated. This class does that.   Moreover, empty fields keep the values of the previous reads with the same types - the code above was written with that purpose in mind."
                        },
                        {
                            "owner": {
                                "account_id": 37811,
                                "reputation": 105529,
                                "user_id": 108205,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "jsbueno"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458842144,
                            "post_id": 36165201,
                            "comment_id": 60047030,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60047030_36165201",
                            "body": "TL;DR: if this is not clear enough - if people confirm there is no other way of doing this, I intend to evolve this solution obey the full Fortran specs and relase it on pypi - please let me know."
                        },
                        {
                            "owner": {
                                "account_id": 3857736,
                                "reputation": 821,
                                "user_id": 4949262,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "everythingfunctional"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458843476,
                            "post_id": 36165201,
                            "comment_id": 60047886,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60047886_36165201",
                            "body": "@jsbueno that was unclear to me without an example, but I see it now. It just seemed like a slightly less clean interface, but maybe not. In Fortran, character variables must be declared with a given length (with an exception in the latest standard), so the padding/truncating becomes inherent. I had started putting together the &#39;structure&#39; of a Fortran Ascii File Reader <a href=\"https://github.com/bprichar/PyLiDiRe\" rel=\"nofollow noreferrer\">here</a>, but if you&#39;ve got the time and desire, I&#39;d be happy to let you take the lead on implementation."
                        },
                        {
                            "owner": {
                                "account_id": 3857736,
                                "reputation": 821,
                                "user_id": 4949262,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "everythingfunctional"
                            },
                            "reply_to_user": {
                                "account_id": 37811,
                                "reputation": 105529,
                                "user_id": 108205,
                                "user_type": "registered",
                                "accept_rate": 86,
                                "display_name": "jsbueno"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1458846204,
                            "post_id": 36165201,
                            "comment_id": 60049502,
                            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#comment60049502_36165201",
                            "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107264/discussion-between-brad-richardson-and-jsbueno\">continue this discussion in chat</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 37811,
                        "reputation": 105529,
                        "user_id": 108205,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "jsbueno"
                    },
                    "comment_count": 10,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1458766958,
                    "last_edit_date": 1458766958,
                    "creation_date": 1458680721,
                    "answer_id": 36165201,
                    "question_id": 36165050,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/36165201#36165201",
                    "body": "<p>That is indeed tricky - I found it easier to write a pure-python stated-based tokenizer than think on a regular expression to parse each line (tough it is possible).</p>\n\n<p>I've used the <a href=\"http://www.cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap02/read-1.html\" rel=\"nofollow\">link provided by Vladimir</a> as the spec - the tokenizer have some doctests that pass.</p>\n\n<pre><code>def tokenize(line, separator=',', whitespace=\"\\t\\n\\x20\", quote='\"'):\n    \"\"\"\n    &gt;&gt;&gt; tokenize('\"some string\" 10.0, 5')\n    ['some string', '10.0', '5']\n\n    &gt;&gt;&gt; tokenize(' \"other string\", 15.0 /')\n    ['other string', '15.0', '/']\n\n    &gt;&gt;&gt; tokenize('\"nother string\", , 7')\n    ['nother string', '', '7']\n\n    \"\"\"\n    inside_str = False\n    token_started = False\n    token = \"\"\n    tokens = []\n    separated = False\n    just_added = False\n    for char in line:\n        if char in quote:\n            if not inside_str:\n                inside_str = True\n\n            else:\n                inside_str = False\n                tokens.append(token)\n                token = \"\"\n                just_added = True\n            continue\n        if char in (whitespace + separator) and not inside_str:\n            if token:\n                tokens.append(token)\n                token = \"\"\n                just_added = True\n            elif char in separator:\n                if not just_added:\n                    tokens.append(\"\")\n                just_added = False\n            continue\n        token += char\n    if token:\n        tokens.append(token)\n    return tokens\n\n\nclass Character(object):\n    def __init__(self, length=None):\n        self.length = length\n    def __call__(self, text):\n        if self.length is None:\n            return text\n        if len(text) &gt; self.length:\n            return text[:self.length]\n        return \"{{:{}}}\".format(self.length).format(text)\n\n\ndef make_types(types, default_value):\n    return types, [default_value] * len[types]\n\n\ndef fortran_reader(file, types, default_char=\"/\", default_value=None, **kw):\n    types, results = make_types(types, default_value)\n    tokens = []\n    while True:\n        tokens = []\n        while len(tokens) &lt; len(results):\n            try:\n                line = next(file)\n            except StopIteration:\n                raise StopIteration\n            tokens += tokenize(line, **kw)\n        for i, (type_, token) in enumerate(zip(types, tokens)):\n            if not token or token in default_char:\n                continue\n            results[i] = type_(token)\n        changed_types = yield(results)\n        if changed_types:\n            types, results = make_types(changed_types)\n</code></pre>\n\n<p>I have not teste this thoughtfully - but for the tokenizer -\nit is designed to work in a Python <code>for</code>statement if the same fields are repeated over and over again - or it can be used with Python's iterators <code>send</code> method to change the values to be read on each iteration. </p>\n\n<p>Please test, and e-mail me (address at  my profile) some testing file. If there is indeed nothing similar, maybe this deserves some polishing and be published in Pypi. </p>\n"
                },
                {
                    "owner": {
                        "account_id": 3857736,
                        "reputation": 821,
                        "user_id": 4949262,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "display_name": "everythingfunctional"
                    },
                    "comment_count": 0,
                    "is_accepted": true,
                    "score": 1,
                    "last_activity_date": 1462799030,
                    "creation_date": 1462799030,
                    "answer_id": 37116561,
                    "question_id": 36165050,
                    "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input/37116561#37116561",
                    "body": "<p>Since I was not able to find a solution to this problem, I decided to write my own solution.</p>\n\n<p>The main drivers are a reader class, and a tokenizer. The reader gets one line at a time from the file, passes it to the tokenizer, and assigns to the variables it is given, getting the next line as necessary.</p>\n\n<pre><code>class FortranAsciiReader(file):\n\ndef read(self, *args):\n    \"\"\"\n    Read from file into the given objects\n    \"\"\"\n    num_args = len(args)\n    num_read = 0\n    encountered_slash = False\n    # If line contained '/' or read into all varialbes, we're done\n    while num_read &lt; num_args and not encountered_slash:\n        line = self.readline()\n        if not line:\n            raise Exception()\n        values = tokenize(line)\n        # Assign elements one-by-one into args, skipping empty fields and stopping at a '/'\n        for val in values:\n            if val == '/':\n                encountered_slash = True\n                break\n            elif val == '':\n                num_read += 1\n            else:\n                args[num_read].assign(val)\n                num_read += 1\n                if num_read == num_args:\n                    break\n</code></pre>\n\n<p>The tokenizer splits the line into tokens in accordance with the way that Fortran performs list directed reads, where ',' and white space are separators, tokens may be \"repeated\" via <code>4*token</code>, and a / terminates input.</p>\n\n<p>My implementation of the tokenizer is a bit long to reproduce here, and I also included classes to transparently provide the functionality of the basic Fortran intrinsic types (i.e. Real, Character, Integer, etc.). The whole project can be found on my github account, currently at <a href=\"https://github.com/bprichar/PyLiDiRe\" rel=\"nofollow\">https://github.com/bprichar/PyLiDiRe</a>. Thanks jsbueno for inspiration for the tokenizer.</p>\n"
                }
            ],
            "owner": {
                "account_id": 3857736,
                "reputation": 821,
                "user_id": 4949262,
                "user_type": "registered",
                "accept_rate": 60,
                "display_name": "everythingfunctional"
            },
            "comment_count": 5,
            "is_answered": true,
            "accepted_answer_id": 37116561,
            "answer_count": 2,
            "score": 3,
            "last_activity_date": 1462799030,
            "creation_date": 1458680204,
            "last_edit_date": 1458768491,
            "question_id": 36165050,
            "link": "https://stackoverflow.com/questions/36165050/python-equivalent-of-fortran-list-directed-input",
            "title": "Python equivalent of Fortran list-directed input",
            "body": "<p>I'd like to be able to read data from an input file in Python, similar to the way that Fortran handles a list-directed read (i.e. <code>read (file, *) char_var, float_var, int_var</code>).</p>\n\n<p>The tricky part is that the way Fortran handles a read statement like this is very \"forgiving\" as far as the input format is concerned. For example, using the previous statement, this:</p>\n\n<pre><code>\"some string\" 10.0, 5\n</code></pre>\n\n<p>would be read the same as:</p>\n\n<pre><code>\"some string\",      10.0\n5\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>\"other string\", 15.0 /\n</code></pre>\n\n<p>is read the same as:</p>\n\n<pre><code>\"other string\"\n15\n/\n</code></pre>\n\n<p>with the value of <code>int_var</code> retaining the same value as before the read statement. And trickier still this:</p>\n\n<pre><code>\"nother string\", , 7\n</code></pre>\n\n<p>will assign the values to <code>char_var</code> and <code>int_var</code> but <code>float_var</code> retains the same value as before the read statement.</p>\n\n<p>Is there an elegant way to implement this?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 6018
}