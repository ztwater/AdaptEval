{
    "items": [
        {
            "tags": [
                "python",
                "numpy",
                "scipy",
                "statistics",
                "confidence-interval"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 14363265,
                        "reputation": 21661,
                        "user_id": 10375049,
                        "user_type": "registered",
                        "display_name": "Marco Cerliani"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1612270462,
                    "post_id": 15033511,
                    "comment_id": 116709287,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data#comment116709287_15033511",
                    "body": "you can use bootstrap: <a href=\"https://stackoverflow.com/a/66008548/10375049\">stackoverflow.com/a/66008548/10375049</a>"
                },
                {
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1639525331,
                    "post_id": 15033511,
                    "comment_id": 124369811,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data#comment124369811_15033511",
                    "body": "what does one have to do for data that is not classification e.g. regression arbitrary real values?"
                },
                {
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1639618258,
                    "post_id": 15033511,
                    "comment_id": 124397599,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data#comment124397599_15033511",
                    "body": "answering my own question, yes, see: <a href=\"https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&amp;lq=1\" title=\"confidence interval given the population mean and standard deviation\">stats.stackexchange.com/questions/554332/&hellip;</a>"
                },
                {
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1652120042,
                    "post_id": 15033511,
                    "comment_id": 127524369,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data#comment127524369_15033511",
                    "body": "answering my own comment above:  I think it can be used for any data because of the following:   I believe it is fine since the mean and std are calculated for general numeric data and the z_p/t_p value only takes in the confidence interval and data size, so it is independent of assumptions on the distribution of data.   So yes I think this equation can be used for both classification and regression."
                },
                {
                    "owner": {
                        "account_id": 17575501,
                        "reputation": 14376,
                        "user_id": 12750353,
                        "user_type": "registered",
                        "display_name": "Bob"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1652212483,
                    "post_id": 15033511,
                    "comment_id": 127551195,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data#comment127551195_15033511",
                    "body": "I came here to get the bounty, but your goals are so different that it will be difficult to write a question that is at the same time relevant to this question and addresses your questions. But in summary the test used for the top answer is relevant for Normally distributed data with few samples (as the number of samples grow it converges to the normal distribution itself). If you apply to a data that is not normal the confidence intervals will not be correct."
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 38356,
                                "reputation": 66727,
                                "user_id": 110026,
                                "user_type": "registered",
                                "accept_rate": 92,
                                "display_name": "Jaime"
                            },
                            "edited": false,
                            "score": 31,
                            "creation_date": 1361576466,
                            "post_id": 15034101,
                            "comment_id": 21130692,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment21130692_15034101",
                            "body": "<code>scipy.stats.norm.interval(confidence, loc=mean, scale=sigma)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 1565970,
                                "reputation": 388,
                                "user_id": 1454769,
                                "user_type": "registered",
                                "display_name": "David"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1424304772,
                            "post_id": 15034101,
                            "comment_id": 45499370,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment45499370_15034101",
                            "body": "@bogatron, about the suggested calculus for the confidence interval, wouldn&#39;t be <b>mean +/- z * sigma/sqrt(n)</b>, where n is sample size?"
                        },
                        {
                            "owner": {
                                "account_id": 1441946,
                                "reputation": 18999,
                                "user_id": 1361822,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "bogatron"
                            },
                            "reply_to_user": {
                                "account_id": 1565970,
                                "reputation": 388,
                                "user_id": 1454769,
                                "user_type": "registered",
                                "display_name": "David"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1424356477,
                            "post_id": 15034101,
                            "comment_id": 45521802,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment45521802_15034101",
                            "body": "@David, you are correct. I misstated the meaning of <code>sigma</code>. <code>sigma</code> in my answer should be the estimated standard deviation of the sample mean, not the estimated standard deviation of the distribution. I&#39;ve updated the answer to clarify that. Thanks for pointing that out."
                        },
                        {
                            "owner": {
                                "account_id": 1168977,
                                "reputation": 335,
                                "user_id": 12075156,
                                "user_type": "registered",
                                "display_name": "Jo&#227;o Vitor Gomes"
                            },
                            "reply_to_user": {
                                "account_id": 38356,
                                "reputation": 66727,
                                "user_id": 110026,
                                "user_type": "registered",
                                "accept_rate": 92,
                                "display_name": "Jaime"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1620349363,
                            "post_id": 15034101,
                            "comment_id": 119181559,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment119181559_15034101",
                            "body": "There is a mislead in @Jaime comment. If you are computing the t student confidence interval, you don&#39;t use sigma, you use the standard error which is sigma/np.sqrt(total number of observations), otherwise you gonna get the wrong result. You could also say: scipy.stats.norm.interval(confidence, loc=mean, scale=standard error)"
                        },
                        {
                            "owner": {
                                "account_id": 4741979,
                                "reputation": 30215,
                                "user_id": 3834415,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "Chris"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1638802989,
                            "post_id": 15034101,
                            "comment_id": 124178262,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment124178262_15034101",
                            "body": "&quot;looking at a look-up table&quot; is an inappropriate answer for this stack exchange. It should be part of a library call so that code can fetch the z-score itself at runtime, and the confidence interval can be exposed to the user as a variable."
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639525101,
                            "post_id": 15034101,
                            "comment_id": 124369766,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment124369766_15034101",
                            "body": "does this work for classification AND regression? (e.g. if there are negative values, arbitary magnitude)"
                        },
                        {
                            "owner": {
                                "account_id": 10494295,
                                "reputation": 1113,
                                "user_id": 7735095,
                                "user_type": "registered",
                                "display_name": "Jakob"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1640175222,
                            "post_id": 15034101,
                            "comment_id": 124532276,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#comment124532276_15034101",
                            "body": "Using z-statsitics is wrong here, instead one should use t-statistics here. For a small number of observations the confidence intervals according to your solution would be way too small! Only for very large number of observations your sollution would be an prroximation to the correct solution to this question. But I would recomment to always use the correct solution based on t-statistics: e.g. <a href=\"https://stackoverflow.com/a/15034143/7735095\">stackoverflow.com/a/15034143/7735095</a> or <a href=\"https://stackoverflow.com/a/34474255/7735095\">stackoverflow.com/a/34474255/7735095</a>"
                        }
                    ],
                    "owner": {
                        "account_id": 1441946,
                        "reputation": 18999,
                        "user_id": 1361822,
                        "user_type": "registered",
                        "accept_rate": 78,
                        "display_name": "bogatron"
                    },
                    "comment_count": 7,
                    "is_accepted": false,
                    "score": 18,
                    "last_activity_date": 1424356150,
                    "last_edit_date": 1424356150,
                    "creation_date": 1361571304,
                    "answer_id": 15034101,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034101#15034101",
                    "body": "<p>Start with looking up the <a href=\"http://en.wikipedia.org/wiki/Standard_score\" rel=\"noreferrer\">z-value</a> for your desired confidence interval from a <a href=\"http://en.wikipedia.org/wiki/Standard_normal_table\" rel=\"noreferrer\">look-up table</a>.  The confidence interval is then <code>mean +/- z*sigma</code>, where <code>sigma</code> is the estimated standard deviation of your sample mean, given by <code>sigma = s / sqrt(n)</code>, where <code>s</code> is the standard deviation computed from your sample data and <code>n</code> is your sample size.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 212787,
                                "reputation": 11045,
                                "user_id": 465838,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "Russ"
                            },
                            "edited": false,
                            "score": 47,
                            "creation_date": 1394609568,
                            "post_id": 15034143,
                            "comment_id": 33960524,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment33960524_15034143",
                            "body": "Careful with the &quot;private&quot; use of <code>sp.stats.t._ppf</code>.  I&#39;m not that comfortable with that in there without further explanation.  Better to use <code>sp.stats.t.ppf</code> directly, unless you are sure you know what you are doing.  On quick inspection of <a href=\"https://github.com/scipy/scipy/blob/v0.13.0/scipy/stats/distributions.py#L1474\" rel=\"nofollow noreferrer\">the source</a> there is a fair amount of code skipped with <code>_ppf</code>.  Possibly benign, but also possibly an unsafe optimization attempt?"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639525073,
                            "post_id": 15034143,
                            "comment_id": 124369759,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment124369759_15034143",
                            "body": "does this work for classification AND regression? (e.g. if there are negative values, arbitary magnitude)"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1639618246,
                            "post_id": 15034143,
                            "comment_id": 124397596,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment124397596_15034143",
                            "body": "anssering myself: yes it is since it&#39;s computing CI <code>mu_n +- t.val(0.95) * std_n&#47; sqrt(n)</code> see for details: <a href=\"https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&amp;lq=1\" title=\"confidence interval given the population mean and standard deviation\">stats.stackexchange.com/questions/554332/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1645039310,
                            "post_id": 15034143,
                            "comment_id": 125767417,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment125767417_15034143",
                            "body": "what is the type of <code>data</code>?"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1645039455,
                            "post_id": 15034143,
                            "comment_id": 125767469,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment125767469_15034143",
                            "body": "why are you doing `    a = 1.0 * data<code>? what is the type of </code>a`?"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1645040388,
                            "post_id": 15034143,
                            "comment_id": 125767833,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment125767833_15034143",
                            "body": "could you provide some example fake data for this? Why is the output of h not a scalar but is an array/list or something like that?"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1645041239,
                            "post_id": 15034143,
                            "comment_id": 125768163,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment125768163_15034143",
                            "body": "are these examples correct? <a href=\"https://stackoverflow.com/a/71148456/1601580\">stackoverflow.com/a/71148456/1601580</a> I&#39;m mainly worried about the N by M case (or general tensors)"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1652119384,
                            "post_id": 15034143,
                            "comment_id": 127524169,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment127524169_15034143",
                            "body": "does this CI calculation assume anything special about the distribution of the data? e.g. does it assume it&#39;s for classification or Bernoulli or something?"
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1652119913,
                            "post_id": 15034143,
                            "comment_id": 127524330,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment127524330_15034143",
                            "body": "I think it can be used for any data because of the following:   I believe it is fine since the mean and std are calculated for general numeric data and the z_p/t_p value only takes in the confidence interval and data size, so it is independent of assumptions on the distribution of data."
                        },
                        {
                            "owner": {
                                "account_id": 5060718,
                                "reputation": 70,
                                "user_id": 4062417,
                                "user_type": "registered",
                                "display_name": "capivarao"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1669978923,
                            "post_id": 15034143,
                            "comment_id": 131771051,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#comment131771051_15034143",
                            "body": "How can I include the p-value to return on this algorithm? Assuming I have the expected mean for the list"
                        }
                    ],
                    "owner": {
                        "account_id": 2404063,
                        "reputation": 2705,
                        "user_id": 2101052,
                        "user_type": "registered",
                        "display_name": "shasan"
                    },
                    "comment_count": 10,
                    "is_accepted": true,
                    "score": 250,
                    "last_activity_date": 1655033186,
                    "last_edit_date": 1655033186,
                    "creation_date": 1361571538,
                    "answer_id": 15034143,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/15034143#15034143",
                    "body": "<pre><code>import numpy as np\nimport scipy.stats\n\ndef mean_confidence_interval(data, confidence=0.95):\n    a = 1.0 * np.array(data)\n    n = len(a)\n    m, se = np.mean(a), scipy.stats.sem(a)\n    h = se * scipy.stats.t.ppf((1 + confidence) / 2., n-1)\n    return m, m-h, m+h\n</code></pre>\n<p>You can calculate like this.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 3846032,
                                "reputation": 33221,
                                "user_id": 3187556,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "Scimonster"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1466951613,
                            "post_id": 34474255,
                            "comment_id": 63518824,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment63518824_34474255",
                            "body": "I believe you should be calling <code>st.t.interval(0.05)</code> to get the 95% confidence interval."
                        },
                        {
                            "owner": {
                                "account_id": 1787493,
                                "reputation": 11031,
                                "user_id": 1628638,
                                "user_type": "registered",
                                "display_name": "Ulrich Stern"
                            },
                            "reply_to_user": {
                                "account_id": 3846032,
                                "reputation": 33221,
                                "user_id": 3187556,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "Scimonster"
                            },
                            "edited": false,
                            "score": 7,
                            "creation_date": 1466955214,
                            "post_id": 34474255,
                            "comment_id": 63520037,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment63520037_34474255",
                            "body": "No, <code>st.t.interval(0.95)</code> is correct for the 95% confidence interval, see the <a href=\"http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.t.html\" rel=\"nofollow noreferrer\">docs</a> for <code>scipy.stats.t</code>.  SciPy&#39;s naming the argument <code>alpha</code> seems less than ideal, though."
                        },
                        {
                            "owner": {
                                "account_id": 12950704,
                                "reputation": 2339,
                                "user_id": 9900084,
                                "user_type": "registered",
                                "display_name": "steven"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1548535811,
                            "post_id": 34474255,
                            "comment_id": 95578138,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment95578138_34474255",
                            "body": "If I have two arrays of data and then calculated the difference of their mean. Is there any way to get a 95% CI for this mean difference? Could you think of any easy way to do it like the one you provide here by using StatsModelsl?"
                        },
                        {
                            "owner": {
                                "account_id": 14590168,
                                "reputation": 1079,
                                "user_id": 10537571,
                                "user_type": "registered",
                                "display_name": "Mehdi"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1627665955,
                            "post_id": 34474255,
                            "comment_id": 121225977,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment121225977_34474255",
                            "body": "Student-t distribution should be used when the sample size is small (less than 30), which is in this case ([10,11,12,13). As a result, normal distribution gives a different result. If you increase your sample size to 1000 for instance, t- and norm give almost identical results."
                        },
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639525069,
                            "post_id": 34474255,
                            "comment_id": 124369755,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment124369755_34474255",
                            "body": "does this work for classification AND regression? (e.g. if there are negative values, arbitary magnitude)"
                        },
                        {
                            "owner": {
                                "account_id": 3093339,
                                "reputation": 10144,
                                "user_id": 2619038,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "NoName"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1658248770,
                            "post_id": 34474255,
                            "comment_id": 129002725,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment129002725_34474255",
                            "body": "Why use <code>scale=st.sem(a)</code> instead of <code>scale=np.std(a)</code>?  Since scale is the standard deviation?"
                        },
                        {
                            "owner": {
                                "account_id": 1837336,
                                "reputation": 1299,
                                "user_id": 1667423,
                                "user_type": "registered",
                                "accept_rate": 36,
                                "display_name": "user76284"
                            },
                            "reply_to_user": {
                                "account_id": 3093339,
                                "reputation": 10144,
                                "user_id": 2619038,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "NoName"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1704488480,
                            "post_id": 34474255,
                            "comment_id": 137101378,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment137101378_34474255",
                            "body": "@NoName <a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.sem.html\" rel=\"nofollow noreferrer\">sem</a> has ddof=1 by default. <a href=\"https://numpy.org/doc/stable/reference/generated/numpy.std.html\" rel=\"nofollow noreferrer\">std</a> has ddof=0 by default."
                        },
                        {
                            "owner": {
                                "account_id": 2155118,
                                "reputation": 2402,
                                "user_id": 1910555,
                                "user_type": "registered",
                                "display_name": "pds"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1709892476,
                            "post_id": 34474255,
                            "comment_id": 137734624,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#comment137734624_34474255",
                            "body": "@UlrichStern , Good news! SciPy now warns about using <code>alpha=</code> arg and recommends <code>confidence=</code> instead ^^"
                        }
                    ],
                    "owner": {
                        "account_id": 1787493,
                        "reputation": 11031,
                        "user_id": 1628638,
                        "user_type": "registered",
                        "display_name": "Ulrich Stern"
                    },
                    "comment_count": 8,
                    "is_accepted": false,
                    "score": 201,
                    "last_activity_date": 1591802048,
                    "last_edit_date": 1591802048,
                    "creation_date": 1451156176,
                    "answer_id": 34474255,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/34474255#34474255",
                    "body": "<p>Here a shortened version of shasan's code, calculating the 95% confidence interval of the mean of array <code>a</code>:</p>\n\n<pre><code>import numpy as np, scipy.stats as st\n\nst.t.interval(0.95, len(a)-1, loc=np.mean(a), scale=st.sem(a))\n</code></pre>\n\n<p>But using StatsModels' <a href=\"http://www.statsmodels.org/stable/generated/statsmodels.stats.weightstats.DescrStatsW.tconfint_mean.html\" rel=\"noreferrer\"><code>tconfint_mean</code></a> is arguably even nicer:</p>\n\n<pre><code>import statsmodels.stats.api as sms\n\nsms.DescrStatsW(a).tconfint_mean()\n</code></pre>\n\n<p>The underlying assumptions for both are that the sample (array <code>a</code>) was drawn independently from a normal distribution with unknown standard deviation (see <a href=\"http://mathworld.wolfram.com/Studentst-Distribution.html\" rel=\"noreferrer\">MathWorld</a> or <a href=\"https://en.wikipedia.org/wiki/Student&#39;s_t-distribution\" rel=\"noreferrer\">Wikipedia</a>).</p>\n\n<p>For large sample size n, the sample mean is normally distributed, and one can calculate its confidence interval using <code>st.norm.interval()</code> (as suggested in Jaime's comment).  But the above solutions are correct also for small n, where <code>st.norm.interval()</code> gives confidence intervals that are too narrow (i.e., \"fake confidence\").  See my <a href=\"https://stackoverflow.com/a/33374673/1628638\">answer</a> to a similar question for more details (and one of Russ's comments here).</p>\n\n<p>Here an example where the correct options give (essentially) identical confidence intervals:</p>\n\n<pre><code>In [9]: a = range(10,14)\n\nIn [10]: mean_confidence_interval(a)\nOut[10]: (11.5, 9.4457397432391215, 13.554260256760879)\n\nIn [11]: st.t.interval(0.95, len(a)-1, loc=np.mean(a), scale=st.sem(a))\nOut[11]: (9.4457397432391215, 13.554260256760879)\n\nIn [12]: sms.DescrStatsW(a).tconfint_mean()\nOut[12]: (9.4457397432391197, 13.55426025676088)\n</code></pre>\n\n<p>And finally, the incorrect result using <code>st.norm.interval()</code>:</p>\n\n<pre><code>In [13]: st.norm.interval(0.95, loc=np.mean(a), scale=st.sem(a))\nOut[13]: (10.23484868811834, 12.76515131188166)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1589784,
                                "reputation": 6089,
                                "user_id": 1601580,
                                "user_type": "registered",
                                "accept_rate": 47,
                                "display_name": "Charlie Parker"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639525085,
                            "post_id": 55270860,
                            "comment_id": 124369763,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/55270860#comment124369763_55270860",
                            "body": "does this work for classification AND regression? (e.g. if there are negative values, arbitary magnitude)"
                        },
                        {
                            "owner": {
                                "account_id": 10494295,
                                "reputation": 1113,
                                "user_id": 7735095,
                                "user_type": "registered",
                                "display_name": "Jakob"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1640174856,
                            "post_id": 55270860,
                            "comment_id": 124532130,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/55270860#comment124532130_55270860",
                            "body": "Is there any reason to use the wrong but approximately correct normal distribution instead the perfectly correct t-distribution? I don&#39;t see any disadvantage of using the correct t-distribution (see <a href=\"https://stackoverflow.com/a/15034143/7735095\">stackoverflow.com/a/15034143/7735095</a> or <a href=\"https://stackoverflow.com/a/34474255/7735095\">stackoverflow.com/a/34474255/7735095</a>) independent of the number of observations."
                        }
                    ],
                    "owner": {
                        "account_id": 12852886,
                        "reputation": 58924,
                        "user_id": 9297144,
                        "user_type": "registered",
                        "display_name": "Xavier Guihot"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 29,
                    "last_activity_date": 1553119574,
                    "creation_date": 1553119574,
                    "answer_id": 55270860,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/55270860#55270860",
                    "body": "<p>Starting <code>Python 3.8</code>, the standard library provides the <a href=\"https://docs.python.org/3.8/library/statistics.html?highlight=normaldist#statistics.NormalDist\" rel=\"noreferrer\"><code>NormalDist</code></a> object as part of the <a href=\"https://docs.python.org/3.8/library/statistics.html\" rel=\"noreferrer\"><code>statistics</code></a> module:</p>\n\n<pre><code>from statistics import NormalDist\n\ndef confidence_interval(data, confidence=0.95):\n  dist = NormalDist.from_samples(data)\n  z = NormalDist().inv_cdf((1 + confidence) / 2.)\n  h = dist.stdev * z / ((len(data) - 1) ** .5)\n  return dist.mean - h, dist.mean + h\n</code></pre>\n\n<p>This:</p>\n\n<ul>\n<li><p>Creates a <code>NormalDist</code> object from the data sample (<a href=\"https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.from_samples\" rel=\"noreferrer\"><code>NormalDist.from_samples(data)</code></a>, which gives us access to the sample's mean and standard deviation via <a href=\"https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.mean\" rel=\"noreferrer\"><code>NormalDist.mean</code></a> and <a href=\"https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.stdev\" rel=\"noreferrer\"><code>NormalDist.stdev</code></a>.</p></li>\n<li><p>Compute the <code>Z-score</code> based on the standard normal distribution (represented by <code>NormalDist()</code>) for the given confidence using the inverse of the cumulative distribution function (<a href=\"https://docs.python.org/3.8/library/statistics.html#statistics.NormalDist.inv_cdf\" rel=\"noreferrer\"><code>inv_cdf</code></a>).</p></li>\n<li><p>Produces the confidence interval based on the sample's standard deviation and mean.</p></li>\n</ul>\n\n<hr>\n\n<p>This assumes the sample size is big enough (let's say more than ~100 points) in order to use the standard normal distribution rather than the student's t distribution to compute the <code>z</code> value.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 1101133,
                                "reputation": 11100,
                                "user_id": 1093508,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "D&#225;vid Moln&#225;r"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1712579686,
                            "post_id": 70088381,
                            "comment_id": 138026866,
                            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/70088381#comment138026866_70088381",
                            "body": "What is sigma? Can you explain?"
                        }
                    ],
                    "owner": {
                        "account_id": 16880213,
                        "reputation": 23,
                        "user_id": 12935982,
                        "user_type": "registered",
                        "display_name": "Candace Agonafir"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1655033073,
                    "last_edit_date": 1655033073,
                    "creation_date": 1637704883,
                    "answer_id": 70088381,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/70088381#70088381",
                    "body": "<p>Regarding Ulrich's answer - that is using the t-value. We use this when the true variance is unknown. This is when the only data you have is the sample data.</p>\n<p>For bogatron's answer, this involves z-tables. The z-tables are used when variance is already known and provided. Then you also have sample data. Sigma is not the estimated standard deviation of the sample mean. It is already known.</p>\n<p>Let's say variance is known and we want 95% confidence:</p>\n<pre><code>from scipy.stats import norm\nalpha = 0.95\n# Define our z\nci = alpha + (1-alpha)/2\n#Lower Interval, where n is sample siz\nc_lb = sample_mean - norm.ppf(ci)*((sigma/(n**0.5)))\nc_ub = sample_mean + norm.ppf(ci)*((sigma/(n**0.5)))\n</code></pre>\n<p>With only sample data and an unknown variance (meaning that the variance will have to be calculated solely from sample data), Ulrich's answer works perfectly. However, you probably would like to designate the confidence interval. If your data is a and you want a confidence interval of 0.95:</p>\n<pre><code>import statsmodels.stats.api as sms\nconf = sms.DescrStatsW(a).tconfint_mean(alpha=0.05)\nconf\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1589784,
                        "reputation": 6089,
                        "user_id": 1601580,
                        "user_type": "registered",
                        "accept_rate": 47,
                        "display_name": "Charlie Parker"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1652120002,
                    "last_edit_date": 1652120002,
                    "creation_date": 1645041207,
                    "answer_id": 71148456,
                    "question_id": 15033511,
                    "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data/71148456#71148456",
                    "body": "<p>Based on the original but with some concrete examples:</p>\n<pre><code>import numpy as np\n\ndef mean_confidence_interval(data, confidence: float = 0.95) -&gt; tuple[float, np.ndarray]:\n    &quot;&quot;&quot;\n    Returns (tuple of) the mean and confidence interval for given data.\n    Data is a np.arrayable iterable.\n\n    ref:\n        - https://stackoverflow.com/a/15034143/1601580\n        - https://github.com/WangYueFt/rfs/blob/f8c837ba93c62dd0ac68a2f4019c619aa86b8421/eval/meta_eval.py#L19\n    &quot;&quot;&quot;\n    import scipy.stats\n    import numpy as np\n\n    a: np.ndarray = 1.0 * np.array(data)\n    n: int = len(a)\n    if n == 1:\n        import logging\n        logging.warning('The first dimension of your data is 1, perhaps you meant to transpose your data? or remove the'\n                        'singleton dimension?')\n    m, se = a.mean(), scipy.stats.sem(a)\n    tp = scipy.stats.t.ppf((1 + confidence) / 2., n - 1)\n    h = se * tp\n    return m, h\n\ndef ci_test_float():\n    import numpy as np\n    # - one WRONG data set of size 1 by N\n    data = np.random.randn(1, 30)  # gives an error becuase len sets n=1, so not this shape!\n    m, ci = mean_confidence_interval(data)\n    print('-- you should get a mean and a list of nan ci (since data is in wrong format, it thinks its 30 data sets of '\n          'length 1.')\n    print(m, ci)\n\n    # right data as N by 1\n    data = np.random.randn(30, 1)\n    m, ci = mean_confidence_interval(data)\n    print('-- gives a mean and a list of length 1 for a single CI (since it thinks you have a single dat aset)')\n    print(m, ci)\n\n    # multiple data sets (7) of size N (=30)\n    data = np.random.randn(30, 7)\n    print('-- gives 7 CIs for the 7 data sets of length 30. 30 is the number ud want large if you were using z(p)'\n          'due to the CLT.')\n    m, ci = mean_confidence_interval(data)\n    print(m, ci)\n\nci_test_float()\n</code></pre>\n<p>output:</p>\n<pre><code>-- you should get a mean and a list of nan ci (since data is in wrong format, it thinks its 30 data sets of length 1.\n0.1431623130952463 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan\n nan nan nan nan nan nan nan nan nan nan nan nan]\n-- gives a mean and a list of length 1 for a single CI (since it thinks you have a single dat aset)\n0.04947206018132864 [0.40627264]\n-- gives 7 CIs for the 7 data sets of length 30. 30 is the number ud want large if you were using z(p)due to the CLT.\n-0.03585104402718902 [0.31867309 0.35619134 0.34860011 0.3812853  0.44334033 0.35841138\n 0.40739732]\n</code></pre>\n<p>I think the Num_samples by Num_datasets is right but if it's not let me know in the comment section.</p>\n<hr />\n<h1>For what type of data does it work for?</h1>\n<p>I think it can be used for any data because of the following:</p>\n<blockquote>\n<p>I believe it is fine since the mean and std are calculated for general numeric data and the z_p/t_p value only takes in the confidence interval and data size, so it is independent of assumptions on the distribution of data.</p>\n</blockquote>\n<p>So it can be used for regression &amp; classification I believe.</p>\n<hr />\n<p>As a bonus, a torch implementation that nearly only uses torch only:</p>\n<pre><code>def torch_compute_confidence_interval(data: Tensor,\n                                      confidence: float = 0.95\n                                      ) -&gt; Tensor:\n    &quot;&quot;&quot;\n    Computes the confidence interval for a given survey of a data set.\n    &quot;&quot;&quot;\n    n: int = len(data)\n    mean: Tensor = data.mean()\n    # se: Tensor = scipy.stats.sem(data)  # compute standard error\n    # se, mean: Tensor = torch.std_mean(data, unbiased=True)  # compute standard error\n    se: Tensor = data.std(unbiased=True) / (n ** 0.5)\n    t_p: float = float(scipy.stats.t.ppf((1 + confidence) / 2., n - 1))\n    ci = t_p * se\n    return mean, ci\n</code></pre>\n<hr />\n<p>Some comments on CI (or see <a href=\"https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&amp;lq=1\">https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&amp;lq=1</a>):</p>\n<pre><code>&quot;&quot;&quot;\nReview for confidence intervals. Confidence intervals say that the true mean is inside the estimated confidence interval\n(the r.v. the user generates). In particular it says:\n    Pr[mu^* \\in [mu_n +- t.val(p) * std_n / sqrt(n) ] ] &gt;= p\ne.g. p = 0.95\nThis does not say that for a specific CI you compute the true mean is in that interval with prob 0.95. Instead it means\nthat if you surveyed/sampled 100 data sets D_n = {x_i}^n_{i=1} of size n (where n is ideally &gt;=30) then for 95 of those\nyou'd expect to have the truee mean inside the CI compute for that current data set. Note you can never check for which\nones mu^* is in the CI since mu^* is unknown. If you knew mu^* you wouldn't need to estimate it. This analysis assumes\nthat the the estimator/value your estimating is the true mean using the sample mean (estimator). Since it usually uses\nthe t.val or z.val (second for the standardozed r.v. of a normal) then it means the approximation that mu_n ~ gaussian\nmust hold. This is most likely true if n &gt;= 0. Note this is similar to statistical learning theory where we use\nthe MLE/ERM estimator to choose a function with delta, gamma etc reasoning. Note that if you do algebra you can also\nsay that the sample mean is in that interval but wrt mu^* but that is borning, no one cares since you do not know mu^*\nso it's not helpful.\n\nAn example use could be for computing the CI of the loss (e.g. 0-1, CE loss, etc). The mu^* you want is the expected\nrisk. So x_i = loss(f(x_i), y_i) and you are computing the CI for what is the true expected risk for that specific loss\nfunction you choose. So mu_n = emperical mean of the loss and std_n = (unbiased) estimate of the std and then you can\nsimply plug in the values.\n\nAssumptions for p-CI:\n    - we are making a statement that mu^* is in mu+-pCI = mu+-t_p * sig_n / sqrt n, sig_n ~ Var[x] is inside the CI\n    p% of the time.\n    - we are estimating mu^, a mean\n    - since the quantity of interest is mu^, then the z_p value (or p-value, depending which one is the unknown), is\n    computed using the normal distribution.\n    - p(mu) ~ N(mu; mu_n, sig_n/ sqrt n), vial CTL which holds for sample means. Ideally n &gt;= 30.\n    - x ~ p^*(x) are iid.\n\nStd_n vs t_p*std_n/ sqrt(n)\n    - std_n = var(x) is more pessimistic but holds always. Never shrinks as n-&gt;infity\n    - but if n is small then pCI might be too small and your &quot;lying to yourself&quot;. So if you have very small data\n    perhaps doing std_n for the CI is better. That holds with prob 99.9%. Hopefuly std is not too large for your\n    experiments to be invalidated.\n\nref:\n    - https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&amp;lq=1\n    - https://stackoverflow.com/questions/70356922/what-is-the-proper-way-to-compute-95-confidence-intervals-with-pytorch-for-clas\n    - https://www.youtube.com/watch?v=MzvRQFYUEFU&amp;list=PLUl4u3cNGP60hI9ATjSFgLZpbNJ7myAg6&amp;index=205\n&quot;&quot;&quot;\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 2212521,
                "reputation": 2208,
                "user_id": 1953958,
                "user_type": "registered",
                "display_name": "Bmayer0122"
            },
            "comment_count": 5,
            "is_answered": true,
            "accepted_answer_id": 15034143,
            "answer_count": 6,
            "score": 188,
            "last_activity_date": 1655033186,
            "creation_date": 1361568590,
            "last_edit_date": 1610532702,
            "question_id": 15033511,
            "link": "https://stackoverflow.com/questions/15033511/compute-a-confidence-interval-from-sample-data",
            "title": "Compute a confidence interval from sample data",
            "body": "<p>I have sample data which I would like to compute a confidence interval for, assuming a normal distribution.</p>\n\n<p>I have found and installed the numpy and scipy packages and have gotten numpy to return a mean and standard deviation (numpy.mean(data) with data being a list). Any advice on getting a sample confidence interval would be much appreciated.</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 9124
}