{
    "items": [
        {
            "tags": [
                "python",
                "numpy",
                "statsmodels",
                "standard-deviation",
                "weighted"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 4800605,
                        "reputation": 30014,
                        "user_id": 3877338,
                        "user_type": "registered",
                        "accept_rate": 93,
                        "display_name": "JohnE"
                    },
                    "edited": false,
                    "score": 2,
                    "creation_date": 1511024987,
                    "post_id": 2413522,
                    "comment_id": 81689847,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy#comment81689847_2413522",
                    "body": "Btw, calculation of weighted std dev is actually a rather complex subject -- there&#39;s more than one way to do it.  See here for a great discussion:  <a href=\"https://www.stata.com/support/faqs/statistics/weights-and-summary-statistics/\" rel=\"nofollow noreferrer\">stata.com/support/faqs/statistics/&hellip;</a>"
                },
                {
                    "owner": {
                        "account_id": 1781734,
                        "reputation": 3899,
                        "user_id": 1624277,
                        "user_type": "registered",
                        "accept_rate": 86,
                        "display_name": "e271p314"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1608764230,
                    "post_id": 2413522,
                    "comment_id": 115680955,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy#comment115680955_2413522",
                    "body": "<a href=\"http://www.ccgalberta.com/pygeostat/statistics.html#weighted-statistics\" rel=\"nofollow noreferrer\">ccgalberta.com/pygeostat/statistics.html#weighted-statistics</a>"
                }
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 64585,
                        "reputation": 864612,
                        "user_id": 190597,
                        "user_type": "registered",
                        "accept_rate": 88,
                        "display_name": "unutbu"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 6,
                    "last_activity_date": 1458014860,
                    "last_edit_date": 1458014860,
                    "creation_date": 1268179611,
                    "answer_id": 2413568,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2413568#2413568",
                    "body": "<p>There doesn't appear to be such a function in numpy/scipy yet, but there is a <a href=\"https://github.com/scipy/scipy/issues/1131\" rel=\"nofollow noreferrer\">ticket</a> proposing this added functionality. Included there you will find <a href=\"http://projects.scipy.org/scipy/attachment/ticket/604/Statistics.py\" rel=\"nofollow noreferrer\">Statistics.py</a> which implements weighted standard deviations.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 2734060,
                                "reputation": 270312,
                                "user_id": 2357112,
                                "user_type": "registered",
                                "accept_rate": 26,
                                "display_name": "user2357112"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1375838789,
                            "post_id": 2415343,
                            "comment_id": 26484692,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment26484692_2415343",
                            "body": "Why not use <code>numpy.average</code> again for the variance?"
                        },
                        {
                            "owner": {
                                "account_id": 2734913,
                                "reputation": 1855,
                                "user_id": 2359802,
                                "user_type": "registered",
                                "accept_rate": 93,
                                "display_name": "Corey"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1394169437,
                            "post_id": 2415343,
                            "comment_id": 33777587,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment33777587_2415343",
                            "body": "Just wanted to point out that this will give the biased variance. For small sample sizes, you may want to re-scale the variance (before sqrt) to get the unbiased variance. See <a href=\"https://en.wikipedia.org/wiki/Weighted_variance#Weighted_sample_variance\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1410515899,
                            "post_id": 2415343,
                            "comment_id": 40365087,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment40365087_2415343",
                            "body": "Yeah, the unbiased variance estimator would be slightly different. This answer gives the standard deviation, since the question asks for a weighted version of <code>numpy.std()</code>."
                        },
                        {
                            "owner": {
                                "account_id": 13447976,
                                "reputation": 2697,
                                "user_id": 9703451,
                                "user_type": "registered",
                                "display_name": "raphael"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1539161895,
                            "post_id": 2415343,
                            "comment_id": 92397394,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment92397394_2415343",
                            "body": "thx for this solution... but why do you use <code>math.sqrt</code> instead of <code>np.sqrt</code> in the end?"
                        },
                        {
                            "owner": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1539253755,
                            "post_id": 2415343,
                            "comment_id": 92438821,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment92438821_2415343",
                            "body": "<code>np.sqrt()</code> would work, but because <code>variance</code> is a simple (Numpy) float (and not a NumPy array), <code>math.sqrt()</code> is more explicit and appropriate (and therefore in general faster, if this matters)."
                        },
                        {
                            "owner": {
                                "account_id": 8170077,
                                "reputation": 1122,
                                "user_id": 6173694,
                                "user_type": "registered",
                                "display_name": "olq_plo"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1678610746,
                            "post_id": 2415343,
                            "comment_id": 133564147,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment133564147_2415343",
                            "body": "I wanted to object to @EricO.Lebigot, but the difference is indeed staggering: <code>%timeit math.sqrt(1.5)</code> 61.6 ns &#177; 0.661 ns per loop, <code>%timeit np.sqrt(1.5)</code>  554 ns &#177; 14.5 ns per loop. <code>math.sqrt</code> is almost a factor 10 faster (Python 3.10.9, numpy v1.23.3)."
                        },
                        {
                            "owner": {
                                "account_id": 390121,
                                "reputation": 20495,
                                "user_id": 749973,
                                "user_type": "registered",
                                "accept_rate": 93,
                                "display_name": "Tae-Sung Shin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1697205729,
                            "post_id": 2415343,
                            "comment_id": 136254460,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment136254460_2415343",
                            "body": "The computation for weighted variance is wrong. I wouldn&#39;t use np.average for weighted variance because &quot;variance = numpy.average((values-average)**2, weights=sample_weights**2)&quot; assuming sum(sample_weights) == 1. But np.average internally adjusts weights so that sum(weights) == 1. Thus, np.average can&#39;t be used for weighted variance."
                        },
                        {
                            "owner": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1699456599,
                            "post_id": 2415343,
                            "comment_id": 136534186,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#comment136534186_2415343",
                            "body": "This is an interesting point. It is quite safe to assume that concrete cases want an average and variance calculated with <i>normalized</i> weights (otherwise they are not very much like an average or an average variance). I did make this explicit in the docstring. Thanks!"
                        }
                    ],
                    "owner": {
                        "account_id": 18661,
                        "reputation": 93232,
                        "user_id": 42973,
                        "user_type": "registered",
                        "accept_rate": 91,
                        "display_name": "Eric O. Lebigot"
                    },
                    "comment_count": 8,
                    "is_accepted": true,
                    "score": 189,
                    "last_activity_date": 1699456479,
                    "last_edit_date": 1699456479,
                    "creation_date": 1268208436,
                    "answer_id": 2415343,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/2415343#2415343",
                    "body": "<p>How about the following short &quot;manual calculation&quot;?</p>\n<pre><code>def weighted_avg_and_std(values, weights):\n    &quot;&quot;&quot;\n    Return the weighted average and standard deviation.\n\n    They weights are in effect first normalized so that they \n    sum to 1 (and so they must not all be 0).\n\n    values, weights -- NumPy ndarrays with the same shape.\n    &quot;&quot;&quot;\n    average = numpy.average(values, weights=weights)\n    # Fast and numerically precise:\n    variance = numpy.average((values-average)**2, weights=weights)\n    return (average, math.sqrt(variance))\n\n    \n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 441885,
                                "reputation": 60711,
                                "user_id": 832230,
                                "user_type": "registered",
                                "display_name": "Asclepius"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1544636553,
                            "post_id": 36464881,
                            "comment_id": 94349623,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/36464881#comment94349623_36464881",
                            "body": "To use this approach to easily calculate the weighted coefficient of variation, see <a href=\"https://stackoverflow.com/a/53748541/832230\">this answer</a>."
                        }
                    ],
                    "owner": {
                        "account_id": 7040846,
                        "reputation": 149720,
                        "user_id": 5393381,
                        "user_type": "registered",
                        "accept_rate": 84,
                        "display_name": "MSeifert"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 55,
                    "last_activity_date": 1544560415,
                    "last_edit_date": 1544560415,
                    "creation_date": 1459990647,
                    "answer_id": 36464881,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/36464881#36464881",
                    "body": "<p>There is a class in <a href=\"https://www.statsmodels.org/stable/index.html\" rel=\"noreferrer\"><code>statsmodels</code></a> that makes it easy to calculate weighted statistics: <a href=\"http://www.statsmodels.org/dev/generated/statsmodels.stats.weightstats.DescrStatsW.html\" rel=\"noreferrer\"><code>statsmodels.stats.weightstats.DescrStatsW</code></a>.</p>\n\n<p>Assuming this dataset and weights:</p>\n\n<pre><code>import numpy as np\nfrom statsmodels.stats.weightstats import DescrStatsW\n\narray = np.array([1,2,1,2,1,2,1,3])\nweights = np.ones_like(array)\nweights[3] = 100\n</code></pre>\n\n<p>You initialize the class (note that you have to pass in the correction factor, the delta <a href=\"https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)\" rel=\"noreferrer\">degrees of freedom</a> at this point):</p>\n\n<pre><code>weighted_stats = DescrStatsW(array, weights=weights, ddof=0)\n</code></pre>\n\n<p>Then you can calculate:</p>\n\n<ul>\n<li><p><a href=\"http://www.statsmodels.org/dev/generated/statsmodels.stats.weightstats.DescrStatsW.mean.html#statsmodels.stats.weightstats.DescrStatsW.mean\" rel=\"noreferrer\"><code>.mean</code></a> the <strong>weighted mean</strong>:</p>\n\n<pre><code>&gt;&gt;&gt; weighted_stats.mean      \n1.97196261682243\n</code></pre></li>\n<li><p><a href=\"http://www.statsmodels.org/dev/generated/statsmodels.stats.weightstats.DescrStatsW.std.html#statsmodels.stats.weightstats.DescrStatsW.std\" rel=\"noreferrer\"><code>.std</code></a> the <strong>weighted standard deviation</strong>:</p>\n\n<pre><code>&gt;&gt;&gt; weighted_stats.std       \n0.21434289609681711\n</code></pre></li>\n<li><p><a href=\"http://www.statsmodels.org/dev/generated/statsmodels.stats.weightstats.DescrStatsW.var.html#statsmodels.stats.weightstats.DescrStatsW.var\" rel=\"noreferrer\"><code>.var</code></a> the <strong>weighted variance</strong>:</p>\n\n<pre><code>&gt;&gt;&gt; weighted_stats.var       \n0.045942877107170932\n</code></pre></li>\n<li><p><a href=\"http://www.statsmodels.org/dev/generated/statsmodels.stats.weightstats.DescrStatsW.std_mean.html#statsmodels.stats.weightstats.DescrStatsW.std_mean\" rel=\"noreferrer\"><code>.std_mean</code></a> the <a href=\"https://en.wikipedia.org/wiki/Standard_error\" rel=\"noreferrer\"><strong>standard error</strong></a> of weighted mean:</p>\n\n<pre><code>&gt;&gt;&gt; weighted_stats.std_mean  \n0.020818822467555047\n</code></pre>\n\n<p>Just in case you're interested in the relation between the standard error and the standard deviation: The standard error is (for <code>ddof == 0</code>) calculated as the weighted standard deviation divided by the square root of the sum of the weights minus 1 (<a href=\"https://github.com/statsmodels/statsmodels/blob/v0.9.0/statsmodels/stats/weightstats.py#L214-L224\" rel=\"noreferrer\">corresponding source for <code>statsmodels</code> version 0.9 on GitHub</a>):</p>\n\n<pre><code>standard_error = standard_deviation / sqrt(sum(weights) - 1)\n</code></pre></li>\n</ul>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 10280609,
                                "reputation": 419,
                                "user_id": 10705616,
                                "user_type": "registered",
                                "display_name": "Paidoo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1681326860,
                            "post_id": 47206774,
                            "comment_id": 134040204,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/47206774#comment134040204_47206774",
                            "body": "The origin of the calculation in the final line could do with some explanation."
                        }
                    ],
                    "owner": {
                        "account_id": 12213779,
                        "reputation": 21,
                        "user_id": 8914853,
                        "user_type": "registered",
                        "display_name": "abah"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 2,
                    "last_activity_date": 1712101953,
                    "last_edit_date": 1712101953,
                    "creation_date": 1510244441,
                    "answer_id": 47206774,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/47206774#47206774",
                    "body": "<p>There is a very good example proposed by <a href=\"https://stats.stackexchange.com/users/25538/gaborous\">gaborous</a>:</p>\n<pre><code>import pandas as pd\nimport numpy as np\n# X is the dataset, as a Pandas' DataFrame\n# Compute the weighted sample mean (fast, efficient and precise)\nmean = np.ma.average(X, axis=0, weights=weights) \n\n# Convert to a Pandas' Series (it's just aesthetic and more \n# ergonomic; no difference in computed values)\nmean = pd.Series(mean, index=list(X.keys())) \nxm = X-mean # xm = X diff to mean\n# fill NaN with 0 \n# a variance of 0 is just void, but at least it keeps the other\n# covariance's values computed correctly))\nxm = xm.fillna(0) \n# Compute the unbiased weighted sample covariance\nsigma2 = 1./(w.sum()-1) * xm.mul(w, axis=0).T.dot(xm); \n</code></pre>\n<p><a href=\"https://stats.stackexchange.com/q/61298\">Correct equation for weighted unbiased sample covariance, URL (version: 2016-06-28)</a></p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 12155691,
                                "reputation": 2858,
                                "user_id": 8874696,
                                "user_type": "registered",
                                "display_name": "Itamar Mushkin"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1670931584,
                            "post_id": 52655244,
                            "comment_id": 131982461,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/52655244#comment131982461_52655244",
                            "body": "This is the shortest and most elegant of the given solutions"
                        },
                        {
                            "owner": {
                                "account_id": 18661,
                                "reputation": 93232,
                                "user_id": 42973,
                                "user_type": "registered",
                                "accept_rate": 91,
                                "display_name": "Eric O. Lebigot"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1678613196,
                            "post_id": 52655244,
                            "comment_id": 133564475,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/52655244#comment133564475_52655244",
                            "body": "This is indeed clean. It is worth noting, though, that this solution is restricted to 1D weights and values and is therefore less general than the accepted answer. The two calculations agree, on 1D data, if <code>np.cov</code> is called with <code>ddof=0</code>."
                        }
                    ],
                    "owner": {
                        "account_id": 55972,
                        "reputation": 1255,
                        "user_id": 167694,
                        "user_type": "registered",
                        "display_name": "Leo"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 45,
                    "last_activity_date": 1538687738,
                    "creation_date": 1538687738,
                    "answer_id": 52655244,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/52655244#52655244",
                    "body": "<p>Here's one more option:</p>\n\n<pre><code>np.sqrt(np.cov(values, aweights=weights))\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 18336739,
                                "reputation": 73,
                                "user_id": 13353989,
                                "user_type": "registered",
                                "display_name": "DouglasCoenen"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1634300674,
                            "post_id": 69230684,
                            "comment_id": 122993722,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/69230684#comment122993722_69230684",
                            "body": "Thanks for this nice answer! However, for your second function <code>weighted_sample_avg_std()</code>, on the third line where you have the second part of the variance equation, the variance is not supposed to be multiplied by a ratio of the sums but by a ratio of the number of non-zeros weights (<a href=\"https://www.itl.nist.gov/div898/software/dataplot/refman2/ch2/weightsd.pdf\" rel=\"nofollow noreferrer\">itl.nist.gov/div898/software/dataplot/refman2/ch2/weightsd.&zwnj;&#8203;pdf</a>)."
                        },
                        {
                            "owner": {
                                "account_id": 14882134,
                                "reputation": 414,
                                "user_id": 13697228,
                                "user_type": "registered",
                                "display_name": "Sterling"
                            },
                            "reply_to_user": {
                                "account_id": 18336739,
                                "reputation": 73,
                                "user_id": 13353989,
                                "user_type": "registered",
                                "display_name": "DouglasCoenen"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1639090155,
                            "post_id": 69230684,
                            "comment_id": 124267181,
                            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/69230684#comment124267181_69230684",
                            "body": "Hmm.. that&#39;s a good point. Would you mind suggesting an edit? I looked into this previously (but after you made the comment), but the actual change wasn&#39;t obvious to me."
                        }
                    ],
                    "owner": {
                        "account_id": 14882134,
                        "reputation": 414,
                        "user_id": 13697228,
                        "user_type": "registered",
                        "display_name": "Sterling"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1631925199,
                    "creation_date": 1631925199,
                    "answer_id": 69230684,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/69230684#69230684",
                    "body": "<p>A follow-up to &quot;sample&quot; or &quot;unbiased&quot; standard deviation in the &quot;<a href=\"https://en.wikipedia.org/wiki/Weighted_arithmetic_mean#Frequency_weights\" rel=\"nofollow noreferrer\">frequency weights</a>&quot; sense since &quot;weighted sample standard deviation python&quot; Google search leads to this post:</p>\n<pre class=\"lang-py prettyprint-override\"><code>def frequency_sample_std_dev(X, n):\n    &quot;&quot;&quot;\n    Sample standard deviation for X and n,\n    where X[i] is the quantity each person in group i has,\n    and n[i] is the number of people in group i.\n    See Equation 6.4 of:\n    Montgomery, Douglas, C. and George C. Runger. Applied Statistics \n     and Probability for Engineers, Enhanced eText. Available from: \n      WileyPLUS, (7th Edition). Wiley Global Education US, 2018.\n    &quot;&quot;&quot;\n    n_groups = len(n)\n    n_people = sum(n)\n    lhs_numerator = sum([ni*Xi**2 for Xi, ni in zip(X, n)])\n    rhs_numerator = sum([Xi*ni for Xi, ni in zip(X,n)])**2/n_people\n    denominator = n_people-1\n    var = (lhs_numerator - rhs_numerator) / denominator\n    std = sqrt(var)\n    return std\n</code></pre>\n<p>Or modifying the answer by @Eric as follows:</p>\n<pre class=\"lang-py prettyprint-override\"><code>def weighted_sample_avg_std(values, weights):\n    &quot;&quot;&quot;\n    Return the weighted average and weighted sample standard deviation.\n\n    values, weights -- Numpy ndarrays with the same shape.\n    \n    Assumes that weights contains only integers (e.g. how many samples in each group).\n    \n    See also https://en.wikipedia.org/wiki/Weighted_arithmetic_mean#Frequency_weights\n    &quot;&quot;&quot;\n    average = np.average(values, weights=weights)\n    variance = np.average((values-average)**2, weights=weights)\n    variance = variance*sum(weights)/(sum(weights)-1)\n    return (average, sqrt(variance))\n\nprint(weighted_sample_avg_std(X, n))\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 3087245,
                        "reputation": 2231,
                        "user_id": 2614160,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "Jan"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1667932029,
                    "creation_date": 1667932029,
                    "answer_id": 74365536,
                    "question_id": 2413522,
                    "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy/74365536#74365536",
                    "body": "<p>I was just searching for an API equivalent of the numpy <code>np.std</code> function that also allows the <code>axis</code> parameter to be set:</p>\n<p>(I just tested it with two dimensions, so feel free for improvements if something is incorrect.)</p>\n<pre class=\"lang-py prettyprint-override\"><code>def std(values, weights=None, axis=None):\n    &quot;&quot;&quot;\n    Return the weighted standard deviation.\n    axis -- the axis for std calculation\n    values, weights -- Numpy ndarrays with the same shape on the according axis.\n    &quot;&quot;&quot;\n    average = np.expand_dims(np.average(values, weights=weights, axis=axis), axis=axis)\n    # Fast and numerically precise:\n    variance = np.average((values-average)**2, weights=weights, axis=axis)\n    return np.sqrt(variance)\n</code></pre>\n<p>Thanks to Eric O Lebigot for the <a href=\"https://stackoverflow.com/a/2415343/2614160\">original answer</a>.</p>\n"
                }
            ],
            "owner": {
                "account_id": 22304,
                "reputation": 9838,
                "user_id": 54873,
                "user_type": "registered",
                "accept_rate": 78,
                "display_name": "YGA"
            },
            "comment_count": 2,
            "is_answered": true,
            "accepted_answer_id": 2415343,
            "answer_count": 7,
            "score": 122,
            "last_activity_date": 1712101953,
            "creation_date": 1268178816,
            "last_edit_date": 1544636102,
            "question_id": 2413522,
            "link": "https://stackoverflow.com/questions/2413522/weighted-standard-deviation-in-numpy",
            "title": "Weighted standard deviation in NumPy",
            "body": "<p><code>numpy.average()</code> has a weights option, but <code>numpy.std()</code> does not.  Does anyone have suggestions for a workaround?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7571
}