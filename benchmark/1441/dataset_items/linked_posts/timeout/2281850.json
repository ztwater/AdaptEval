{
    "items": [
        {
            "tags": [
                "python"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 317335,
                        "reputation": 27386,
                        "user_id": 633961,
                        "user_type": "registered",
                        "accept_rate": 66,
                        "display_name": "guettli"
                    },
                    "edited": false,
                    "score": 7,
                    "creation_date": 1493728961,
                    "post_id": 2281850,
                    "comment_id": 74519229,
                    "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish#comment74519229_2281850",
                    "body": "For all lazy people, who love to use libraries instead of copy+pasting code snippets from StackOverflow: <a href=\"https://pypi.python.org/pypi/timeout-decorator\" rel=\"nofollow noreferrer\">pypi.python.org/pypi/timeout-decorator</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 68390,
                                "reputation": 11169,
                                "user_id": 199554,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Wim"
                            },
                            "edited": false,
                            "score": 94,
                            "creation_date": 1266426191,
                            "post_id": 2282656,
                            "comment_id": 2246031,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment2246031_2282656",
                            "body": "Beware that this is not thread-safe: if you&#39;re using multithreading, the signal will get caught by a random thread. For single-threaded programs though, this is the easiest solution."
                        },
                        {
                            "owner": {
                                "account_id": 2398419,
                                "reputation": 63206,
                                "user_id": 2096752,
                                "user_type": "registered",
                                "accept_rate": 79,
                                "display_name": "shx2"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1383249485,
                            "post_id": 2282656,
                            "comment_id": 29289038,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment29289038_2282656",
                            "body": "Nice. Also, it is recommended to decorate the function <code>wrapper</code> with <code>@functools.wraps(func)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 291103,
                                "reputation": 17789,
                                "user_id": 593047,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "ron rothman"
                            },
                            "edited": false,
                            "score": 8,
                            "creation_date": 1395008884,
                            "post_id": 2282656,
                            "comment_id": 34134540,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment34134540_2282656",
                            "body": "FYI, there are missing parens after the first &quot;@timeout&quot;.  It should read <code>@timeout() def ...</code>."
                        },
                        {
                            "owner": {
                                "account_id": 5945102,
                                "reputation": 12386,
                                "user_id": 4674856,
                                "user_type": "registered",
                                "display_name": "flycee"
                            },
                            "reply_to_user": {
                                "account_id": 68390,
                                "reputation": 11169,
                                "user_id": 199554,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Wim"
                            },
                            "edited": false,
                            "score": 6,
                            "creation_date": 1428928008,
                            "post_id": 2282656,
                            "comment_id": 47356119,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment47356119_2282656",
                            "body": "@wim I think it can only be used in main thread, because if you use it in worker thread, it will raise &#39;ValueError: signal only works in main thread&#39;."
                        },
                        {
                            "owner": {
                                "account_id": 1727919,
                                "reputation": 5402,
                                "user_id": 1582182,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "Mmmh mmh"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1447864592,
                            "post_id": 2282656,
                            "comment_id": 55337765,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment55337765_2282656",
                            "body": "Could also use <a href=\"https://docs.python.org/3/library/signal.html#signal.setitimer\" rel=\"nofollow noreferrer\">docs.python.org/3/library/signal.html#signal.setitimer</a> to allow half second timeouts."
                        },
                        {
                            "owner": {
                                "account_id": 1855263,
                                "reputation": 2585,
                                "user_id": 1680996,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "Bertrand Caron"
                            },
                            "reply_to_user": {
                                "account_id": 68390,
                                "reputation": 11169,
                                "user_id": 199554,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "Wim"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1459811866,
                            "post_id": 2282656,
                            "comment_id": 60444473,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment60444473_2282656",
                            "body": "@Wim Could you elaborate on which part is not thread-safe (I imagine something to do with <code>signal</code>) and what side-effects are to be expected ? Also, would you happen to have a threadsafe version ?"
                        },
                        {
                            "owner": {
                                "account_id": 1933047,
                                "reputation": 524,
                                "user_id": 1742048,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "Swoop"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1477443523,
                            "post_id": 2282656,
                            "comment_id": 67766383,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment67766383_2282656",
                            "body": "This works great when the function you&#39;re decorating doesnt take any arguments.  What changes would allow the decorator to be applied to say:  def long_running_function4(my_arg):"
                        },
                        {
                            "owner": {
                                "account_id": 1933047,
                                "reputation": 524,
                                "user_id": 1742048,
                                "user_type": "registered",
                                "accept_rate": 78,
                                "display_name": "Swoop"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1477492857,
                            "post_id": 2282656,
                            "comment_id": 67790855,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment67790855_2282656",
                            "body": "Seems the answer to my question above would be to add empty parenthesis to the decorator as such:  @timeout()"
                        },
                        {
                            "owner": {
                                "account_id": 2121156,
                                "reputation": 5734,
                                "user_id": 1884363,
                                "user_type": "registered",
                                "accept_rate": 69,
                                "display_name": "sudo"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1485623665,
                            "post_id": 2282656,
                            "comment_id": 71006321,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment71006321_2282656",
                            "body": "This is usually working for me, but it occasionally gets stuck on a Jpype call that never returns. Can I do something more forceful like a SIGKILL after 10 seconds?"
                        },
                        {
                            "owner": {
                                "account_id": 9323751,
                                "reputation": 689,
                                "user_id": 6921751,
                                "user_type": "registered",
                                "accept_rate": 70,
                                "display_name": "SaAtomic"
                            },
                            "edited": false,
                            "score": 12,
                            "creation_date": 1488955457,
                            "post_id": 2282656,
                            "comment_id": 72454536,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment72454536_2282656",
                            "body": "What would be a viable alternative for this, when using threads?"
                        },
                        {
                            "owner": {
                                "account_id": 7420808,
                                "reputation": 152,
                                "user_id": 9912116,
                                "user_type": "registered",
                                "display_name": "lightbox142"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1609876873,
                            "post_id": 2282656,
                            "comment_id": 115957754,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment115957754_2282656",
                            "body": "how would you use this inside a method in another class?"
                        },
                        {
                            "owner": {
                                "account_id": 17552327,
                                "reputation": 131,
                                "user_id": 13485850,
                                "user_type": "registered",
                                "display_name": "ddaedalus"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1628773128,
                            "post_id": 2282656,
                            "comment_id": 121514912,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment121514912_2282656",
                            "body": "excellent answer !!!"
                        },
                        {
                            "owner": {
                                "account_id": 3757463,
                                "reputation": 393,
                                "user_id": 3123501,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Liz"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1674412217,
                            "post_id": 2282656,
                            "comment_id": 132704292,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#comment132704292_2282656",
                            "body": "This doesn&#39;t work on Windows"
                        }
                    ],
                    "owner": {
                        "account_id": 27673,
                        "reputation": 5408,
                        "user_id": 73282,
                        "user_type": "registered",
                        "display_name": "David Narayan"
                    },
                    "comment_count": 13,
                    "is_accepted": true,
                    "score": 286,
                    "last_activity_date": 1699466061,
                    "last_edit_date": 1699466061,
                    "creation_date": 1266425775,
                    "answer_id": 2282656,
                    "question_id": 2281850,
                    "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/2282656#2282656",
                    "body": "<p>The process for timing out an operations is described in the documentation for <a href=\"https://docs.python.org/3/library/signal.html\" rel=\"nofollow noreferrer\">signal</a>.</p>\n<p>The basic idea is to use signal handlers to set an alarm for some time interval and raise an exception once that timer expires.</p>\n<p>Note that this will only work on UNIX.</p>\n<p>Here's an implementation that creates a decorator (save the following code as <code>timeout.py</code>).</p>\n<pre><code>import errno\nimport os\nimport signal\nimport functools\n\nclass TimeoutError(Exception):\n    pass\n\ndef timeout(seconds=10, error_message=os.strerror(errno.ETIME)):\n    def decorator(func):\n        def _handle_timeout(signum, frame):\n            raise TimeoutError(error_message)\n\n        @functools.wraps(func)\n        def wrapper(*args, **kwargs):\n            signal.signal(signal.SIGALRM, _handle_timeout)\n            signal.alarm(seconds)\n            try:\n                result = func(*args, **kwargs)\n            finally:\n                signal.alarm(0)\n            return result\n\n        return wrapper\n\n    return decorator\n</code></pre>\n<p>This creates a decorator called <code>@timeout</code> that can be applied to any long running functions.</p>\n<p>So, in your application code, you can use the decorator like so:</p>\n<pre><code>from timeout import timeout\n\n# Timeout a long running function with the default expiry of 10 seconds.\n@timeout\ndef long_running_function1():\n    ...\n\n# Timeout after 5 seconds\n@timeout(5)\ndef long_running_function2():\n    ...\n\n# Timeout after 30 seconds, with the error &quot;Connection timed out&quot;\n@timeout(30, os.strerror(errno.ETIMEDOUT))\ndef long_running_function3():\n    ...\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 58965,
                                "reputation": 34541,
                                "user_id": 380038,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "Framester"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1412241468,
                            "post_id": 22348885,
                            "comment_id": 41006200,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment41006200_22348885",
                            "body": "Python &lt; v3 does not have a TimeoutError. But one can very easily write one own class with like explained here: <a href=\"http://stackoverflow.com/a/1319675/380038\">stackoverflow.com/a/1319675/380038</a>"
                        },
                        {
                            "owner": {
                                "account_id": 3317875,
                                "reputation": 1950,
                                "user_id": 2789762,
                                "user_type": "registered",
                                "accept_rate": 84,
                                "display_name": "Kevin"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1444932598,
                            "post_id": 22348885,
                            "comment_id": 54120056,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment54120056_22348885",
                            "body": "You could easily add in a decorator <code>@timeout.timeout</code> as a static method to this. Then, you could easily choose between a decorator or a <code>with</code> statement."
                        },
                        {
                            "owner": {
                                "account_id": 1980843,
                                "reputation": 562,
                                "user_id": 1777508,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "lucastamoios"
                            },
                            "edited": false,
                            "score": 9,
                            "creation_date": 1477834683,
                            "post_id": 22348885,
                            "comment_id": 67914328,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment67914328_22348885",
                            "body": "Interesting to note that if inside the <code>with Timeout(t)</code> context any error is raised, the <code>__exit__</code> is still called, avoiding, thus, any complication caused by <code>TimeOutError</code> being raised instead of the real error. This is a very lovable solution."
                        },
                        {
                            "owner": {
                                "account_id": 6685462,
                                "reputation": 876,
                                "user_id": 5156887,
                                "user_type": "registered",
                                "display_name": "Nick Crews"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1482027108,
                            "post_id": 22348885,
                            "comment_id": 69609118,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment69609118_22348885",
                            "body": "This is giving me an error if I try to give it a non-integer amount of seconds. Is there a way to make it so it works for floats?"
                        },
                        {
                            "owner": {
                                "account_id": 71043,
                                "reputation": 31266,
                                "user_id": 205521,
                                "user_type": "registered",
                                "accept_rate": 89,
                                "display_name": "Thomas Ahle"
                            },
                            "reply_to_user": {
                                "account_id": 6685462,
                                "reputation": 876,
                                "user_id": 5156887,
                                "user_type": "registered",
                                "display_name": "Nick Crews"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1482052338,
                            "post_id": 22348885,
                            "comment_id": 69612860,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment69612860_22348885",
                            "body": "@Nick what about <a href=\"https://docs.python.org/3/library/signal.html#signal.setitimer\" rel=\"nofollow noreferrer\">docs.python.org/3/library/signal.html#signal.setitimer</a>"
                        },
                        {
                            "owner": {
                                "account_id": 9323751,
                                "reputation": 689,
                                "user_id": 6921751,
                                "user_type": "registered",
                                "accept_rate": 70,
                                "display_name": "SaAtomic"
                            },
                            "edited": false,
                            "score": 31,
                            "creation_date": 1488955581,
                            "post_id": 22348885,
                            "comment_id": 72454590,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment72454590_22348885",
                            "body": "Can someone recommend a viable solution that, like this, that works in threads?"
                        },
                        {
                            "owner": {
                                "account_id": 1591640,
                                "reputation": 3469,
                                "user_id": 1474847,
                                "user_type": "registered",
                                "accept_rate": 71,
                                "display_name": "Jendas"
                            },
                            "reply_to_user": {
                                "account_id": 6685462,
                                "reputation": 876,
                                "user_id": 5156887,
                                "user_type": "registered",
                                "display_name": "Nick Crews"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1489423232,
                            "post_id": 22348885,
                            "comment_id": 72653304,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment72653304_22348885",
                            "body": "@Nick Some time ago I created version of timeout decorator, that works with floats - <a href=\"http://stackoverflow.com/questions/11901328/how-to-timeout-function-in-python-timeout-less-than-a-second/11901541#11901541\" title=\"how to timeout function in python timeout less than a second\">stackoverflow.com/questions/11901328/&hellip;</a>"
                        },
                        {
                            "owner": {
                                "account_id": 172084,
                                "reputation": 253,
                                "user_id": 399894,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "Brij"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1499329656,
                            "post_id": 22348885,
                            "comment_id": 76862717,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment76862717_22348885",
                            "body": "This does not work if the function is catching generic exception,  ` def bad_func():             try:                 time.sleep(100)             except Exception:                 pass `"
                        },
                        {
                            "owner": {
                                "account_id": 2531675,
                                "reputation": 24405,
                                "user_id": 2199852,
                                "user_type": "registered",
                                "accept_rate": 67,
                                "display_name": "User"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1552532162,
                            "post_id": 22348885,
                            "comment_id": 97048625,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment97048625_22348885",
                            "body": "Only issue is: <code>signal only works in main thread</code>"
                        },
                        {
                            "owner": {
                                "account_id": 12355618,
                                "reputation": 304,
                                "user_id": 9012126,
                                "user_type": "registered",
                                "display_name": "szdrnja"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1581953493,
                            "post_id": 22348885,
                            "comment_id": 106600089,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment106600089_22348885",
                            "body": "I suggest using <a href=\"https://docs.python.org/3/library/signal.html#signal.setitimer\" rel=\"nofollow noreferrer\"><code>signal.settimer</code></a> over <code>signal.alarm</code> for the added resolution. With this implementation shortest timeout is 1 second."
                        },
                        {
                            "owner": {
                                "account_id": 6467750,
                                "reputation": 488,
                                "user_id": 5009004,
                                "user_type": "registered",
                                "accept_rate": 22,
                                "display_name": "whenitrains"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1683499352,
                            "post_id": 22348885,
                            "comment_id": 134372171,
                            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#comment134372171_22348885",
                            "body": "Same thread issue: signal only works in main thread of the main interpreter"
                        }
                    ],
                    "owner": {
                        "account_id": 71043,
                        "reputation": 31266,
                        "user_id": 205521,
                        "user_type": "registered",
                        "accept_rate": 89,
                        "display_name": "Thomas Ahle"
                    },
                    "comment_count": 11,
                    "is_accepted": false,
                    "score": 203,
                    "last_activity_date": 1475772168,
                    "last_edit_date": 1475772168,
                    "creation_date": 1394620806,
                    "answer_id": 22348885,
                    "question_id": 2281850,
                    "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish/22348885#22348885",
                    "body": "<p>I rewrote David's answer using the <code>with</code> statement, it allows you do do this:</p>\n\n<pre><code>with timeout(seconds=3):\n    time.sleep(4)\n</code></pre>\n\n<p>Which will raise a TimeoutError.</p>\n\n<p>The code is still using <code>signal</code> and thus UNIX only:</p>\n\n<pre><code>import signal\n\nclass timeout:\n    def __init__(self, seconds=1, error_message='Timeout'):\n        self.seconds = seconds\n        self.error_message = error_message\n    def handle_timeout(self, signum, frame):\n        raise TimeoutError(self.error_message)\n    def __enter__(self):\n        signal.signal(signal.SIGALRM, self.handle_timeout)\n        signal.alarm(self.seconds)\n    def __exit__(self, type, value, traceback):\n        signal.alarm(0)\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 53691,
                "reputation": 26055,
                "user_id": 160574,
                "user_type": "registered",
                "accept_rate": 85,
                "display_name": "Christoffer"
            },
            "comment_count": 1,
            "is_answered": true,
            "closed_date": 1423912118,
            "accepted_answer_id": 2282656,
            "answer_count": 2,
            "score": 177,
            "last_activity_date": 1699466061,
            "creation_date": 1266420108,
            "last_edit_date": 1438744405,
            "question_id": 2281850,
            "link": "https://stackoverflow.com/questions/2281850/timeout-function-if-it-takes-too-long-to-finish",
            "closed_reason": "Duplicate",
            "title": "Timeout function if it takes too long to finish",
            "body": "<p>I have a shell script that loops through a text file containing URL:s that I want to visit and take screenshots of.</p>\n\n<p>All this is done and simple. The script initializes a class that when run creates a screenshot of each site in the list. Some sites take a very, very long time to load, and some might not be loaded at all. So I want to wrap the screengrabber-function in a timeout script, making the function return <code>False</code> if it couldn't finish within 10 seconds.</p>\n\n<p>I'm content with the simplest solution possible, maybe setting a asynchronous timer that will return False after 10 seconds no matter what actually happens inside the function?</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 7260
}