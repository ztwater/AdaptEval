{
    "items": [
        {
            "tags": [
                "python",
                "geometry",
                "computational-geometry"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 1263942,
                        "reputation": 10042,
                        "user_id": 1221660,
                        "user_type": "registered",
                        "accept_rate": 54,
                        "display_name": "Emanuele Paolini"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1434370970,
                    "post_id": 30844482,
                    "comment_id": 49733566,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment49733566_30844482",
                    "body": "seems to me that you consider the intersections of the circle with the whole line, not only the line segment between the two given points. Is this what you want?"
                },
                {
                    "owner": {
                        "account_id": 877121,
                        "reputation": 6365,
                        "user_id": 84308,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "deets"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1434373339,
                    "post_id": 30844482,
                    "comment_id": 49735263,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment49735263_30844482",
                    "body": "The only possible optimisation I can think of involves the use of some kind of spatial partition. E.g. a quad-tree. But there is non-trivial cost associated in computing these, so it depends on your larger problem if that&#39;s useful or not."
                },
                {
                    "owner": {
                        "account_id": 5094352,
                        "reputation": 945,
                        "user_id": 4924585,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "xibinke"
                    },
                    "reply_to_user": {
                        "account_id": 1263942,
                        "reputation": 10042,
                        "user_id": 1221660,
                        "user_type": "registered",
                        "accept_rate": 54,
                        "display_name": "Emanuele Paolini"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1434376335,
                    "post_id": 30844482,
                    "comment_id": 49737482,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment49737482_30844482",
                    "body": "@EmanuelePaolini,Thank you.I&#39;ve modified the script according to your concern."
                },
                {
                    "owner": {
                        "account_id": 1152185,
                        "reputation": 4165,
                        "user_id": 1133649,
                        "user_type": "registered",
                        "accept_rate": 75,
                        "display_name": "Roman Susi"
                    },
                    "edited": false,
                    "score": 1,
                    "creation_date": 1434376807,
                    "post_id": 30844482,
                    "comment_id": 49737818,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment49737818_30844482",
                    "body": "<a href=\"http://stackoverflow.com/questions/1073336/circle-line-segment-collision-detection-algorithm\" title=\"circle line segment collision detection algorithm\">stackoverflow.com/questions/1073336/&hellip;</a> - may be relevant"
                },
                {
                    "owner": {
                        "account_id": 4599139,
                        "reputation": 31464,
                        "user_id": 3730397,
                        "user_type": "registered",
                        "accept_rate": 73,
                        "display_name": "firelynx"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1435667689,
                    "post_id": 30844482,
                    "comment_id": 50287305,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment50287305_30844482",
                    "body": "Are there still any open issues not answered by any of the answers posted?"
                },
                {
                    "owner": {
                        "account_id": 3069690,
                        "reputation": 101,
                        "user_id": 2600676,
                        "user_type": "registered",
                        "display_name": "Alexandre Frias"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1635950886,
                    "post_id": 30844482,
                    "comment_id": 123429249,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py#comment123429249_30844482",
                    "body": "You need to fix the variable &quot;esp&quot; in the line 5. I assume it is &quot;lep&quot; as the input function."
                }
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1263942,
                        "reputation": 10042,
                        "user_id": 1221660,
                        "user_type": "registered",
                        "accept_rate": 54,
                        "display_name": "Emanuele Paolini"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1434379969,
                    "creation_date": 1434379969,
                    "answer_id": 30848321,
                    "question_id": 30844482,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30848321#30848321",
                    "body": "<p>I think that the formula you use to find the coordinates of the two intersections cannot be optimized further. The only improvement (which is numerically important) is to distinguish the two cases: <code>|x_2-x_1| &gt;= |y_2-y_1|</code> and <code>|x_2-x1| &lt; |y_2-y1|</code> so that the quantity <code>k</code> is always between -1 and 1 (in your computation you can get very high numerical errors if |x_2-x_1| is very small). You can swap x-s and y-s to reduce one case to the other.</p>\n\n<p>You could also implement a preliminary check: if both endpoints are internal to the circle there are no intersection. By computing the squared distance from the points to the center of the circle this becomes a simple formula which does not use the square root function. The other check: \"whether the line is outside the circle\" is already implemented in your code and corresponds to delta &lt; 0. If you have a lot of small segments these two check should give a shortcut answer (no intersection) in most cases.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 58364,
                        "reputation": 299717,
                        "user_id": 174728,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "John La Rooy"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1434445804,
                    "creation_date": 1434445804,
                    "answer_id": 30863290,
                    "question_id": 30844482,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30863290#30863290",
                    "body": "<p>A low cost spacial partition might be to divide the plane into 9 pieces</p>\n\n<p>Here is a crappy diagram. Imagine, if you will, that the lines are just touching the circle.</p>\n\n<pre>\n  | |\n__|_|__\n__|O|__\n  | |\n  | |\n</pre>\n\n<p>8 of the areas we are interested in are surrounding the circle. The square in the centre isn't much use for a cheap test, but you can place a square of <code>r/sqrt(2)</code> inside the circle, so it's corners just touch the circle.</p>\n\n<p>Lets label the areas</p>\n\n<pre>\nA |B| C\n__|_|__\nD_|O|_E\n  | |\nF |G| H\n</pre>\n\n<p>And the square of <code>r/sqrt(2)</code> in the centre we'll call <code>J</code></p>\n\n<p>We will call the set of points in the centre square shown in the diagram that aren't in <code>J</code>, <code>Z</code></p>\n\n<p>Label each vertex of the polygon with it's letter code.</p>\n\n<p>Now we can quickly see </p>\n\n<pre>\nAA => Outside\nAB => Outside\nAC => Outside\n...\nAJ => Intersects\nBJ => Intersects\n...\nJJ => Inside\n</pre>\n\n<p>This can turned into a lookup table</p>\n\n<p>So depending on your dataset, you may have saved yourself a load of work. Anything with an endpoint in <code>Z</code> will need to be tested however.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 5094352,
                                "reputation": 945,
                                "user_id": 4924585,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "xibinke"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1435763415,
                            "post_id": 30998492,
                            "comment_id": 50338566,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment50338566_30998492",
                            "body": "Yeah...What about the efficiency of calculate the intersection by the library like Shapely or SymPy, compared to define function myself? That&#39;s one of what I want to know."
                        },
                        {
                            "owner": {
                                "account_id": 4599139,
                                "reputation": 31464,
                                "user_id": 3730397,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "firelynx"
                            },
                            "reply_to_user": {
                                "account_id": 5094352,
                                "reputation": 945,
                                "user_id": 4924585,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "xibinke"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1435765455,
                            "post_id": 30998492,
                            "comment_id": 50339967,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment50339967_30998492",
                            "body": "Shapely is based on GEOS (<a href=\"http://trac.osgeo.org/geos/\" rel=\"nofollow noreferrer\">trac.osgeo.org/geos</a>) which is built in C++ and considerably faster than anything you write natively in python. SymPy seems to be based on mpmath (<a href=\"http://mpmath.org/\" rel=\"nofollow noreferrer\">mpmath.org</a>) which also seems to be python, but seems to have lots of quite complex math integrated into it. Implementing that yourself may require a lot of work, and will probably not be as fast as GEOS C++ implementations."
                        },
                        {
                            "owner": {
                                "account_id": 147068,
                                "reputation": 1181,
                                "user_id": 357931,
                                "user_type": "registered",
                                "display_name": "albrnick"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1602265893,
                            "post_id": 30998492,
                            "comment_id": 113676604,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment113676604_30998492",
                            "body": "Sometimes this returns just a single Point, and sometimes MultiplePoints. How can I test the return value to know which is which?"
                        },
                        {
                            "owner": {
                                "account_id": 4599139,
                                "reputation": 31464,
                                "user_id": 3730397,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "firelynx"
                            },
                            "reply_to_user": {
                                "account_id": 147068,
                                "reputation": 1181,
                                "user_id": 357931,
                                "user_type": "registered",
                                "display_name": "albrnick"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1603874754,
                            "post_id": 30998492,
                            "comment_id": 114171383,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment114171383_30998492",
                            "body": "@albrnick a straight line can intersect a circle 0-2 times. This is why you get sometimes a single point or a multipoint. It would be pythonic to assume single and if you get an exception you fallback to multi. But I don&#39;t know what you want to test."
                        },
                        {
                            "owner": {
                                "account_id": 147068,
                                "reputation": 1181,
                                "user_id": 357931,
                                "user_type": "registered",
                                "display_name": "albrnick"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1603982085,
                            "post_id": 30998492,
                            "comment_id": 114212780,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment114212780_30998492",
                            "body": "I was looking to see how to detect which I get. Turns out I can do an isinstance() to check the class. (I was hoping for a method on the object proper)"
                        },
                        {
                            "owner": {
                                "account_id": 4599139,
                                "reputation": 31464,
                                "user_id": 3730397,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "firelynx"
                            },
                            "reply_to_user": {
                                "account_id": 147068,
                                "reputation": 1181,
                                "user_id": 357931,
                                "user_type": "registered",
                                "display_name": "albrnick"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1604048584,
                            "post_id": 30998492,
                            "comment_id": 114233835,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment114233835_30998492",
                            "body": "@albrnick I think you can always instantiate it as a multipoint and treat it as a multipoint. just take the result and hand it to <code>MultiPoint(result)</code>"
                        },
                        {
                            "owner": {
                                "account_id": 11259074,
                                "reputation": 132,
                                "user_id": 11497669,
                                "user_type": "registered",
                                "display_name": "yash"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1626606214,
                            "post_id": 30998492,
                            "comment_id": 120933233,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment120933233_30998492",
                            "body": "If I change the first point of the LineString to (6,5) or (5,5), the output  gives an error stating that the&quot; &#39;Point&#39; object has no attribute &#39;geoms&#39; &quot; . Does it mean that the line must start and end outside the circle? Could you please elaborate?"
                        },
                        {
                            "owner": {
                                "account_id": 12615438,
                                "reputation": 3633,
                                "user_id": 9173068,
                                "user_type": "registered",
                                "display_name": "Bernhard Jaeger"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1682104458,
                            "post_id": 30998492,
                            "comment_id": 134168766,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment134168766_30998492",
                            "body": "Since somebody in the comments asked: I benchmarked the python function proposed by Peter below with the shapely library as proposed in this answer  python 0.000019 seconds. shapely 0.000101 seconds.  The native python implementation is 5 times faster on my computer. This is primarily due to the overhead of creating the shapely objects (~70 mu) but the raw intersection computation is still ~15 mu faster in python."
                        },
                        {
                            "owner": {
                                "account_id": 4599139,
                                "reputation": 31464,
                                "user_id": 3730397,
                                "user_type": "registered",
                                "accept_rate": 73,
                                "display_name": "firelynx"
                            },
                            "reply_to_user": {
                                "account_id": 12615438,
                                "reputation": 3633,
                                "user_id": 9173068,
                                "user_type": "registered",
                                "display_name": "Bernhard Jaeger"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1682522600,
                            "post_id": 30998492,
                            "comment_id": 134230284,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#comment134230284_30998492",
                            "body": "@BernhardJaeger Thanks for checking and providing us with your findings. I think it should be noted that creating the shapely objects can be done once, then you can reuse them to check intersection many times, at which point, using shapely will be faster. But for a one time check, native python can be faster. There are usually many edge cases in geometric math that needs to be accounted for."
                        }
                    ],
                    "owner": {
                        "account_id": 4599139,
                        "reputation": 31464,
                        "user_id": 3730397,
                        "user_type": "registered",
                        "accept_rate": 73,
                        "display_name": "firelynx"
                    },
                    "comment_count": 9,
                    "is_accepted": true,
                    "score": 22,
                    "last_activity_date": 1436035719,
                    "last_edit_date": 1495542590,
                    "creation_date": 1435050502,
                    "answer_id": 30998492,
                    "question_id": 30844482,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/30998492#30998492",
                    "body": "<p>I guess maybe your question is about how to in theory do this in the fastest manner. But if you want to do this quickly, you should really use something which is written in C/C++.</p>\n\n<p>I am quite used to <a href=\"http://toblerity.org/shapely/manual.html\" rel=\"noreferrer\">Shapely</a>, so I will provide an example of how to do this with this library. There are many geometry libraries for python. I will list them at the end of this answer.</p>\n\n<pre><code>from shapely.geometry import LineString\nfrom shapely.geometry import Point\n\np = Point(5,5)\nc = p.buffer(3).boundary\nl = LineString([(0,0), (10, 10)])\ni = c.intersection(l)\n\nprint i.geoms[0].coords[0]\n(2.8786796564403576, 2.8786796564403576)\n\nprint i.geoms[1].coords[0]\n(7.121320343559642, 7.121320343559642)\n</code></pre>\n\n<p>What is a little bit counter intuitive in Shapely is that circles are the boundries of points with buffer areas. This is why I do <code>p.buffer(3).boundry</code></p>\n\n<p>Also the intersection <code>i</code> is a list of geometric shapes, both of them points in this case, this is why I have to get both of them from <code>i.geoms[]</code></p>\n\n<p>There is <a href=\"https://stackoverflow.com/questions/1076778/good-geometry-library-in-python\">another Stackoverflow question</a> which goes into details about these libraries for those interested.</p>\n\n<ul>\n<li><a href=\"http://www.sympy.org/en/index.html\" rel=\"noreferrer\">SymPy</a></li>\n<li><a href=\"http://cgal-python.gforge.inria.fr/\" rel=\"noreferrer\">CGAL Python bindings</a></li>\n<li><a href=\"http://code.google.com/p/pyeuclid/\" rel=\"noreferrer\">PyEuclid</a></li>\n<li><a href=\"http://www.pythonocc.org/\" rel=\"noreferrer\">PythonOCC</a></li>\n<li><a href=\"http://code.google.com/p/geometry-simple/\" rel=\"noreferrer\">Geometry-simple</a></li>\n</ul>\n\n<p>EDIT because comments:</p>\n\n<p>Shapely is based on GEOS (trac.osgeo.org/geos) which is built in C++ and considerably faster than anything you write natively in python. SymPy seems to be based on mpmath (mpmath.org) which also seems to be python, but seems to have lots of quite complex math integrated into it. Implementing that yourself may require a lot of work, and will probably not be as fast as GEOS C++ implementations.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 462262,
                                "reputation": 1230,
                                "user_id": 864490,
                                "user_type": "registered",
                                "accept_rate": 39,
                                "display_name": "Jason Boyd"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1683495588,
                            "post_id": 59582674,
                            "comment_id": 134371870,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment134371870_59582674",
                            "body": "I haven&#39;t tried running this code, but in the first line where it&#39;s actually computing intersections, am I nuts or are you multiplying &quot;sign&quot; (defined here as the negative of the actual sign of dy) by the actual sign of dy? In which case, these always reduce to -1, and the value of dy is never included as on the Wolfram page giving the equation.   There&#39;s a bit too much logical flipping here for me to read this clearly, would be nice if it were expanded for clarity rather than using a clever list comprehension. Sorting the returned points could be left to the reader to do."
                        },
                        {
                            "owner": {
                                "account_id": 454252,
                                "reputation": 12944,
                                "user_id": 851699,
                                "user_type": "registered",
                                "accept_rate": 41,
                                "display_name": "Peter"
                            },
                            "reply_to_user": {
                                "account_id": 462262,
                                "reputation": 1230,
                                "user_id": 864490,
                                "user_type": "registered",
                                "accept_rate": 39,
                                "display_name": "Jason Boyd"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1683580877,
                            "post_id": 59582674,
                            "comment_id": 134385841,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment134385841_59582674",
                            "body": "Yeah something definitely looks fishy there, what was he thinking?..."
                        },
                        {
                            "owner": {
                                "account_id": 462262,
                                "reputation": 1230,
                                "user_id": 864490,
                                "user_type": "registered",
                                "accept_rate": 39,
                                "display_name": "Jason Boyd"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1683645335,
                            "post_id": 59582674,
                            "comment_id": 134396617,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment134396617_59582674",
                            "body": "Well, this code works. I ported it to Javascript, and it works. My problem is, I can&#39;t reason geometrically about it as I don&#39;t understand what all the variables represent, so for instance I can&#39;t understand the relation between sign of dy and the solutions to find the intersection points. I hate having code that works that I can&#39;t comprehend..."
                        },
                        {
                            "owner": {
                                "account_id": 454252,
                                "reputation": 12944,
                                "user_id": 851699,
                                "user_type": "registered",
                                "accept_rate": 41,
                                "display_name": "Peter"
                            },
                            "reply_to_user": {
                                "account_id": 462262,
                                "reputation": 1230,
                                "user_id": 864490,
                                "user_type": "registered",
                                "accept_rate": 39,
                                "display_name": "Jason Boyd"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1683655233,
                            "post_id": 59582674,
                            "comment_id": 134399044,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment134399044_59582674",
                            "body": "I think the author was attempting to make it so the intersections would be ordered according to their position along the line segment (so that the first would be closer to pt1), but they made the change in two places instead of one, so it will have zero effect.  I suspect you can just remove the ` * (-1 if dy &lt; 0 else 1)`"
                        },
                        {
                            "owner": {
                                "account_id": 462262,
                                "reputation": 1230,
                                "user_id": 864490,
                                "user_type": "registered",
                                "accept_rate": 39,
                                "display_name": "Jason Boyd"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1683657962,
                            "post_id": 59582674,
                            "comment_id": 134399621,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment134399621_59582674",
                            "body": "As I grok it, the (-1 if dy &lt; 0 else 1) is the <i>actual</i> sign(x) function. What he names &quot;sign&quot;, I renamed plusMinus. His code works because the plusMinus does two passes on the equations, to produce the +/- of the quadratic formula it&#39;s derived from. What I don&#39;t get is how one figures out the relation between the +/- in the x coord to the +/- in the y coord, since we want 2 solutions, not 2*2 solutions. The author gets this but doesn&#39;t explain the reasoning. He&#39;s checking the sign of dy in the list comprehension, both to sort the result points but also to ensure this relation."
                        },
                        {
                            "owner": {
                                "account_id": 342528,
                                "reputation": 3426,
                                "user_id": 673726,
                                "user_type": "registered",
                                "accept_rate": 98,
                                "display_name": "Joel"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1698071681,
                            "post_id": 59582674,
                            "comment_id": 136355473,
                            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#comment136355473_59582674",
                            "body": "Very useful, thanks. I had the link with the formula, but as a mere computer programmer, i found it hard to put into code. Your code is very useful."
                        }
                    ],
                    "owner": {
                        "account_id": 454252,
                        "reputation": 12944,
                        "user_id": 851699,
                        "user_type": "registered",
                        "accept_rate": 41,
                        "display_name": "Peter"
                    },
                    "comment_count": 6,
                    "is_accepted": false,
                    "score": 13,
                    "last_activity_date": 1578071769,
                    "creation_date": 1578071769,
                    "answer_id": 59582674,
                    "question_id": 30844482,
                    "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py/59582674#59582674",
                    "body": "<p>Here's a solution that computes the intersection of a circle with either a line or a line segment defined by two (x, y) points:</p>\n\n<pre><code>def circle_line_segment_intersection(circle_center, circle_radius, pt1, pt2, full_line=True, tangent_tol=1e-9):\n    \"\"\" Find the points at which a circle intersects a line-segment.  This can happen at 0, 1, or 2 points.\n\n    :param circle_center: The (x, y) location of the circle center\n    :param circle_radius: The radius of the circle\n    :param pt1: The (x, y) location of the first point of the segment\n    :param pt2: The (x, y) location of the second point of the segment\n    :param full_line: True to find intersections along full line - not just in the segment.  False will just return intersections within the segment.\n    :param tangent_tol: Numerical tolerance at which we decide the intersections are close enough to consider it a tangent\n    :return Sequence[Tuple[float, float]]: A list of length 0, 1, or 2, where each element is a point at which the circle intercepts a line segment.\n\n    Note: We follow: http://mathworld.wolfram.com/Circle-LineIntersection.html\n    \"\"\"\n\n    (p1x, p1y), (p2x, p2y), (cx, cy) = pt1, pt2, circle_center\n    (x1, y1), (x2, y2) = (p1x - cx, p1y - cy), (p2x - cx, p2y - cy)\n    dx, dy = (x2 - x1), (y2 - y1)\n    dr = (dx ** 2 + dy ** 2)**.5\n    big_d = x1 * y2 - x2 * y1\n    discriminant = circle_radius ** 2 * dr ** 2 - big_d ** 2\n\n    if discriminant &lt; 0:  # No intersection between circle and line\n        return []\n    else:  # There may be 0, 1, or 2 intersections with the segment\n        intersections = [\n            (cx + (big_d * dy + sign * (-1 if dy &lt; 0 else 1) * dx * discriminant**.5) / dr ** 2,\n             cy + (-big_d * dx + sign * abs(dy) * discriminant**.5) / dr ** 2)\n            for sign in ((1, -1) if dy &lt; 0 else (-1, 1))]  # This makes sure the order along the segment is correct\n        if not full_line:  # If only considering the segment, filter out intersections that do not fall within the segment\n            fraction_along_segment = [(xi - p1x) / dx if abs(dx) &gt; abs(dy) else (yi - p1y) / dy for xi, yi in intersections]\n            intersections = [pt for pt, frac in zip(intersections, fraction_along_segment) if 0 &lt;= frac &lt;= 1]\n        if len(intersections) == 2 and abs(discriminant) &lt;= tangent_tol:  # If line is tangent to circle, return just one point (as both intersections have same location)\n            return [intersections[0]]\n        else:\n            return intersections\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 5094352,
                "reputation": 945,
                "user_id": 4924585,
                "user_type": "registered",
                "accept_rate": 100,
                "display_name": "xibinke"
            },
            "comment_count": 6,
            "is_answered": true,
            "accepted_answer_id": 30998492,
            "answer_count": 4,
            "score": 28,
            "last_activity_date": 1578071769,
            "creation_date": 1434369081,
            "last_edit_date": 1435763193,
            "question_id": 30844482,
            "link": "https://stackoverflow.com/questions/30844482/what-is-most-efficient-way-to-find-the-intersection-of-a-line-and-a-circle-in-py",
            "title": "What is most efficient way to find the intersection of a line and a circle in python?",
            "body": "<p>I have a polygon consists of lots of points. I want to find the intersection of the polygon and a circle. Providing the circle center of [x0,y0] and radius of r0, I have wrote a rough function to simply solve the quadratic equation of the circle and a line. But what about the efficiency of find the intersection of every line segment of the polygon one by one? <strong>Is there more efficient way?</strong> </p>\n\n<p>I know sympy already provide the feature to get the intersections of different geometry. But also <strong>what about the efficiency of external library like sympy compared to calculate it by my own function</strong>, if I want to deal with lots of polygons?</p>\n\n<pre><code>def LineIntersectCircle(p,lsp,lep):\n# p is the circle parameter, lsp and lep is the two end of the line\n  x0,y0,r0 = p\n  x1,y1 = lsp\n  x2,y2 = esp\n  if x1 == x2:\n    if abs(r0) &gt;= abs(x1 - x0):\n        p1 = x1, y0 - sqrt(r0**2 - (x1-x0)**2)\n        p2 = x1, y0 + sqrt(r0**2 - (x1-x0)**2)\n        inp = [p1,p2]\n        # select the points lie on the line segment\n        inp = [p for p in inp if p[1]&gt;=min(y1,y2) and p[1]&lt;=max(y1,y2)]\n    else:\n        inp = []\n  else:\n    k = (y1 - y2)/(x1 - x2)\n    b0 = y1 - k*x1\n    a = k**2 + 1\n    b = 2*k*(b0 - y0) - 2*x0\n    c = (b0 - y0)**2 + x0**2 - r0**2\n    delta = b**2 - 4*a*c\n    if delta &gt;= 0:\n        p1x = (-b - sqrt(delta))/(2*a)\n        p2x = (-b + sqrt(delta))/(2*a)\n        p1y = k*x1 + b0\n        p2y = k*x2 + b0\n        inp = [[p1x,p1y],[p2x,p2y]]\n        # select the points lie on the line segment\n        inp = [p for p in inp if p[0]&gt;=min(x1,x2) and p[0]&lt;=max(x1,x2)]\n    else:\n        inp = []\n  return inp\n</code></pre>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 8045
}