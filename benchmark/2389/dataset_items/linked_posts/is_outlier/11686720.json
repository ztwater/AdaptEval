{
    "items": [
        {
            "tags": [
                "python",
                "numpy"
            ],
            "comments": [
                {
                    "owner": {
                        "account_id": 104636,
                        "reputation": 589403,
                        "user_id": 279627,
                        "user_type": "registered",
                        "accept_rate": 82,
                        "display_name": "Sven Marnach"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1343388172,
                    "post_id": 11686720,
                    "comment_id": 15494574,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list#comment15494574_11686720",
                    "body": "Related: <a href=\"http://stackoverflow.com/questions/10231206/can-scipy-stats-identify-and-mask-obvious-outliers\">Can scipy.stats identify and mask obvious outliers?</a>, though that question seems to deal with more complex situations.  For the simple task you described, an external package seems to be overkill."
                },
                {
                    "owner": {
                        "account_id": 1182444,
                        "reputation": 5505,
                        "user_id": 1157089,
                        "user_type": "registered",
                        "accept_rate": 71,
                        "display_name": "aaren"
                    },
                    "reply_to_user": {
                        "account_id": 104636,
                        "reputation": 589403,
                        "user_id": 279627,
                        "user_type": "registered",
                        "accept_rate": 82,
                        "display_name": "Sven Marnach"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1343391006,
                    "post_id": 11686720,
                    "comment_id": 15495741,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list#comment15495741_11686720",
                    "body": "I was thinking that given the number of builtins in the main numpy library it was strange that there was nothing to do this. It seems like quite a common thing to do with raw, noisy data."
                },
                {
                    "owner": {
                        "account_id": 16132321,
                        "reputation": 2903,
                        "user_id": 11645617,
                        "user_type": "registered",
                        "display_name": "Weilory"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1605853898,
                    "post_id": 11686720,
                    "comment_id": 114785064,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list#comment114785064_11686720",
                    "body": "Linear outliers can be found by <code>numpy std</code> function, however, if the data is non-linear, for example, a parabola or cubic function, <code>standard deviation</code> will not handle the task well, since it needs regression to help working out the outliers."
                },
                {
                    "owner": {
                        "account_id": 16132321,
                        "reputation": 2903,
                        "user_id": 11645617,
                        "user_type": "registered",
                        "display_name": "Weilory"
                    },
                    "edited": false,
                    "score": 0,
                    "creation_date": 1605853924,
                    "post_id": 11686720,
                    "comment_id": 114785070,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list#comment114785070_11686720",
                    "body": "That&#39;s why I coded this repo: <a href=\"https://github.com/Weilory/python-outliers\" rel=\"nofollow noreferrer\">outliers.py</a>"
                }
            ],
            "answers": [
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 59120,
                                "reputation": 57347,
                                "user_id": 176922,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "Benjamin Bannier"
                            },
                            "edited": false,
                            "score": 5,
                            "creation_date": 1368611606,
                            "post_id": 11686764,
                            "comment_id": 23794428,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment23794428_11686764",
                            "body": "That method works good enough if <code>m</code> is sufficiently large (e.g. <code>m=6</code>), but for small values of <code>m</code> this suffers from the mean the variance not being robust estimators."
                        },
                        {
                            "owner": {
                                "account_id": 303988,
                                "reputation": 10659,
                                "user_id": 613246,
                                "user_type": "registered",
                                "accept_rate": 57,
                                "display_name": "Eelco Hoogendoorn"
                            },
                            "edited": false,
                            "score": 35,
                            "creation_date": 1408092514,
                            "post_id": 11686764,
                            "comment_id": 39475402,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment39475402_11686764",
                            "body": "that isn&#39;t really a complaint about the method though, but a complaint about the vague notion of an &#39;outlier&#39;"
                        },
                        {
                            "owner": {
                                "account_id": 170035,
                                "reputation": 6524,
                                "user_id": 396483,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "john k"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1505599855,
                            "post_id": 11686764,
                            "comment_id": 79481347,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment79481347_11686764",
                            "body": "how do you choose an m?"
                        },
                        {
                            "owner": {
                                "account_id": 170035,
                                "reputation": 6524,
                                "user_id": 396483,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "john k"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1505600805,
                            "post_id": 11686764,
                            "comment_id": 79481553,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment79481553_11686764",
                            "body": "I have not gotten this to work.  I keep getting an error     return data[abs(data - np.mean(data)) &lt; m * np.std(data)] TypeError: only integer scalar arrays can be converted to a scalar index OR it just freezes my program"
                        },
                        {
                            "owner": {
                                "account_id": 915438,
                                "reputation": 2983,
                                "user_id": 948323,
                                "user_type": "registered",
                                "accept_rate": 90,
                                "display_name": "Sander van Leeuwen"
                            },
                            "reply_to_user": {
                                "account_id": 170035,
                                "reputation": 6524,
                                "user_id": 396483,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "john k"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1512488810,
                            "post_id": 11686764,
                            "comment_id": 82273440,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment82273440_11686764",
                            "body": "@johnktejik data arg needs to be a numpy array."
                        },
                        {
                            "owner": {
                                "account_id": 1898040,
                                "reputation": 566,
                                "user_id": 1714538,
                                "user_type": "registered",
                                "accept_rate": 50,
                                "display_name": "lorenzo"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1525438554,
                            "post_id": 11686764,
                            "comment_id": 87367959,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment87367959_11686764",
                            "body": "@eumiro I think you need &lt;= to handle the case where all data have the same value. Adding a small epsilon on the right side of the equation should make it more robust for similar cases too. Thanks for this clean, simple solution."
                        },
                        {
                            "owner": {
                                "account_id": 1801314,
                                "reputation": 13126,
                                "user_id": 1639594,
                                "user_type": "registered",
                                "accept_rate": 53,
                                "display_name": "Cybernetic"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1605851613,
                            "post_id": 11686764,
                            "comment_id": 114784482,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment114784482_11686764",
                            "body": "This doesn&#39;t work for the numbers  [1, 56, 44, 68, 12, 22, 35, 5, 1000, 1020]. It leaves 1000 in the data."
                        },
                        {
                            "owner": {
                                "account_id": 16438069,
                                "reputation": 103,
                                "user_id": 11875176,
                                "user_type": "registered",
                                "display_name": "Hashemi Emad"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1622552491,
                            "post_id": 11686764,
                            "comment_id": 119820194,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment119820194_11686764",
                            "body": "although this works, it&#39;s way faster to use   mu=np.mean(data)  s=np.std(data)  data[np.logical_and(data&lt;mu+m * s,data&gt;mu-m * s)]"
                        },
                        {
                            "owner": {
                                "account_id": 1002817,
                                "reputation": 1108,
                                "user_id": 1017293,
                                "user_type": "registered",
                                "display_name": "ARA1307"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1712523743,
                            "post_id": 11686764,
                            "comment_id": 138021315,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#comment138021315_11686764",
                            "body": "For those who get <code>TypeError: only integer scalar arrays</code> error, you&#39;re probably passing pythons&#39; list, not np.array. Just add: <code>data = np.array(data)</code> at the beginning and <code>data.tolist() </code> at the end."
                        }
                    ],
                    "owner": {
                        "account_id": 202404,
                        "reputation": 210323,
                        "user_id": 449449,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "eumiro"
                    },
                    "comment_count": 9,
                    "is_accepted": true,
                    "score": 146,
                    "last_activity_date": 1343388477,
                    "last_edit_date": 1343388477,
                    "creation_date": 1343388150,
                    "answer_id": 11686764,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/11686764#11686764",
                    "body": "<p>This method is almost identical to yours, just more numpyst (also working on numpy arrays only):</p>\n\n<pre><code>def reject_outliers(data, m=2):\n    return data[abs(data - np.mean(data)) &lt; m * np.std(data)]\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 9748851,
                                "reputation": 544,
                                "user_id": 7227829,
                                "user_type": "registered",
                                "display_name": "Charlie G"
                            },
                            "edited": false,
                            "score": 8,
                            "creation_date": 1491429221,
                            "post_id": 16562028,
                            "comment_id": 73554658,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment73554658_16562028",
                            "body": "<a href=\"http://www.itl.nist.gov/div898/handbook/eda/section3/eda35h.htm\" rel=\"nofollow noreferrer\">itl.nist.gov/div898/handbook/eda/section3/eda35h.htm</a> this is basically the modified Z-score referenced here, but with a different threshold. If my math is right, they recommend an m of <code>3.5 &#47; .6745 ~= 5.189</code> (they multiply <code>s</code> by .6745 and specify an <code>m</code> of 3.5...also take <code>abs(s)</code>).   Can anybody explain the choice of m? Or is it something you&#39;ll identify from your particular dataset?"
                        },
                        {
                            "owner": {
                                "account_id": 59120,
                                "reputation": 57347,
                                "user_id": 176922,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "Benjamin Bannier"
                            },
                            "reply_to_user": {
                                "account_id": 9748851,
                                "reputation": 544,
                                "user_id": 7227829,
                                "user_type": "registered",
                                "display_name": "Charlie G"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1495878966,
                            "post_id": 16562028,
                            "comment_id": 75442020,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment75442020_16562028",
                            "body": "@Charlie: The choice for <code>m</code> depends on the input data set. Its value ultimately decides the purity of the filtered data and the efficiency of rejecting true outliers. One way to determine a good value would be to examine the interplay of purity and efficiency from simulated (training) data, and pick some value."
                        },
                        {
                            "owner": {
                                "account_id": 117234,
                                "reputation": 39915,
                                "user_id": 4561314,
                                "user_type": "registered",
                                "accept_rate": 53,
                                "display_name": "stackoverflowuser2010"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1498595196,
                            "post_id": 16562028,
                            "comment_id": 76559315,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment76559315_16562028",
                            "body": "@BenjaminBannier: Can you please provide some concrete explanation for choosing a value for <code>m</code> rather than fluffy statements like &quot;interplay of purity and efficiency&quot;?"
                        },
                        {
                            "owner": {
                                "account_id": 59120,
                                "reputation": 57347,
                                "user_id": 176922,
                                "user_type": "registered",
                                "accept_rate": 62,
                                "display_name": "Benjamin Bannier"
                            },
                            "reply_to_user": {
                                "account_id": 117234,
                                "reputation": 39915,
                                "user_id": 4561314,
                                "user_type": "registered",
                                "accept_rate": 53,
                                "display_name": "stackoverflowuser2010"
                            },
                            "edited": false,
                            "score": 2,
                            "creation_date": 1498651039,
                            "post_id": 16562028,
                            "comment_id": 76583318,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment76583318_16562028",
                            "body": "@stackoverflowuser2010: Like I said, this depends on your specific requirements, i.e., how clean we need to signal sample to be (false positives), or how many signal measurements we can afford to throw away to keep the signal clean (false negatives). As for a specific example evaluation for a certain use case, see e.g., <a href=\"http://www.desy.de/~blist/notes/whyeffpur.ps.gz\" rel=\"nofollow noreferrer\">desy.de/~blist/notes/whyeffpur.ps.gz</a>."
                        },
                        {
                            "owner": {
                                "account_id": 3032426,
                                "reputation": 2269,
                                "user_id": 2571165,
                                "user_type": "registered",
                                "accept_rate": 88,
                                "display_name": "Omegaman"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1503593603,
                            "post_id": 16562028,
                            "comment_id": 78692775,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment78692775_16562028",
                            "body": "I&#39;m looking for the Igleqicz and Hoaglin paper, but haven&#39;t found it yet. Is there a reason given for why the 0.6745 factor is hardcoded into the modified Z-score provided by NIST?  It does seem odd to include a scaling factor on one side of the test and then an arbitrary threshold of 3.5 on the other.  That scaling factor must have a meaning, otherwise it would have been as easy to drop it and suggest values greater than 5 are outliers."
                        },
                        {
                            "owner": {
                                "account_id": 170035,
                                "reputation": 6524,
                                "user_id": 396483,
                                "user_type": "registered",
                                "accept_rate": 68,
                                "display_name": "john k"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1505600905,
                            "post_id": 16562028,
                            "comment_id": 79481574,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment79481574_16562028",
                            "body": "this gives me a &#39;list index out of range&#39;"
                        },
                        {
                            "owner": {
                                "account_id": 95521,
                                "reputation": 2753,
                                "user_id": 260108,
                                "user_type": "registered",
                                "accept_rate": 76,
                                "display_name": "Vasilis"
                            },
                            "edited": false,
                            "score": 4,
                            "creation_date": 1521426593,
                            "post_id": 16562028,
                            "comment_id": 85710291,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment85710291_16562028",
                            "body": "I get the following error when I call the function with a list of floats: <code>TypeError: only integer scalar arrays can be converted to a scalar index</code>"
                        },
                        {
                            "owner": {
                                "account_id": 5370370,
                                "reputation": 808,
                                "user_id": 4341436,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Fato39"
                            },
                            "reply_to_user": {
                                "account_id": 9748851,
                                "reputation": 544,
                                "user_id": 7227829,
                                "user_type": "registered",
                                "display_name": "Charlie G"
                            },
                            "edited": false,
                            "score": 3,
                            "creation_date": 1524750335,
                            "post_id": 16562028,
                            "comment_id": 87105437,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment87105437_16562028",
                            "body": "@Charlie, if you look at the figure <a href=\"https://www.itl.nist.gov/div898/handbook/eda/section3/eda356.htm#MAD\" rel=\"nofollow noreferrer\">itl.nist.gov/div898/handbook/eda/section3/eda356.htm#MAD</a> , you will see that when dealing with normal distribution (which in fact is not the case you would need the modified z-scores) with SD = 1, you have MAD ~ 0.68, which explains the scaling factor. The choice of m = 3.5 therefore implies that you want to discard 0.05 % of the data."
                        },
                        {
                            "owner": {
                                "account_id": 9748851,
                                "reputation": 544,
                                "user_id": 7227829,
                                "user_type": "registered",
                                "display_name": "Charlie G"
                            },
                            "reply_to_user": {
                                "account_id": 5370370,
                                "reputation": 808,
                                "user_id": 4341436,
                                "user_type": "registered",
                                "accept_rate": 100,
                                "display_name": "Fato39"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1524875221,
                            "post_id": 16562028,
                            "comment_id": 87160108,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment87160108_16562028",
                            "body": "@Fato39 so m can be thought of as a discarding decision parameter? Neat!"
                        },
                        {
                            "owner": {
                                "account_id": 2021451,
                                "reputation": 1439,
                                "user_id": 2836444,
                                "user_type": "registered",
                                "accept_rate": 80,
                                "display_name": "gkpln3"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1537966146,
                            "post_id": 16562028,
                            "comment_id": 91975809,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment91975809_16562028",
                            "body": "This has given me much better results than the accepted answer. I&#39;ve added this section to enable receiving an arbitrary list:    <code>def reject_outliers(data, m = 2.):     if not isinstance(data, np.ndarray):         data = np.array(data)     d = np.abs(data - np.median(data))     mdev = np.median(d)     s = d&#47;mdev if mdev else 0.     return data[s&lt;m]</code>"
                        },
                        {
                            "owner": {
                                "account_id": 8754174,
                                "reputation": 558,
                                "user_id": 6546263,
                                "user_type": "registered",
                                "accept_rate": 38,
                                "display_name": "sqp_125"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1574342675,
                            "post_id": 16562028,
                            "comment_id": 104205090,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment104205090_16562028",
                            "body": "I want to remove x precent of my data. How should I set m=...? I dont get it."
                        },
                        {
                            "owner": {
                                "account_id": 9755407,
                                "reputation": 1011,
                                "user_id": 7232335,
                                "user_type": "registered",
                                "display_name": "Nathaniel Jones"
                            },
                            "reply_to_user": {
                                "account_id": 8754174,
                                "reputation": 558,
                                "user_id": 6546263,
                                "user_type": "registered",
                                "accept_rate": 38,
                                "display_name": "sqp_125"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1620082021,
                            "post_id": 16562028,
                            "comment_id": 119091317,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment119091317_16562028",
                            "body": "@sqp_125 For removing x percent of your data, take a look at <a href=\"https://numpy.org/devdocs/reference/generated/numpy.quantile.html\" rel=\"nofollow noreferrer\">numpy.quantile</a>. To filter out the top 10% of your data: <code>data_filt = data[data &lt; np.quantile(data, 0.90)]</code>. Or to get the middle 50% of your data: <code>data_filt = data[(data &gt;= np.quantile(data, 0.25)) * (data &lt; np.quantile(data, 0.75))]</code>"
                        },
                        {
                            "owner": {
                                "account_id": 21656237,
                                "reputation": 439,
                                "user_id": 15975987,
                                "user_type": "registered",
                                "display_name": "Hefe"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1667534965,
                            "post_id": 16562028,
                            "comment_id": 131194163,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment131194163_16562028",
                            "body": "Can someone explain in simple terms how this function determines outliers? Something like: &quot;it is removing values that are <code>m</code> standard deviations away from the mean.&quot; I know that is not literally what it&#39;s doing but I&#39;m looking for an explanation in those terms."
                        },
                        {
                            "owner": {
                                "account_id": 1002817,
                                "reputation": 1108,
                                "user_id": 1017293,
                                "user_type": "registered",
                                "display_name": "ARA1307"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1712523806,
                            "post_id": 16562028,
                            "comment_id": 138021322,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#comment138021322_16562028",
                            "body": "Those who get <code>TypeError: only integer scalar arrays can be converted to a scalar index</code> error, you&#39;re passing pythons&#39; list, not np.array. You should convert list to np.array at the beginning and then back to the list at the end."
                        }
                    ],
                    "owner": {
                        "account_id": 59120,
                        "reputation": 57347,
                        "user_id": 176922,
                        "user_type": "registered",
                        "accept_rate": 62,
                        "display_name": "Benjamin Bannier"
                    },
                    "comment_count": 14,
                    "is_accepted": false,
                    "score": 234,
                    "last_activity_date": 1684765858,
                    "last_edit_date": 1684765858,
                    "creation_date": 1368611906,
                    "answer_id": 16562028,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/16562028#16562028",
                    "body": "<p>Something important when dealing with outliers is that one should try to use estimators as robust as possible. The mean of a distribution will be biased by outliers but e.g. the median will be much less.</p>\n<p>Building on eumiro's answer:</p>\n<pre><code>def reject_outliers(data, m = 2.):\n    d = np.abs(data - np.median(data))\n    mdev = np.median(d)\n    s = d/mdev if mdev else np.zeros(len(d))\n    return data[s&lt;m]\n</code></pre>\n<p>Here I have replace the mean with the more robust median and the standard deviation with the median absolute distance to the median. I then scaled the distances by their (again) median value so that <code>m</code> is on a reasonable relative scale.</p>\n<p>Note that for the <code>data[s&lt;m]</code> syntax to work, <code>data</code> must be a numpy array.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 263317,
                        "reputation": 9025,
                        "user_id": 548792,
                        "user_type": "registered",
                        "accept_rate": 67,
                        "display_name": "ankostis"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 14,
                    "last_activity_date": 1473504430,
                    "last_edit_date": 1473504430,
                    "creation_date": 1473501948,
                    "answer_id": 39424972,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/39424972#39424972",
                    "body": "<p>Building on Benjamin's, using <code>pandas.Series</code>, and replacing <a href=\"https://en.wikipedia.org/wiki/Robust_measures_of_scale#IQR_and_MAD\" rel=\"noreferrer\">MAD with IQR</a>:</p>\n\n<pre><code>def reject_outliers(sr, iq_range=0.5):\n    pcnt = (1 - iq_range) / 2\n    qlow, median, qhigh = sr.dropna().quantile([pcnt, 0.50, 1-pcnt])\n    iqr = qhigh - qlow\n    return sr[ (sr - median).abs() &lt;= iqr]\n</code></pre>\n\n<p>For instance, if you set <code>iq_range=0.6</code>, the percentiles of the interquartile-range would become: <code>0.20 &lt;--&gt; 0.80</code>, so <em>more</em> outliers will be included.</p>\n"
                },
                {
                    "owner": {
                        "account_id": 5246847,
                        "reputation": 902,
                        "user_id": 4192269,
                        "user_type": "registered",
                        "display_name": "Chris"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 5,
                    "last_activity_date": 1500554595,
                    "creation_date": 1500554595,
                    "answer_id": 45215127,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/45215127#45215127",
                    "body": "<p>An alternative is to make a robust estimation of the standard deviation (assuming Gaussian statistics). Looking up online calculators, I see that the 90% percentile corresponds to 1.2815&sigma; and the 95% is 1.645&sigma; (<a href=\"http://vassarstats.net/tabs.html?#z\" rel=\"noreferrer\">http://vassarstats.net/tabs.html?#z</a>)</p>\n\n<p>As a simple example:</p>\n\n<pre><code>import numpy as np\n\n# Create some random numbers\nx = np.random.normal(5, 2, 1000)\n\n# Calculate the statistics\nprint(\"Mean= \", np.mean(x))\nprint(\"Median= \", np.median(x))\nprint(\"Max/Min=\", x.max(), \" \", x.min())\nprint(\"StdDev=\", np.std(x))\nprint(\"90th Percentile\", np.percentile(x, 90))\n\n# Add a few large points\nx[10] += 1000\nx[20] += 2000\nx[30] += 1500\n\n# Recalculate the statistics\nprint()\nprint(\"Mean= \", np.mean(x))\nprint(\"Median= \", np.median(x))\nprint(\"Max/Min=\", x.max(), \" \", x.min())\nprint(\"StdDev=\", np.std(x))\nprint(\"90th Percentile\", np.percentile(x, 90))\n\n# Measure the percentile intervals and then estimate Standard Deviation of the distribution, both from median to the 90th percentile and from the 10th to 90th percentile\np90 = np.percentile(x, 90)\np10 = np.percentile(x, 10)\np50 = np.median(x)\n# p50 to p90 is 1.2815 sigma\nrSig = (p90-p50)/1.2815\nprint(\"Robust Sigma=\", rSig)\n\nrSig = (p90-p10)/(2*1.2815)\nprint(\"Robust Sigma=\", rSig)\n</code></pre>\n\n<p>The output I get is:</p>\n\n<pre><code>Mean=  4.99760520022\nMedian=  4.95395274981\nMax/Min= 11.1226494654   -2.15388472011\nSigma= 1.976629928\n90th Percentile 7.52065379649\n\nMean=  9.64760520022\nMedian=  4.95667658782\nMax/Min= 2205.43861943   -2.15388472011\nSigma= 88.6263902244\n90th Percentile 7.60646688694\n\nRobust Sigma= 2.06772555531\nRobust Sigma= 1.99878292462\n</code></pre>\n\n<p>Which is close to the expected value of 2.</p>\n\n<p>If we want to remove points above/below 5 standard deviations (with 1000 points we would expect 1 value > 3 standard deviations):</p>\n\n<pre><code>y = x[abs(x - p50) &lt; rSig*5]\n\n# Print the statistics again\nprint(\"Mean= \", np.mean(y))\nprint(\"Median= \", np.median(y))\nprint(\"Max/Min=\", y.max(), \" \", y.min())\nprint(\"StdDev=\", np.std(y))\n</code></pre>\n\n<p>Which gives:</p>\n\n<pre><code>Mean=  4.99755359935\nMedian=  4.95213030447\nMax/Min= 11.1226494654   -2.15388472011\nStdDev= 1.97692712883\n</code></pre>\n\n<p>I have no idea which approach is the more efficent/robust</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 5944441,
                                "reputation": 1414,
                                "user_id": 4674445,
                                "user_type": "registered",
                                "display_name": "Egal"
                            },
                            "reply_to_user": {
                                "account_id": 9894636,
                                "reputation": 370,
                                "user_id": 7326568,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "\u041e\u043b\u0435\u0433 \u041c\u0456\u0441\u044c\u043a\u043e"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1689253316,
                            "post_id": 45399188,
                            "comment_id": 135189262,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/45399188#comment135189262_45399188",
                            "body": "What do you mean it doesn&#39;t work for a simple 1-d array, Oleg?"
                        },
                        {
                            "owner": {
                                "account_id": 9894636,
                                "reputation": 370,
                                "user_id": 7326568,
                                "user_type": "registered",
                                "accept_rate": 60,
                                "display_name": "\u041e\u043b\u0435\u0433 \u041c\u0456\u0441\u044c\u043a\u043e"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1689366733,
                            "post_id": 45399188,
                            "comment_id": 135208907,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/45399188#comment135208907_45399188",
                            "body": "Well, I put it very simple and concise. Can&#39;t share my code due to the NDA, but this solution does not give me the expected answer. I removed my answer since it may be misleading, maybe it does work for others in their cases. The solution below from user ankostis did the trick."
                        }
                    ],
                    "owner": {
                        "account_id": 5944441,
                        "reputation": 1414,
                        "user_id": 4674445,
                        "user_type": "registered",
                        "display_name": "Egal"
                    },
                    "comment_count": 2,
                    "is_accepted": false,
                    "score": 20,
                    "last_activity_date": 1566821201,
                    "last_edit_date": 1566821201,
                    "creation_date": 1501413024,
                    "answer_id": 45399188,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/45399188#45399188",
                    "body": "<p>Benjamin Bannier's answer yields a pass-through when the median of distances from the median is 0, so I found this modified version a bit more helpful for cases as given in the example below.</p>\n\n<pre><code>def reject_outliers_2(data, m=2.):\n    d = np.abs(data - np.median(data))\n    mdev = np.median(d)\n    s = d / (mdev if mdev else 1.)\n    return data[s &lt; m]\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>data_points = np.array([10, 10, 10, 17, 10, 10])\nprint(reject_outliers(data_points))\nprint(reject_outliers_2(data_points))\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>[[10, 10, 10, 17, 10, 10]]  # 17 is not filtered\n[10, 10, 10, 10, 10]  # 17 is filtered (it's distance, 7, is greater than m)\n</code></pre>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 6576344,
                                "reputation": 1389,
                                "user_id": 5082228,
                                "user_type": "registered",
                                "display_name": "Andy R"
                            },
                            "edited": false,
                            "score": 1,
                            "creation_date": 1535707175,
                            "post_id": 50956077,
                            "comment_id": 91175045,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/50956077#comment91175045_50956077",
                            "body": "You could also np.clip them to minimum and maximum allowed values to keep the dimensions."
                        }
                    ],
                    "owner": {
                        "account_id": 376674,
                        "reputation": 4814,
                        "user_id": 728286,
                        "user_type": "registered",
                        "accept_rate": 96,
                        "display_name": "Alex S"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1529524431,
                    "creation_date": 1529524431,
                    "answer_id": 50956077,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/50956077#50956077",
                    "body": "<p>I wanted to do something similar, except setting the number to NaN rather than removing it from the data, since if you remove it you change the length which can mess up plotting (i.e. if you're only removing outliers from one column in a table, but you need it to remain the same as the other columns so you can plot them against each other).</p>\n\n<p>To do so I used <a href=\"https://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html\" rel=\"nofollow noreferrer\">numpy's masking functions</a>:</p>\n\n<pre><code>def reject_outliers(data, m=2):\n    stdev = np.std(data)\n    mean = np.mean(data)\n    maskMin = mean - stdev * m\n    maskMax = mean + stdev * m\n    mask = np.ma.masked_outside(data, maskMin, maskMax)\n    print('Masking values outside of {} and {}'.format(maskMin, maskMax))\n    return mask\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 4877233,
                        "reputation": 963,
                        "user_id": 3931936,
                        "user_type": "registered",
                        "display_name": "Losses Don"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1537572550,
                    "last_edit_date": 1537572550,
                    "creation_date": 1537411697,
                    "answer_id": 52416834,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/52416834#52416834",
                    "body": "<p>I would like to provide two methods in this answer, solution based on \"z score\" and solution based on \"IQR\".</p>\n\n<p>The code provided in this answer works on both single dim <code>numpy</code> array and multiple <code>numpy</code> array.</p>\n\n<p>Let's import some modules firstly.</p>\n\n<pre><code>import collections\nimport numpy as np\nimport scipy.stats as stat\nfrom scipy.stats import iqr\n</code></pre>\n\n<h2>z score based method</h2>\n\n<p>This method will test if the number falls outside the three standard deviations. Based on this rule, if the value is outlier, the method will return true, if not, return false.</p>\n\n<pre><code>def sd_outlier(x, axis = None, bar = 3, side = 'both'):\n    assert side in ['gt', 'lt', 'both'], 'Side should be `gt`, `lt` or `both`.'\n\n    d_z = stat.zscore(x, axis = axis)\n\n    if side == 'gt':\n        return d_z &gt; bar\n    elif side == 'lt':\n        return d_z &lt; -bar\n    elif side == 'both':\n        return np.abs(d_z) &gt; bar\n</code></pre>\n\n<h2>IQR based method</h2>\n\n<p>This method will test if the value is less than <code>q1 - 1.5 * iqr</code> or greater than <code>q3 + 1.5 * iqr</code>, which is similar to SPSS's plot method.</p>\n\n<pre><code>def q1(x, axis = None):\n    return np.percentile(x, 25, axis = axis)\n\ndef q3(x, axis = None):\n    return np.percentile(x, 75, axis = axis)\n\ndef iqr_outlier(x, axis = None, bar = 1.5, side = 'both'):\n    assert side in ['gt', 'lt', 'both'], 'Side should be `gt`, `lt` or `both`.'\n\n    d_iqr = iqr(x, axis = axis)\n    d_q1 = q1(x, axis = axis)\n    d_q3 = q3(x, axis = axis)\n    iqr_distance = np.multiply(d_iqr, bar)\n\n    stat_shape = list(x.shape)\n\n    if isinstance(axis, collections.Iterable):\n        for single_axis in axis:\n            stat_shape[single_axis] = 1\n    else:\n        stat_shape[axis] = 1\n\n    if side in ['gt', 'both']:\n        upper_range = d_q3 + iqr_distance\n        upper_outlier = np.greater(x - upper_range.reshape(stat_shape), 0)\n    if side in ['lt', 'both']:\n        lower_range = d_q1 - iqr_distance\n        lower_outlier = np.less(x - lower_range.reshape(stat_shape), 0)\n\n    if side == 'gt':\n        return upper_outlier\n    if side == 'lt':\n        return lower_outlier\n    if side == 'both':\n        return np.logical_or(upper_outlier, lower_outlier)\n</code></pre>\n\n<p>Finally, if you want to filter out the outliers, use a <code>numpy</code> selector.</p>\n\n<p>Have a nice day.</p>\n"
                },
                {
                    "comments": [
                        {
                            "owner": {
                                "account_id": 9752008,
                                "reputation": 31,
                                "user_id": 7229979,
                                "user_type": "registered",
                                "display_name": "K. Foe"
                            },
                            "edited": false,
                            "score": 0,
                            "creation_date": 1568045663,
                            "post_id": 57857621,
                            "comment_id": 102141565,
                            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/57857621#comment102141565_57857621",
                            "body": "Sorry, I overlooked that there is already an IQR suggestion above. Should I leave this answer anyway due to shorter code or delete it?"
                        }
                    ],
                    "owner": {
                        "account_id": 9752008,
                        "reputation": 31,
                        "user_id": 7229979,
                        "user_type": "registered",
                        "display_name": "K. Foe"
                    },
                    "comment_count": 1,
                    "is_accepted": false,
                    "score": 3,
                    "last_activity_date": 1568045420,
                    "creation_date": 1568045420,
                    "answer_id": 57857621,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/57857621#57857621",
                    "body": "<p>Consider that all the above methods fail when your standard deviation gets very large due to huge outliers.</p>\n\n<p>(<em>Simalar as the average caluclation fails and should rather caluclate the median. Though, the average is \"more prone to such an error as the stdDv\".</em>)</p>\n\n<p>You could try to iteratively apply your algorithm or you filter using the interquartile range:\n(here \"factor\" relates to a n*sigma range, yet only when your data follows a Gaussian distribution)</p>\n\n<pre><code>import numpy as np\n\ndef sortoutOutliers(dataIn,factor):\n    quant3, quant1 = np.percentile(dataIn, [75 ,25])\n    iqr = quant3 - quant1\n    iqrSigma = iqr/1.34896\n    medData = np.median(dataIn)\n    dataOut = [ x for x in dataIn if ( (x &gt; medData - factor* iqrSigma) and (x &lt; medData + factor* iqrSigma) ) ] \n    return(dataOut)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 1788811,
                        "reputation": 576,
                        "user_id": 1629652,
                        "user_type": "registered",
                        "display_name": "Caner Erden"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1587317156,
                    "creation_date": 1587317156,
                    "answer_id": 61308669,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/61308669#61308669",
                    "body": "<p>if you want to get the index position of the outliers <code>idx_list</code> will return it.</p>\n\n<pre><code>def reject_outliers(data, m = 2.):\n        d = np.abs(data - np.median(data))\n        mdev = np.median(d)\n        s = d/mdev if mdev else 0.\n        data_range = np.arange(len(data))\n        idx_list = data_range[s&gt;=m]\n        return data[s&lt;m], idx_list\n\ndata_points = np.array([8, 10, 35, 17, 73, 77])  \nprint(reject_outliers(data_points))\n\nafter rejection: [ 8 10 35 17], index positions of outliers: [4 5]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 7900759,
                        "reputation": 5,
                        "user_id": 5967856,
                        "user_type": "registered",
                        "display_name": "ron653"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1593498701,
                    "creation_date": 1593498701,
                    "answer_id": 62651535,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/62651535#62651535",
                    "body": "<p>For a set of <strong>images</strong> (each image has 3 dimensions), where I wanted to reject outliers for each pixel I used:</p>\n<pre><code>mean = np.mean(imgs, axis=0)\nstd = np.std(imgs, axis=0)\nmask = np.greater(0.5 * std + 1, np.abs(imgs - mean))\nmasked = np.multiply(imgs, mask)\n</code></pre>\n<p>Then it is possible to compute the mean:</p>\n<pre><code>masked_mean = np.divide(np.sum(masked, axis=0), np.sum(mask, axis=0))\n</code></pre>\n<p>(I use it for Background Subtraction)</p>\n"
                },
                {
                    "owner": {
                        "account_id": 2421943,
                        "reputation": 2282,
                        "user_id": 4117624,
                        "user_type": "registered",
                        "accept_rate": 100,
                        "display_name": "scrx2"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1607435388,
                    "creation_date": 1607435388,
                    "answer_id": 65200210,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/65200210#65200210",
                    "body": "<p>Here I find the outliers in <code>x</code> and substitute them with the median of a window of points (<code>win</code>) around them (taking from Benjamin Bannier answer the median deviation)</p>\n<pre><code>def outlier_smoother(x, m=3, win=3, plots=False):\n    ''' finds outliers in x, points &gt; m*mdev(x) [mdev:median deviation] \n    and replaces them with the median of win points around them '''\n    x_corr = np.copy(x)\n    d = np.abs(x - np.median(x))\n    mdev = np.median(d)\n    idxs_outliers = np.nonzero(d &gt; m*mdev)[0]\n    for i in idxs_outliers:\n        if i-win &lt; 0:\n            x_corr[i] = np.median(np.append(x[0:i], x[i+1:i+win+1]))\n        elif i+win+1 &gt; len(x):\n            x_corr[i] = np.median(np.append(x[i-win:i], x[i+1:len(x)]))\n        else:\n            x_corr[i] = np.median(np.append(x[i-win:i], x[i+1:i+win+1]))\n    if plots:\n        plt.figure('outlier_smoother', clear=True)\n        plt.plot(x, label='orig.', lw=5)\n        plt.plot(idxs_outliers, x[idxs_outliers], 'ro', label='outliers')                                                                                                                    \n        plt.plot(x_corr, '-o', label='corrected')\n        plt.legend()\n    \n    return x_corr\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/Wom6j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wom6j.png\" alt=\"enter image description here\" /></a></p>\n"
                },
                {
                    "owner": {
                        "account_id": 426613,
                        "reputation": 1261,
                        "user_id": 807908,
                        "user_type": "registered",
                        "display_name": "Yaroslav"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1624947322,
                    "creation_date": 1624947322,
                    "answer_id": 68173504,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/68173504#68173504",
                    "body": "<p>Trim outliers in a numpy array along axis and replace them with min or max values along this axis, whichever is closer. The threshold is z-score:</p>\n<pre><code>def np_z_trim(x, threshold=10, axis=0):\n    &quot;&quot;&quot; Replace outliers in numpy ndarray along axis with min or max values\n    within the threshold along this axis, whichever is closer.&quot;&quot;&quot;\n    mean = np.mean(x, axis=axis, keepdims=True)\n    std = np.std(x, axis=axis, keepdims=True)\n    masked = np.where(np.abs(x - mean) &lt; threshold * std, x, np.nan)\n    min = np.nanmin(masked, axis=axis, keepdims=True)\n    max = np.nanmax(masked, axis=axis, keepdims=True)\n    repl = np.where(np.abs(x - max) &lt; np.abs(x - min), max, min)\n    return np.where(np.isnan(masked), repl, masked)\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 11222659,
                        "reputation": 2430,
                        "user_id": 8233320,
                        "user_type": "registered",
                        "accept_rate": 92,
                        "display_name": "whoisraibolt"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 1,
                    "last_activity_date": 1635365798,
                    "last_edit_date": 1635365798,
                    "creation_date": 1635365423,
                    "answer_id": 69744877,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/69744877#69744877",
                    "body": "<p>So many answers, but I'm adding a new one that can be useful for the author or even for other users.</p>\n<p>You could use the <strong>Hampel filter</strong>. But you need to work with <code>Series</code>.</p>\n<p><strong>Hampel filter</strong> returns the <strong>Outliers indices</strong>, then you can delete them from the <code>Series</code>, and then convert it back to a <code>List</code>.</p>\n<p>To use <strong>Hampel filter</strong>, you can easily install the package with <code>pip</code>:</p>\n<pre><code>pip install hampel\n</code></pre>\n<p>Usage:</p>\n<pre><code># Imports\nfrom hampel import hampel\nimport pandas as pd\n\nlist_d = [2, 4, 5, 1, 6, 5, 40]\n\n# List to Series\ntime_series = pd.Series(list_d)\n\n# Outlier detection with Hampel filter\n# Returns the Outlier indices\noutlier_indices = hampel(ts = time_series, window_size = 3)\n\n# Drop Outliers indices from Series\nfiltered_d = time_series.drop(outlier_indices)\n\nfiltered_d.values.tolist()\n\nprint(f'filtered_d: {filtered_d.values.tolist()}')\n</code></pre>\n<p>And the output will be:</p>\n<blockquote>\n<p>filtered_d: [2, 4, 5, 1, 6, 5]</p>\n</blockquote>\n<p>Where, <code>ts</code> is a pandas <code>Series</code> object and <code>window_size</code> is a total window size will be computed as <code>2 * window_size + 1</code>.</p>\n<p>For this Series I set <code>window_size</code> with the value <code>3</code>.</p>\n<p>The cool thing about working with Series is being able to generate graphics:</p>\n<pre><code># Imports\nimport matplotlib.pyplot as plt\n\nplt.style.use('seaborn-darkgrid')\n\n# Plot Original Series\ntime_series.plot(style = 'k-')\nplt.title('Original Series')\nplt.show()\n    \n# Plot Cleaned Series\nfiltered_d.plot(style = 'k-')\nplt.title('Cleaned Series (Without detected Outliers)')\nplt.show()\n</code></pre>\n<p>And the output will be:</p>\n<p><a href=\"https://i.stack.imgur.com/EzRA0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EzRA0.png\" alt=\"enter image description here\" /></a>\n<a href=\"https://i.stack.imgur.com/PFklE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PFklE.png\" alt=\"enter image description here\" /></a></p>\n<p>To learn more about <strong>Hampel filter</strong>, I recommend the following readings:</p>\n<ul>\n<li><a href=\"https://github.com/MichaelisTrofficus/hampel_filter\" rel=\"nofollow noreferrer\">Python implementation of the Hampel Filter</a></li>\n<li><a href=\"https://towardsdatascience.com/outlier-detection-with-hampel-filter-85ddf523c73d\" rel=\"nofollow noreferrer\">Outlier Detection with Hampel Filter</a></li>\n<li><a href=\"https://medium.com/wwblog/clean-up-your-time-series-data-with-a-hampel-filter-58b0bb3ebb04\" rel=\"nofollow noreferrer\">Clean-up your time series data with a Hampel Filter</a></li>\n</ul>\n"
                },
                {
                    "owner": {
                        "account_id": 3931023,
                        "reputation": 1168,
                        "user_id": 3249563,
                        "user_type": "registered",
                        "display_name": "Johnny V"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1635515826,
                    "creation_date": 1635515826,
                    "answer_id": 69770185,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/69770185#69770185",
                    "body": "<p>My solution drops the top and bottom percentiles, keeping values that are equal to the boundary:</p>\n<pre class=\"lang-py prettyprint-override\"><code>def remove_percentile_outliers(data, percent_to_drop=0.001):\n    low, high = data.quantile([percent_to_drop / 2, 1-percent_to_drop / 2])\n    return data[(data &gt;= low )&amp;(data &lt;= high)]\n</code></pre>\n"
                },
                {
                    "owner": {
                        "account_id": 23224232,
                        "reputation": 11,
                        "user_id": 17348590,
                        "user_type": "registered",
                        "display_name": "Kurt Hoppe"
                    },
                    "comment_count": 0,
                    "is_accepted": false,
                    "score": 0,
                    "last_activity_date": 1659586883,
                    "creation_date": 1659586883,
                    "answer_id": 73230346,
                    "question_id": 11686720,
                    "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list/73230346#73230346",
                    "body": "<p>My solution let the outliers equal to the previous value.</p>\n<pre><code>test_data = [2,4,5,1,6,5,40, 3]\ndef reject_outliers(data, m=2):\n    mean = np.mean(data)\n    std = np.std(data)\n    for i in range(len(data)) :\n        if np.abs(data[i] -mean) &gt; m*std :\n            data[i] = data[i-1]\n    return data\nreject_outliers(test_data)\n</code></pre>\n<p>Output:</p>\n<pre><code>[2, 4, 5, 1, 6, 5, 5, 3]\n</code></pre>\n"
                }
            ],
            "owner": {
                "account_id": 1182444,
                "reputation": 5505,
                "user_id": 1157089,
                "user_type": "registered",
                "accept_rate": 71,
                "display_name": "aaren"
            },
            "comment_count": 4,
            "is_answered": true,
            "accepted_answer_id": 11686764,
            "answer_count": 15,
            "score": 140,
            "last_activity_date": 1684765858,
            "creation_date": 1343387957,
            "question_id": 11686720,
            "link": "https://stackoverflow.com/questions/11686720/is-there-a-numpy-builtin-to-reject-outliers-from-a-list",
            "title": "Is there a numpy builtin to reject outliers from a list",
            "body": "<p>Is there a numpy builtin to do something like the following? That is, take a list <code>d</code> and return a list <code>filtered_d</code> with any outlying elements removed based on some assumed distribution of the points in <code>d</code>.</p>\n\n<pre><code>import numpy as np\n\ndef reject_outliers(data):\n    m = 2\n    u = np.mean(data)\n    s = np.std(data)\n    filtered = [e for e in data if (u - 2 * s &lt; e &lt; u + 2 * s)]\n    return filtered\n\n&gt;&gt;&gt; d = [2,4,5,1,6,5,40]\n&gt;&gt;&gt; filtered_d = reject_outliers(d)\n&gt;&gt;&gt; print filtered_d\n[2,4,5,1,6,5]\n</code></pre>\n\n<p>I say 'something like' because the function might allow for varying distributions (poisson, gaussian, etc.) and varying outlier thresholds within those distributions (like the <code>m</code> I've used here).</p>\n"
        }
    ],
    "has_more": false,
    "quota_max": 10000,
    "quota_remaining": 5373
}